var Qy=Object.defineProperty,tm=Object.defineProperties;var em=Object.getOwnPropertyDescriptors;var Ts=Object.getOwnPropertySymbols;var df=Object.prototype.hasOwnProperty,pf=Object.prototype.propertyIsEnumerable;var ff=(r,e,t)=>e in r?Qy(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,On=(r,e)=>{for(var t in e||(e={}))df.call(e,t)&&ff(r,t,e[t]);if(Ts)for(var t of Ts(e))pf.call(e,t)&&ff(r,t,e[t]);return r},Zn=(r,e)=>tm(r,em(e));var fo=(r,e)=>{var t={};for(var n in r)df.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&Ts)for(var n of Ts(r))e.indexOf(n)<0&&pf.call(r,n)&&(t[n]=r[n]);return t};import{S as Mr,i as Lr,s as Dr,e as ie,t as Ni,c as re,a as _e,h as Bi,d as Mt,b as St,g as Le,J as Ut,K as Ln,j as sh,k as De,m as ke,E as ce,L as nm,M as Od,N as Bs,O as Gs,w as si,x as ai,y as li,P as ur,Q as zs,q as Dn,o as kn,B as hi,R as Th,v as wh,T as Us,U as Pl,V as gf,W as im,X as rm}from"./index-3c56177a.js";import{w as om}from"./index-60e10c7c.js";var sm=function(){function r(e){this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null}return r.prototype.preventDefault=function(){this.defaultPrevented=!0},r.prototype.stopPropagation=function(){this.propagationStopped=!0},r}(),Nn=sm,Or={PROPERTYCHANGE:"propertychange"},am=function(){function r(){this.disposed=!1}return r.prototype.dispose=function(){this.disposed||(this.disposed=!0,this.disposeInternal())},r.prototype.disposeInternal=function(){},r}(),_a=am;function Ir(r,e){return r>e?1:r<e?-1:0}function Sh(r,e,t){var n=r.length;if(r[0]<=e)return 0;if(e<=r[n-1])return n-1;var i=void 0;if(t>0){for(i=1;i<n;++i)if(r[i]<e)return i-1}else if(t<0){for(i=1;i<n;++i)if(r[i]<=e)return i}else for(i=1;i<n;++i){if(r[i]==e)return i;if(r[i]<e)return typeof t=="function"?t(e,r[i-1],r[i])>0?i-1:i:r[i-1]-e<e-r[i]?i-1:i}return n-1}function lm(r,e,t){for(;e<t;){var n=r[e];r[e]=r[t],r[t]=n,++e,--t}}function Id(r,e){for(var t=Array.isArray(e)?e:[e],n=t.length,i=0;i<n;i++)r[r.length]=t[i]}function Ki(r,e){var t=r.length;if(t!==e.length)return!1;for(var n=0;n<t;n++)if(r[n]!==e[n])return!1;return!0}function hm(r,e,t){var n=e||Ir;return r.every(function(i,a){if(a===0)return!0;var u=n(r[a-1],i);return!(u>0||t&&u===0)})}function wr(){return!0}function va(){return!1}function Hi(){}function cm(r){var e=!1,t,n,i;return function(){var a=Array.prototype.slice.call(arguments);return(!e||this!==i||!Ki(a,n))&&(e=!0,i=this,n=a,t=r.apply(this,arguments)),t}}function um(r){function e(){var t;try{t=r()}catch(n){return Promise.reject(n)}return t instanceof Promise?t:Promise.resolve(t)}return e()}var oe=typeof Object.assign=="function"?Object.assign:function(r,e){if(r==null)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(r),n=1,i=arguments.length;n<i;++n){var a=arguments[n];if(a!=null)for(var u in a)a.hasOwnProperty(u)&&(t[u]=a[u])}return t};function kr(r){for(var e in r)delete r[e]}var Ad=typeof Object.values=="function"?Object.values:function(r){var e=[];for(var t in r)e.push(r[t]);return e};function Oo(r){var e;for(e in r)return!1;return!e}var fm=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),dm=function(r){fm(e,r);function e(t){var n=r.call(this)||this;return n.eventTarget_=t,n.pendingRemovals_=null,n.dispatching_=null,n.listeners_=null,n}return e.prototype.addEventListener=function(t,n){if(!(!t||!n)){var i=this.listeners_||(this.listeners_={}),a=i[t]||(i[t]=[]);a.indexOf(n)===-1&&a.push(n)}},e.prototype.dispatchEvent=function(t){var n=typeof t=="string",i=n?t:t.type,a=this.listeners_&&this.listeners_[i];if(!!a){var u=n?new Nn(t):t;u.target||(u.target=this.eventTarget_||this);var p=this.dispatching_||(this.dispatching_={}),g=this.pendingRemovals_||(this.pendingRemovals_={});i in p||(p[i]=0,g[i]=0),++p[i];for(var v,m=0,b=a.length;m<b;++m)if("handleEvent"in a[m]?v=a[m].handleEvent(u):v=a[m].call(this,u),v===!1||u.propagationStopped){v=!1;break}if(--p[i]===0){var E=g[i];for(delete g[i];E--;)this.removeEventListener(i,Hi);delete p[i]}return v}},e.prototype.disposeInternal=function(){this.listeners_&&kr(this.listeners_)},e.prototype.getListeners=function(t){return this.listeners_&&this.listeners_[t]||void 0},e.prototype.hasListener=function(t){return this.listeners_?t?t in this.listeners_:Object.keys(this.listeners_).length>0:!1},e.prototype.removeEventListener=function(t,n){var i=this.listeners_&&this.listeners_[t];if(i){var a=i.indexOf(n);a!==-1&&(this.pendingRemovals_&&t in this.pendingRemovals_?(i[a]=Hi,++this.pendingRemovals_[t]):(i.splice(a,1),i.length===0&&delete this.listeners_[t]))}},e}(_a),Zi=dm,pt={CHANGE:"change",ERROR:"error",BLUR:"blur",CLEAR:"clear",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",DRAGENTER:"dragenter",DRAGOVER:"dragover",DROP:"drop",FOCUS:"focus",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",RESIZE:"resize",TOUCHMOVE:"touchmove",WHEEL:"wheel"};function Lt(r,e,t,n,i){if(n&&n!==r&&(t=t.bind(n)),i){var a=t;t=function(){r.removeEventListener(e,t),a.apply(this,arguments)}}var u={target:r,type:e,listener:t};return r.addEventListener(e,t),u}function qs(r,e,t,n){return Lt(r,e,t,n,!0)}function Kt(r){r&&r.target&&(r.target.removeEventListener(r.type,r.listener),kr(r))}var pm=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),ya=function(r){pm(e,r);function e(){var t=r.call(this)||this;return t.on=t.onInternal,t.once=t.onceInternal,t.un=t.unInternal,t.revision_=0,t}return e.prototype.changed=function(){++this.revision_,this.dispatchEvent(pt.CHANGE)},e.prototype.getRevision=function(){return this.revision_},e.prototype.onInternal=function(t,n){if(Array.isArray(t)){for(var i=t.length,a=new Array(i),u=0;u<i;++u)a[u]=Lt(this,t[u],n);return a}else return Lt(this,t,n)},e.prototype.onceInternal=function(t,n){var i;if(Array.isArray(t)){var a=t.length;i=new Array(a);for(var u=0;u<a;++u)i[u]=qs(this,t[u],n)}else i=qs(this,t,n);return n.ol_key=i,i},e.prototype.unInternal=function(t,n){var i=n.ol_key;if(i)gm(i);else if(Array.isArray(t))for(var a=0,u=t.length;a<u;++a)this.removeEventListener(t[a],n);else this.removeEventListener(t,n)},e}(Zi);ya.prototype.on;ya.prototype.once;ya.prototype.un;function gm(r){if(Array.isArray(r))for(var e=0,t=r.length;e<t;++e)Kt(r[e]);else Kt(r)}var Pd=ya;function Rt(){return function(){throw new Error("Unimplemented abstract method.")}()}var _m=0;function Xt(r){return r.ol_uid||(r.ol_uid=String(++_m))}var vm="6.14.1",Md=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),_f=function(r){Md(e,r);function e(t,n,i){var a=r.call(this,t)||this;return a.key=n,a.oldValue=i,a}return e}(Nn),ym=function(r){Md(e,r);function e(t){var n=r.call(this)||this;return n.on,n.once,n.un,Xt(n),n.values_=null,t!==void 0&&n.setProperties(t),n}return e.prototype.get=function(t){var n;return this.values_&&this.values_.hasOwnProperty(t)&&(n=this.values_[t]),n},e.prototype.getKeys=function(){return this.values_&&Object.keys(this.values_)||[]},e.prototype.getProperties=function(){return this.values_&&oe({},this.values_)||{}},e.prototype.hasProperties=function(){return!!this.values_},e.prototype.notify=function(t,n){var i;i="change:".concat(t),this.hasListener(i)&&this.dispatchEvent(new _f(i,t,n)),i=Or.PROPERTYCHANGE,this.hasListener(i)&&this.dispatchEvent(new _f(i,t,n))},e.prototype.addChangeListener=function(t,n){this.addEventListener("change:".concat(t),n)},e.prototype.removeChangeListener=function(t,n){this.removeEventListener("change:".concat(t),n)},e.prototype.set=function(t,n,i){var a=this.values_||(this.values_={});if(i)a[t]=n;else{var u=a[t];a[t]=n,u!==n&&this.notify(t,u)}},e.prototype.setProperties=function(t,n){for(var i in t)this.set(i,t[i],n)},e.prototype.applyProperties=function(t){!t.values_||oe(this.values_||(this.values_={}),t.values_)},e.prototype.unset=function(t,n){if(this.values_&&t in this.values_){var i=this.values_[t];delete this.values_[t],Oo(this.values_)&&(this.values_=null),n||this.notify(t,i)}},e}(Pd),Tn=ym,mm=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),xm=function(r){mm(e,r);function e(t){var n=this,i="v"+vm.split("-")[0],a="Assertion failed. See https://openlayers.org/en/"+i+"/doc/errors/#"+t+" for details.";return n=r.call(this,a)||this,n.code=t,n.name="AssertionError",n.message=a,n}return e}(Error),Ld=xm;function Ct(r,e){if(!r)throw new Ld(e)}var bm=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Em=function(r){bm(e,r);function e(t){var n=r.call(this)||this;if(n.on,n.once,n.un,n.id_=void 0,n.geometryName_="geometry",n.style_=null,n.styleFunction_=void 0,n.geometryChangeKey_=null,n.addChangeListener(n.geometryName_,n.handleGeometryChanged_),t)if(typeof t.getSimplifiedGeometry=="function"){var i=t;n.setGeometry(i)}else{var a=t;n.setProperties(a)}return n}return e.prototype.clone=function(){var t=new e(this.hasProperties()?this.getProperties():null);t.setGeometryName(this.getGeometryName());var n=this.getGeometry();n&&t.setGeometry(n.clone());var i=this.getStyle();return i&&t.setStyle(i),t},e.prototype.getGeometry=function(){return this.get(this.geometryName_)},e.prototype.getId=function(){return this.id_},e.prototype.getGeometryName=function(){return this.geometryName_},e.prototype.getStyle=function(){return this.style_},e.prototype.getStyleFunction=function(){return this.styleFunction_},e.prototype.handleGeometryChange_=function(){this.changed()},e.prototype.handleGeometryChanged_=function(){this.geometryChangeKey_&&(Kt(this.geometryChangeKey_),this.geometryChangeKey_=null);var t=this.getGeometry();t&&(this.geometryChangeKey_=Lt(t,pt.CHANGE,this.handleGeometryChange_,this)),this.changed()},e.prototype.setGeometry=function(t){this.set(this.geometryName_,t)},e.prototype.setStyle=function(t){this.style_=t,this.styleFunction_=t?Tm(t):void 0,this.changed()},e.prototype.setId=function(t){this.id_=t,this.changed()},e.prototype.setGeometryName=function(t){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=t,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()},e}(Tn);function Tm(r){if(typeof r=="function")return r;var e;if(Array.isArray(r))e=r;else{Ct(typeof r.getZIndex=="function",41);var t=r;e=[t]}return function(){return e}}var vf=Em,mt={POINT:"Point",LINE_STRING:"LineString",LINEAR_RING:"LinearRing",POLYGON:"Polygon",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon",GEOMETRY_COLLECTION:"GeometryCollection",CIRCLE:"Circle"},ge={RADIANS:"radians",DEGREES:"degrees",FEET:"ft",METERS:"m",PIXELS:"pixels",TILE_PIXELS:"tile-pixels",USFEET:"us-ft"},wm={"9001":ge.METERS,"9002":ge.FEET,"9003":ge.USFEET,"9101":ge.RADIANS,"9102":ge.DEGREES};function yf(r){return wm[r]}var yn={};yn[ge.RADIANS]=6370997/(2*Math.PI);yn[ge.DEGREES]=2*Math.PI*6370997/360;yn[ge.FEET]=.3048;yn[ge.METERS]=1;yn[ge.USFEET]=1200/3937;var ui=typeof navigator!="undefined"&&typeof navigator.userAgent!="undefined"?navigator.userAgent.toLowerCase():"",Sm=ui.indexOf("firefox")!==-1,Rm=ui.indexOf("safari")!==-1&&ui.indexOf("chrom")==-1,Cm=Rm&&!!(ui.indexOf("version/15.4")>=0||ui.match(/cpu (os|iphone os) 15_4 like mac os x/)),Om=ui.indexOf("webkit")!==-1&&ui.indexOf("edge")==-1,Im=ui.indexOf("macintosh")!==-1,Dd=typeof devicePixelRatio!="undefined"?devicePixelRatio:1,ma=typeof WorkerGlobalScope!="undefined"&&typeof OffscreenCanvas!="undefined"&&self instanceof WorkerGlobalScope,Am=typeof Image!="undefined"&&Image.prototype.decode,kd=function(){var r=!1;try{var e=Object.defineProperty({},"passive",{get:function(){r=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch{}return r}(),Fd=new Array(6);function ze(){return[1,0,0,1,0,0]}function Ml(r){return xa(r,1,0,0,1,0,0)}function Nd(r,e){var t=r[0],n=r[1],i=r[2],a=r[3],u=r[4],p=r[5],g=e[0],v=e[1],m=e[2],b=e[3],E=e[4],w=e[5];return r[0]=t*g+i*v,r[1]=n*g+a*v,r[2]=t*m+i*b,r[3]=n*m+a*b,r[4]=t*E+i*w+u,r[5]=n*E+a*w+p,r}function xa(r,e,t,n,i,a,u){return r[0]=e,r[1]=t,r[2]=n,r[3]=i,r[4]=a,r[5]=u,r}function Pm(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r}function ne(r,e){var t=e[0],n=e[1];return e[0]=r[0]*t+r[2]*n+r[4],e[1]=r[1]*t+r[3]*n+r[5],e}function Mm(r,e){var t=Math.cos(e),n=Math.sin(e);return Nd(r,xa(Fd,t,n,-n,t,0,0))}function Lm(r,e,t){return Nd(r,xa(Fd,e,0,0,t,0,0))}function Dm(r,e,t){return xa(r,e,0,0,t,0,0)}function mn(r,e,t,n,i,a,u,p){var g=Math.sin(a),v=Math.cos(a);return r[0]=n*v,r[1]=i*g,r[2]=-n*g,r[3]=i*v,r[4]=u*n*v-p*n*g+e,r[5]=u*i*g+p*i*v+t,r}function Bd(r,e){var t=km(e);Ct(t!==0,32);var n=e[0],i=e[1],a=e[2],u=e[3],p=e[4],g=e[5];return r[0]=u/t,r[1]=-i/t,r[2]=-a/t,r[3]=n/t,r[4]=(a*g-u*p)/t,r[5]=-(n*g-i*p)/t,r}function km(r){return r[0]*r[3]-r[1]*r[2]}var mf;function Fm(r){var e="matrix("+r.join(", ")+")";if(ma)return e;var t=mf||(mf=document.createElement("div"));return t.style.transform=e,t.style.transform}var yo={BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",TOP_LEFT:"top-left",TOP_RIGHT:"top-right"},pe={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function xf(r){for(var e=xn(),t=0,n=r.length;t<n;++t)wo(e,r[t]);return e}function Rh(r,e,t){return t?(t[0]=r[0]-e,t[1]=r[1]-e,t[2]=r[2]+e,t[3]=r[3]+e,t):[r[0]-e,r[1]-e,r[2]+e,r[3]+e]}function Gd(r,e){return e?(e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e):r.slice()}function zd(r,e,t){var n,i;return e<r[0]?n=r[0]-e:r[2]<e?n=e-r[2]:n=0,t<r[1]?i=r[1]-t:r[3]<t?i=t-r[3]:i=0,n*n+i*i}function Yi(r,e){return Ud(r,e[0],e[1])}function xr(r,e){return r[0]<=e[0]&&e[2]<=r[2]&&r[1]<=e[1]&&e[3]<=r[3]}function Ud(r,e,t){return r[0]<=e&&e<=r[2]&&r[1]<=t&&t<=r[3]}function ah(r,e){var t=r[0],n=r[1],i=r[2],a=r[3],u=e[0],p=e[1],g=pe.UNKNOWN;return u<t?g=g|pe.LEFT:u>i&&(g=g|pe.RIGHT),p<n?g=g|pe.BELOW:p>a&&(g=g|pe.ABOVE),g===pe.UNKNOWN&&(g=pe.INTERSECTING),g}function xn(){return[1/0,1/0,-1/0,-1/0]}function bn(r,e,t,n,i){return i?(i[0]=r,i[1]=e,i[2]=t,i[3]=n,i):[r,e,t,n]}function ba(r){return bn(1/0,1/0,-1/0,-1/0,r)}function Nm(r,e){var t=r[0],n=r[1];return bn(t,n,t,n,e)}function Bm(r,e,t,n,i){var a=ba(i);return Vd(a,r,e,t,n)}function Js(r,e){return r[0]==e[0]&&r[2]==e[2]&&r[1]==e[1]&&r[3]==e[3]}function Gm(r,e){return e[0]<r[0]&&(r[0]=e[0]),e[2]>r[2]&&(r[2]=e[2]),e[1]<r[1]&&(r[1]=e[1]),e[3]>r[3]&&(r[3]=e[3]),r}function wo(r,e){e[0]<r[0]&&(r[0]=e[0]),e[0]>r[2]&&(r[2]=e[0]),e[1]<r[1]&&(r[1]=e[1]),e[1]>r[3]&&(r[3]=e[1])}function Vd(r,e,t,n,i){for(;t<n;t+=i)zm(r,e[t],e[t+1]);return r}function zm(r,e,t){r[0]=Math.min(r[0],e),r[1]=Math.min(r[1],t),r[2]=Math.max(r[2],e),r[3]=Math.max(r[3],t)}function Ch(r,e){var t;return t=e(Ea(r)),t||(t=e(Ta(r)),t)||(t=e(wa(r)),t)||(t=e(Fr(r)),t)?t:!1}function lh(r){var e=0;return Sa(r)||(e=Qt(r)*sn(r)),e}function Ea(r){return[r[0],r[1]]}function Ta(r){return[r[2],r[1]]}function $i(r){return[(r[0]+r[2])/2,(r[1]+r[3])/2]}function Um(r,e){var t;return e===yo.BOTTOM_LEFT?t=Ea(r):e===yo.BOTTOM_RIGHT?t=Ta(r):e===yo.TOP_LEFT?t=Fr(r):e===yo.TOP_RIGHT?t=wa(r):Ct(!1,13),t}function hh(r,e,t,n,i){var a=e*n[0]/2,u=e*n[1]/2,p=Math.cos(t),g=Math.sin(t),v=a*p,m=a*g,b=u*p,E=u*g,w=r[0],S=r[1],O=w-v+E,I=w-v-E,M=w+v-E,A=w+v+E,k=S-m-b,L=S-m+b,B=S+m+b,G=S+m-b;return bn(Math.min(O,I,M,A),Math.min(k,L,B,G),Math.max(O,I,M,A),Math.max(k,L,B,G),i)}function sn(r){return r[3]-r[1]}function ji(r,e,t){var n=t||xn();return Fe(r,e)?(r[0]>e[0]?n[0]=r[0]:n[0]=e[0],r[1]>e[1]?n[1]=r[1]:n[1]=e[1],r[2]<e[2]?n[2]=r[2]:n[2]=e[2],r[3]<e[3]?n[3]=r[3]:n[3]=e[3]):ba(n),n}function Fr(r){return[r[0],r[3]]}function wa(r){return[r[2],r[3]]}function Qt(r){return r[2]-r[0]}function Fe(r,e){return r[0]<=e[2]&&r[2]>=e[0]&&r[1]<=e[3]&&r[3]>=e[1]}function Sa(r){return r[2]<r[0]||r[3]<r[1]}function Vm(r,e){return e?(e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e):r}function Xm(r,e,t){var n=!1,i=ah(r,e),a=ah(r,t);if(i===pe.INTERSECTING||a===pe.INTERSECTING)n=!0;else{var u=r[0],p=r[1],g=r[2],v=r[3],m=e[0],b=e[1],E=t[0],w=t[1],S=(w-b)/(E-m),O=void 0,I=void 0;!!(a&pe.ABOVE)&&!(i&pe.ABOVE)&&(O=E-(w-v)/S,n=O>=u&&O<=g),!n&&!!(a&pe.RIGHT)&&!(i&pe.RIGHT)&&(I=w-(E-g)*S,n=I>=p&&I<=v),!n&&!!(a&pe.BELOW)&&!(i&pe.BELOW)&&(O=E-(w-p)/S,n=O>=u&&O<=g),!n&&!!(a&pe.LEFT)&&!(i&pe.LEFT)&&(I=w-(E-u)*S,n=I>=p&&I<=v)}return n}function jm(r,e){var t=e.getExtent(),n=$i(r);if(e.canWrapX()&&(n[0]<t[0]||n[0]>=t[2])){var i=Qt(t),a=Math.floor((n[0]-t[0])/i),u=a*i;r[0]-=u,r[2]-=u}return r}var Wm=function(){function r(e){this.code_=e.code,this.units_=e.units,this.extent_=e.extent!==void 0?e.extent:null,this.worldExtent_=e.worldExtent!==void 0?e.worldExtent:null,this.axisOrientation_=e.axisOrientation!==void 0?e.axisOrientation:"enu",this.global_=e.global!==void 0?e.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}return r.prototype.canWrapX=function(){return this.canWrapX_},r.prototype.getCode=function(){return this.code_},r.prototype.getExtent=function(){return this.extent_},r.prototype.getUnits=function(){return this.units_},r.prototype.getMetersPerUnit=function(){return this.metersPerUnit_||yn[this.units_]},r.prototype.getWorldExtent=function(){return this.worldExtent_},r.prototype.getAxisOrientation=function(){return this.axisOrientation_},r.prototype.isGlobal=function(){return this.global_},r.prototype.setGlobal=function(e){this.global_=e,this.canWrapX_=!!(e&&this.extent_)},r.prototype.getDefaultTileGrid=function(){return this.defaultTileGrid_},r.prototype.setDefaultTileGrid=function(e){this.defaultTileGrid_=e},r.prototype.setExtent=function(e){this.extent_=e,this.canWrapX_=!!(this.global_&&e)},r.prototype.setWorldExtent=function(e){this.worldExtent_=e},r.prototype.setGetPointResolution=function(e){this.getPointResolutionFunc_=e},r.prototype.getPointResolutionFunc=function(){return this.getPointResolutionFunc_},r}(),Qs=Wm;function se(r,e,t){return Math.min(Math.max(r,e),t)}var Hm=function(){var r;return"cosh"in Math?r=Math.cosh:r=function(e){var t=Math.exp(e);return(t+1/t)/2},r}(),Xd=function(){var r;return"log2"in Math?r=Math.log2:r=function(e){return Math.log(e)*Math.LOG2E},r}();function Ym(r,e,t,n,i,a){var u=i-t,p=a-n;if(u!==0||p!==0){var g=((r-t)*u+(e-n)*p)/(u*u+p*p);g>1?(t=i,n=a):g>0&&(t+=u*g,n+=p*g)}return Sr(r,e,t,n)}function Sr(r,e,t,n){var i=t-r,a=n-e;return i*i+a*a}function $m(r){for(var e=r.length,t=0;t<e;t++){for(var n=t,i=Math.abs(r[t][t]),a=t+1;a<e;a++){var u=Math.abs(r[a][t]);u>i&&(i=u,n=a)}if(i===0)return null;var p=r[n];r[n]=r[t],r[t]=p;for(var g=t+1;g<e;g++)for(var v=-r[g][t]/r[t][t],m=t;m<e+1;m++)t==m?r[g][m]=0:r[g][m]+=v*r[t][m]}for(var b=new Array(e),E=e-1;E>=0;E--){b[E]=r[E][e]/r[E][E];for(var w=E-1;w>=0;w--)r[w][e]-=r[w][E]*b[E]}return b}function Vs(r){return r*Math.PI/180}function So(r,e){var t=r%e;return t*e<0?t+e:t}function Li(r,e,t){return r+t*(e-r)}function jd(r,e){var t=Math.pow(10,e);return Math.round(r*t)/t}function ws(r,e){return Math.floor(jd(r,e))}function Ss(r,e){return Math.ceil(jd(r,e))}var Km=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),No=6378137,br=Math.PI*No,Zm=[-br,-br,br,br],qm=[-180,-85,180,85],Rs=No*Math.log(Math.tan(Math.PI/2)),fr=function(r){Km(e,r);function e(t){return r.call(this,{code:t,units:ge.METERS,extent:Zm,global:!0,worldExtent:qm,getPointResolution:function(n,i){return n/Hm(i[1]/No)}})||this}return e}(Qs),bf=[new fr("EPSG:3857"),new fr("EPSG:102100"),new fr("EPSG:102113"),new fr("EPSG:900913"),new fr("http://www.opengis.net/def/crs/EPSG/0/3857"),new fr("http://www.opengis.net/gml/srs/epsg.xml#3857")];function Jm(r,e,t){var n=r.length,i=t>1?t:2,a=e;a===void 0&&(i>2?a=r.slice():a=new Array(n));for(var u=0;u<n;u+=i){a[u]=br*r[u]/180;var p=No*Math.log(Math.tan(Math.PI*(+r[u+1]+90)/360));p>Rs?p=Rs:p<-Rs&&(p=-Rs),a[u+1]=p}return a}function Qm(r,e,t){var n=r.length,i=t>1?t:2,a=e;a===void 0&&(i>2?a=r.slice():a=new Array(n));for(var u=0;u<n;u+=i)a[u]=180*r[u]/br,a[u+1]=360*Math.atan(Math.exp(r[u+1]/No))/Math.PI-90;return a}var t0=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),e0=6378137,Ef=[-180,-90,180,90],n0=Math.PI*e0/180,Pi=function(r){t0(e,r);function e(t,n){return r.call(this,{code:t,units:ge.DEGREES,extent:Ef,axisOrientation:n,global:!0,metersPerUnit:n0,worldExtent:Ef})||this}return e}(Qs),Tf=[new Pi("CRS:84"),new Pi("EPSG:4326","neu"),new Pi("urn:ogc:def:crs:OGC:1.3:CRS84"),new Pi("urn:ogc:def:crs:OGC:2:84"),new Pi("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new Pi("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new Pi("http://www.opengis.net/def/crs/EPSG/0/4326","neu")],ch={};function i0(r){return ch[r]||ch[r.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function r0(r,e){ch[r]=e}var Rr={};function ta(r,e,t){var n=r.getCode(),i=e.getCode();n in Rr||(Rr[n]={}),Rr[n][i]=t}function o0(r,e){var t;return r in Rr&&e in Rr[r]&&(t=Rr[r][e]),t}function s0(r,e){return r[0]+=+e[0],r[1]+=+e[1],r}function ea(r,e){for(var t=!0,n=r.length-1;n>=0;--n)if(r[n]!=e[n]){t=!1;break}return t}function Oh(r,e){var t=Math.cos(e),n=Math.sin(e),i=r[0]*t-r[1]*n,a=r[1]*t+r[0]*n;return r[0]=i,r[1]=a,r}function a0(r,e){return r[0]*=e,r[1]*=e,r}function Wd(r,e){if(e.canWrapX()){var t=Qt(e.getExtent()),n=l0(r,e,t);n&&(r[0]-=n*t)}return r}function l0(r,e,t){var n=e.getExtent(),i=0;if(e.canWrapX()&&(r[0]<n[0]||r[0]>n[2])){var a=t||Qt(n);i=Math.floor((r[0]-n[0])/a)}return i}var h0=63710088e-1;function wf(r,e,t){var n=t||h0,i=Vs(r[1]),a=Vs(e[1]),u=(a-i)/2,p=Vs(e[0]-r[0])/2,g=Math.sin(u)*Math.sin(u)+Math.sin(p)*Math.sin(p)*Math.cos(i)*Math.cos(a);return 2*n*Math.atan2(Math.sqrt(g),Math.sqrt(1-g))}var uh=!0;function c0(r){var e=r===void 0?!0:r;uh=!e}function Ih(r,e,t){var n;if(e!==void 0){for(var i=0,a=r.length;i<a;++i)e[i]=r[i];n=e}else n=r.slice();return n}function Hd(r,e,t){if(e!==void 0&&r!==e){for(var n=0,i=r.length;n<i;++n)e[n]=r[n];r=e}return r}function u0(r){r0(r.getCode(),r),ta(r,r,Ih)}function f0(r){r.forEach(u0)}function Je(r){return typeof r=="string"?i0(r):r||null}function Sf(r,e,t,n){r=Je(r);var i,a=r.getPointResolutionFunc();if(a){if(i=a(e,t),n&&n!==r.getUnits()){var u=r.getMetersPerUnit();u&&(i=i*u/yn[n])}}else{var p=r.getUnits();if(p==ge.DEGREES&&!n||n==ge.DEGREES)i=e;else{var g=Ph(r,Je("EPSG:4326"));if(g===Hd&&p!==ge.DEGREES)i=e*r.getMetersPerUnit();else{var v=[t[0]-e/2,t[1],t[0]+e/2,t[1],t[0],t[1]-e/2,t[0],t[1]+e/2];v=g(v,v,2);var m=wf(v.slice(0,2),v.slice(2,4)),b=wf(v.slice(4,6),v.slice(6,8));i=(m+b)/2}var u=n?yn[n]:r.getMetersPerUnit();u!==void 0&&(i/=u)}}return i}function Rf(r){f0(r),r.forEach(function(e){r.forEach(function(t){e!==t&&ta(e,t,Ih)})})}function d0(r,e,t,n){r.forEach(function(i){e.forEach(function(a){ta(i,a,t),ta(a,i,n)})})}function Ah(r,e){return r?typeof r=="string"?Je(r):r:Je(e)}function p0(r,e){if(r===e)return!0;var t=r.getUnits()===e.getUnits();if(r.getCode()===e.getCode())return t;var n=Ph(r,e);return n===Ih&&t}function Ph(r,e){var t=r.getCode(),n=e.getCode(),i=o0(t,n);return i||(i=Hd),i}function na(r,e){var t=Je(r),n=Je(e);return Ph(t,n)}function g0(r,e,t){var n=na(e,t);return n(r,void 0,r.length)}var _0=null;function v0(){return _0}function ia(r,e){return r}function Pn(r,e){return uh&&!ea(r,[0,0])&&r[0]>=-180&&r[0]<=180&&r[1]>=-90&&r[1]<=90&&(uh=!1,console.warn("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),r}function Mh(r,e){return r}function Gi(r,e){return r}function y0(){Rf(bf),Rf(Tf),d0(Tf,bf,Jm,Qm)}y0();function Wi(r,e,t,n,i,a){for(var u=a||[],p=0,g=e;g<t;g+=n){var v=r[g],m=r[g+1];u[p++]=i[0]*v+i[2]*m+i[4],u[p++]=i[1]*v+i[3]*m+i[5]}return a&&u.length!=p&&(u.length=p),u}function Lh(r,e,t,n,i,a,u){for(var p=u||[],g=Math.cos(i),v=Math.sin(i),m=a[0],b=a[1],E=0,w=e;w<t;w+=n){var S=r[w]-m,O=r[w+1]-b;p[E++]=m+S*g-O*v,p[E++]=b+S*v+O*g;for(var I=w+2;I<w+n;++I)p[E++]=r[I]}return u&&p.length!=E&&(p.length=E),p}function m0(r,e,t,n,i,a,u,p){for(var g=p||[],v=u[0],m=u[1],b=0,E=e;E<t;E+=n){var w=r[E]-v,S=r[E+1]-m;g[b++]=v+i*w,g[b++]=m+a*S;for(var O=E+2;O<E+n;++O)g[b++]=r[O]}return p&&g.length!=b&&(g.length=b),g}function Yd(r,e,t,n,i,a,u){for(var p=u||[],g=0,v=e;v<t;v+=n){p[g++]=r[v]+i,p[g++]=r[v+1]+a;for(var m=v+2;m<v+n;++m)p[g++]=r[m]}return u&&p.length!=g&&(p.length=g),p}var x0=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Cf=ze(),b0=function(r){x0(e,r);function e(){var t=r.call(this)||this;return t.extent_=xn(),t.extentRevision_=-1,t.simplifiedGeometryMaxMinSquaredTolerance=0,t.simplifiedGeometryRevision=0,t.simplifyTransformedInternal=cm(function(n,i,a){if(!a)return this.getSimplifiedGeometry(i);var u=this.clone();return u.applyTransform(a),u.getSimplifiedGeometry(i)}),t}return e.prototype.simplifyTransformed=function(t,n){return this.simplifyTransformedInternal(this.getRevision(),t,n)},e.prototype.clone=function(){return Rt()},e.prototype.closestPointXY=function(t,n,i,a){return Rt()},e.prototype.containsXY=function(t,n){var i=this.getClosestPoint([t,n]);return i[0]===t&&i[1]===n},e.prototype.getClosestPoint=function(t,n){var i=n||[NaN,NaN];return this.closestPointXY(t[0],t[1],i,1/0),i},e.prototype.intersectsCoordinate=function(t){return this.containsXY(t[0],t[1])},e.prototype.computeExtent=function(t){return Rt()},e.prototype.getExtent=function(t){if(this.extentRevision_!=this.getRevision()){var n=this.computeExtent(this.extent_);(isNaN(n[0])||isNaN(n[1]))&&ba(n),this.extentRevision_=this.getRevision()}return Vm(this.extent_,t)},e.prototype.rotate=function(t,n){Rt()},e.prototype.scale=function(t,n,i){Rt()},e.prototype.simplify=function(t){return this.getSimplifiedGeometry(t*t)},e.prototype.getSimplifiedGeometry=function(t){return Rt()},e.prototype.getType=function(){return Rt()},e.prototype.applyTransform=function(t){Rt()},e.prototype.intersectsExtent=function(t){return Rt()},e.prototype.translate=function(t,n){Rt()},e.prototype.transform=function(t,n){var i=Je(t),a=i.getUnits()==ge.TILE_PIXELS?function(u,p,g){var v=i.getExtent(),m=i.getWorldExtent(),b=sn(m)/sn(v);return mn(Cf,m[0],m[3],b,-b,0,0,0),Wi(u,0,u.length,g,Cf,p),na(i,n)(u,p,g)}:na(i,n);return this.applyTransform(a),this},e}(Tn),E0=b0,je={XY:"XY",XYZ:"XYZ",XYM:"XYM",XYZM:"XYZM"},T0=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),w0=function(r){T0(e,r);function e(){var t=r.call(this)||this;return t.layout=je.XY,t.stride=2,t.flatCoordinates=null,t}return e.prototype.computeExtent=function(t){return Bm(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.getCoordinates=function(){return Rt()},e.prototype.getFirstCoordinate=function(){return this.flatCoordinates.slice(0,this.stride)},e.prototype.getFlatCoordinates=function(){return this.flatCoordinates},e.prototype.getLastCoordinate=function(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)},e.prototype.getLayout=function(){return this.layout},e.prototype.getSimplifiedGeometry=function(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;var n=this.getSimplifiedGeometryInternal(t),i=n.getFlatCoordinates();return i.length<this.flatCoordinates.length?n:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)},e.prototype.getSimplifiedGeometryInternal=function(t){return this},e.prototype.getStride=function(){return this.stride},e.prototype.setFlatCoordinates=function(t,n){this.stride=Of(t),this.layout=t,this.flatCoordinates=n},e.prototype.setCoordinates=function(t,n){Rt()},e.prototype.setLayout=function(t,n,i){var a;if(t)a=Of(t);else{for(var u=0;u<i;++u)if(n.length===0){this.layout=je.XY,this.stride=2;return}else n=n[0];a=n.length,t=S0(a)}this.layout=t,this.stride=a},e.prototype.applyTransform=function(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())},e.prototype.rotate=function(t,n){var i=this.getFlatCoordinates();if(i){var a=this.getStride();Lh(i,0,i.length,a,t,n,i),this.changed()}},e.prototype.scale=function(t,n,i){var a=n;a===void 0&&(a=t);var u=i;u||(u=$i(this.getExtent()));var p=this.getFlatCoordinates();if(p){var g=this.getStride();m0(p,0,p.length,g,t,a,u,p),this.changed()}},e.prototype.translate=function(t,n){var i=this.getFlatCoordinates();if(i){var a=this.getStride();Yd(i,0,i.length,a,t,n,i),this.changed()}},e}(E0);function S0(r){var e;return r==2?e=je.XY:r==3?e=je.XYZ:r==4&&(e=je.XYZM),e}function Of(r){var e;return r==je.XY?e=2:r==je.XYZ||r==je.XYM?e=3:r==je.XYZM&&(e=4),e}function R0(r,e,t){var n=r.getFlatCoordinates();if(n){var i=r.getStride();return Wi(n,0,n.length,i,e,t)}else return null}var Ra=w0;function $d(r,e,t,n){for(var i=0,a=t.length;i<a;++i)r[e++]=t[i];return e}function Kd(r,e,t,n){for(var i=0,a=t.length;i<a;++i)for(var u=t[i],p=0;p<n;++p)r[e++]=u[p];return e}function C0(r,e,t,n,i){for(var a=i||[],u=0,p=0,g=t.length;p<g;++p){var v=Kd(r,e,t[p],n);a[u++]=v,e=v}return a.length=u,a}var O0=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Zd=function(r){O0(e,r);function e(t,n,i){var a=r.call(this)||this;if(i!==void 0&&n===void 0)a.setFlatCoordinates(i,t);else{var u=n||0;a.setCenterAndRadius(t,u,i)}return a}return e.prototype.clone=function(){var t=new e(this.flatCoordinates.slice(),void 0,this.layout);return t.applyProperties(this),t},e.prototype.closestPointXY=function(t,n,i,a){var u=this.flatCoordinates,p=t-u[0],g=n-u[1],v=p*p+g*g;if(v<a){if(v===0)for(var m=0;m<this.stride;++m)i[m]=u[m];else{var b=this.getRadius()/Math.sqrt(v);i[0]=u[0]+b*p,i[1]=u[1]+b*g;for(var m=2;m<this.stride;++m)i[m]=u[m]}return i.length=this.stride,v}else return a},e.prototype.containsXY=function(t,n){var i=this.flatCoordinates,a=t-i[0],u=n-i[1];return a*a+u*u<=this.getRadiusSquared_()},e.prototype.getCenter=function(){return this.flatCoordinates.slice(0,this.stride)},e.prototype.computeExtent=function(t){var n=this.flatCoordinates,i=n[this.stride]-n[0];return bn(n[0]-i,n[1]-i,n[0]+i,n[1]+i,t)},e.prototype.getRadius=function(){return Math.sqrt(this.getRadiusSquared_())},e.prototype.getRadiusSquared_=function(){var t=this.flatCoordinates[this.stride]-this.flatCoordinates[0],n=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return t*t+n*n},e.prototype.getType=function(){return mt.CIRCLE},e.prototype.intersectsExtent=function(t){var n=this.getExtent();if(Fe(t,n)){var i=this.getCenter();return t[0]<=i[0]&&t[2]>=i[0]||t[1]<=i[1]&&t[3]>=i[1]?!0:Ch(t,this.intersectsCoordinate.bind(this))}return!1},e.prototype.setCenter=function(t){var n=this.stride,i=this.flatCoordinates[n]-this.flatCoordinates[0],a=t.slice();a[n]=a[0]+i;for(var u=1;u<n;++u)a[n+u]=t[u];this.setFlatCoordinates(this.layout,a),this.changed()},e.prototype.setCenterAndRadius=function(t,n,i){this.setLayout(i,t,0),this.flatCoordinates||(this.flatCoordinates=[]);var a=this.flatCoordinates,u=$d(a,0,t,this.stride);a[u++]=a[0]+n;for(var p=1,g=this.stride;p<g;++p)a[u++]=a[p];a.length=u,this.changed()},e.prototype.getCoordinates=function(){return null},e.prototype.setCoordinates=function(t,n){},e.prototype.setRadius=function(t){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+t,this.changed()},e.prototype.rotate=function(t,n){var i=this.getCenter(),a=this.getStride();this.setCenter(Lh(i,0,i.length,a,t,n,i)),this.changed()},e.prototype.translate=function(t,n){var i=this.getCenter(),a=this.getStride();this.setCenter(Yd(i,0,i.length,a,t,n,i)),this.changed()},e}(Ra);Zd.prototype.transform;var If=Zd;function Af(r,e,t,n,i,a,u){var p=r[e],g=r[e+1],v=r[t]-p,m=r[t+1]-g,b;if(v===0&&m===0)b=e;else{var E=((i-p)*v+(a-g)*m)/(v*v+m*m);if(E>1)b=t;else if(E>0){for(var w=0;w<n;++w)u[w]=Li(r[e+w],r[t+w],E);u.length=n;return}else b=e}for(var w=0;w<n;++w)u[w]=r[b+w];u.length=n}function qd(r,e,t,n,i){var a=r[e],u=r[e+1];for(e+=n;e<t;e+=n){var p=r[e],g=r[e+1],v=Sr(a,u,p,g);v>i&&(i=v),a=p,u=g}return i}function I0(r,e,t,n,i){for(var a=0,u=t.length;a<u;++a){var p=t[a];i=qd(r,e,p,n,i),e=p}return i}function Jd(r,e,t,n,i,a,u,p,g,v,m){if(e==t)return v;var b,E;if(i===0)if(E=Sr(u,p,r[e],r[e+1]),E<v){for(b=0;b<n;++b)g[b]=r[e+b];return g.length=n,E}else return v;for(var w=m||[NaN,NaN],S=e+n;S<t;)if(Af(r,S-n,S,n,u,p,w),E=Sr(u,p,w[0],w[1]),E<v){for(v=E,b=0;b<n;++b)g[b]=w[b];g.length=n,S+=n}else S+=n*Math.max((Math.sqrt(E)-Math.sqrt(v))/i|0,1);if(a&&(Af(r,t-n,e,n,u,p,w),E=Sr(u,p,w[0],w[1]),E<v)){for(v=E,b=0;b<n;++b)g[b]=w[b];g.length=n}return v}function A0(r,e,t,n,i,a,u,p,g,v,m){for(var b=m||[NaN,NaN],E=0,w=t.length;E<w;++E){var S=t[E];v=Jd(r,e,S,n,i,a,u,p,g,v,b),e=S}return v}function P0(r,e,t,n,i,a,u){var p=(t-e)/n;if(p<3){for(;e<t;e+=n)a[u++]=r[e],a[u++]=r[e+1];return u}var g=new Array(p);g[0]=1,g[p-1]=1;for(var v=[e,t-n],m=0;v.length>0;){for(var b=v.pop(),E=v.pop(),w=0,S=r[E],O=r[E+1],I=r[b],M=r[b+1],A=E+n;A<b;A+=n){var k=r[A],L=r[A+1],B=Ym(k,L,S,O,I,M);B>w&&(m=A,w=B)}w>i&&(g[(m-e)/n]=1,E+n<m&&v.push(E,m),m+n<b&&v.push(m,b))}for(var A=0;A<p;++A)g[A]&&(a[u++]=r[e+A*n],a[u++]=r[e+A*n+1]);return u}function Di(r,e){return e*Math.round(r/e)}function M0(r,e,t,n,i,a,u){if(e==t)return u;var p=Di(r[e],i),g=Di(r[e+1],i);e+=n,a[u++]=p,a[u++]=g;var v,m;do if(v=Di(r[e],i),m=Di(r[e+1],i),e+=n,e==t)return a[u++]=v,a[u++]=m,u;while(v==p&&m==g);for(;e<t;){var b=Di(r[e],i),E=Di(r[e+1],i);if(e+=n,!(b==v&&E==m)){var w=v-p,S=m-g,O=b-p,I=E-g;if(w*I==S*O&&(w<0&&O<w||w==O||w>0&&O>w)&&(S<0&&I<S||S==I||S>0&&I>S)){v=b,m=E;continue}a[u++]=v,a[u++]=m,p=v,g=m,v=b,m=E}}return a[u++]=v,a[u++]=m,u}function L0(r,e,t,n,i,a,u,p){for(var g=0,v=t.length;g<v;++g){var m=t[g];u=M0(r,e,m,n,i,a,u),p.push(u),e=m}return u}function Er(r,e,t,n,i){for(var a=i!==void 0?i:[],u=0,p=e;p<t;p+=n)a[u++]=r.slice(p,p+n);return a.length=u,a}function ra(r,e,t,n,i){for(var a=i!==void 0?i:[],u=0,p=0,g=t.length;p<g;++p){var v=t[p];a[u++]=Er(r,e,v,n,a[u]),e=v}return a.length=u,a}function Pf(r,e,t,n,i){for(var a=i!==void 0?i:[],u=0,p=0,g=t.length;p<g;++p){var v=t[p];a[u++]=ra(r,e,v,n,a[u]),e=v[v.length-1]}return a.length=u,a}function Qd(r,e,t,n){for(var i=0,a=r[t-n],u=r[t-n+1];e<t;e+=n){var p=r[e],g=r[e+1];i+=u*p-a*g,a=p,u=g}return i/2}function D0(r,e,t,n){for(var i=0,a=0,u=t.length;a<u;++a){var p=t[a];i+=Qd(r,e,p,n),e=p}return i}var k0=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),F0=function(r){k0(e,r);function e(t,n){var i=r.call(this)||this;return i.maxDelta_=-1,i.maxDeltaRevision_=-1,n!==void 0&&!Array.isArray(t[0])?i.setFlatCoordinates(n,t):i.setCoordinates(t,n),i}return e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,n,i,a){return a<zd(this.getExtent(),t,n)?a:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(qd(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Jd(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,n,i,a))},e.prototype.getArea=function(){return Qd(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getCoordinates=function(){return Er(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getSimplifiedGeometryInternal=function(t){var n=[];return n.length=P0(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,n,0),new e(n,je.XY)},e.prototype.getType=function(){return mt.LINEAR_RING},e.prototype.intersectsExtent=function(t){return!1},e.prototype.setCoordinates=function(t,n){this.setLayout(n,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Kd(this.flatCoordinates,0,t,this.stride),this.changed()},e}(Ra),Mf=F0;function N0(r,e,t,n,i){var a;for(e+=n;e<t;e+=n)if(a=i(r.slice(e-n,e),r.slice(e,e+n)),a)return a;return!1}function B0(r,e,t,n,i){var a=Ch(i,function(u){return!zi(r,e,t,n,u[0],u[1])});return!a}function zi(r,e,t,n,i,a){for(var u=0,p=r[t-n],g=r[t-n+1];e<t;e+=n){var v=r[e],m=r[e+1];g<=a?m>a&&(v-p)*(a-g)-(i-p)*(m-g)>0&&u++:m<=a&&(v-p)*(a-g)-(i-p)*(m-g)<0&&u--,p=v,g=m}return u!==0}function tp(r,e,t,n,i,a){if(t.length===0||!zi(r,e,t[0],n,i,a))return!1;for(var u=1,p=t.length;u<p;++u)if(zi(r,t[u-1],t[u],n,i,a))return!1;return!0}function ep(r,e,t,n,i){var a=Vd(xn(),r,e,t,n);return Fe(i,a)?xr(i,a)||a[0]>=i[0]&&a[2]<=i[2]||a[1]>=i[1]&&a[3]<=i[3]?!0:N0(r,e,t,n,function(u,p){return Xm(i,u,p)}):!1}function G0(r,e,t,n,i){return!!(ep(r,e,t,n,i)||zi(r,e,t,n,i[0],i[1])||zi(r,e,t,n,i[0],i[3])||zi(r,e,t,n,i[2],i[1])||zi(r,e,t,n,i[2],i[3]))}function z0(r,e,t,n,i){if(!G0(r,e,t[0],n,i))return!1;if(t.length===1)return!0;for(var a=1,u=t.length;a<u;++a)if(B0(r,t[a-1],t[a],n,i)&&!ep(r,t[a-1],t[a],n,i))return!1;return!0}function U0(r,e,t,n){for(var i=r[e],a=r[e+1],u=0,p=e+n;p<t;p+=n){var g=r[p],v=r[p+1];u+=Math.sqrt((g-i)*(g-i)+(v-a)*(v-a)),i=g,a=v}return u}var V0=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),X0=function(r){V0(e,r);function e(t,n){var i=r.call(this)||this;return i.setCoordinates(t,n),i}return e.prototype.clone=function(){var t=new e(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t},e.prototype.closestPointXY=function(t,n,i,a){var u=this.flatCoordinates,p=Sr(t,n,u[0],u[1]);if(p<a){for(var g=this.stride,v=0;v<g;++v)i[v]=u[v];return i.length=g,p}else return a},e.prototype.getCoordinates=function(){return this.flatCoordinates?this.flatCoordinates.slice():[]},e.prototype.computeExtent=function(t){return Nm(this.flatCoordinates,t)},e.prototype.getType=function(){return mt.POINT},e.prototype.intersectsExtent=function(t){return Ud(t,this.flatCoordinates[0],this.flatCoordinates[1])},e.prototype.setCoordinates=function(t,n){this.setLayout(n,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=$d(this.flatCoordinates,0,t,this.stride),this.changed()},e}(Ra),j0=X0;function W0(r,e,t,n,i,a,u){for(var p,g,v,m,b,E,w,S=i[a+1],O=[],I=0,M=t.length;I<M;++I){var A=t[I];for(m=r[A-n],E=r[A-n+1],p=e;p<A;p+=n)b=r[p],w=r[p+1],(S<=E&&w<=S||E<=S&&S<=w)&&(v=(S-E)/(w-E)*(b-m)+m,O.push(v)),m=b,E=w}var k=NaN,L=-1/0;for(O.sort(Ir),m=O[0],p=1,g=O.length;p<g;++p){b=O[p];var B=Math.abs(b-m);B>L&&(v=(m+b)/2,tp(r,e,t,n,v,S)&&(k=v,L=B)),m=b}return isNaN(k)&&(k=i[a]),u?(u.push(k,S,L),u):[k,S,L]}function H0(r,e,t,n){for(;e<t-n;){for(var i=0;i<n;++i){var a=r[e+i];r[e+i]=r[t-n+i],r[t-n+i]=a}e+=n,t-=n}}function np(r,e,t,n){for(var i=0,a=r[t-n],u=r[t-n+1];e<t;e+=n){var p=r[e],g=r[e+1];i+=(p-a)*(g+u),a=p,u=g}return i===0?void 0:i>0}function Y0(r,e,t,n,i){for(var a=i!==void 0?i:!1,u=0,p=t.length;u<p;++u){var g=t[u],v=np(r,e,g,n);if(u===0){if(a&&v||!a&&!v)return!1}else if(a&&!v||!a&&v)return!1;e=g}return!0}function Lf(r,e,t,n,i){for(var a=i!==void 0?i:!1,u=0,p=t.length;u<p;++u){var g=t[u],v=np(r,e,g,n),m=u===0?a&&v||!a&&!v:a&&!v||!a&&v;m&&H0(r,e,g,n),e=g}return e}var $0=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),ip=function(r){$0(e,r);function e(t,n,i){var a=r.call(this)||this;return a.ends_=[],a.flatInteriorPointRevision_=-1,a.flatInteriorPoint_=null,a.maxDelta_=-1,a.maxDeltaRevision_=-1,a.orientedRevision_=-1,a.orientedFlatCoordinates_=null,n!==void 0&&i?(a.setFlatCoordinates(n,t),a.ends_=i):a.setCoordinates(t,n),a}return e.prototype.appendLinearRing=function(t){this.flatCoordinates?Id(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},e.prototype.clone=function(){var t=new e(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t},e.prototype.closestPointXY=function(t,n,i,a){return a<zd(this.getExtent(),t,n)?a:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(I0(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),A0(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,n,i,a))},e.prototype.containsXY=function(t,n){return tp(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,n)},e.prototype.getArea=function(){return D0(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)},e.prototype.getCoordinates=function(t){var n;return t!==void 0?(n=this.getOrientedFlatCoordinates().slice(),Lf(n,0,this.ends_,this.stride,t)):n=this.flatCoordinates,ra(n,0,this.ends_,this.stride)},e.prototype.getEnds=function(){return this.ends_},e.prototype.getFlatInteriorPoint=function(){if(this.flatInteriorPointRevision_!=this.getRevision()){var t=$i(this.getExtent());this.flatInteriorPoint_=W0(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_},e.prototype.getInteriorPoint=function(){return new j0(this.getFlatInteriorPoint(),je.XYM)},e.prototype.getLinearRingCount=function(){return this.ends_.length},e.prototype.getLinearRing=function(t){return t<0||this.ends_.length<=t?null:new Mf(this.flatCoordinates.slice(t===0?0:this.ends_[t-1],this.ends_[t]),this.layout)},e.prototype.getLinearRings=function(){for(var t=this.layout,n=this.flatCoordinates,i=this.ends_,a=[],u=0,p=0,g=i.length;p<g;++p){var v=i[p],m=new Mf(n.slice(u,v),t);a.push(m),u=v}return a},e.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;Y0(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=Lf(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},e.prototype.getSimplifiedGeometryInternal=function(t){var n=[],i=[];return n.length=L0(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),n,0,i),new e(n,je.XY,i)},e.prototype.getType=function(){return mt.POLYGON},e.prototype.intersectsExtent=function(t){return z0(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)},e.prototype.setCoordinates=function(t,n){this.setLayout(n,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var i=C0(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=i.length===0?0:i[i.length-1],this.changed()},e}(Ra);function Df(r){var e=r[0],t=r[1],n=r[2],i=r[3],a=[e,t,e,i,n,i,n,t,e,t];return new ip(a,je.XY,[a.length])}var Ne={ADD:"add",REMOVE:"remove"},rp=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),kf={LENGTH:"length"},Cs=function(r){rp(e,r);function e(t,n,i){var a=r.call(this,t)||this;return a.element=n,a.index=i,a}return e}(Nn),K0=function(r){rp(e,r);function e(t,n){var i=r.call(this)||this;i.on,i.once,i.un;var a=n||{};if(i.unique_=!!a.unique,i.array_=t||[],i.unique_)for(var u=0,p=i.array_.length;u<p;++u)i.assertUnique_(i.array_[u],u);return i.updateLength_(),i}return e.prototype.clear=function(){for(;this.getLength()>0;)this.pop()},e.prototype.extend=function(t){for(var n=0,i=t.length;n<i;++n)this.push(t[n]);return this},e.prototype.forEach=function(t){for(var n=this.array_,i=0,a=n.length;i<a;++i)t(n[i],i,n)},e.prototype.getArray=function(){return this.array_},e.prototype.item=function(t){return this.array_[t]},e.prototype.getLength=function(){return this.get(kf.LENGTH)},e.prototype.insertAt=function(t,n){this.unique_&&this.assertUnique_(n),this.array_.splice(t,0,n),this.updateLength_(),this.dispatchEvent(new Cs(Ne.ADD,n,t))},e.prototype.pop=function(){return this.removeAt(this.getLength()-1)},e.prototype.push=function(t){this.unique_&&this.assertUnique_(t);var n=this.getLength();return this.insertAt(n,t),this.getLength()},e.prototype.remove=function(t){for(var n=this.array_,i=0,a=n.length;i<a;++i)if(n[i]===t)return this.removeAt(i)},e.prototype.removeAt=function(t){var n=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new Cs(Ne.REMOVE,n,t)),n},e.prototype.setAt=function(t,n){var i=this.getLength();if(t<i){this.unique_&&this.assertUnique_(n,t);var a=this.array_[t];this.array_[t]=n,this.dispatchEvent(new Cs(Ne.REMOVE,a,t)),this.dispatchEvent(new Cs(Ne.ADD,n,t))}else{for(var u=i;u<t;++u)this.insertAt(u,void 0);this.insertAt(t,n)}},e.prototype.updateLength_=function(){this.set(kf.LENGTH,this.array_.length)},e.prototype.assertUnique_=function(t,n){for(var i=0,a=this.array_.length;i<a;++i)if(this.array_[i]===t&&i!==n)throw new Ld(58)},e}(Tn),qe=K0,Be={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"},Z0=function(){function r(e){var t=e||{};this.color_=t.color!==void 0?t.color:null}return r.prototype.clone=function(){var e=this.getColor();return new r({color:Array.isArray(e)?e.slice():e||void 0})},r.prototype.getColor=function(){return this.color_},r.prototype.setColor=function(e){this.color_=e},r}(),op=Z0,q0=function(){function r(e){var t=e||{};this.color_=t.color!==void 0?t.color:null,this.lineCap_=t.lineCap,this.lineDash_=t.lineDash!==void 0?t.lineDash:null,this.lineDashOffset_=t.lineDashOffset,this.lineJoin_=t.lineJoin,this.miterLimit_=t.miterLimit,this.width_=t.width}return r.prototype.clone=function(){var e=this.getColor();return new r({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})},r.prototype.getColor=function(){return this.color_},r.prototype.getLineCap=function(){return this.lineCap_},r.prototype.getLineDash=function(){return this.lineDash_},r.prototype.getLineDashOffset=function(){return this.lineDashOffset_},r.prototype.getLineJoin=function(){return this.lineJoin_},r.prototype.getMiterLimit=function(){return this.miterLimit_},r.prototype.getWidth=function(){return this.width_},r.prototype.setColor=function(e){this.color_=e},r.prototype.setLineCap=function(e){this.lineCap_=e},r.prototype.setLineDash=function(e){this.lineDash_=e},r.prototype.setLineDashOffset=function(e){this.lineDashOffset_=e},r.prototype.setLineJoin=function(e){this.lineJoin_=e},r.prototype.setMiterLimit=function(e){this.miterLimit_=e},r.prototype.setWidth=function(e){this.width_=e},r}(),Xs=q0,Wt={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function Ff(r){return r[0]>0&&r[1]>0}function J0(r,e,t){return t===void 0&&(t=[0,0]),t[0]=r[0]*e+.5|0,t[1]=r[1]*e+.5|0,t}function Ge(r,e){return Array.isArray(r)?r:(e===void 0?e=[r,r]:(e[0]=r,e[1]=r),e)}var Q0=function(){function r(e){this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=Ge(e.scale),this.displacement_=e.displacement}return r.prototype.clone=function(){var e=this.getScale();return new r({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice()})},r.prototype.getOpacity=function(){return this.opacity_},r.prototype.getRotateWithView=function(){return this.rotateWithView_},r.prototype.getRotation=function(){return this.rotation_},r.prototype.getScale=function(){return this.scale_},r.prototype.getScaleArray=function(){return this.scaleArray_},r.prototype.getDisplacement=function(){return this.displacement_},r.prototype.getAnchor=function(){return Rt()},r.prototype.getImage=function(e){return Rt()},r.prototype.getHitDetectionImage=function(){return Rt()},r.prototype.getPixelRatio=function(e){return 1},r.prototype.getImageState=function(){return Rt()},r.prototype.getImageSize=function(){return Rt()},r.prototype.getOrigin=function(){return Rt()},r.prototype.getSize=function(){return Rt()},r.prototype.setDisplacement=function(e){this.displacement_=e},r.prototype.setOpacity=function(e){this.opacity_=e},r.prototype.setRotateWithView=function(e){this.rotateWithView_=e},r.prototype.setRotation=function(e){this.rotation_=e},r.prototype.setScale=function(e){this.scale_=e,this.scaleArray_=Ge(e)},r.prototype.listenImageChange=function(e){Rt()},r.prototype.load=function(){Rt()},r.prototype.unlistenImageChange=function(e){Rt()},r}(),sp=Q0,ap=/^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i,lp=/^([a-z]*)$|^hsla?\(.*\)$/i;function hp(r){return typeof r=="string"?r:fp(r)}function cp(r){var e=document.createElement("div");if(e.style.color=r,e.style.color!==""){document.body.appendChild(e);var t=getComputedStyle(e).color;return document.body.removeChild(e),t}else return""}var up=function(){var r=1024,e={},t=0;return function(n){var i;if(e.hasOwnProperty(n))i=e[n];else{if(t>=r){var a=0;for(var u in e)(a++&3)===0&&(delete e[u],--t)}i=tx(n),e[n]=i,++t}return i}}();function Io(r){return Array.isArray(r)?r:up(r)}function tx(r){var e,t,n,i,a;if(lp.exec(r)&&(r=cp(r)),ap.exec(r)){var u=r.length-1,p=void 0;u<=4?p=1:p=2;var g=u===4||u===8;e=parseInt(r.substr(1+0*p,p),16),t=parseInt(r.substr(1+1*p,p),16),n=parseInt(r.substr(1+2*p,p),16),g?i=parseInt(r.substr(1+3*p,p),16):i=255,p==1&&(e=(e<<4)+e,t=(t<<4)+t,n=(n<<4)+n,g&&(i=(i<<4)+i)),a=[e,t,n,i/255]}else r.indexOf("rgba(")==0?(a=r.slice(5,-1).split(",").map(Number),Nf(a)):r.indexOf("rgb(")==0?(a=r.slice(4,-1).split(",").map(Number),a.push(1),Nf(a)):Ct(!1,14);return a}function Nf(r){return r[0]=se(r[0]+.5|0,0,255),r[1]=se(r[1]+.5|0,0,255),r[2]=se(r[2]+.5|0,0,255),r[3]=se(r[3],0,1),r}function fp(r){var e=r[0];e!=(e|0)&&(e=e+.5|0);var t=r[1];t!=(t|0)&&(t=t+.5|0);var n=r[2];n!=(n|0)&&(n=n+.5|0);var i=r[3]===void 0?1:Math.round(r[3]*100)/100;return"rgba("+e+","+t+","+n+","+i+")"}function ex(r){return lp.test(r)&&(r=cp(r)),ap.test(r)||r.indexOf("rgba(")===0||r.indexOf("rgb(")===0}function vn(r){return Array.isArray(r)?fp(r):r}function We(r,e,t,n){var i;return t&&t.length?i=t.shift():ma?i=new OffscreenCanvas(r||300,e||300):i=document.createElement("canvas"),r&&(i.width=r),e&&(i.height=e),i.getContext("2d",n)}function Bf(r,e){var t=e.parentNode;t&&t.replaceChild(r,e)}function fh(r){return r&&r.parentNode?r.parentNode.removeChild(r):null}function nx(r){for(;r.lastChild;)r.removeChild(r.lastChild)}function ix(r,e){for(var t=r.childNodes,n=0;;++n){var i=t[n],a=e[n];if(!i&&!a)break;if(i!==a){if(!i){r.appendChild(a);continue}if(!a){r.removeChild(i),--n;continue}r.insertBefore(a,i)}}}var Os="ol-hidden",Ca="ol-unselectable",Dh="ol-control",Gf="ol-collapsed",rx=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z]+?)\\s*$`].join(""),"i"),zf=["style","variant","weight","size","lineHeight","family"],dp=function(r){var e=r.match(rx);if(!e)return null;for(var t={lineHeight:"normal",size:"1.2em",style:"normal",weight:"normal",variant:"normal"},n=0,i=zf.length;n<i;++n){var a=e[n+1];a!==void 0&&(t[zf[n]]=a)}return t.families=t.family.split(/,\s?/),t};function ox(r){return r===1?"":String(Math.round(r*100)/100)}var pp="10px sans-serif",Fn="#000",oa="round",Ao=[],Po=0,Ar="round",Mo=10,Lo="#000",Do="center",sa="middle",Ui=[0,0,0,0],ko=1,Mn=new Tn,sx=new Zi;sx.setSize=function(){console.warn("labelCache is deprecated.")};var vr=null,dh,ph={},ax=function(){var r=100,e="32px ",t=["monospace","serif"],n=t.length,i="wmytzilWMYTZIL@#/&?$%10\uF013",a,u;function p(v,m,b){for(var E=!0,w=0;w<n;++w){var S=t[w];if(u=aa(v+" "+m+" "+e+S,i),b!=S){var O=aa(v+" "+m+" "+e+b+","+S,i);E=E&&O!=u}}return!!E}function g(){for(var v=!0,m=Mn.getKeys(),b=0,E=m.length;b<E;++b){var w=m[b];Mn.get(w)<r&&(p.apply(this,w.split(`
`))?(kr(ph),vr=null,dh=void 0,Mn.set(w,r)):(Mn.set(w,Mn.get(w)+1,!0),v=!1))}v&&(clearInterval(a),a=void 0)}return function(v){var m=dp(v);if(!!m)for(var b=m.families,E=0,w=b.length;E<w;++E){var S=b[E],O=m.style+`
`+m.weight+`
`+S;Mn.get(O)===void 0&&(Mn.set(O,r,!0),p(m.style,m.weight,S)||(Mn.set(O,0,!0),a===void 0&&(a=setInterval(g,32))))}}}(),lx=function(){var r;return function(e){var t=ph[e];if(t==null){if(ma){var n=dp(e),i=gp(e,"\u017Dg"),a=isNaN(Number(n.lineHeight))?1.2:Number(n.lineHeight);t=a*(i.actualBoundingBoxAscent+i.actualBoundingBoxDescent)}else r||(r=document.createElement("div"),r.innerHTML="M",r.style.minHeight="0",r.style.maxHeight="none",r.style.height="auto",r.style.padding="0",r.style.border="none",r.style.position="absolute",r.style.display="block",r.style.left="-99999px"),r.style.font=e,document.body.appendChild(r),t=r.offsetHeight,document.body.removeChild(r);ph[e]=t}return t}}();function gp(r,e){return vr||(vr=We(1,1)),r!=dh&&(vr.font=r,dh=vr.font),vr.measureText(e)}function aa(r,e){return gp(r,e).width}function Uf(r,e,t){if(e in t)return t[e];var n=aa(r,e);return t[e]=n,n}function hx(r,e){for(var t=[],n=[],i=[],a=0,u=0,p=0,g=0,v=0,m=e.length;v<=m;v+=2){var b=e[v];if(b===`
`||v===m){a=Math.max(a,u),i.push(u),u=0,p+=g;continue}var E=e[v+1]||r.font,w=aa(E,b);t.push(w),u+=w;var S=lx(E);n.push(S),g=Math.max(g,S)}return{width:a,height:p,widths:t,heights:n,lineWidths:i}}function cx(r,e,t,n,i,a,u,p,g,v,m){r.save(),t!==1&&(r.globalAlpha*=t),e&&r.setTransform.apply(r,e),n.contextInstructions?(r.translate(g,v),r.scale(m[0],m[1]),ux(n,r)):m[0]<0||m[1]<0?(r.translate(g,v),r.scale(m[0],m[1]),r.drawImage(n,i,a,u,p,0,0,u,p)):r.drawImage(n,i,a,u,p,g,v,u*m[0],p*m[1]),r.restore()}function ux(r,e){for(var t=r.contextInstructions,n=0,i=t.length;n<i;n+=2)Array.isArray(t[n+1])?e[t[n]].apply(e,t[n+1]):e[t[n]]=t[n+1]}var fx=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),dx=function(r){fx(e,r);function e(t){var n=this,i=t.rotateWithView!==void 0?t.rotateWithView:!1;return n=r.call(this,{opacity:1,rotateWithView:i,rotation:t.rotation!==void 0?t.rotation:0,scale:t.scale!==void 0?t.scale:1,displacement:t.displacement!==void 0?t.displacement:[0,0]})||this,n.canvas_=void 0,n.hitDetectionCanvas_=null,n.fill_=t.fill!==void 0?t.fill:null,n.origin_=[0,0],n.points_=t.points,n.radius_=t.radius!==void 0?t.radius:t.radius1,n.radius2_=t.radius2,n.angle_=t.angle!==void 0?t.angle:0,n.stroke_=t.stroke!==void 0?t.stroke:null,n.size_=null,n.renderOptions_=null,n.render(),n}return e.prototype.clone=function(){var t=this.getScale(),n=new e({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,displacement:this.getDisplacement().slice()});return n.setOpacity(this.getOpacity()),n},e.prototype.getAnchor=function(){var t=this.size_;if(!t)return null;var n=this.getDisplacement();return[t[0]/2-n[0],t[1]/2+n[1]]},e.prototype.getAngle=function(){return this.angle_},e.prototype.getFill=function(){return this.fill_},e.prototype.getHitDetectionImage=function(){return this.hitDetectionCanvas_||this.createHitDetectionCanvas_(this.renderOptions_),this.hitDetectionCanvas_},e.prototype.getImage=function(t){var n=this.canvas_[t];if(!n){var i=this.renderOptions_,a=We(i.size*t,i.size*t);this.draw_(i,a,t),n=a.canvas,this.canvas_[t]=n}return n},e.prototype.getPixelRatio=function(t){return t},e.prototype.getImageSize=function(){return this.size_},e.prototype.getImageState=function(){return Wt.LOADED},e.prototype.getOrigin=function(){return this.origin_},e.prototype.getPoints=function(){return this.points_},e.prototype.getRadius=function(){return this.radius_},e.prototype.getRadius2=function(){return this.radius2_},e.prototype.getSize=function(){return this.size_},e.prototype.getStroke=function(){return this.stroke_},e.prototype.listenImageChange=function(t){},e.prototype.load=function(){},e.prototype.unlistenImageChange=function(t){},e.prototype.calculateLineJoinSize_=function(t,n,i){if(n===0||this.points_===1/0||t!=="bevel"&&t!=="miter")return n;var a=this.radius_,u=this.radius2_===void 0?a:this.radius2_;if(a<u){var p=a;a=u,u=p}var g=this.radius2_===void 0?this.points_:this.points_*2,v=2*Math.PI/g,m=u*Math.sin(v),b=Math.sqrt(u*u-m*m),E=a-b,w=Math.sqrt(m*m+E*E),S=w/m;if(t==="miter"&&S<=i)return S*n;var O=n/2/S,I=n/2*(E/w),M=Math.sqrt((a+O)*(a+O)+I*I),A=M-a;if(this.radius2_===void 0||t==="bevel")return A*2;var k=a*Math.sin(v),L=Math.sqrt(a*a-k*k),B=u-L,G=Math.sqrt(k*k+B*B),V=G/k;if(V<=i){var U=V*n/2-u-a;return 2*Math.max(A,U)}return A*2},e.prototype.createRenderOptions=function(){var t=Ar,n=0,i=null,a=0,u,p=0;this.stroke_&&(u=this.stroke_.getColor(),u===null&&(u=Lo),u=vn(u),p=this.stroke_.getWidth(),p===void 0&&(p=ko),i=this.stroke_.getLineDash(),a=this.stroke_.getLineDashOffset(),t=this.stroke_.getLineJoin(),t===void 0&&(t=Ar),n=this.stroke_.getMiterLimit(),n===void 0&&(n=Mo));var g=this.calculateLineJoinSize_(t,p,n),v=Math.max(this.radius_,this.radius2_||0),m=Math.ceil(2*v+g);return{strokeStyle:u,strokeWidth:p,size:m,lineDash:i,lineDashOffset:a,lineJoin:t,miterLimit:n}},e.prototype.render=function(){this.renderOptions_=this.createRenderOptions();var t=this.renderOptions_.size;this.canvas_={},this.size_=[t,t]},e.prototype.draw_=function(t,n,i){if(n.scale(i,i),n.translate(t.size/2,t.size/2),this.createPath_(n),this.fill_){var a=this.fill_.getColor();a===null&&(a=Fn),n.fillStyle=vn(a),n.fill()}this.stroke_&&(n.strokeStyle=t.strokeStyle,n.lineWidth=t.strokeWidth,n.setLineDash&&t.lineDash&&(n.setLineDash(t.lineDash),n.lineDashOffset=t.lineDashOffset),n.lineJoin=t.lineJoin,n.miterLimit=t.miterLimit,n.stroke())},e.prototype.createHitDetectionCanvas_=function(t){if(this.fill_){var n=this.fill_.getColor(),i=0;if(typeof n=="string"&&(n=Io(n)),n===null?i=1:Array.isArray(n)&&(i=n.length===4?n[3]:1),i===0){var a=We(t.size,t.size);this.hitDetectionCanvas_=a.canvas,this.drawHitDetectionCanvas_(t,a)}}this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.getImage(1))},e.prototype.createPath_=function(t){var n=this.points_,i=this.radius_;if(n===1/0)t.arc(0,0,i,0,2*Math.PI);else{var a=this.radius2_===void 0?i:this.radius2_;this.radius2_!==void 0&&(n*=2);for(var u=this.angle_-Math.PI/2,p=2*Math.PI/n,g=0;g<n;g++){var v=u+g*p,m=g%2===0?i:a;t.lineTo(m*Math.cos(v),m*Math.sin(v))}t.closePath()}},e.prototype.drawHitDetectionCanvas_=function(t,n){n.translate(t.size/2,t.size/2),this.createPath_(n),n.fillStyle=Fn,n.fill(),this.stroke_&&(n.strokeStyle=t.strokeStyle,n.lineWidth=t.strokeWidth,t.lineDash&&(n.setLineDash(t.lineDash),n.lineDashOffset=t.lineDashOffset),n.lineJoin=t.lineJoin,n.miterLimit=t.miterLimit,n.stroke())},e}(sp),px=dx,gx=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),_x=function(r){gx(e,r);function e(t){var n=t||{};return r.call(this,{points:1/0,fill:n.fill,radius:n.radius,stroke:n.stroke,scale:n.scale!==void 0?n.scale:1,rotation:n.rotation!==void 0?n.rotation:0,rotateWithView:n.rotateWithView!==void 0?n.rotateWithView:!1,displacement:n.displacement!==void 0?n.displacement:[0,0]})||this}return e.prototype.clone=function(){var t=this.getScale(),n=new e({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice()});return n.setOpacity(this.getOpacity()),n},e.prototype.setRadius=function(t){this.radius_=t,this.render()},e}(px),vx=_x,_p=function(){function r(e){var t=e||{};this.geometry_=null,this.geometryFunction_=Vf,t.geometry!==void 0&&this.setGeometry(t.geometry),this.fill_=t.fill!==void 0?t.fill:null,this.image_=t.image!==void 0?t.image:null,this.renderer_=t.renderer!==void 0?t.renderer:null,this.hitDetectionRenderer_=t.hitDetectionRenderer!==void 0?t.hitDetectionRenderer:null,this.stroke_=t.stroke!==void 0?t.stroke:null,this.text_=t.text!==void 0?t.text:null,this.zIndex_=t.zIndex}return r.prototype.clone=function(){var e=this.getGeometry();return e&&typeof e=="object"&&(e=e.clone()),new r({geometry:e,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer(),stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})},r.prototype.getRenderer=function(){return this.renderer_},r.prototype.setRenderer=function(e){this.renderer_=e},r.prototype.setHitDetectionRenderer=function(e){this.hitDetectionRenderer_=e},r.prototype.getHitDetectionRenderer=function(){return this.hitDetectionRenderer_},r.prototype.getGeometry=function(){return this.geometry_},r.prototype.getGeometryFunction=function(){return this.geometryFunction_},r.prototype.getFill=function(){return this.fill_},r.prototype.setFill=function(e){this.fill_=e},r.prototype.getImage=function(){return this.image_},r.prototype.setImage=function(e){this.image_=e},r.prototype.getStroke=function(){return this.stroke_},r.prototype.setStroke=function(e){this.stroke_=e},r.prototype.getText=function(){return this.text_},r.prototype.setText=function(e){this.text_=e},r.prototype.getZIndex=function(){return this.zIndex_},r.prototype.setGeometry=function(e){typeof e=="function"?this.geometryFunction_=e:typeof e=="string"?this.geometryFunction_=function(t){return t.get(e)}:e?e!==void 0&&(this.geometryFunction_=function(){return e}):this.geometryFunction_=Vf,this.geometry_=e},r.prototype.setZIndex=function(e){this.zIndex_=e},r}();function yx(r){var e;if(typeof r=="function")e=r;else{var t;if(Array.isArray(r))t=r;else{Ct(typeof r.getZIndex=="function",41);var n=r;t=[n]}e=function(){return t}}return e}var Ll=null;function mx(r,e){if(!Ll){var t=new op({color:"rgba(255,255,255,0.4)"}),n=new Xs({color:"#3399CC",width:1.25});Ll=[new _p({image:new vx({fill:t,stroke:n,radius:5}),fill:t,stroke:n})]}return Ll}function Vf(r){return r.getGeometry()}var Dl=_p,xx={POINT:"point",LINE:"line"},Bt={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"},bx=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Ex=function(r){bx(e,r);function e(t){var n=r.call(this)||this;n.on,n.once,n.un,n.background_=t.background;var i=oe({},t);return typeof t.properties=="object"&&(delete i.properties,oe(i,t.properties)),i[Bt.OPACITY]=t.opacity!==void 0?t.opacity:1,Ct(typeof i[Bt.OPACITY]=="number",64),i[Bt.VISIBLE]=t.visible!==void 0?t.visible:!0,i[Bt.Z_INDEX]=t.zIndex,i[Bt.MAX_RESOLUTION]=t.maxResolution!==void 0?t.maxResolution:1/0,i[Bt.MIN_RESOLUTION]=t.minResolution!==void 0?t.minResolution:0,i[Bt.MIN_ZOOM]=t.minZoom!==void 0?t.minZoom:-1/0,i[Bt.MAX_ZOOM]=t.maxZoom!==void 0?t.maxZoom:1/0,n.className_=i.className!==void 0?i.className:"ol-layer",delete i.className,n.setProperties(i),n.state_=null,n}return e.prototype.getBackground=function(){return this.background_},e.prototype.getClassName=function(){return this.className_},e.prototype.getLayerState=function(t){var n=this.state_||{layer:this,managed:t===void 0?!0:t},i=this.getZIndex();return n.opacity=se(Math.round(this.getOpacity()*100)/100,0,1),n.visible=this.getVisible(),n.extent=this.getExtent(),n.zIndex=i===void 0&&!n.managed?1/0:i,n.maxResolution=this.getMaxResolution(),n.minResolution=Math.max(this.getMinResolution(),0),n.minZoom=this.getMinZoom(),n.maxZoom=this.getMaxZoom(),this.state_=n,n},e.prototype.getLayersArray=function(t){return Rt()},e.prototype.getLayerStatesArray=function(t){return Rt()},e.prototype.getExtent=function(){return this.get(Bt.EXTENT)},e.prototype.getMaxResolution=function(){return this.get(Bt.MAX_RESOLUTION)},e.prototype.getMinResolution=function(){return this.get(Bt.MIN_RESOLUTION)},e.prototype.getMinZoom=function(){return this.get(Bt.MIN_ZOOM)},e.prototype.getMaxZoom=function(){return this.get(Bt.MAX_ZOOM)},e.prototype.getOpacity=function(){return this.get(Bt.OPACITY)},e.prototype.getSourceState=function(){return Rt()},e.prototype.getVisible=function(){return this.get(Bt.VISIBLE)},e.prototype.getZIndex=function(){return this.get(Bt.Z_INDEX)},e.prototype.setBackground=function(t){this.background_=t,this.changed()},e.prototype.setExtent=function(t){this.set(Bt.EXTENT,t)},e.prototype.setMaxResolution=function(t){this.set(Bt.MAX_RESOLUTION,t)},e.prototype.setMinResolution=function(t){this.set(Bt.MIN_RESOLUTION,t)},e.prototype.setMaxZoom=function(t){this.set(Bt.MAX_ZOOM,t)},e.prototype.setMinZoom=function(t){this.set(Bt.MIN_ZOOM,t)},e.prototype.setOpacity=function(t){Ct(typeof t=="number",64),this.set(Bt.OPACITY,t)},e.prototype.setVisible=function(t){this.set(Bt.VISIBLE,t)},e.prototype.setZIndex=function(t){this.set(Bt.Z_INDEX,t)},e.prototype.disposeInternal=function(){this.state_&&(this.state_.layer=null,this.state_=null),r.prototype.disposeInternal.call(this)},e}(Tn),vp=Ex,Oe={UNDEFINED:"undefined",LOADING:"loading",READY:"ready",ERROR:"error"},Tx=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),wx=function(r){Tx(e,r);function e(t){var n=this,i=oe({},t);delete i.source,n=r.call(this,i)||this,n.on,n.once,n.un,n.mapPrecomposeKey_=null,n.mapRenderKey_=null,n.sourceChangeKey_=null,n.renderer_=null,n.rendered=!1,t.render&&(n.render=t.render),t.map&&n.setMap(t.map),n.addChangeListener(Bt.SOURCE,n.handleSourcePropertyChange_);var a=t.source?t.source:null;return n.setSource(a),n}return e.prototype.getLayersArray=function(t){var n=t||[];return n.push(this),n},e.prototype.getLayerStatesArray=function(t){var n=t||[];return n.push(this.getLayerState()),n},e.prototype.getSource=function(){return this.get(Bt.SOURCE)||null},e.prototype.getRenderSource=function(){return this.getSource()},e.prototype.getSourceState=function(){var t=this.getSource();return t?t.getState():Oe.UNDEFINED},e.prototype.handleSourceChange_=function(){this.changed()},e.prototype.handleSourcePropertyChange_=function(){this.sourceChangeKey_&&(Kt(this.sourceChangeKey_),this.sourceChangeKey_=null);var t=this.getSource();t&&(this.sourceChangeKey_=Lt(t,pt.CHANGE,this.handleSourceChange_,this)),this.changed()},e.prototype.getFeatures=function(t){return this.renderer_?this.renderer_.getFeatures(t):new Promise(function(n){return n([])})},e.prototype.getData=function(t){return!this.renderer_||!this.rendered?null:this.renderer_.getData(t)},e.prototype.render=function(t,n){var i=this.getRenderer();if(i.prepareFrame(t))return this.rendered=!0,i.renderFrame(t,n)},e.prototype.unrender=function(){this.rendered=!1},e.prototype.setMapInternal=function(t){t||this.unrender(),this.set(Bt.MAP,t)},e.prototype.getMapInternal=function(){return this.get(Bt.MAP)},e.prototype.setMap=function(t){this.mapPrecomposeKey_&&(Kt(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(Kt(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=Lt(t,Be.PRECOMPOSE,function(n){var i=n,a=i.frameState.layerStatesArray,u=this.getLayerState(!1);Ct(!a.some(function(p){return p.layer===u.layer}),67),a.push(u)},this),this.mapRenderKey_=Lt(this,pt.CHANGE,t.render,t),this.changed())},e.prototype.setSource=function(t){this.set(Bt.SOURCE,t)},e.prototype.getRenderer=function(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_},e.prototype.hasRenderer=function(){return!!this.renderer_},e.prototype.createRenderer=function(){return null},e.prototype.disposeInternal=function(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_),this.setSource(null),r.prototype.disposeInternal.call(this)},e}(vp);function la(r,e){if(!r.visible)return!1;var t=e.resolution;if(t<r.minResolution||t>=r.maxResolution)return!1;var n=e.zoom;return n>r.minZoom&&n<=r.maxZoom}var Oa=wx;function Sx(r,e,t,n,i){yp(r,e,t||0,n||r.length-1,i||Rx)}function yp(r,e,t,n,i){for(;n>t;){if(n-t>600){var a=n-t+1,u=e-t+1,p=Math.log(a),g=.5*Math.exp(2*p/3),v=.5*Math.sqrt(p*g*(a-g)/a)*(u-a/2<0?-1:1),m=Math.max(t,Math.floor(e-u*g/a+v)),b=Math.min(n,Math.floor(e+(a-u)*g/a+v));yp(r,e,m,b,i)}var E=r[e],w=t,S=n;for(po(r,t,e),i(r[n],E)>0&&po(r,t,n);w<S;){for(po(r,w,S),w++,S--;i(r[w],E)<0;)w++;for(;i(r[S],E)>0;)S--}i(r[t],E)===0?po(r,t,S):(S++,po(r,S,n)),S<=e&&(t=S+1),e<=S&&(n=S-1)}}function po(r,e,t){var n=r[e];r[e]=r[t],r[t]=n}function Rx(r,e){return r<e?-1:r>e?1:0}class mp{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(e){let t=this.data;const n=[];if(!As(e,t))return n;const i=this.toBBox,a=[];for(;t;){for(let u=0;u<t.children.length;u++){const p=t.children[u],g=t.leaf?i(p):p;As(e,g)&&(t.leaf?n.push(p):Fl(e,g)?this._all(p,n):a.push(p))}t=a.pop()}return n}collides(e){let t=this.data;if(!As(e,t))return!1;const n=[];for(;t;){for(let i=0;i<t.children.length;i++){const a=t.children[i],u=t.leaf?this.toBBox(a):a;if(As(e,u)){if(t.leaf||Fl(e,u))return!0;n.push(a)}}t=n.pop()}return!1}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let n=0;n<e.length;n++)this.insert(e[n]);return this}let t=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=t;else if(this.data.height===t.height)this._splitRoot(this.data,t);else{if(this.data.height<t.height){const n=this.data;this.data=t,t=n}this._insert(t,this.data.height-t.height-1,!0)}return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=yr([]),this}remove(e,t){if(!e)return this;let n=this.data;const i=this.toBBox(e),a=[],u=[];let p,g,v;for(;n||a.length;){if(n||(n=a.pop(),g=a[a.length-1],p=u.pop(),v=!0),n.leaf){const m=Cx(e,n.children,t);if(m!==-1)return n.children.splice(m,1),a.push(n),this._condense(a),this}!v&&!n.leaf&&Fl(n,i)?(a.push(n),u.push(p),p=0,g=n,n=n.children[0]):g?(p++,n=g.children[p],v=!1):n=null}return this}toBBox(e){return e}compareMinX(e,t){return e.minX-t.minX}compareMinY(e,t){return e.minY-t.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,t){const n=[];for(;e;)e.leaf?t.push(...e.children):n.push(...e.children),e=n.pop();return t}_build(e,t,n,i){const a=n-t+1;let u=this._maxEntries,p;if(a<=u)return p=yr(e.slice(t,n+1)),dr(p,this.toBBox),p;i||(i=Math.ceil(Math.log(a)/Math.log(u)),u=Math.ceil(a/Math.pow(u,i-1))),p=yr([]),p.leaf=!1,p.height=i;const g=Math.ceil(a/u),v=g*Math.ceil(Math.sqrt(u));Xf(e,t,n,v,this.compareMinX);for(let m=t;m<=n;m+=v){const b=Math.min(m+v-1,n);Xf(e,m,b,g,this.compareMinY);for(let E=m;E<=b;E+=g){const w=Math.min(E+g-1,b);p.children.push(this._build(e,E,w,i-1))}}return dr(p,this.toBBox),p}_chooseSubtree(e,t,n,i){for(;i.push(t),!(t.leaf||i.length-1===n);){let a=1/0,u=1/0,p;for(let g=0;g<t.children.length;g++){const v=t.children[g],m=kl(v),b=Ax(e,v)-m;b<u?(u=b,a=m<a?m:a,p=v):b===u&&m<a&&(a=m,p=v)}t=p||t.children[0]}return t}_insert(e,t,n){const i=n?e:this.toBBox(e),a=[],u=this._chooseSubtree(i,this.data,t,a);for(u.children.push(e),xo(u,i);t>=0&&a[t].children.length>this._maxEntries;)this._split(a,t),t--;this._adjustParentBBoxes(i,a,t)}_split(e,t){const n=e[t],i=n.children.length,a=this._minEntries;this._chooseSplitAxis(n,a,i);const u=this._chooseSplitIndex(n,a,i),p=yr(n.children.splice(u,n.children.length-u));p.height=n.height,p.leaf=n.leaf,dr(n,this.toBBox),dr(p,this.toBBox),t?e[t-1].children.push(p):this._splitRoot(n,p)}_splitRoot(e,t){this.data=yr([e,t]),this.data.height=e.height+1,this.data.leaf=!1,dr(this.data,this.toBBox)}_chooseSplitIndex(e,t,n){let i,a=1/0,u=1/0;for(let p=t;p<=n-t;p++){const g=mo(e,0,p,this.toBBox),v=mo(e,p,n,this.toBBox),m=Px(g,v),b=kl(g)+kl(v);m<a?(a=m,i=p,u=b<u?b:u):m===a&&b<u&&(u=b,i=p)}return i||n-t}_chooseSplitAxis(e,t,n){const i=e.leaf?this.compareMinX:Ox,a=e.leaf?this.compareMinY:Ix,u=this._allDistMargin(e,t,n,i),p=this._allDistMargin(e,t,n,a);u<p&&e.children.sort(i)}_allDistMargin(e,t,n,i){e.children.sort(i);const a=this.toBBox,u=mo(e,0,t,a),p=mo(e,n-t,n,a);let g=Is(u)+Is(p);for(let v=t;v<n-t;v++){const m=e.children[v];xo(u,e.leaf?a(m):m),g+=Is(u)}for(let v=n-t-1;v>=t;v--){const m=e.children[v];xo(p,e.leaf?a(m):m),g+=Is(p)}return g}_adjustParentBBoxes(e,t,n){for(let i=n;i>=0;i--)xo(t[i],e)}_condense(e){for(let t=e.length-1,n;t>=0;t--)e[t].children.length===0?t>0?(n=e[t-1].children,n.splice(n.indexOf(e[t]),1)):this.clear():dr(e[t],this.toBBox)}}function Cx(r,e,t){if(!t)return e.indexOf(r);for(let n=0;n<e.length;n++)if(t(r,e[n]))return n;return-1}function dr(r,e){mo(r,0,r.children.length,e,r)}function mo(r,e,t,n,i){i||(i=yr(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(let a=e;a<t;a++){const u=r.children[a];xo(i,r.leaf?n(u):u)}return i}function xo(r,e){return r.minX=Math.min(r.minX,e.minX),r.minY=Math.min(r.minY,e.minY),r.maxX=Math.max(r.maxX,e.maxX),r.maxY=Math.max(r.maxY,e.maxY),r}function Ox(r,e){return r.minX-e.minX}function Ix(r,e){return r.minY-e.minY}function kl(r){return(r.maxX-r.minX)*(r.maxY-r.minY)}function Is(r){return r.maxX-r.minX+(r.maxY-r.minY)}function Ax(r,e){return(Math.max(e.maxX,r.maxX)-Math.min(e.minX,r.minX))*(Math.max(e.maxY,r.maxY)-Math.min(e.minY,r.minY))}function Px(r,e){const t=Math.max(r.minX,e.minX),n=Math.max(r.minY,e.minY),i=Math.min(r.maxX,e.maxX),a=Math.min(r.maxY,e.maxY);return Math.max(0,i-t)*Math.max(0,a-n)}function Fl(r,e){return r.minX<=e.minX&&r.minY<=e.minY&&e.maxX<=r.maxX&&e.maxY<=r.maxY}function As(r,e){return e.minX<=r.maxX&&e.minY<=r.maxY&&e.maxX>=r.minX&&e.maxY>=r.minY}function yr(r){return{children:r,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Xf(r,e,t,n,i){const a=[e,t];for(;a.length;){if(t=a.pop(),e=a.pop(),t-e<=n)continue;const u=e+Math.ceil((t-e)/n/2)*n;Sx(r,u,e,t,i),a.push(e,u,u,t)}}var Mx=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),jf={RENDER_ORDER:"renderOrder"},Lx=function(r){Mx(e,r);function e(t){var n=this,i=t||{},a=oe({},i);return delete a.style,delete a.renderBuffer,delete a.updateWhileAnimating,delete a.updateWhileInteracting,n=r.call(this,a)||this,n.declutter_=i.declutter!==void 0?i.declutter:!1,n.renderBuffer_=i.renderBuffer!==void 0?i.renderBuffer:100,n.style_=null,n.styleFunction_=void 0,n.setStyle(i.style),n.updateWhileAnimating_=i.updateWhileAnimating!==void 0?i.updateWhileAnimating:!1,n.updateWhileInteracting_=i.updateWhileInteracting!==void 0?i.updateWhileInteracting:!1,n}return e.prototype.getDeclutter=function(){return this.declutter_},e.prototype.getFeatures=function(t){return r.prototype.getFeatures.call(this,t)},e.prototype.getRenderBuffer=function(){return this.renderBuffer_},e.prototype.getRenderOrder=function(){return this.get(jf.RENDER_ORDER)},e.prototype.getStyle=function(){return this.style_},e.prototype.getStyleFunction=function(){return this.styleFunction_},e.prototype.getUpdateWhileAnimating=function(){return this.updateWhileAnimating_},e.prototype.getUpdateWhileInteracting=function(){return this.updateWhileInteracting_},e.prototype.renderDeclutter=function(t){t.declutterTree||(t.declutterTree=new mp(9)),this.getRenderer().renderDeclutter(t)},e.prototype.setRenderOrder=function(t){this.set(jf.RENDER_ORDER,t)},e.prototype.setStyle=function(t){this.style_=t!==void 0?t:mx,this.styleFunction_=t===null?void 0:yx(this.style_),this.changed()},e}(Oa),Dx=Lx,Bo={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},Ps=[Bo.FILL],oi=[Bo.STROKE],Vi=[Bo.BEGIN_PATH],Wf=[Bo.CLOSE_PATH],ft=Bo,kx=function(){function r(){}return r.prototype.drawCustom=function(e,t,n,i){},r.prototype.drawGeometry=function(e){},r.prototype.setStyle=function(e){},r.prototype.drawCircle=function(e,t){},r.prototype.drawFeature=function(e,t){},r.prototype.drawGeometryCollection=function(e,t){},r.prototype.drawLineString=function(e,t){},r.prototype.drawMultiLineString=function(e,t){},r.prototype.drawMultiPoint=function(e,t){},r.prototype.drawMultiPolygon=function(e,t){},r.prototype.drawPoint=function(e,t){},r.prototype.drawPolygon=function(e,t){},r.prototype.drawText=function(e,t){},r.prototype.setFillStrokeStyle=function(e,t){},r.prototype.setImageStyle=function(e,t){},r.prototype.setTextStyle=function(e,t){},r}(),xp=kx,Fx=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Nx=function(r){Fx(e,r);function e(t,n,i,a){var u=r.call(this)||this;return u.tolerance=t,u.maxExtent=n,u.pixelRatio=a,u.maxLineWidth=0,u.resolution=i,u.beginGeometryInstruction1_=null,u.beginGeometryInstruction2_=null,u.bufferedMaxExtent_=null,u.instructions=[],u.coordinates=[],u.tmpCoordinate_=[],u.hitDetectionInstructions=[],u.state={},u}return e.prototype.applyPixelRatio=function(t){var n=this.pixelRatio;return n==1?t:t.map(function(i){return i*n})},e.prototype.appendFlatPointCoordinates=function(t,n){for(var i=this.getBufferedMaxExtent(),a=this.tmpCoordinate_,u=this.coordinates,p=u.length,g=0,v=t.length;g<v;g+=n)a[0]=t[g],a[1]=t[g+1],Yi(i,a)&&(u[p++]=a[0],u[p++]=a[1]);return p},e.prototype.appendFlatLineCoordinates=function(t,n,i,a,u,p){var g=this.coordinates,v=g.length,m=this.getBufferedMaxExtent();p&&(n+=a);var b=t[n],E=t[n+1],w=this.tmpCoordinate_,S=!0,O,I,M;for(O=n+a;O<i;O+=a)w[0]=t[O],w[1]=t[O+1],M=ah(m,w),M!==I?(S&&(g[v++]=b,g[v++]=E,S=!1),g[v++]=w[0],g[v++]=w[1]):M===pe.INTERSECTING?(g[v++]=w[0],g[v++]=w[1],S=!1):S=!0,b=w[0],E=w[1],I=M;return(u&&S||O===n+a)&&(g[v++]=b,g[v++]=E),v},e.prototype.drawCustomCoordinates_=function(t,n,i,a,u){for(var p=0,g=i.length;p<g;++p){var v=i[p],m=this.appendFlatLineCoordinates(t,n,v,a,!1,!1);u.push(m),n=v}return n},e.prototype.drawCustom=function(t,n,i,a){this.beginGeometry(t,n);var u=t.getType(),p=t.getStride(),g=this.coordinates.length,v,m,b,E,w;switch(u){case mt.MULTI_POLYGON:v=t.getOrientedFlatCoordinates(),E=[];var S=t.getEndss();w=0;for(var O=0,I=S.length;O<I;++O){var M=[];w=this.drawCustomCoordinates_(v,w,S[O],p,M),E.push(M)}this.instructions.push([ft.CUSTOM,g,E,t,i,Pf]),this.hitDetectionInstructions.push([ft.CUSTOM,g,E,t,a||i,Pf]);break;case mt.POLYGON:case mt.MULTI_LINE_STRING:b=[],v=u==mt.POLYGON?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),w=this.drawCustomCoordinates_(v,0,t.getEnds(),p,b),this.instructions.push([ft.CUSTOM,g,b,t,i,ra]),this.hitDetectionInstructions.push([ft.CUSTOM,g,b,t,a||i,ra]);break;case mt.LINE_STRING:case mt.CIRCLE:v=t.getFlatCoordinates(),m=this.appendFlatLineCoordinates(v,0,v.length,p,!1,!1),this.instructions.push([ft.CUSTOM,g,m,t,i,Er]),this.hitDetectionInstructions.push([ft.CUSTOM,g,m,t,a||i,Er]);break;case mt.MULTI_POINT:v=t.getFlatCoordinates(),m=this.appendFlatPointCoordinates(v,p),m>g&&(this.instructions.push([ft.CUSTOM,g,m,t,i,Er]),this.hitDetectionInstructions.push([ft.CUSTOM,g,m,t,a||i,Er]));break;case mt.POINT:v=t.getFlatCoordinates(),this.coordinates.push(v[0],v[1]),m=this.coordinates.length,this.instructions.push([ft.CUSTOM,g,m,t,i]),this.hitDetectionInstructions.push([ft.CUSTOM,g,m,t,a||i]);break}this.endGeometry(n)},e.prototype.beginGeometry=function(t,n){this.beginGeometryInstruction1_=[ft.BEGIN_GEOMETRY,n,0,t],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[ft.BEGIN_GEOMETRY,n,0,t],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)},e.prototype.finish=function(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}},e.prototype.reverseHitDetectionInstructions=function(){var t=this.hitDetectionInstructions;t.reverse();var n,i=t.length,a,u,p=-1;for(n=0;n<i;++n)a=t[n],u=a[0],u==ft.END_GEOMETRY?p=n:u==ft.BEGIN_GEOMETRY&&(a[2]=n,lm(this.hitDetectionInstructions,p,n),p=-1)},e.prototype.setFillStrokeStyle=function(t,n){var i=this.state;if(t){var a=t.getColor();i.fillStyle=vn(a||Fn)}else i.fillStyle=void 0;if(n){var u=n.getColor();i.strokeStyle=vn(u||Lo);var p=n.getLineCap();i.lineCap=p!==void 0?p:oa;var g=n.getLineDash();i.lineDash=g?g.slice():Ao;var v=n.getLineDashOffset();i.lineDashOffset=v||Po;var m=n.getLineJoin();i.lineJoin=m!==void 0?m:Ar;var b=n.getWidth();i.lineWidth=b!==void 0?b:ko;var E=n.getMiterLimit();i.miterLimit=E!==void 0?E:Mo,i.lineWidth>this.maxLineWidth&&(this.maxLineWidth=i.lineWidth,this.bufferedMaxExtent_=null)}else i.strokeStyle=void 0,i.lineCap=void 0,i.lineDash=null,i.lineDashOffset=void 0,i.lineJoin=void 0,i.lineWidth=void 0,i.miterLimit=void 0},e.prototype.createFill=function(t){var n=t.fillStyle,i=[ft.SET_FILL_STYLE,n];return typeof n!="string"&&i.push(!0),i},e.prototype.applyStroke=function(t){this.instructions.push(this.createStroke(t))},e.prototype.createStroke=function(t){return[ft.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]},e.prototype.updateFillStyle=function(t,n){var i=t.fillStyle;(typeof i!="string"||t.currentFillStyle!=i)&&(i!==void 0&&this.instructions.push(n.call(this,t)),t.currentFillStyle=i)},e.prototype.updateStrokeStyle=function(t,n){var i=t.strokeStyle,a=t.lineCap,u=t.lineDash,p=t.lineDashOffset,g=t.lineJoin,v=t.lineWidth,m=t.miterLimit;(t.currentStrokeStyle!=i||t.currentLineCap!=a||u!=t.currentLineDash&&!Ki(t.currentLineDash,u)||t.currentLineDashOffset!=p||t.currentLineJoin!=g||t.currentLineWidth!=v||t.currentMiterLimit!=m)&&(i!==void 0&&n.call(this,t),t.currentStrokeStyle=i,t.currentLineCap=a,t.currentLineDash=u,t.currentLineDashOffset=p,t.currentLineJoin=g,t.currentLineWidth=v,t.currentMiterLimit=m)},e.prototype.endGeometry=function(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;var n=[ft.END_GEOMETRY,t];this.instructions.push(n),this.hitDetectionInstructions.push(n)},e.prototype.getBufferedMaxExtent=function(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=Gd(this.maxExtent),this.maxLineWidth>0)){var t=this.resolution*(this.maxLineWidth+1)/2;Rh(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_},e}(xp),Go=Nx,Bx=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Gx=function(r){Bx(e,r);function e(t,n,i,a){var u=r.call(this,t,n,i,a)||this;return u.hitDetectionImage_=null,u.image_=null,u.imagePixelRatio_=void 0,u.anchorX_=void 0,u.anchorY_=void 0,u.height_=void 0,u.opacity_=void 0,u.originX_=void 0,u.originY_=void 0,u.rotateWithView_=void 0,u.rotation_=void 0,u.scale_=void 0,u.width_=void 0,u.declutterImageWithText_=void 0,u}return e.prototype.drawPoint=function(t,n){if(!!this.image_){this.beginGeometry(t,n);var i=t.getFlatCoordinates(),a=t.getStride(),u=this.coordinates.length,p=this.appendFlatPointCoordinates(i,a);this.instructions.push([ft.DRAW_IMAGE,u,p,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterImageWithText_]),this.hitDetectionInstructions.push([ft.DRAW_IMAGE,u,p,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterImageWithText_]),this.endGeometry(n)}},e.prototype.drawMultiPoint=function(t,n){if(!!this.image_){this.beginGeometry(t,n);var i=t.getFlatCoordinates(),a=t.getStride(),u=this.coordinates.length,p=this.appendFlatPointCoordinates(i,a);this.instructions.push([ft.DRAW_IMAGE,u,p,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterImageWithText_]),this.hitDetectionInstructions.push([ft.DRAW_IMAGE,u,p,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterImageWithText_]),this.endGeometry(n)}},e.prototype.finish=function(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,r.prototype.finish.call(this)},e.prototype.setImageStyle=function(t,n){var i=t.getAnchor(),a=t.getSize(),u=t.getHitDetectionImage(),p=t.getImage(this.pixelRatio),g=t.getOrigin();this.imagePixelRatio_=t.getPixelRatio(this.pixelRatio),this.anchorX_=i[0],this.anchorY_=i[1],this.hitDetectionImage_=u,this.image_=p,this.height_=a[1],this.opacity_=t.getOpacity(),this.originX_=g[0]*this.imagePixelRatio_,this.originY_=g[1]*this.imagePixelRatio_,this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScaleArray(),this.width_=a[0],this.declutterImageWithText_=n},e}(Go),zx=Gx,Ux=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Vx=function(r){Ux(e,r);function e(t,n,i,a){return r.call(this,t,n,i,a)||this}return e.prototype.drawFlatCoordinates_=function(t,n,i,a){var u=this.coordinates.length,p=this.appendFlatLineCoordinates(t,n,i,a,!1,!1),g=[ft.MOVE_TO_LINE_TO,u,p];return this.instructions.push(g),this.hitDetectionInstructions.push(g),i},e.prototype.drawLineString=function(t,n){var i=this.state,a=i.strokeStyle,u=i.lineWidth;if(!(a===void 0||u===void 0)){this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(t,n),this.hitDetectionInstructions.push([ft.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Ao,Po],Vi);var p=t.getFlatCoordinates(),g=t.getStride();this.drawFlatCoordinates_(p,0,p.length,g),this.hitDetectionInstructions.push(oi),this.endGeometry(n)}},e.prototype.drawMultiLineString=function(t,n){var i=this.state,a=i.strokeStyle,u=i.lineWidth;if(!(a===void 0||u===void 0)){this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(t,n),this.hitDetectionInstructions.push([ft.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset],Vi);for(var p=t.getEnds(),g=t.getFlatCoordinates(),v=t.getStride(),m=0,b=0,E=p.length;b<E;++b)m=this.drawFlatCoordinates_(g,m,p[b],v);this.hitDetectionInstructions.push(oi),this.endGeometry(n)}},e.prototype.finish=function(){var t=this.state;return t.lastStroke!=null&&t.lastStroke!=this.coordinates.length&&this.instructions.push(oi),this.reverseHitDetectionInstructions(),this.state=null,r.prototype.finish.call(this)},e.prototype.applyStroke=function(t){t.lastStroke!=null&&t.lastStroke!=this.coordinates.length&&(this.instructions.push(oi),t.lastStroke=this.coordinates.length),t.lastStroke=0,r.prototype.applyStroke.call(this,t),this.instructions.push(Vi)},e}(Go),Xx=Vx,jx=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Wx=function(r){jx(e,r);function e(t,n,i,a){return r.call(this,t,n,i,a)||this}return e.prototype.drawFlatCoordinatess_=function(t,n,i,a){var u=this.state,p=u.fillStyle!==void 0,g=u.strokeStyle!==void 0,v=i.length;this.instructions.push(Vi),this.hitDetectionInstructions.push(Vi);for(var m=0;m<v;++m){var b=i[m],E=this.coordinates.length,w=this.appendFlatLineCoordinates(t,n,b,a,!0,!g),S=[ft.MOVE_TO_LINE_TO,E,w];this.instructions.push(S),this.hitDetectionInstructions.push(S),g&&(this.instructions.push(Wf),this.hitDetectionInstructions.push(Wf)),n=b}return p&&(this.instructions.push(Ps),this.hitDetectionInstructions.push(Ps)),g&&(this.instructions.push(oi),this.hitDetectionInstructions.push(oi)),n},e.prototype.drawCircle=function(t,n){var i=this.state,a=i.fillStyle,u=i.strokeStyle;if(!(a===void 0&&u===void 0)){this.setFillStrokeStyles_(),this.beginGeometry(t,n),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([ft.SET_FILL_STYLE,Fn]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([ft.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset]);var p=t.getFlatCoordinates(),g=t.getStride(),v=this.coordinates.length;this.appendFlatLineCoordinates(p,0,p.length,g,!1,!1);var m=[ft.CIRCLE,v];this.instructions.push(Vi,m),this.hitDetectionInstructions.push(Vi,m),i.fillStyle!==void 0&&(this.instructions.push(Ps),this.hitDetectionInstructions.push(Ps)),i.strokeStyle!==void 0&&(this.instructions.push(oi),this.hitDetectionInstructions.push(oi)),this.endGeometry(n)}},e.prototype.drawPolygon=function(t,n){var i=this.state,a=i.fillStyle,u=i.strokeStyle;if(!(a===void 0&&u===void 0)){this.setFillStrokeStyles_(),this.beginGeometry(t,n),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([ft.SET_FILL_STYLE,Fn]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([ft.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset]);var p=t.getEnds(),g=t.getOrientedFlatCoordinates(),v=t.getStride();this.drawFlatCoordinatess_(g,0,p,v),this.endGeometry(n)}},e.prototype.drawMultiPolygon=function(t,n){var i=this.state,a=i.fillStyle,u=i.strokeStyle;if(!(a===void 0&&u===void 0)){this.setFillStrokeStyles_(),this.beginGeometry(t,n),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([ft.SET_FILL_STYLE,Fn]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([ft.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset]);for(var p=t.getEndss(),g=t.getOrientedFlatCoordinates(),v=t.getStride(),m=0,b=0,E=p.length;b<E;++b)m=this.drawFlatCoordinatess_(g,m,p[b],v);this.endGeometry(n)}},e.prototype.finish=function(){this.reverseHitDetectionInstructions(),this.state=null;var t=this.tolerance;if(t!==0)for(var n=this.coordinates,i=0,a=n.length;i<a;++i)n[i]=Di(n[i],t);return r.prototype.finish.call(this)},e.prototype.setFillStrokeStyles_=function(){var t=this.state,n=t.fillStyle;n!==void 0&&this.updateFillStyle(t,this.createFill),t.strokeStyle!==void 0&&this.updateStrokeStyle(t,this.applyStroke)},e}(Go),Hf=Wx;function Hx(r,e,t,n,i){var a=t,u=t,p=0,g=0,v=t,m,b,E,w,S,O,I,M,A,k;for(b=t;b<n;b+=i){var L=e[b],B=e[b+1];S!==void 0&&(A=L-S,k=B-O,w=Math.sqrt(A*A+k*k),I!==void 0&&(g+=E,m=Math.acos((I*A+M*k)/(E*w)),m>r&&(g>p&&(p=g,a=v,u=b),g=0,v=b-i)),E=w,I=A,M=k),S=L,O=B}return g+=w,g>p?[v,b]:[a,u]}var Yx=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),ha={left:0,end:0,center:.5,right:1,start:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1},$x=function(r){Yx(e,r);function e(t,n,i,a){var u=r.call(this,t,n,i,a)||this;return u.labels_=null,u.text_="",u.textOffsetX_=0,u.textOffsetY_=0,u.textRotateWithView_=void 0,u.textRotation_=0,u.textFillState_=null,u.fillStates={},u.textStrokeState_=null,u.strokeStates={},u.textState_={},u.textStates={},u.textKey_="",u.fillKey_="",u.strokeKey_="",u.declutterImageWithText_=void 0,u}return e.prototype.finish=function(){var t=r.prototype.finish.call(this);return t.textStates=this.textStates,t.fillStates=this.fillStates,t.strokeStates=this.strokeStates,t},e.prototype.drawText=function(t,n){var i=this.textFillState_,a=this.textStrokeState_,u=this.textState_;if(!(this.text_===""||!u||!i&&!a)){var p=this.coordinates,g=p.length,v=t.getType(),m=null,b=t.getStride();if(u.placement===xx.LINE&&(v==mt.LINE_STRING||v==mt.MULTI_LINE_STRING||v==mt.POLYGON||v==mt.MULTI_POLYGON)){if(!Fe(this.getBufferedMaxExtent(),t.getExtent()))return;var E=void 0;if(m=t.getFlatCoordinates(),v==mt.LINE_STRING)E=[m.length];else if(v==mt.MULTI_LINE_STRING)E=t.getEnds();else if(v==mt.POLYGON)E=t.getEnds().slice(0,1);else if(v==mt.MULTI_POLYGON){var w=t.getEndss();E=[];for(var S=0,O=w.length;S<O;++S)E.push(w[S][0])}this.beginGeometry(t,n);for(var I=u.textAlign,M=0,A=void 0,k=0,L=E.length;k<L;++k){if(I==null){var B=Hx(u.maxAngle,m,M,E[k],b);M=B[0],A=B[1]}else A=E[k];for(var S=M;S<A;S+=b)p.push(m[S],m[S+1]);var G=p.length;M=E[k],this.drawChars_(g,G),g=G}this.endGeometry(n)}else{var V=u.overflow?null:[];switch(v){case mt.POINT:case mt.MULTI_POINT:m=t.getFlatCoordinates();break;case mt.LINE_STRING:m=t.getFlatMidpoint();break;case mt.CIRCLE:m=t.getCenter();break;case mt.MULTI_LINE_STRING:m=t.getFlatMidpoints(),b=2;break;case mt.POLYGON:m=t.getFlatInteriorPoint(),u.overflow||V.push(m[2]/this.resolution),b=3;break;case mt.MULTI_POLYGON:var U=t.getFlatInteriorPoints();m=[];for(var S=0,O=U.length;S<O;S+=3)u.overflow||V.push(U[S+2]/this.resolution),m.push(U[S],U[S+1]);if(m.length===0)return;b=2;break}var G=this.appendFlatPointCoordinates(m,b);if(G===g)return;if(V&&(G-g)/2!==m.length/b){var K=g/2;V=V.filter(function(at,ht){var ut=p[(K+ht)*2]===m[ht*b]&&p[(K+ht)*2+1]===m[ht*b+1];return ut||--K,ut})}this.saveTextStates_(),(u.backgroundFill||u.backgroundStroke)&&(this.setFillStrokeStyle(u.backgroundFill,u.backgroundStroke),u.backgroundFill&&(this.updateFillStyle(this.state,this.createFill),this.hitDetectionInstructions.push(this.createFill(this.state))),u.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(t,n);var H=u.padding;if(H!=Ui&&(u.scale[0]<0||u.scale[1]<0)){var et=u.padding[0],X=u.padding[1],j=u.padding[2],J=u.padding[3];u.scale[0]<0&&(X=-X,J=-J),u.scale[1]<0&&(et=-et,j=-j),H=[et,X,j,J]}var Q=this.pixelRatio;this.instructions.push([ft.DRAW_IMAGE,g,G,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterImageWithText_,H==Ui?Ui:H.map(function(at){return at*Q}),!!u.backgroundFill,!!u.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,V]);var tt=1/Q;this.hitDetectionInstructions.push([ft.DRAW_IMAGE,g,G,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[tt,tt],NaN,this.declutterImageWithText_,H,!!u.backgroundFill,!!u.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,V]),this.endGeometry(n)}}},e.prototype.saveTextStates_=function(){var t=this.textStrokeState_,n=this.textState_,i=this.textFillState_,a=this.strokeKey_;t&&(a in this.strokeStates||(this.strokeStates[a]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));var u=this.textKey_;u in this.textStates||(this.textStates[u]={font:n.font,textAlign:n.textAlign||Do,textBaseline:n.textBaseline||sa,scale:n.scale});var p=this.fillKey_;i&&(p in this.fillStates||(this.fillStates[p]={fillStyle:i.fillStyle}))},e.prototype.drawChars_=function(t,n){var i=this.textStrokeState_,a=this.textState_,u=this.strokeKey_,p=this.textKey_,g=this.fillKey_;this.saveTextStates_();var v=this.pixelRatio,m=ha[a.textBaseline],b=this.textOffsetY_*v,E=this.text_,w=i?i.lineWidth*Math.abs(a.scale[0])/2:0;this.instructions.push([ft.DRAW_CHARS,t,n,m,a.overflow,g,a.maxAngle,v,b,u,w*v,E,p,1]),this.hitDetectionInstructions.push([ft.DRAW_CHARS,t,n,m,a.overflow,g,a.maxAngle,1,b,u,w,E,p,1/v])},e.prototype.setTextStyle=function(t,n){var i,a,u;if(!t)this.text_="";else{var p=t.getFill();p?(a=this.textFillState_,a||(a={},this.textFillState_=a),a.fillStyle=vn(p.getColor()||Fn)):(a=null,this.textFillState_=a);var g=t.getStroke();if(!g)u=null,this.textStrokeState_=u;else{u=this.textStrokeState_,u||(u={},this.textStrokeState_=u);var v=g.getLineDash(),m=g.getLineDashOffset(),b=g.getWidth(),E=g.getMiterLimit();u.lineCap=g.getLineCap()||oa,u.lineDash=v?v.slice():Ao,u.lineDashOffset=m===void 0?Po:m,u.lineJoin=g.getLineJoin()||Ar,u.lineWidth=b===void 0?ko:b,u.miterLimit=E===void 0?Mo:E,u.strokeStyle=vn(g.getColor()||Lo)}i=this.textState_;var w=t.getFont()||pp;ax(w);var S=t.getScaleArray();i.overflow=t.getOverflow(),i.font=w,i.maxAngle=t.getMaxAngle(),i.placement=t.getPlacement(),i.textAlign=t.getTextAlign(),i.textBaseline=t.getTextBaseline()||sa,i.backgroundFill=t.getBackgroundFill(),i.backgroundStroke=t.getBackgroundStroke(),i.padding=t.getPadding()||Ui,i.scale=S===void 0?[1,1]:S;var O=t.getOffsetX(),I=t.getOffsetY(),M=t.getRotateWithView(),A=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=O===void 0?0:O,this.textOffsetY_=I===void 0?0:I,this.textRotateWithView_=M===void 0?!1:M,this.textRotation_=A===void 0?0:A,this.strokeKey_=u?(typeof u.strokeStyle=="string"?u.strokeStyle:Xt(u.strokeStyle))+u.lineCap+u.lineDashOffset+"|"+u.lineWidth+u.lineJoin+u.miterLimit+"["+u.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.textBaseline||"?"),this.fillKey_=a?typeof a.fillStyle=="string"?a.fillStyle:"|"+Xt(a.fillStyle):""}this.declutterImageWithText_=n},e}(Go),Kx=$x,Zx={Circle:Hf,Default:Go,Image:zx,LineString:Xx,Polygon:Hf,Text:Kx},qx=function(){function r(e,t,n,i){this.tolerance_=e,this.maxExtent_=t,this.pixelRatio_=i,this.resolution_=n,this.buildersByZIndex_={}}return r.prototype.finish=function(){var e={};for(var t in this.buildersByZIndex_){e[t]=e[t]||{};var n=this.buildersByZIndex_[t];for(var i in n){var a=n[i].finish();e[t][i]=a}}return e},r.prototype.getBuilder=function(e,t){var n=e!==void 0?e.toString():"0",i=this.buildersByZIndex_[n];i===void 0&&(i={},this.buildersByZIndex_[n]=i);var a=i[t];if(a===void 0){var u=Zx[t];a=new u(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),i[t]=a}return a},r}(),Yf=qx,Jx=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Qx=function(r){Jx(e,r);function e(t){var n=r.call(this)||this;return n.ready=!0,n.boundHandleImageChange_=n.handleImageChange_.bind(n),n.layer_=t,n.declutterExecutorGroup=null,n}return e.prototype.getFeatures=function(t){return Rt()},e.prototype.getData=function(t){return null},e.prototype.prepareFrame=function(t){return Rt()},e.prototype.renderFrame=function(t,n){return Rt()},e.prototype.loadedTileCallback=function(t,n,i){t[n]||(t[n]={}),t[n][i.tileCoord.toString()]=i},e.prototype.createLoadedTileFinder=function(t,n,i){return function(a,u){var p=this.loadedTileCallback.bind(this,i,a);return t.forEachLoadedTile(n,a,u,p)}.bind(this)},e.prototype.forEachFeatureAtCoordinate=function(t,n,i,a,u){},e.prototype.getDataAtPixel=function(t,n,i){return null},e.prototype.getLayer=function(){return this.layer_},e.prototype.handleFontsChanged=function(){},e.prototype.handleImageChange_=function(t){var n=t.target;n.getState()===Wt.LOADED&&this.renderIfReadyAndVisible()},e.prototype.loadImage=function(t){var n=t.getState();return n!=Wt.LOADED&&n!=Wt.ERROR&&t.addEventListener(pt.CHANGE,this.boundHandleImageChange_),n==Wt.IDLE&&(t.load(),n=t.getState()),n==Wt.LOADED},e.prototype.renderIfReadyAndVisible=function(){var t=this.getLayer();t.getVisible()&&t.getSourceState()==Oe.READY&&t.changed()},e.prototype.disposeInternal=function(){delete this.layer_,r.prototype.disposeInternal.call(this)},e}(Pd),bp=Qx,tb=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),eb=function(r){tb(e,r);function e(t,n,i,a){var u=r.call(this,t)||this;return u.inversePixelTransform=n,u.frameState=i,u.context=a,u}return e}(Nn),Ro=eb,nb=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),bo=null;function ib(){var r=document.createElement("canvas");r.width=1,r.height=1,bo=r.getContext("2d")}var rb=function(r){nb(e,r);function e(t){var n=r.call(this,t)||this;return n.container=null,n.renderedResolution,n.tempTransform=ze(),n.pixelTransform=ze(),n.inversePixelTransform=ze(),n.context=null,n.containerReused=!1,n.pixelContext_=null,n.frameState=null,n}return e.prototype.getImageData=function(t,n,i){bo||ib(),bo.clearRect(0,0,1,1);var a;try{bo.drawImage(t,n,i,1,1,0,0,1,1),a=bo.getImageData(0,0,1,1).data}catch{return null}return a},e.prototype.getBackground=function(t){var n=this.getLayer(),i=n.getBackground();return typeof i=="function"&&(i=i(t.viewState.resolution)),i||void 0},e.prototype.useContainer=function(t,n,i,a){var u=this.getLayer().getClassName(),p,g;if(t&&t.className===u&&t.style.opacity===""&&i===1&&(!a||t.style.backgroundColor&&Ki(Io(t.style.backgroundColor),Io(a)))){var v=t.firstElementChild;v instanceof HTMLCanvasElement&&(g=v.getContext("2d"))}if(g&&g.canvas.style.transform===n?(this.container=t,this.context=g,this.containerReused=!0):this.containerReused&&(this.container=null,this.context=null,this.containerReused=!1),!this.container){p=document.createElement("div"),p.className=u;var m=p.style;m.position="absolute",m.width="100%",m.height="100%",a&&(m.backgroundColor=a),g=We();var v=g.canvas;p.appendChild(v),m=v.style,m.position="absolute",m.left="0",m.transformOrigin="top left",this.container=p,this.context=g}},e.prototype.clipUnrotated=function(t,n,i){var a=Fr(i),u=wa(i),p=Ta(i),g=Ea(i);ne(n.coordinateToPixelTransform,a),ne(n.coordinateToPixelTransform,u),ne(n.coordinateToPixelTransform,p),ne(n.coordinateToPixelTransform,g);var v=this.inversePixelTransform;ne(v,a),ne(v,u),ne(v,p),ne(v,g),t.save(),t.beginPath(),t.moveTo(Math.round(a[0]),Math.round(a[1])),t.lineTo(Math.round(u[0]),Math.round(u[1])),t.lineTo(Math.round(p[0]),Math.round(p[1])),t.lineTo(Math.round(g[0]),Math.round(g[1])),t.clip()},e.prototype.dispatchRenderEvent_=function(t,n,i){var a=this.getLayer();if(a.hasListener(t)){var u=new Ro(t,this.inversePixelTransform,i,n);a.dispatchEvent(u)}},e.prototype.preRender=function(t,n){this.frameState=n,this.dispatchRenderEvent_(Be.PRERENDER,t,n)},e.prototype.postRender=function(t,n){this.dispatchRenderEvent_(Be.POSTRENDER,t,n)},e.prototype.getRenderTransform=function(t,n,i,a,u,p,g){var v=u/2,m=p/2,b=a/n,E=-b,w=-t[0]+g,S=-t[1];return mn(this.tempTransform,v,m,b,E,-i,w,S)},e.prototype.getDataAtPixel=function(t,n,i){var a=ne(this.inversePixelTransform,t.slice()),u=this.context,p=this.getLayer(),g=p.getExtent();if(g){var v=ne(n.pixelToCoordinateTransform,t.slice());if(!Yi(g,v))return null}var m=Math.round(a[0]),b=Math.round(a[1]),E=this.pixelContext_;if(!E){var w=document.createElement("canvas");w.width=1,w.height=1,E=w.getContext("2d"),this.pixelContext_=E}E.clearRect(0,0,1,1);var S;try{E.drawImage(u.canvas,m,b,1,1,0,0,1,1),S=E.getImageData(0,0,1,1).data}catch(O){return O.name==="SecurityError"?(this.pixelContext_=null,new Uint8Array):S}return S[3]===0?null:S},e.prototype.disposeInternal=function(){delete this.frameState,r.prototype.disposeInternal.call(this)},e}(bp),ob=rb,qt={CIRCLE:"Circle",DEFAULT:"Default",IMAGE:"Image",LINE_STRING:"LineString",POLYGON:"Polygon",TEXT:"Text"};function sb(r,e,t,n,i,a,u,p,g,v,m,b){var E=r[e],w=r[e+1],S=0,O=0,I=0,M=0;function A(){S=E,O=w,e+=n,E=r[e],w=r[e+1],M+=I,I=Math.sqrt((E-S)*(E-S)+(w-O)*(w-O))}do A();while(e<t-n&&M+I<a);for(var k=I===0?0:(a-M)/I,L=Li(S,E,k),B=Li(O,w,k),G=e-n,V=M,U=a+p*g(v,i,m);e<t-n&&M+I<U;)A();k=I===0?0:(U-M)/I;var K=Li(S,E,k),H=Li(O,w,k),et;if(b){var X=[L,B,K,H];Lh(X,0,4,2,b,X,X),et=X[0]>X[2]}else et=L>K;var j=Math.PI,J=[],Q=G+n===e;e=G,I=0,M=V,E=r[e],w=r[e+1];var tt;if(Q){A(),tt=Math.atan2(w-O,E-S),et&&(tt+=tt>0?-j:j);var rt=(K+L)/2,at=(H+B)/2;return J[0]=[rt,at,(U-a)/2,tt,i],J}for(var ht=0,ut=i.length;ht<ut;){A();var wt=Math.atan2(w-O,E-S);if(et&&(wt+=wt>0?-j:j),tt!==void 0){var Y=wt-tt;if(Y+=Y>j?-2*j:Y<-j?2*j:0,Math.abs(Y)>u)return null}tt=wt;for(var Yt=ht,zt=0;ht<ut;++ht){var Zt=et?ut-ht-1:ht,te=p*g(v,i[Zt],m);if(e+n<t&&M+I<a+zt+te/2)break;zt+=te}if(ht!==Yt){var Ue=et?i.substring(ut-Yt,ut-ht):i.substring(Yt,ht);k=I===0?0:(a+zt/2-M)/I;var rt=Li(S,E,k),at=Li(O,w,k);J.push([rt,at,zt/2,wt,Ue]),a+=zt}}return J}var pr=xn(),qn=[],In=[],An=[],Jn=[];function $f(r){return r[3].declutterBox}var ab=new RegExp("["+String.fromCharCode(1425)+"-"+String.fromCharCode(2303)+String.fromCharCode(64285)+"-"+String.fromCharCode(65023)+String.fromCharCode(65136)+"-"+String.fromCharCode(65276)+String.fromCharCode(67584)+"-"+String.fromCharCode(69631)+String.fromCharCode(124928)+"-"+String.fromCharCode(126975)+"]");function Kf(r,e){return(e==="start"||e==="end")&&!ab.test(r)&&(e=e==="start"?"left":"right"),ha[e]}function lb(r,e,t){return t>0&&r.push(`
`,""),r.push(e,""),r}var hb=function(){function r(e,t,n,i){this.overlaps=n,this.pixelRatio=t,this.resolution=e,this.alignFill_,this.instructions=i.instructions,this.coordinates=i.coordinates,this.coordinateCache_={},this.renderedTransform_=ze(),this.hitDetectionInstructions=i.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=i.fillStates||{},this.strokeStates=i.strokeStates||{},this.textStates=i.textStates||{},this.widths_={},this.labels_={}}return r.prototype.createLabel=function(e,t,n,i){var a=e+t+n+i;if(this.labels_[a])return this.labels_[a];var u=i?this.strokeStates[i]:null,p=n?this.fillStates[n]:null,g=this.textStates[t],v=this.pixelRatio,m=[g.scale[0]*v,g.scale[1]*v],b=Array.isArray(e),E=Kf(b?e[0]:e,g.textAlign||Do),w=i&&u.lineWidth?u.lineWidth:0,S=b?e:e.split(`
`).reduce(lb,[]),O=hx(g,S),I=O.width,M=O.height,A=O.widths,k=O.heights,L=O.lineWidths,B=I+w,G=[],V=(B+2)*m[0],U=(M+w)*m[1],K={width:V<0?Math.floor(V):Math.ceil(V),height:U<0?Math.floor(U):Math.ceil(U),contextInstructions:G};if((m[0]!=1||m[1]!=1)&&G.push("scale",m),i){G.push("strokeStyle",u.strokeStyle),G.push("lineWidth",w),G.push("lineCap",u.lineCap),G.push("lineJoin",u.lineJoin),G.push("miterLimit",u.miterLimit);var H=ma?OffscreenCanvasRenderingContext2D:CanvasRenderingContext2D;H.prototype.setLineDash&&(G.push("setLineDash",[u.lineDash]),G.push("lineDashOffset",u.lineDashOffset))}n&&G.push("fillStyle",p.fillStyle),G.push("textBaseline","middle"),G.push("textAlign","center");for(var et=.5-E,X=E*B+et*w,j=[],J=[],Q=0,tt=0,rt=0,at=0,ht,ut=0,wt=S.length;ut<wt;ut+=2){var Y=S[ut];if(Y===`
`){tt+=Q,Q=0,X=E*B+et*w,++at;continue}var Yt=S[ut+1]||g.font;Yt!==ht&&(i&&j.push("font",Yt),n&&J.push("font",Yt),ht=Yt),Q=Math.max(Q,k[rt]);var zt=[Y,X+et*A[rt]+E*(A[rt]-L[at]),.5*(w+Q)+tt];X+=A[rt],i&&j.push("strokeText",zt),n&&J.push("fillText",zt),++rt}return Array.prototype.push.apply(G,j),Array.prototype.push.apply(G,J),this.labels_[a]=K,K},r.prototype.replayTextBackground_=function(e,t,n,i,a,u,p){e.beginPath(),e.moveTo.apply(e,t),e.lineTo.apply(e,n),e.lineTo.apply(e,i),e.lineTo.apply(e,a),e.lineTo.apply(e,t),u&&(this.alignFill_=u[2],this.fill_(e)),p&&(this.setStrokeStyle_(e,p),e.stroke())},r.prototype.calculateImageOrLabelDimensions_=function(e,t,n,i,a,u,p,g,v,m,b,E,w,S,O,I){p*=E[0],g*=E[1];var M=n-p,A=i-g,k=a+v>e?e-v:a,L=u+m>t?t-m:u,B=S[3]+k*E[0]+S[1],G=S[0]+L*E[1]+S[2],V=M-S[3],U=A-S[0];(O||b!==0)&&(qn[0]=V,Jn[0]=V,qn[1]=U,In[1]=U,In[0]=V+B,An[0]=In[0],An[1]=U+G,Jn[1]=An[1]);var K;return b!==0?(K=mn(ze(),n,i,1,1,b,-n,-i),ne(K,qn),ne(K,In),ne(K,An),ne(K,Jn),bn(Math.min(qn[0],In[0],An[0],Jn[0]),Math.min(qn[1],In[1],An[1],Jn[1]),Math.max(qn[0],In[0],An[0],Jn[0]),Math.max(qn[1],In[1],An[1],Jn[1]),pr)):bn(Math.min(V,V+B),Math.min(U,U+G),Math.max(V,V+B),Math.max(U,U+G),pr),w&&(M=Math.round(M),A=Math.round(A)),{drawImageX:M,drawImageY:A,drawImageW:k,drawImageH:L,originX:v,originY:m,declutterBox:{minX:pr[0],minY:pr[1],maxX:pr[2],maxY:pr[3],value:I},canvasTransform:K,scale:E}},r.prototype.replayImageOrLabel_=function(e,t,n,i,a,u,p){var g=!!(u||p),v=i.declutterBox,m=e.canvas,b=p?p[2]*i.scale[0]/2:0,E=v.minX-b<=m.width/t&&v.maxX+b>=0&&v.minY-b<=m.height/t&&v.maxY+b>=0;return E&&(g&&this.replayTextBackground_(e,qn,In,An,Jn,u,p),cx(e,i.canvasTransform,a,n,i.originX,i.originY,i.drawImageW,i.drawImageH,i.drawImageX,i.drawImageY,i.scale)),!0},r.prototype.fill_=function(e){if(this.alignFill_){var t=ne(this.renderedTransform_,[0,0]),n=512*this.pixelRatio;e.save(),e.translate(t[0]%n,t[1]%n),e.rotate(this.viewRotation_)}e.fill(),this.alignFill_&&e.restore()},r.prototype.setStrokeStyle_=function(e,t){e.strokeStyle=t[1],e.lineWidth=t[2],e.lineCap=t[3],e.lineJoin=t[4],e.miterLimit=t[5],e.setLineDash&&(e.lineDashOffset=t[7],e.setLineDash(t[6]))},r.prototype.drawLabelWithPointPlacement_=function(e,t,n,i){var a=this.textStates[t],u=this.createLabel(e,t,i,n),p=this.strokeStates[n],g=this.pixelRatio,v=Kf(Array.isArray(e)?e[0]:e,a.textAlign||Do),m=ha[a.textBaseline||sa],b=p&&p.lineWidth?p.lineWidth:0,E=u.width/g-2*a.scale[0],w=v*E+2*(.5-v)*b,S=m*u.height/g+2*(.5-m)*b;return{label:u,anchorX:w,anchorY:S}},r.prototype.execute_=function(e,t,n,i,a,u,p,g){var v;this.pixelCoordinates_&&Ki(n,this.renderedTransform_)?v=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),v=Wi(this.coordinates,0,this.coordinates.length,2,n,this.pixelCoordinates_),Pm(this.renderedTransform_,n));for(var m=0,b=i.length,E=0,w,S,O,I,M,A,k,L,B,G,V,U,K=0,H=0,et=null,X=null,j=this.coordinateCache_,J=this.viewRotation_,Q=Math.round(Math.atan2(-n[1],n[0])*1e12)/1e12,tt={context:e,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:J},rt=this.instructions!=i||this.overlaps?0:200,at,ht,ut,wt;m<b;){var Y=i[m],Yt=Y[0];switch(Yt){case ft.BEGIN_GEOMETRY:at=Y[1],wt=Y[3],at.getGeometry()?p!==void 0&&!Fe(p,wt.getExtent())?m=Y[2]+1:++m:m=Y[2];break;case ft.BEGIN_PATH:K>rt&&(this.fill_(e),K=0),H>rt&&(e.stroke(),H=0),!K&&!H&&(e.beginPath(),I=NaN,M=NaN),++m;break;case ft.CIRCLE:E=Y[1];var zt=v[E],Zt=v[E+1],te=v[E+2],Ue=v[E+3],ee=te-zt,ue=Ue-Zt,wn=Math.sqrt(ee*ee+ue*ue);e.moveTo(zt+wn,Zt),e.arc(zt,Zt,wn,0,2*Math.PI,!0),++m;break;case ft.CLOSE_PATH:e.closePath(),++m;break;case ft.CUSTOM:E=Y[1],w=Y[2];var qi=Y[3],Bn=Y[4],pi=Y.length==6?Y[5]:void 0;tt.geometry=qi,tt.feature=at,m in j||(j[m]=[]);var He=j[m];pi?pi(v,E,w,2,He):(He[0]=v[E],He[1]=v[E+1],He.length=2),Bn(He,tt),++m;break;case ft.DRAW_IMAGE:E=Y[1],w=Y[2],L=Y[3],S=Y[4],O=Y[5];var Gn=Y[6],gi=Y[7],_i=Y[8],vi=Y[9],Te=Y[10],Ji=Y[11],Ot=Y[12],Dt=Y[13],vt=Y[14];if(!L&&Y.length>=19){B=Y[18],G=Y[19],V=Y[20],U=Y[21];var jt=this.drawLabelWithPointPlacement_(B,G,V,U);L=jt.label,Y[3]=L;var we=Y[22];S=(jt.anchorX-we)*this.pixelRatio,Y[4]=S;var gt=Y[23];O=(jt.anchorY-gt)*this.pixelRatio,Y[5]=O,Gn=L.height,Y[6]=Gn,Dt=L.width,Y[13]=Dt}var Qi=void 0;Y.length>24&&(Qi=Y[24]);var yi=void 0,kt=void 0,It=void 0;Y.length>16?(yi=Y[15],kt=Y[16],It=Y[17]):(yi=Ui,kt=!1,It=!1),Te&&Q?Ji+=J:!Te&&!Q&&(Ji-=J);for(var mi=0;E<w;E+=2)if(!(Qi&&Qi[mi++]<Dt/this.pixelRatio)){var Se=this.calculateImageOrLabelDimensions_(L.width,L.height,v[E],v[E+1],Dt,Gn,S,O,_i,vi,Ji,Ot,a,yi,kt||It,at),Ur=[e,t,L,Se,gi,kt?et:null,It?X:null],xi=void 0,an=void 0;if(g&&vt){var Qe=w-E;if(!vt[Qe]){vt[Qe]=Ur;continue}if(xi=vt[Qe],delete vt[Qe],an=$f(xi),g.collides(an))continue}g&&g.collides(Se.declutterBox)||(xi&&(g&&g.insert(an),this.replayImageOrLabel_.apply(this,xi)),g&&g.insert(Se.declutterBox),this.replayImageOrLabel_.apply(this,Ur))}++m;break;case ft.DRAW_CHARS:var Vr=Y[1],Xo=Y[2],Xr=Y[3],Da=Y[4];U=Y[5];var jo=Y[6],tn=Y[7],bi=Y[8];V=Y[9];var ve=Y[10];B=Y[11],G=Y[12];var Ye=[Y[13],Y[13]],Ei=this.textStates[G],zn=Ei.font,Ve=[Ei.scale[0]*tn,Ei.scale[1]*tn],Sn=void 0;zn in this.widths_?Sn=this.widths_[zn]:(Sn={},this.widths_[zn]=Sn);var Un=U0(v,Vr,Xo,2),tr=Math.abs(Ve[0])*Uf(zn,B,Sn);if(Da||tr<=Un){var ka=this.textStates[G].textAlign,Et=(Un-tr)*ha[ka],Nt=sb(v,Vr,Xo,2,B,Et,jo,Math.abs(Ve[0]),Uf,zn,Sn,Q?0:this.viewRotation_);t:if(Nt){var At=[],en=void 0,ln=void 0,Ti=void 0,bt=void 0,fe=void 0;if(V)for(en=0,ln=Nt.length;en<ln;++en){fe=Nt[en],Ti=fe[4],bt=this.createLabel(Ti,G,"",V),S=fe[2]+(Ve[0]<0?-ve:ve),O=Xr*bt.height+(.5-Xr)*2*ve*Ve[1]/Ve[0]-bi;var Se=this.calculateImageOrLabelDimensions_(bt.width,bt.height,fe[0],fe[1],bt.width,bt.height,S,O,0,0,fe[3],Ye,!1,Ui,!1,at);if(g&&g.collides(Se.declutterBox))break t;At.push([e,t,bt,Se,1,null,null])}if(U)for(en=0,ln=Nt.length;en<ln;++en){fe=Nt[en],Ti=fe[4],bt=this.createLabel(Ti,G,U,""),S=fe[2],O=Xr*bt.height-bi;var Se=this.calculateImageOrLabelDimensions_(bt.width,bt.height,fe[0],fe[1],bt.width,bt.height,S,O,0,0,fe[3],Ye,!1,Ui,!1,at);if(g&&g.collides(Se.declutterBox))break t;At.push([e,t,bt,Se,1,null,null])}g&&g.load(At.map($f));for(var wi=0,Re=At.length;wi<Re;++wi)this.replayImageOrLabel_.apply(this,At[wi])}}++m;break;case ft.END_GEOMETRY:if(u!==void 0){at=Y[1];var Ae=u(at,wt);if(Ae)return Ae}++m;break;case ft.FILL:rt?K++:this.fill_(e),++m;break;case ft.MOVE_TO_LINE_TO:for(E=Y[1],w=Y[2],ht=v[E],ut=v[E+1],A=ht+.5|0,k=ut+.5|0,(A!==I||k!==M)&&(e.moveTo(ht,ut),I=A,M=k),E+=2;E<w;E+=2)ht=v[E],ut=v[E+1],A=ht+.5|0,k=ut+.5|0,(E==w-2||A!==I||k!==M)&&(e.lineTo(ht,ut),I=A,M=k);++m;break;case ft.SET_FILL_STYLE:et=Y,this.alignFill_=Y[2],K&&(this.fill_(e),K=0,H&&(e.stroke(),H=0)),e.fillStyle=Y[1],++m;break;case ft.SET_STROKE_STYLE:X=Y,H&&(e.stroke(),H=0),this.setStrokeStyle_(e,Y),++m;break;case ft.STROKE:rt?H++:e.stroke(),++m;break;default:++m;break}}K&&this.fill_(e),H&&e.stroke()},r.prototype.execute=function(e,t,n,i,a,u){this.viewRotation_=i,this.execute_(e,t,n,this.instructions,a,void 0,void 0,u)},r.prototype.executeHitDetection=function(e,t,n,i,a){return this.viewRotation_=n,this.execute_(e,1,t,this.hitDetectionInstructions,!0,i,a)},r}(),cb=hb,Nl=[qt.POLYGON,qt.CIRCLE,qt.LINE_STRING,qt.IMAGE,qt.TEXT,qt.DEFAULT],ub=function(){function r(e,t,n,i,a,u){this.maxExtent_=e,this.overlaps_=i,this.pixelRatio_=n,this.resolution_=t,this.renderBuffer_=u,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=ze(),this.createExecutors_(a)}return r.prototype.clip=function(e,t){var n=this.getClipCoords(t);e.beginPath(),e.moveTo(n[0],n[1]),e.lineTo(n[2],n[3]),e.lineTo(n[4],n[5]),e.lineTo(n[6],n[7]),e.clip()},r.prototype.createExecutors_=function(e){for(var t in e){var n=this.executorsByZIndex_[t];n===void 0&&(n={},this.executorsByZIndex_[t]=n);var i=e[t];for(var a in i){var u=i[a];n[a]=new cb(this.resolution_,this.pixelRatio_,this.overlaps_,u)}}},r.prototype.hasExecutors=function(e){for(var t in this.executorsByZIndex_)for(var n=this.executorsByZIndex_[t],i=0,a=e.length;i<a;++i)if(e[i]in n)return!0;return!1},r.prototype.forEachFeatureAtCoordinate=function(e,t,n,i,a,u){i=Math.round(i);var p=i*2+1,g=mn(this.hitDetectionTransform_,i+.5,i+.5,1/t,-1/t,-n,-e[0],-e[1]),v=!this.hitDetectionContext_;v&&(this.hitDetectionContext_=We(p,p));var m=this.hitDetectionContext_;m.canvas.width!==p||m.canvas.height!==p?(m.canvas.width=p,m.canvas.height=p):v||m.clearRect(0,0,p,p);var b;this.renderBuffer_!==void 0&&(b=xn(),wo(b,e),Rh(b,t*(this.renderBuffer_+i),b));var E=fb(i),w;function S(G,V){for(var U=m.getImageData(0,0,p,p).data,K=0,H=E.length;K<H;K++)if(U[E[K]]>0){if(!u||w!==qt.IMAGE&&w!==qt.TEXT||u.indexOf(G)!==-1){var et=(E[K]-3)/4,X=i-et%p,j=i-(et/p|0),J=a(G,V,X*X+j*j);if(J)return J}m.clearRect(0,0,p,p);break}}var O=Object.keys(this.executorsByZIndex_).map(Number);O.sort(Ir);var I,M,A,k,L;for(I=O.length-1;I>=0;--I){var B=O[I].toString();for(A=this.executorsByZIndex_[B],M=Nl.length-1;M>=0;--M)if(w=Nl[M],k=A[w],k!==void 0&&(L=k.executeHitDetection(m,g,n,S,b),L))return L}},r.prototype.getClipCoords=function(e){var t=this.maxExtent_;if(!t)return null;var n=t[0],i=t[1],a=t[2],u=t[3],p=[n,i,n,u,a,u,a,i];return Wi(p,0,8,2,e,p),p},r.prototype.isEmpty=function(){return Oo(this.executorsByZIndex_)},r.prototype.execute=function(e,t,n,i,a,u,p){var g=Object.keys(this.executorsByZIndex_).map(Number);g.sort(Ir),this.maxExtent_&&(e.save(),this.clip(e,n));var v=u||Nl,m,b,E,w,S,O;for(p&&g.reverse(),m=0,b=g.length;m<b;++m){var I=g[m].toString();for(S=this.executorsByZIndex_[I],E=0,w=v.length;E<w;++E){var M=v[E];O=S[M],O!==void 0&&O.execute(e,t,n,i,a,p)}}this.maxExtent_&&e.restore()},r}(),Bl={};function fb(r){if(Bl[r]!==void 0)return Bl[r];for(var e=r*2+1,t=r*r,n=new Array(t+1),i=0;i<=r;++i)for(var a=0;a<=r;++a){var u=i*i+a*a;if(u>t)break;var p=n[u];p||(p=[],n[u]=p),p.push(((r+i)*e+(r+a))*4+3),i>0&&p.push(((r-i)*e+(r+a))*4+3),a>0&&(p.push(((r+i)*e+(r-a))*4+3),i>0&&p.push(((r-i)*e+(r-a))*4+3))}for(var g=[],i=0,v=n.length;i<v;++i)n[i]&&g.push.apply(g,n[i]);return Bl[r]=g,g}var Zf=ub,Ee={ANIMATING:0,INTERACTING:1},db=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),pb=function(r){db(e,r);function e(t,n,i,a,u,p,g){var v=r.call(this)||this;return v.context_=t,v.pixelRatio_=n,v.extent_=i,v.transform_=a,v.viewRotation_=u,v.squaredTolerance_=p,v.userTransform_=g,v.contextFillState_=null,v.contextStrokeState_=null,v.contextTextState_=null,v.fillState_=null,v.strokeState_=null,v.image_=null,v.imageAnchorX_=0,v.imageAnchorY_=0,v.imageHeight_=0,v.imageOpacity_=0,v.imageOriginX_=0,v.imageOriginY_=0,v.imageRotateWithView_=!1,v.imageRotation_=0,v.imageScale_=[0,0],v.imageWidth_=0,v.text_="",v.textOffsetX_=0,v.textOffsetY_=0,v.textRotateWithView_=!1,v.textRotation_=0,v.textScale_=[0,0],v.textFillState_=null,v.textStrokeState_=null,v.textState_=null,v.pixelCoordinates_=[],v.tmpLocalTransform_=ze(),v}return e.prototype.drawImages_=function(t,n,i,a){if(!!this.image_){var u=Wi(t,n,i,a,this.transform_,this.pixelCoordinates_),p=this.context_,g=this.tmpLocalTransform_,v=p.globalAlpha;this.imageOpacity_!=1&&(p.globalAlpha=v*this.imageOpacity_);var m=this.imageRotation_;this.imageRotateWithView_&&(m+=this.viewRotation_);for(var b=0,E=u.length;b<E;b+=2){var w=u[b]-this.imageAnchorX_,S=u[b+1]-this.imageAnchorY_;if(m!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){var O=w+this.imageAnchorX_,I=S+this.imageAnchorY_;mn(g,O,I,1,1,m,-O,-I),p.setTransform.apply(p,g),p.translate(O,I),p.scale(this.imageScale_[0],this.imageScale_[1]),p.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),p.setTransform(1,0,0,1,0,0)}else p.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,w,S,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(p.globalAlpha=v)}},e.prototype.drawText_=function(t,n,i,a){if(!(!this.textState_||this.text_==="")){this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);var u=Wi(t,n,i,a,this.transform_,this.pixelCoordinates_),p=this.context_,g=this.textRotation_;for(this.textRotateWithView_&&(g+=this.viewRotation_);n<i;n+=a){var v=u[n]+this.textOffsetX_,m=u[n+1]+this.textOffsetY_;if(g!==0||this.textScale_[0]!=1||this.textScale_[1]!=1){var b=mn(this.tmpLocalTransform_,v,m,1,1,g,-v,-m);p.setTransform.apply(p,b),p.translate(v,m),p.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&p.strokeText(this.text_,0,0),this.textFillState_&&p.fillText(this.text_,0,0),p.setTransform(1,0,0,1,0,0)}else this.textStrokeState_&&p.strokeText(this.text_,v,m),this.textFillState_&&p.fillText(this.text_,v,m)}}},e.prototype.moveToLineTo_=function(t,n,i,a,u){var p=this.context_,g=Wi(t,n,i,a,this.transform_,this.pixelCoordinates_);p.moveTo(g[0],g[1]);var v=g.length;u&&(v-=2);for(var m=2;m<v;m+=2)p.lineTo(g[m],g[m+1]);return u&&p.closePath(),i},e.prototype.drawRings_=function(t,n,i,a){for(var u=0,p=i.length;u<p;++u)n=this.moveToLineTo_(t,n,i[u],a,!0);return n},e.prototype.drawCircle=function(t){if(!!Fe(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var n=R0(t,this.transform_,this.pixelCoordinates_),i=n[2]-n[0],a=n[3]-n[1],u=Math.sqrt(i*i+a*a),p=this.context_;p.beginPath(),p.arc(n[0],n[1],u,0,2*Math.PI),this.fillState_&&p.fill(),this.strokeState_&&p.stroke()}this.text_!==""&&this.drawText_(t.getCenter(),0,2,2)}},e.prototype.setStyle=function(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())},e.prototype.setTransform=function(t){this.transform_=t},e.prototype.drawGeometry=function(t){var n=t.getType();switch(n){case mt.POINT:this.drawPoint(t);break;case mt.LINE_STRING:this.drawLineString(t);break;case mt.POLYGON:this.drawPolygon(t);break;case mt.MULTI_POINT:this.drawMultiPoint(t);break;case mt.MULTI_LINE_STRING:this.drawMultiLineString(t);break;case mt.MULTI_POLYGON:this.drawMultiPolygon(t);break;case mt.GEOMETRY_COLLECTION:this.drawGeometryCollection(t);break;case mt.CIRCLE:this.drawCircle(t);break}},e.prototype.drawFeature=function(t,n){var i=n.getGeometryFunction()(t);!i||!Fe(this.extent_,i.getExtent())||(this.setStyle(n),this.drawGeometry(i))},e.prototype.drawGeometryCollection=function(t){for(var n=t.getGeometriesArray(),i=0,a=n.length;i<a;++i)this.drawGeometry(n[i])},e.prototype.drawPoint=function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var n=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(n,0,n.length,i),this.text_!==""&&this.drawText_(n,0,n.length,i)},e.prototype.drawMultiPoint=function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var n=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(n,0,n.length,i),this.text_!==""&&this.drawText_(n,0,n.length,i)},e.prototype.drawLineString=function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Fe(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var n=this.context_,i=t.getFlatCoordinates();n.beginPath(),this.moveToLineTo_(i,0,i.length,t.getStride(),!1),n.stroke()}if(this.text_!==""){var a=t.getFlatMidpoint();this.drawText_(a,0,2,2)}}},e.prototype.drawMultiLineString=function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var n=t.getExtent();if(!!Fe(this.extent_,n)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var i=this.context_,a=t.getFlatCoordinates(),u=0,p=t.getEnds(),g=t.getStride();i.beginPath();for(var v=0,m=p.length;v<m;++v)u=this.moveToLineTo_(a,u,p[v],g,!1);i.stroke()}if(this.text_!==""){var b=t.getFlatMidpoints();this.drawText_(b,0,b.length,2)}}},e.prototype.drawPolygon=function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Fe(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var n=this.context_;n.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&n.fill(),this.strokeState_&&n.stroke()}if(this.text_!==""){var i=t.getFlatInteriorPoint();this.drawText_(i,0,2,2)}}},e.prototype.drawMultiPolygon=function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Fe(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var n=this.context_,i=t.getOrientedFlatCoordinates(),a=0,u=t.getEndss(),p=t.getStride();n.beginPath();for(var g=0,v=u.length;g<v;++g){var m=u[g];a=this.drawRings_(i,a,m,p)}this.fillState_&&n.fill(),this.strokeState_&&n.stroke()}if(this.text_!==""){var b=t.getFlatInteriorPoints();this.drawText_(b,0,b.length,2)}}},e.prototype.setContextFillState_=function(t){var n=this.context_,i=this.contextFillState_;i?i.fillStyle!=t.fillStyle&&(i.fillStyle=t.fillStyle,n.fillStyle=t.fillStyle):(n.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})},e.prototype.setContextStrokeState_=function(t){var n=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=t.lineCap&&(i.lineCap=t.lineCap,n.lineCap=t.lineCap),n.setLineDash&&(Ki(i.lineDash,t.lineDash)||n.setLineDash(i.lineDash=t.lineDash),i.lineDashOffset!=t.lineDashOffset&&(i.lineDashOffset=t.lineDashOffset,n.lineDashOffset=t.lineDashOffset)),i.lineJoin!=t.lineJoin&&(i.lineJoin=t.lineJoin,n.lineJoin=t.lineJoin),i.lineWidth!=t.lineWidth&&(i.lineWidth=t.lineWidth,n.lineWidth=t.lineWidth),i.miterLimit!=t.miterLimit&&(i.miterLimit=t.miterLimit,n.miterLimit=t.miterLimit),i.strokeStyle!=t.strokeStyle&&(i.strokeStyle=t.strokeStyle,n.strokeStyle=t.strokeStyle)):(n.lineCap=t.lineCap,n.setLineDash&&(n.setLineDash(t.lineDash),n.lineDashOffset=t.lineDashOffset),n.lineJoin=t.lineJoin,n.lineWidth=t.lineWidth,n.miterLimit=t.miterLimit,n.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})},e.prototype.setContextTextState_=function(t){var n=this.context_,i=this.contextTextState_,a=t.textAlign?t.textAlign:Do;i?(i.font!=t.font&&(i.font=t.font,n.font=t.font),i.textAlign!=a&&(i.textAlign=a,n.textAlign=a),i.textBaseline!=t.textBaseline&&(i.textBaseline=t.textBaseline,n.textBaseline=t.textBaseline)):(n.font=t.font,n.textAlign=a,n.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:a,textBaseline:t.textBaseline})},e.prototype.setFillStrokeStyle=function(t,n){var i=this;if(!t)this.fillState_=null;else{var a=t.getColor();this.fillState_={fillStyle:vn(a||Fn)}}if(!n)this.strokeState_=null;else{var u=n.getColor(),p=n.getLineCap(),g=n.getLineDash(),v=n.getLineDashOffset(),m=n.getLineJoin(),b=n.getWidth(),E=n.getMiterLimit(),w=g||Ao;this.strokeState_={lineCap:p!==void 0?p:oa,lineDash:this.pixelRatio_===1?w:w.map(function(S){return S*i.pixelRatio_}),lineDashOffset:(v||Po)*this.pixelRatio_,lineJoin:m!==void 0?m:Ar,lineWidth:(b!==void 0?b:ko)*this.pixelRatio_,miterLimit:E!==void 0?E:Mo,strokeStyle:vn(u||Lo)}}},e.prototype.setImageStyle=function(t){var n;if(!t||!(n=t.getSize())){this.image_=null;return}var i=t.getAnchor(),a=t.getOrigin();this.image_=t.getImage(this.pixelRatio_),this.imageAnchorX_=i[0]*this.pixelRatio_,this.imageAnchorY_=i[1]*this.pixelRatio_,this.imageHeight_=n[1]*this.pixelRatio_,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=a[0],this.imageOriginY_=a[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation(),this.imageScale_=t.getScaleArray(),this.imageWidth_=n[0]*this.pixelRatio_},e.prototype.setTextStyle=function(t){if(!t)this.text_="";else{var n=t.getFill();if(!n)this.textFillState_=null;else{var i=n.getColor();this.textFillState_={fillStyle:vn(i||Fn)}}var a=t.getStroke();if(!a)this.textStrokeState_=null;else{var u=a.getColor(),p=a.getLineCap(),g=a.getLineDash(),v=a.getLineDashOffset(),m=a.getLineJoin(),b=a.getWidth(),E=a.getMiterLimit();this.textStrokeState_={lineCap:p!==void 0?p:oa,lineDash:g||Ao,lineDashOffset:v||Po,lineJoin:m!==void 0?m:Ar,lineWidth:b!==void 0?b:ko,miterLimit:E!==void 0?E:Mo,strokeStyle:vn(u||Lo)}}var w=t.getFont(),S=t.getOffsetX(),O=t.getOffsetY(),I=t.getRotateWithView(),M=t.getRotation(),A=t.getScaleArray(),k=t.getText(),L=t.getTextAlign(),B=t.getTextBaseline();this.textState_={font:w!==void 0?w:pp,textAlign:L!==void 0?L:Do,textBaseline:B!==void 0?B:sa},this.text_=k!==void 0?Array.isArray(k)?k.reduce(function(G,V,U){return G+=U%2?" ":V},""):k:"",this.textOffsetX_=S!==void 0?this.pixelRatio_*S:0,this.textOffsetY_=O!==void 0?this.pixelRatio_*O:0,this.textRotateWithView_=I!==void 0?I:!1,this.textRotation_=M!==void 0?M:0,this.textScale_=[this.pixelRatio_*A[0],this.pixelRatio_*A[1]]}},e}(xp),gb=pb,ii={FRACTION:"fraction",PIXELS:"pixels"},Ze={BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",TOP_LEFT:"top-left",TOP_RIGHT:"top-right"},_b=function(){function r(){this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32}return r.prototype.clear=function(){this.cache_={},this.cacheSize_=0},r.prototype.canExpireCache=function(){return this.cacheSize_>this.maxCacheSize_},r.prototype.expire=function(){if(this.canExpireCache()){var e=0;for(var t in this.cache_){var n=this.cache_[t];(e++&3)===0&&!n.hasListener()&&(delete this.cache_[t],--this.cacheSize_)}}},r.prototype.get=function(e,t,n){var i=qf(e,t,n);return i in this.cache_?this.cache_[i]:null},r.prototype.set=function(e,t,n,i){var a=qf(e,t,n);this.cache_[a]=i,++this.cacheSize_},r.prototype.setSize=function(e){this.maxCacheSize_=e,this.expire()},r}();function qf(r,e,t){var n=t?hp(t):"null";return e+":"+r+":"+n}var ca=new _b,vb=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),yb=function(r){vb(e,r);function e(t,n,i,a){var u=r.call(this)||this;return u.extent=t,u.pixelRatio_=i,u.resolution=n,u.state=a,u}return e.prototype.changed=function(){this.dispatchEvent(pt.CHANGE)},e.prototype.getExtent=function(){return this.extent},e.prototype.getImage=function(){return Rt()},e.prototype.getPixelRatio=function(){return this.pixelRatio_},e.prototype.getResolution=function(){return this.resolution},e.prototype.getState=function(){return this.state},e.prototype.load=function(){Rt()},e}(Zi),mb=yb,xb=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();(function(r){xb(e,r);function e(t,n,i,a,u,p){var g=r.call(this,t,n,i,Wt.IDLE)||this;return g.src_=a,g.image_=new Image,u!==null&&(g.image_.crossOrigin=u),g.unlisten_=null,g.state=Wt.IDLE,g.imageLoadFunction_=p,g}return e.prototype.getImage=function(){return this.image_},e.prototype.handleImageError_=function(){this.state=Wt.ERROR,this.unlistenImage_(),this.changed()},e.prototype.handleImageLoad_=function(){this.resolution===void 0&&(this.resolution=sn(this.extent)/this.image_.height),this.state=Wt.LOADED,this.unlistenImage_(),this.changed()},e.prototype.load=function(){(this.state==Wt.IDLE||this.state==Wt.ERROR)&&(this.state=Wt.LOADING,this.changed(),this.imageLoadFunction_(this,this.src_),this.unlisten_=kh(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))},e.prototype.setImage=function(t){this.image_=t,this.resolution=sn(this.extent)/this.image_.height},e.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)},e})(mb);function kh(r,e,t){var n=r,i=!0,a=!1,u=!1,p=[qs(n,pt.LOAD,function(){u=!0,a||e()})];return n.src&&Am?(a=!0,n.decode().then(function(){i&&e()}).catch(function(g){i&&(u?e():t())})):p.push(qs(n,pt.ERROR,t)),function(){i=!1,p.forEach(Kt)}}var bb=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),go=null,Eb=function(r){bb(e,r);function e(t,n,i,a,u,p){var g=r.call(this)||this;return g.hitDetectionImage_=null,g.image_=t||new Image,a!==null&&(g.image_.crossOrigin=a),g.canvas_={},g.color_=p,g.unlisten_=null,g.imageState_=u,g.size_=i,g.src_=n,g.tainted_,g}return e.prototype.isTainted_=function(){if(this.tainted_===void 0&&this.imageState_===Wt.LOADED){go||(go=We(1,1)),go.drawImage(this.image_,0,0);try{go.getImageData(0,0,1,1),this.tainted_=!1}catch{go=null,this.tainted_=!0}}return this.tainted_===!0},e.prototype.dispatchChangeEvent_=function(){this.dispatchEvent(pt.CHANGE)},e.prototype.handleImageError_=function(){this.imageState_=Wt.ERROR,this.unlistenImage_(),this.dispatchChangeEvent_()},e.prototype.handleImageLoad_=function(){this.imageState_=Wt.LOADED,this.size_?(this.image_.width=this.size_[0],this.image_.height=this.size_[1]):this.size_=[this.image_.width,this.image_.height],this.unlistenImage_(),this.dispatchChangeEvent_()},e.prototype.getImage=function(t){return this.replaceColor_(t),this.canvas_[t]?this.canvas_[t]:this.image_},e.prototype.getPixelRatio=function(t){return this.replaceColor_(t),this.canvas_[t]?t:1},e.prototype.getImageState=function(){return this.imageState_},e.prototype.getHitDetectionImage=function(){if(!this.hitDetectionImage_)if(this.isTainted_()){var t=this.size_[0],n=this.size_[1],i=We(t,n);i.fillRect(0,0,t,n),this.hitDetectionImage_=i.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_},e.prototype.getSize=function(){return this.size_},e.prototype.getSrc=function(){return this.src_},e.prototype.load=function(){if(this.imageState_==Wt.IDLE){this.imageState_=Wt.LOADING;try{this.image_.src=this.src_}catch{this.handleImageError_()}this.unlisten_=kh(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this))}},e.prototype.replaceColor_=function(t){if(!(!this.color_||this.canvas_[t]||this.imageState_!==Wt.LOADED)){var n=document.createElement("canvas");this.canvas_[t]=n,n.width=Math.ceil(this.image_.width*t),n.height=Math.ceil(this.image_.height*t);var i=n.getContext("2d");if(i.scale(t,t),i.drawImage(this.image_,0,0),i.globalCompositeOperation="multiply",i.globalCompositeOperation==="multiply"||this.isTainted_())i.fillStyle=hp(this.color_),i.fillRect(0,0,n.width/t,n.height/t),i.globalCompositeOperation="destination-in",i.drawImage(this.image_,0,0);else{for(var a=i.getImageData(0,0,n.width,n.height),u=a.data,p=this.color_[0]/255,g=this.color_[1]/255,v=this.color_[2]/255,m=this.color_[3],b=0,E=u.length;b<E;b+=4)u[b]*=p,u[b+1]*=g,u[b+2]*=v,u[b+3]*=m;i.putImageData(a,0,0)}}},e.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)},e}(Zi);function Tb(r,e,t,n,i,a){var u=ca.get(e,n,a);return u||(u=new Eb(r,e,t,n,i,a),ca.set(e,n,a,u)),u}var wb=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Sb=function(r){wb(e,r);function e(t){var n=this,i=t||{},a=i.opacity!==void 0?i.opacity:1,u=i.rotation!==void 0?i.rotation:0,p=i.scale!==void 0?i.scale:1,g=i.rotateWithView!==void 0?i.rotateWithView:!1;n=r.call(this,{opacity:a,rotation:u,scale:p,displacement:i.displacement!==void 0?i.displacement:[0,0],rotateWithView:g})||this,n.anchor_=i.anchor!==void 0?i.anchor:[.5,.5],n.normalizedAnchor_=null,n.anchorOrigin_=i.anchorOrigin!==void 0?i.anchorOrigin:Ze.TOP_LEFT,n.anchorXUnits_=i.anchorXUnits!==void 0?i.anchorXUnits:ii.FRACTION,n.anchorYUnits_=i.anchorYUnits!==void 0?i.anchorYUnits:ii.FRACTION,n.crossOrigin_=i.crossOrigin!==void 0?i.crossOrigin:null;var v=i.img!==void 0?i.img:null;n.imgSize_=i.imgSize;var m=i.src;Ct(!(m!==void 0&&v),4),Ct(!v||v&&n.imgSize_,5),(m===void 0||m.length===0)&&v&&(m=v.src||Xt(v)),Ct(m!==void 0&&m.length>0,6);var b=i.src!==void 0?Wt.IDLE:Wt.LOADED;return n.color_=i.color!==void 0?Io(i.color):null,n.iconImage_=Tb(v,m,n.imgSize_!==void 0?n.imgSize_:null,n.crossOrigin_,b,n.color_),n.offset_=i.offset!==void 0?i.offset:[0,0],n.offsetOrigin_=i.offsetOrigin!==void 0?i.offsetOrigin:Ze.TOP_LEFT,n.origin_=null,n.size_=i.size!==void 0?i.size:null,n}return e.prototype.clone=function(){var t=this.getScale();return new e({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,imgSize:this.imgSize_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:Array.isArray(t)?t.slice():t,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc()})},e.prototype.getAnchor=function(){var t=this.normalizedAnchor_;if(!t){t=this.anchor_;var n=this.getSize();if(this.anchorXUnits_==ii.FRACTION||this.anchorYUnits_==ii.FRACTION){if(!n)return null;t=this.anchor_.slice(),this.anchorXUnits_==ii.FRACTION&&(t[0]*=n[0]),this.anchorYUnits_==ii.FRACTION&&(t[1]*=n[1])}if(this.anchorOrigin_!=Ze.TOP_LEFT){if(!n)return null;t===this.anchor_&&(t=this.anchor_.slice()),(this.anchorOrigin_==Ze.TOP_RIGHT||this.anchorOrigin_==Ze.BOTTOM_RIGHT)&&(t[0]=-t[0]+n[0]),(this.anchorOrigin_==Ze.BOTTOM_LEFT||this.anchorOrigin_==Ze.BOTTOM_RIGHT)&&(t[1]=-t[1]+n[1])}this.normalizedAnchor_=t}var i=this.getDisplacement();return[t[0]-i[0],t[1]+i[1]]},e.prototype.setAnchor=function(t){this.anchor_=t,this.normalizedAnchor_=null},e.prototype.getColor=function(){return this.color_},e.prototype.getImage=function(t){return this.iconImage_.getImage(t)},e.prototype.getPixelRatio=function(t){return this.iconImage_.getPixelRatio(t)},e.prototype.getImageSize=function(){return this.iconImage_.getSize()},e.prototype.getImageState=function(){return this.iconImage_.getImageState()},e.prototype.getHitDetectionImage=function(){return this.iconImage_.getHitDetectionImage()},e.prototype.getOrigin=function(){if(this.origin_)return this.origin_;var t=this.offset_;if(this.offsetOrigin_!=Ze.TOP_LEFT){var n=this.getSize(),i=this.iconImage_.getSize();if(!n||!i)return null;t=t.slice(),(this.offsetOrigin_==Ze.TOP_RIGHT||this.offsetOrigin_==Ze.BOTTOM_RIGHT)&&(t[0]=i[0]-n[0]-t[0]),(this.offsetOrigin_==Ze.BOTTOM_LEFT||this.offsetOrigin_==Ze.BOTTOM_RIGHT)&&(t[1]=i[1]-n[1]-t[1])}return this.origin_=t,this.origin_},e.prototype.getSrc=function(){return this.iconImage_.getSrc()},e.prototype.getSize=function(){return this.size_?this.size_:this.iconImage_.getSize()},e.prototype.listenImageChange=function(t){this.iconImage_.addEventListener(pt.CHANGE,t)},e.prototype.load=function(){this.iconImage_.load()},e.prototype.unlistenImageChange=function(t){this.iconImage_.removeEventListener(pt.CHANGE,t)},e}(sp),Rb=Sb,_n=.5;function Cb(r,e,t,n,i,a,u){var p=r[0]*_n,g=r[1]*_n,v=We(p,g);v.imageSmoothingEnabled=!1;for(var m=v.canvas,b=new gb(v,_n,i,null,u),E=t.length,w=Math.floor((256*256*256-1)/E),S={},O=1;O<=E;++O){var I=t[O-1],M=I.getStyleFunction()||n;if(!!n){var A=M(I,a);if(!!A){Array.isArray(A)||(A=[A]);for(var k=O*w,L="#"+("000000"+k.toString(16)).slice(-6),B=0,G=A.length;B<G;++B){var V=A[B],U=V.getGeometryFunction()(I);if(!(!U||!Fe(i,U.getExtent()))){var K=V.clone(),H=K.getFill();H&&H.setColor(L);var et=K.getStroke();et&&(et.setColor(L),et.setLineDash(null)),K.setText(void 0);var X=V.getImage();if(X&&X.getOpacity()!==0){var j=X.getImageSize();if(!j)continue;var J=We(j[0],j[1],void 0,{alpha:!1}),Q=J.canvas;J.fillStyle=L,J.fillRect(0,0,Q.width,Q.height),K.setImage(new Rb({img:Q,imgSize:j,anchor:X.getAnchor(),anchorXUnits:ii.PIXELS,anchorYUnits:ii.PIXELS,offset:X.getOrigin(),opacity:1,size:X.getSize(),scale:X.getScale(),rotation:X.getRotation(),rotateWithView:X.getRotateWithView()}))}var tt=K.getZIndex()||0,rt=S[tt];rt||(rt={},S[tt]=rt,rt[mt.POLYGON]=[],rt[mt.CIRCLE]=[],rt[mt.LINE_STRING]=[],rt[mt.POINT]=[]),rt[U.getType().replace("Multi","")].push(U,K)}}}}}for(var at=Object.keys(S).map(Number).sort(Ir),O=0,ht=at.length;O<ht;++O){var rt=S[at[O]];for(var ut in rt)for(var wt=rt[ut],B=0,G=wt.length;B<G;B+=2){b.setStyle(wt[B+1]);for(var Y=0,Yt=e.length;Y<Yt;++Y)b.setTransform(e[Y]),b.drawGeometry(wt[B])}}return v.getImageData(0,0,m.width,m.height)}function Ob(r,e,t){var n=[];if(t){var i=Math.floor(Math.round(r[0])*_n),a=Math.floor(Math.round(r[1])*_n),u=(se(i,0,t.width-1)+se(a,0,t.height-1)*t.width)*4,p=t.data[u],g=t.data[u+1],v=t.data[u+2],m=v+256*(g+256*p),b=Math.floor((256*256*256-1)/e.length);m&&m%b===0&&n.push(e[m/b-1])}return n}var Ib=.5,Ep={Point:Bb,LineString:kb,Polygon:zb,MultiPoint:Gb,MultiLineString:Fb,MultiPolygon:Nb,GeometryCollection:Db,Circle:Mb};function Ab(r,e){return parseInt(Xt(r),10)-parseInt(Xt(e),10)}function Pb(r,e){var t=gh(r,e);return t*t}function gh(r,e){return Ib*r/e}function Mb(r,e,t,n,i){var a=t.getFill(),u=t.getStroke();if(a||u){var p=r.getBuilder(t.getZIndex(),qt.CIRCLE);p.setFillStrokeStyle(a,u),p.drawCircle(e,n)}var g=t.getText();if(g&&g.getText()){var v=(i||r).getBuilder(t.getZIndex(),qt.TEXT);v.setTextStyle(g),v.drawText(e,n)}}function Jf(r,e,t,n,i,a,u){var p=!1,g=t.getImage();if(g){var v=g.getImageState();v==Wt.LOADED||v==Wt.ERROR?g.unlistenImageChange(i):(v==Wt.IDLE&&g.load(),v=g.getImageState(),g.listenImageChange(i),p=!0)}return Lb(r,e,t,n,a,u),p}function Lb(r,e,t,n,i,a){var u=t.getGeometryFunction()(e);if(!!u){var p=u.simplifyTransformed(n,i),g=t.getRenderer();if(g)Tp(r,p,t,e);else{var v=Ep[p.getType()];v(r,p,t,e,a)}}}function Tp(r,e,t,n){if(e.getType()==mt.GEOMETRY_COLLECTION){for(var i=e.getGeometries(),a=0,u=i.length;a<u;++a)Tp(r,i[a],t,n);return}var p=r.getBuilder(t.getZIndex(),qt.DEFAULT);p.drawCustom(e,n,t.getRenderer(),t.getHitDetectionRenderer())}function Db(r,e,t,n,i){var a=e.getGeometriesArray(),u,p;for(u=0,p=a.length;u<p;++u){var g=Ep[a[u].getType()];g(r,a[u],t,n,i)}}function kb(r,e,t,n,i){var a=t.getStroke();if(a){var u=r.getBuilder(t.getZIndex(),qt.LINE_STRING);u.setFillStrokeStyle(null,a),u.drawLineString(e,n)}var p=t.getText();if(p&&p.getText()){var g=(i||r).getBuilder(t.getZIndex(),qt.TEXT);g.setTextStyle(p),g.drawText(e,n)}}function Fb(r,e,t,n,i){var a=t.getStroke();if(a){var u=r.getBuilder(t.getZIndex(),qt.LINE_STRING);u.setFillStrokeStyle(null,a),u.drawMultiLineString(e,n)}var p=t.getText();if(p&&p.getText()){var g=(i||r).getBuilder(t.getZIndex(),qt.TEXT);g.setTextStyle(p),g.drawText(e,n)}}function Nb(r,e,t,n,i){var a=t.getFill(),u=t.getStroke();if(u||a){var p=r.getBuilder(t.getZIndex(),qt.POLYGON);p.setFillStrokeStyle(a,u),p.drawMultiPolygon(e,n)}var g=t.getText();if(g&&g.getText()){var v=(i||r).getBuilder(t.getZIndex(),qt.TEXT);v.setTextStyle(g),v.drawText(e,n)}}function Bb(r,e,t,n,i){var a=t.getImage(),u=t.getText(),p;if(i&&(r=i,p=a&&u&&u.getText()?{}:void 0),a){if(a.getImageState()!=Wt.LOADED)return;var g=r.getBuilder(t.getZIndex(),qt.IMAGE);g.setImageStyle(a,p),g.drawPoint(e,n)}if(u&&u.getText()){var v=r.getBuilder(t.getZIndex(),qt.TEXT);v.setTextStyle(u,p),v.drawText(e,n)}}function Gb(r,e,t,n,i){var a=t.getImage(),u=t.getText(),p;if(i&&(r=i,p=a&&u&&u.getText()?{}:void 0),a){if(a.getImageState()!=Wt.LOADED)return;var g=r.getBuilder(t.getZIndex(),qt.IMAGE);g.setImageStyle(a,p),g.drawMultiPoint(e,n)}if(u&&u.getText()){var v=(i||r).getBuilder(t.getZIndex(),qt.TEXT);v.setTextStyle(u,p),v.drawText(e,n)}}function zb(r,e,t,n,i){var a=t.getFill(),u=t.getStroke();if(a||u){var p=r.getBuilder(t.getZIndex(),qt.POLYGON);p.setFillStrokeStyle(a,u),p.drawPolygon(e,n)}var g=t.getText();if(g&&g.getText()){var v=(i||r).getBuilder(t.getZIndex(),qt.TEXT);v.setTextStyle(g),v.drawText(e,n)}}var Ub=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Vb=function(r){Ub(e,r);function e(t){var n=r.call(this,t)||this;return n.boundHandleStyleImageChange_=n.handleStyleImageChange_.bind(n),n.animatingOrInteracting_,n.dirty_=!1,n.hitDetectionImageData_=null,n.renderedFeatures_=null,n.renderedRevision_=-1,n.renderedResolution_=NaN,n.renderedExtent_=xn(),n.wrappedRenderedExtent_=xn(),n.renderedRotation_,n.renderedCenter_=null,n.renderedProjection_=null,n.renderedRenderOrder_=null,n.replayGroup_=null,n.replayGroupChanged=!0,n.declutterExecutorGroup=null,n.clipping=!0,n}return e.prototype.renderWorlds=function(t,n,i){var a=n.extent,u=n.viewState,p=u.center,g=u.resolution,v=u.projection,m=u.rotation,b=v.getExtent(),E=this.getLayer().getSource(),w=n.pixelRatio,S=n.viewHints,O=!(S[Ee.ANIMATING]||S[Ee.INTERACTING]),I=this.context,M=Math.round(n.size[0]*w),A=Math.round(n.size[1]*w),k=E.getWrapX()&&v.canWrapX(),L=k?Qt(b):null,B=k?Math.ceil((a[2]-b[2])/L)+1:1,G=k?Math.floor((a[0]-b[0])/L):0;do{var V=this.getRenderTransform(p,g,m,w,M,A,G*L);t.execute(I,1,V,m,O,void 0,i)}while(++G<B)},e.prototype.renderDeclutter=function(t){this.declutterExecutorGroup&&this.renderWorlds(this.declutterExecutorGroup,t,t.declutterTree)},e.prototype.renderFrame=function(t,n){var i=t.pixelRatio,a=t.layerStatesArray[t.layerIndex];Dm(this.pixelTransform,1/i,1/i),Bd(this.inversePixelTransform,this.pixelTransform);var u=Fm(this.pixelTransform);this.useContainer(n,u,a.opacity,this.getBackground(t));var p=this.context,g=p.canvas,v=this.replayGroup_,m=this.declutterExecutorGroup;if((!v||v.isEmpty())&&(!m||m.isEmpty()))return null;var b=Math.round(t.size[0]*i),E=Math.round(t.size[1]*i);g.width!=b||g.height!=E?(g.width=b,g.height=E,g.style.transform!==u&&(g.style.transform=u)):this.containerReused||p.clearRect(0,0,b,E),this.preRender(p,t);var w=t.viewState;w.projection;var S=!1,O=!0;if(a.extent&&this.clipping){var I=Gi(a.extent);O=Fe(I,t.extent),S=O&&!xr(I,t.extent),S&&this.clipUnrotated(p,t,I)}O&&this.renderWorlds(v,t),S&&p.restore(),this.postRender(p,t);var M=ox(a.opacity),A=this.container;return M!==A.style.opacity&&(A.style.opacity=M),this.renderedRotation_!==w.rotation&&(this.renderedRotation_=w.rotation,this.hitDetectionImageData_=null),this.container},e.prototype.getFeatures=function(t){return new Promise(function(n){if(!this.hitDetectionImageData_&&!this.animatingOrInteracting_){var i=[this.context.canvas.width,this.context.canvas.height];ne(this.pixelTransform,i);var a=this.renderedCenter_,u=this.renderedResolution_,p=this.renderedRotation_,g=this.renderedProjection_,v=this.wrappedRenderedExtent_,m=this.getLayer(),b=[],E=i[0]*_n,w=i[1]*_n;b.push(this.getRenderTransform(a,u,p,_n,E,w,0).slice());var S=m.getSource(),O=g.getExtent();if(S.getWrapX()&&g.canWrapX()&&!xr(O,v)){for(var I=v[0],M=Qt(O),A=0,k=void 0;I<O[0];)--A,k=M*A,b.push(this.getRenderTransform(a,u,p,_n,E,w,k).slice()),I+=M;for(A=0,I=v[2];I>O[2];)++A,k=M*A,b.push(this.getRenderTransform(a,u,p,_n,E,w,k).slice()),I-=M}this.hitDetectionImageData_=Cb(i,b,this.renderedFeatures_,m.getStyleFunction(),v,u,p)}n(Ob(t,this.renderedFeatures_,this.hitDetectionImageData_))}.bind(this))},e.prototype.forEachFeatureAtCoordinate=function(t,n,i,a,u){var p=this;if(!!this.replayGroup_){var g=n.viewState.resolution,v=n.viewState.rotation,m=this.getLayer(),b={},E=function(O,I,M){var A=Xt(O),k=b[A];if(k){if(k!==!0&&M<k.distanceSq){if(M===0)return b[A]=!0,u.splice(u.lastIndexOf(k),1),a(O,m,I);k.geometry=I,k.distanceSq=M}}else{if(M===0)return b[A]=!0,a(O,m,I);u.push(b[A]={feature:O,layer:m,geometry:I,distanceSq:M,callback:a})}},w,S=[this.replayGroup_];return this.declutterExecutorGroup&&S.push(this.declutterExecutorGroup),S.some(function(O){return w=O.forEachFeatureAtCoordinate(t,g,v,i,E,O===p.declutterExecutorGroup&&n.declutterTree?n.declutterTree.all().map(function(I){return I.value}):null)}),w}},e.prototype.handleFontsChanged=function(){var t=this.getLayer();t.getVisible()&&this.replayGroup_&&t.changed()},e.prototype.handleStyleImageChange_=function(t){this.renderIfReadyAndVisible()},e.prototype.prepareFrame=function(t){var n=this.getLayer(),i=n.getSource();if(!i)return!1;var a=t.viewHints[Ee.ANIMATING],u=t.viewHints[Ee.INTERACTING],p=n.getUpdateWhileAnimating(),g=n.getUpdateWhileInteracting();if(!this.dirty_&&!p&&a||!g&&u)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;var v=t.extent,m=t.viewState,b=m.projection,E=m.resolution,w=t.pixelRatio,S=n.getRevision(),O=n.getRenderBuffer(),I=n.getRenderOrder();I===void 0&&(I=Ab);var M=m.center.slice(),A=Rh(v,O*E),k=A.slice(),L=[A.slice()],B=b.getExtent();if(i.getWrapX()&&b.canWrapX()&&!xr(B,t.extent)){var G=Qt(B),V=Math.max(Qt(A)/2,G);A[0]=B[0]-V,A[2]=B[2]+V,Wd(M,b);var U=jm(L[0],b);U[0]<B[0]&&U[2]<B[2]?L.push([U[0]+G,U[1],U[2]+G,U[3]]):U[0]>B[0]&&U[2]>B[2]&&L.push([U[0]-G,U[1],U[2]-G,U[3]])}if(!this.dirty_&&this.renderedResolution_==E&&this.renderedRevision_==S&&this.renderedRenderOrder_==I&&xr(this.wrappedRenderedExtent_,A))return Ki(this.renderedExtent_,k)||(this.hitDetectionImageData_=null,this.renderedExtent_=k),this.renderedCenter_=M,this.replayGroupChanged=!1,!0;this.replayGroup_=null,this.dirty_=!1;var K=new Yf(gh(E,w),A,E,w),H;this.getLayer().getDeclutter()&&(H=new Yf(gh(E,w),A,E,w));for(var et,X,j,X=0,j=L.length;X<j;++X)i.loadFeatures(L[X],E,b);var J=Pb(E,w),Q=function(ut){var wt,Y=ut.getStyleFunction()||n.getStyleFunction();if(Y&&(wt=Y(ut,E)),wt){var Yt=this.renderFeature(ut,J,wt,K,et,H);this.dirty_=this.dirty_||Yt}}.bind(this),tt=Mh(A),rt=i.getFeaturesInExtent(tt);I&&rt.sort(I);for(var X=0,j=rt.length;X<j;++X)Q(rt[X]);this.renderedFeatures_=rt;var at=K.finish(),ht=new Zf(A,E,w,i.getOverlaps(),at,n.getRenderBuffer());return H&&(this.declutterExecutorGroup=new Zf(A,E,w,i.getOverlaps(),H.finish(),n.getRenderBuffer())),this.renderedResolution_=E,this.renderedRevision_=S,this.renderedRenderOrder_=I,this.renderedExtent_=k,this.wrappedRenderedExtent_=A,this.renderedCenter_=M,this.renderedProjection_=b,this.replayGroup_=ht,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0},e.prototype.renderFeature=function(t,n,i,a,u,p){if(!i)return!1;var g=!1;if(Array.isArray(i))for(var v=0,m=i.length;v<m;++v)g=Jf(a,t,i[v],n,this.boundHandleStyleImageChange_,u,p)||g;else g=Jf(a,t,i,n,this.boundHandleStyleImageChange_,u,p);return g},e}(ob),Xb=Vb,jb=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Wb=function(r){jb(e,r);function e(t){return r.call(this,t)||this}return e.prototype.createRenderer=function(){return new Xb(this)},e}(Dx),Qf=Wb,Hb=function(){function r(e){this.rbush_=new mp(e),this.items_={}}return r.prototype.insert=function(e,t){var n={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],value:t};this.rbush_.insert(n),this.items_[Xt(t)]=n},r.prototype.load=function(e,t){for(var n=new Array(t.length),i=0,a=t.length;i<a;i++){var u=e[i],p=t[i],g={minX:u[0],minY:u[1],maxX:u[2],maxY:u[3],value:p};n[i]=g,this.items_[Xt(p)]=g}this.rbush_.load(n)},r.prototype.remove=function(e){var t=Xt(e),n=this.items_[t];return delete this.items_[t],this.rbush_.remove(n)!==null},r.prototype.update=function(e,t){var n=this.items_[Xt(t)],i=[n.minX,n.minY,n.maxX,n.maxY];Js(i,e)||(this.remove(t),this.insert(e,t))},r.prototype.getAll=function(){var e=this.rbush_.all();return e.map(function(t){return t.value})},r.prototype.getInExtent=function(e){var t={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]},n=this.rbush_.search(t);return n.map(function(i){return i.value})},r.prototype.forEach=function(e){return this.forEach_(this.getAll(),e)},r.prototype.forEachInExtent=function(e,t){return this.forEach_(this.getInExtent(e),t)},r.prototype.forEach_=function(e,t){for(var n,i=0,a=e.length;i<a;i++)if(n=t(e[i]),n)return n;return n},r.prototype.isEmpty=function(){return Oo(this.items_)},r.prototype.clear=function(){this.rbush_.clear(),this.items_={}},r.prototype.getExtent=function(e){var t=this.rbush_.toJSON();return bn(t.minX,t.minY,t.maxX,t.maxY,e)},r.prototype.concat=function(e){this.rbush_.load(e.rbush_.all());for(var t in e.items_)this.items_[t]=e.items_[t]},r}(),td=Hb,Yb=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),$b=function(r){Yb(e,r);function e(t){var n=r.call(this)||this;n.projection=Je(t.projection),n.attributions_=ed(t.attributions),n.attributionsCollapsible_=t.attributionsCollapsible!==void 0?t.attributionsCollapsible:!0,n.loading=!1,n.state_=t.state!==void 0?t.state:Oe.READY,n.wrapX_=t.wrapX!==void 0?t.wrapX:!1,n.interpolate_=!!t.interpolate,n.viewResolver=null,n.viewRejector=null;var i=n;return n.viewPromise_=new Promise(function(a,u){i.viewResolver=a,i.viewRejector=u}),n}return e.prototype.getAttributions=function(){return this.attributions_},e.prototype.getAttributionsCollapsible=function(){return this.attributionsCollapsible_},e.prototype.getProjection=function(){return this.projection},e.prototype.getResolutions=function(){return Rt()},e.prototype.getView=function(){return this.viewPromise_},e.prototype.getState=function(){return this.state_},e.prototype.getWrapX=function(){return this.wrapX_},e.prototype.getInterpolate=function(){return this.interpolate_},e.prototype.refresh=function(){this.changed()},e.prototype.setAttributions=function(t){this.attributions_=ed(t),this.changed()},e.prototype.setState=function(t){this.state_=t,this.changed()},e}(Tn);function ed(r){return r?Array.isArray(r)?function(e){return r}:typeof r=="function"?r:function(e){return[r]}:null}var wp=$b,rn={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};function Kb(r,e){return[[-1/0,-1/0,1/0,1/0]]}var _o={ARRAY_BUFFER:"arraybuffer",JSON:"json",TEXT:"text",XML:"xml"},Zb=!1;function qb(r,e,t,n,i,a,u){var p=new XMLHttpRequest;p.open("GET",typeof r=="function"?r(t,n,i):r,!0),e.getType()==_o.ARRAY_BUFFER&&(p.responseType="arraybuffer"),p.withCredentials=Zb,p.onload=function(g){if(!p.status||p.status>=200&&p.status<300){var v=e.getType(),m=void 0;v==_o.JSON||v==_o.TEXT?m=p.responseText:v==_o.XML?(m=p.responseXML,m||(m=new DOMParser().parseFromString(p.responseText,"application/xml"))):v==_o.ARRAY_BUFFER&&(m=p.response),m?a(e.readFeatures(m,{extent:t,featureProjection:i}),e.readProjection(m)):u()}else u()},p.onerror=u,p.send()}function nd(r,e){return function(t,n,i,a,u){var p=this;qb(r,e,t,n,i,function(g,v){p.addFeatures(g),a!==void 0&&a(g)},u||Hi)}}var Sp=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Qn=function(r){Sp(e,r);function e(t,n,i){var a=r.call(this,t)||this;return a.feature=n,a.features=i,a}return e}(Nn),Jb=function(r){Sp(e,r);function e(t){var n=this,i=t||{};n=r.call(this,{attributions:i.attributions,interpolate:!0,projection:void 0,state:Oe.READY,wrapX:i.wrapX!==void 0?i.wrapX:!0})||this,n.on,n.once,n.un,n.loader_=Hi,n.format_=i.format,n.overlaps_=i.overlaps===void 0?!0:i.overlaps,n.url_=i.url,i.loader!==void 0?n.loader_=i.loader:n.url_!==void 0&&(Ct(n.format_,7),n.loader_=nd(n.url_,n.format_)),n.strategy_=i.strategy!==void 0?i.strategy:Kb;var a=i.useSpatialIndex!==void 0?i.useSpatialIndex:!0;n.featuresRtree_=a?new td:null,n.loadedExtentsRtree_=new td,n.loadingExtentsCount_=0,n.nullGeometryFeatures_={},n.idIndex_={},n.uidIndex_={},n.featureChangeKeys_={},n.featuresCollection_=null;var u,p;return Array.isArray(i.features)?p=i.features:i.features&&(u=i.features,p=u.getArray()),!a&&u===void 0&&(u=new qe(p)),p!==void 0&&n.addFeaturesInternal(p),u!==void 0&&n.bindFeaturesCollection_(u),n}return e.prototype.addFeature=function(t){this.addFeatureInternal(t),this.changed()},e.prototype.addFeatureInternal=function(t){var n=Xt(t);if(!this.addToIndex_(n,t)){this.featuresCollection_&&this.featuresCollection_.remove(t);return}this.setupChangeEvents_(n,t);var i=t.getGeometry();if(i){var a=i.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(a,t)}else this.nullGeometryFeatures_[n]=t;this.dispatchEvent(new Qn(rn.ADDFEATURE,t))},e.prototype.setupChangeEvents_=function(t,n){this.featureChangeKeys_[t]=[Lt(n,pt.CHANGE,this.handleFeatureChange_,this),Lt(n,Or.PROPERTYCHANGE,this.handleFeatureChange_,this)]},e.prototype.addToIndex_=function(t,n){var i=!0,a=n.getId();return a!==void 0&&(a.toString()in this.idIndex_?i=!1:this.idIndex_[a.toString()]=n),i&&(Ct(!(t in this.uidIndex_),30),this.uidIndex_[t]=n),i},e.prototype.addFeatures=function(t){this.addFeaturesInternal(t),this.changed()},e.prototype.addFeaturesInternal=function(t){for(var n=[],i=[],a=[],u=0,p=t.length;u<p;u++){var g=t[u],v=Xt(g);this.addToIndex_(v,g)&&i.push(g)}for(var u=0,m=i.length;u<m;u++){var g=i[u],v=Xt(g);this.setupChangeEvents_(v,g);var b=g.getGeometry();if(b){var E=b.getExtent();n.push(E),a.push(g)}else this.nullGeometryFeatures_[v]=g}if(this.featuresRtree_&&this.featuresRtree_.load(n,a),this.hasListener(rn.ADDFEATURE))for(var u=0,w=i.length;u<w;u++)this.dispatchEvent(new Qn(rn.ADDFEATURE,i[u]))},e.prototype.bindFeaturesCollection_=function(t){var n=!1;this.addEventListener(rn.ADDFEATURE,function(i){n||(n=!0,t.push(i.feature),n=!1)}),this.addEventListener(rn.REMOVEFEATURE,function(i){n||(n=!0,t.remove(i.feature),n=!1)}),t.addEventListener(Ne.ADD,function(i){n||(n=!0,this.addFeature(i.element),n=!1)}.bind(this)),t.addEventListener(Ne.REMOVE,function(i){n||(n=!0,this.removeFeature(i.element),n=!1)}.bind(this)),this.featuresCollection_=t},e.prototype.clear=function(t){if(t){for(var n in this.featureChangeKeys_){var i=this.featureChangeKeys_[n];i.forEach(Kt)}this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){var a=function(g){this.removeFeatureInternal(g)}.bind(this);this.featuresRtree_.forEach(a);for(var u in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[u])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};var p=new Qn(rn.CLEAR);this.dispatchEvent(p),this.changed()},e.prototype.forEachFeature=function(t){if(this.featuresRtree_)return this.featuresRtree_.forEach(t);this.featuresCollection_&&this.featuresCollection_.forEach(t)},e.prototype.forEachFeatureAtCoordinateDirect=function(t,n){var i=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(i,function(a){var u=a.getGeometry();if(u.intersectsCoordinate(t))return n(a)})},e.prototype.forEachFeatureInExtent=function(t,n){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(t,n);this.featuresCollection_&&this.featuresCollection_.forEach(n)},e.prototype.forEachFeatureIntersectingExtent=function(t,n){return this.forEachFeatureInExtent(t,function(i){var a=i.getGeometry();if(a.intersectsExtent(t)){var u=n(i);if(u)return u}})},e.prototype.getFeaturesCollection=function(){return this.featuresCollection_},e.prototype.getFeatures=function(){var t;return this.featuresCollection_?t=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(t=this.featuresRtree_.getAll(),Oo(this.nullGeometryFeatures_)||Id(t,Ad(this.nullGeometryFeatures_))),t},e.prototype.getFeaturesAtCoordinate=function(t){var n=[];return this.forEachFeatureAtCoordinateDirect(t,function(i){n.push(i)}),n},e.prototype.getFeaturesInExtent=function(t){return this.featuresRtree_?this.featuresRtree_.getInExtent(t):this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]},e.prototype.getClosestFeatureToCoordinate=function(t,n){var i=t[0],a=t[1],u=null,p=[NaN,NaN],g=1/0,v=[-1/0,-1/0,1/0,1/0],m=n||wr;return this.featuresRtree_.forEachInExtent(v,function(b){if(m(b)){var E=b.getGeometry(),w=g;if(g=E.closestPointXY(i,a,p,g),g<w){u=b;var S=Math.sqrt(g);v[0]=i-S,v[1]=a-S,v[2]=i+S,v[3]=a+S}}}),u},e.prototype.getExtent=function(t){return this.featuresRtree_.getExtent(t)},e.prototype.getFeatureById=function(t){var n=this.idIndex_[t.toString()];return n!==void 0?n:null},e.prototype.getFeatureByUid=function(t){var n=this.uidIndex_[t];return n!==void 0?n:null},e.prototype.getFormat=function(){return this.format_},e.prototype.getOverlaps=function(){return this.overlaps_},e.prototype.getUrl=function(){return this.url_},e.prototype.handleFeatureChange_=function(t){var n=t.target,i=Xt(n),a=n.getGeometry();if(!a)i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(n),this.nullGeometryFeatures_[i]=n);else{var u=a.getExtent();i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(u,n)):this.featuresRtree_&&this.featuresRtree_.update(u,n)}var p=n.getId();if(p!==void 0){var g=p.toString();this.idIndex_[g]!==n&&(this.removeFromIdIndex_(n),this.idIndex_[g]=n)}else this.removeFromIdIndex_(n),this.uidIndex_[i]=n;this.changed(),this.dispatchEvent(new Qn(rn.CHANGEFEATURE,n))},e.prototype.hasFeature=function(t){var n=t.getId();return n!==void 0?n in this.idIndex_:Xt(t)in this.uidIndex_},e.prototype.isEmpty=function(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&Oo(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0},e.prototype.loadFeatures=function(t,n,i){for(var a=this.loadedExtentsRtree_,u=this.strategy_(t,n,i),p=function(b,E){var w=u[b],S=a.forEachInExtent(w,function(O){return xr(O.extent,w)});S||(++g.loadingExtentsCount_,g.dispatchEvent(new Qn(rn.FEATURESLOADSTART)),g.loader_.call(g,w,n,i,function(O){--this.loadingExtentsCount_,this.dispatchEvent(new Qn(rn.FEATURESLOADEND,void 0,O))}.bind(g),function(){--this.loadingExtentsCount_,this.dispatchEvent(new Qn(rn.FEATURESLOADERROR))}.bind(g)),a.insert(w,{extent:w.slice()}))},g=this,v=0,m=u.length;v<m;++v)p(v);this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0},e.prototype.refresh=function(){this.clear(!0),this.loadedExtentsRtree_.clear(),r.prototype.refresh.call(this)},e.prototype.removeLoadedExtent=function(t){var n=this.loadedExtentsRtree_,i;n.forEachInExtent(t,function(a){if(Js(a.extent,t))return i=a,!0}),i&&n.remove(i)},e.prototype.removeFeature=function(t){if(!!t){var n=Xt(t);n in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[n]:this.featuresRtree_&&this.featuresRtree_.remove(t);var i=this.removeFeatureInternal(t);i&&this.changed()}},e.prototype.removeFeatureInternal=function(t){var n=Xt(t),i=this.featureChangeKeys_[n];if(!!i){i.forEach(Kt),delete this.featureChangeKeys_[n];var a=t.getId();return a!==void 0&&delete this.idIndex_[a.toString()],delete this.uidIndex_[n],this.dispatchEvent(new Qn(rn.REMOVEFEATURE,t)),t}},e.prototype.removeFromIdIndex_=function(t){var n=!1;for(var i in this.idIndex_)if(this.idIndex_[i]===t){delete this.idIndex_[i],n=!0;break}return n},e.prototype.setLoader=function(t){this.loader_=t},e.prototype.setUrl=function(t){Ct(this.format_,7),this.url_=t,this.setLoader(nd(t,this.format_))},e}(wp),id=Jb,Rp=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),ri=function(r){Rp(e,r);function e(t,n){var i=r.call(this,t)||this;return i.layer=n,i}return e}(Nn),Gl={LAYERS:"layers"},Qb=function(r){Rp(e,r);function e(t){var n=this,i=t||{},a=oe({},i);delete a.layers;var u=i.layers;return n=r.call(this,a)||this,n.on,n.once,n.un,n.layersListenerKeys_=[],n.listenerKeys_={},n.addChangeListener(Gl.LAYERS,n.handleLayersChanged_),u?Array.isArray(u)?u=new qe(u.slice(),{unique:!0}):Ct(typeof u.getArray=="function",43):u=new qe(void 0,{unique:!0}),n.setLayers(u),n}return e.prototype.handleLayerChange_=function(){this.changed()},e.prototype.handleLayersChanged_=function(){this.layersListenerKeys_.forEach(Kt),this.layersListenerKeys_.length=0;var t=this.getLayers();this.layersListenerKeys_.push(Lt(t,Ne.ADD,this.handleLayersAdd_,this),Lt(t,Ne.REMOVE,this.handleLayersRemove_,this));for(var n in this.listenerKeys_)this.listenerKeys_[n].forEach(Kt);kr(this.listenerKeys_);for(var i=t.getArray(),a=0,u=i.length;a<u;a++){var p=i[a];this.registerLayerListeners_(p),this.dispatchEvent(new ri("addlayer",p))}this.changed()},e.prototype.registerLayerListeners_=function(t){var n=[Lt(t,Or.PROPERTYCHANGE,this.handleLayerChange_,this),Lt(t,pt.CHANGE,this.handleLayerChange_,this)];t instanceof e&&n.push(Lt(t,"addlayer",this.handleLayerGroupAdd_,this),Lt(t,"removelayer",this.handleLayerGroupRemove_,this)),this.listenerKeys_[Xt(t)]=n},e.prototype.handleLayerGroupAdd_=function(t){this.dispatchEvent(new ri("addlayer",t.layer))},e.prototype.handleLayerGroupRemove_=function(t){this.dispatchEvent(new ri("removelayer",t.layer))},e.prototype.handleLayersAdd_=function(t){var n=t.element;this.registerLayerListeners_(n),this.dispatchEvent(new ri("addlayer",n)),this.changed()},e.prototype.handleLayersRemove_=function(t){var n=t.element,i=Xt(n);this.listenerKeys_[i].forEach(Kt),delete this.listenerKeys_[i],this.dispatchEvent(new ri("removelayer",n)),this.changed()},e.prototype.getLayers=function(){return this.get(Gl.LAYERS)},e.prototype.setLayers=function(t){var n=this.getLayers();if(n)for(var i=n.getArray(),a=0,u=i.length;a<u;++a)this.dispatchEvent(new ri("removelayer",i[a]));this.set(Gl.LAYERS,t)},e.prototype.getLayersArray=function(t){var n=t!==void 0?t:[];return this.getLayers().forEach(function(i){i.getLayersArray(n)}),n},e.prototype.getLayerStatesArray=function(t){var n=t!==void 0?t:[],i=n.length;this.getLayers().forEach(function(m){m.getLayerStatesArray(n)});var a=this.getLayerState(),u=a.zIndex;!t&&a.zIndex===void 0&&(u=0);for(var p=i,g=n.length;p<g;p++){var v=n[p];v.opacity*=a.opacity,v.visible=v.visible&&a.visible,v.maxResolution=Math.min(v.maxResolution,a.maxResolution),v.minResolution=Math.max(v.minResolution,a.minResolution),v.minZoom=Math.max(v.minZoom,a.minZoom),v.maxZoom=Math.min(v.maxZoom,a.maxZoom),a.extent!==void 0&&(v.extent!==void 0?v.extent=ji(v.extent,a.extent):v.extent=a.extent),v.zIndex===void 0&&(v.zIndex=u)}return n},e.prototype.getSourceState=function(){return Oe.READY},e}(vp),Ia=Qb,Fh=34962,Nh=34963,t1=35040,Bh=35044,e1=35048,n1=5121,i1=5123,r1=5125,Cp=5126,rd=["experimental-webgl","webgl","webkit-3d","moz-webgl"];function Op(r,e){for(var t=oe({preserveDrawingBuffer:!0,antialias:!Cm},e),n=rd.length,i=0;i<n;++i)try{var a=r.getContext(rd[i],t);if(a)return a}catch{}return null}var o1={STATIC_DRAW:Bh,STREAM_DRAW:t1,DYNAMIC_DRAW:e1},s1=function(){function r(e,t){this.array=null,this.type=e,Ct(e===Fh||e===Nh,62),this.usage=t!==void 0?t:o1.STATIC_DRAW}return r.prototype.ofSize=function(e){this.array=new(zl(this.type))(e)},r.prototype.fromArray=function(e){var t=zl(this.type);this.array=t.from?t.from(e):new t(e)},r.prototype.fromArrayBuffer=function(e){this.array=new(zl(this.type))(e)},r.prototype.getType=function(){return this.type},r.prototype.getArray=function(){return this.array},r.prototype.getUsage=function(){return this.usage},r.prototype.getSize=function(){return this.array?this.array.length:0},r}();function zl(r){switch(r){case Fh:return Float32Array;case Nh:return Uint32Array;default:return Float32Array}}var Ip=s1,Ms={LOST:"webglcontextlost",RESTORED:"webglcontextrestored"},a1=`
  precision mediump float;
  
  attribute vec2 a_position;
  varying vec2 v_texCoord;
  varying vec2 v_screenCoord;
  
  uniform vec2 u_screenSize;
   
  void main() {
    v_texCoord = a_position * 0.5 + 0.5;
    v_screenCoord = v_texCoord * u_screenSize;
    gl_Position = vec4(a_position, 0.0, 1.0);
  }
`,l1=`
  precision mediump float;
   
  uniform sampler2D u_image;
  uniform float u_opacity;
   
  varying vec2 v_texCoord;
   
  void main() {
    gl_FragColor = texture2D(u_image, v_texCoord) * u_opacity;
  }
`,h1=function(){function r(e){this.gl_=e.webGlContext;var t=this.gl_;this.scaleRatio_=e.scaleRatio||1,this.renderTargetTexture_=t.createTexture(),this.renderTargetTextureSize_=null,this.frameBuffer_=t.createFramebuffer();var n=t.createShader(t.VERTEX_SHADER);t.shaderSource(n,e.vertexShader||a1),t.compileShader(n);var i=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(i,e.fragmentShader||l1),t.compileShader(i),this.renderTargetProgram_=t.createProgram(),t.attachShader(this.renderTargetProgram_,n),t.attachShader(this.renderTargetProgram_,i),t.linkProgram(this.renderTargetProgram_),this.renderTargetVerticesBuffer_=t.createBuffer();var a=[-1,-1,1,-1,-1,1,1,-1,1,1,-1,1];t.bindBuffer(t.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),t.bufferData(t.ARRAY_BUFFER,new Float32Array(a),t.STATIC_DRAW),this.renderTargetAttribLocation_=t.getAttribLocation(this.renderTargetProgram_,"a_position"),this.renderTargetUniformLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_screenSize"),this.renderTargetOpacityLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_opacity"),this.renderTargetTextureLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_image"),this.uniforms_=[],e.uniforms&&Object.keys(e.uniforms).forEach(function(u){this.uniforms_.push({value:e.uniforms[u],location:t.getUniformLocation(this.renderTargetProgram_,u)})}.bind(this))}return r.prototype.getGL=function(){return this.gl_},r.prototype.init=function(e){var t=this.getGL(),n=[t.drawingBufferWidth*this.scaleRatio_,t.drawingBufferHeight*this.scaleRatio_];if(t.bindFramebuffer(t.FRAMEBUFFER,this.getFrameBuffer()),t.viewport(0,0,n[0],n[1]),!this.renderTargetTextureSize_||this.renderTargetTextureSize_[0]!==n[0]||this.renderTargetTextureSize_[1]!==n[1]){this.renderTargetTextureSize_=n;var i=0,a=t.RGBA,u=0,p=t.RGBA,g=t.UNSIGNED_BYTE,v=null;t.bindTexture(t.TEXTURE_2D,this.renderTargetTexture_),t.texImage2D(t.TEXTURE_2D,i,a,n[0],n[1],u,p,g,v),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.renderTargetTexture_,0)}},r.prototype.apply=function(e,t,n,i){var a=this.getGL(),u=e.size;if(a.bindFramebuffer(a.FRAMEBUFFER,t?t.getFrameBuffer():null),a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,this.renderTargetTexture_),!t){var p=Xt(a.canvas);if(!e.renderTargets[p]){var g=a.getContextAttributes();g&&g.preserveDrawingBuffer&&(a.clearColor(0,0,0,0),a.clear(a.COLOR_BUFFER_BIT)),e.renderTargets[p]=!0}}a.enable(a.BLEND),a.blendFunc(a.ONE,a.ONE_MINUS_SRC_ALPHA),a.viewport(0,0,a.drawingBufferWidth,a.drawingBufferHeight),a.bindBuffer(a.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),a.useProgram(this.renderTargetProgram_),a.enableVertexAttribArray(this.renderTargetAttribLocation_),a.vertexAttribPointer(this.renderTargetAttribLocation_,2,a.FLOAT,!1,0,0),a.uniform2f(this.renderTargetUniformLocation_,u[0],u[1]),a.uniform1i(this.renderTargetTextureLocation_,0);var v=e.layerStatesArray[e.layerIndex].opacity;a.uniform1f(this.renderTargetOpacityLocation_,v),this.applyUniforms(e),n&&n(a,e),a.drawArrays(a.TRIANGLES,0,6),i&&i(a,e)},r.prototype.getFrameBuffer=function(){return this.frameBuffer_},r.prototype.applyUniforms=function(e){var t=this.getGL(),n,i=1;this.uniforms_.forEach(function(a){if(n=typeof a.value=="function"?a.value(e):a.value,n instanceof HTMLCanvasElement||n instanceof ImageData)a.texture||(a.texture=t.createTexture()),t.activeTexture(t["TEXTURE".concat(i)]),t.bindTexture(t.TEXTURE_2D,a.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),n instanceof ImageData?t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,n.width,n.height,0,t.UNSIGNED_BYTE,new Uint8Array(n.data)):t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n),t.uniform1i(a.location,i++);else if(Array.isArray(n))switch(n.length){case 2:t.uniform2f(a.location,n[0],n[1]);return;case 3:t.uniform3f(a.location,n[0],n[1],n[2]);return;case 4:t.uniform4f(a.location,n[0],n[1],n[2],n[3]);return;default:return}else typeof n=="number"&&t.uniform1f(a.location,n)})},r}(),od=h1;function Ap(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function js(r,e){return r[0]=e[0],r[1]=e[1],r[4]=e[2],r[5]=e[3],r[12]=e[4],r[13]=e[5],r}var c1=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),vo={PROJECTION_MATRIX:"u_projectionMatrix",OFFSET_SCALE_MATRIX:"u_offsetScaleMatrix",OFFSET_ROTATION_MATRIX:"u_offsetRotateMatrix",TIME:"u_time",ZOOM:"u_zoom",RESOLUTION:"u_resolution"},Eo={UNSIGNED_BYTE:n1,UNSIGNED_SHORT:i1,UNSIGNED_INT:r1,FLOAT:Cp},ua={};function sd(r){return"shared/"+r}var ad=0;function u1(){var r="unique/"+ad;return ad+=1,r}function f1(r){var e=ua[r];if(!e){var t=document.createElement("canvas");t.style.position="absolute",t.style.left="0",e={users:0,canvas:t},ua[r]=e}return e.users+=1,e.canvas}function d1(r){var e=ua[r];if(!!e&&(e.users-=1,!(e.users>0))){var t=e.canvas,n=Op(t),i=n.getExtension("WEBGL_lose_context");i&&i.loseContext(),delete ua[r]}}var p1=function(r){c1(e,r);function e(t){var n=r.call(this)||this,i=t||{};n.boundHandleWebGLContextLost_=n.handleWebGLContextLost.bind(n),n.boundHandleWebGLContextRestored_=n.handleWebGLContextRestored.bind(n),n.canvasCacheKey_=i.canvasCacheKey?sd(i.canvasCacheKey):u1(),n.canvas_=f1(n.canvasCacheKey_),n.gl_=Op(n.canvas_),n.bufferCache_={},n.extensionCache_={},n.currentProgram_=null,n.canvas_.addEventListener(Ms.LOST,n.boundHandleWebGLContextLost_),n.canvas_.addEventListener(Ms.RESTORED,n.boundHandleWebGLContextRestored_),n.offsetRotateMatrix_=ze(),n.offsetScaleMatrix_=ze(),n.tmpMat4_=Ap(),n.uniformLocations_={},n.attribLocations_={},n.uniforms_=[],i.uniforms&&n.setUniforms(i.uniforms);var a=n.getGL();return n.postProcessPasses_=i.postProcesses?i.postProcesses.map(function(u){return new od({webGlContext:a,scaleRatio:u.scaleRatio,vertexShader:u.vertexShader,fragmentShader:u.fragmentShader,uniforms:u.uniforms})}):[new od({webGlContext:a})],n.shaderCompileErrors_=null,n.startTime_=Date.now(),n}return e.prototype.setUniforms=function(t){this.uniforms_=[];for(var n in t)this.uniforms_.push({name:n,value:t[n]});this.uniformLocations_={}},e.prototype.canvasCacheKeyMatches=function(t){return this.canvasCacheKey_===sd(t)},e.prototype.getExtension=function(t){if(t in this.extensionCache_)return this.extensionCache_[t];var n=this.gl_.getExtension(t);return this.extensionCache_[t]=n,n},e.prototype.bindBuffer=function(t){var n=this.getGL(),i=Xt(t),a=this.bufferCache_[i];if(!a){var u=n.createBuffer();a={buffer:t,webGlBuffer:u},this.bufferCache_[i]=a}n.bindBuffer(t.getType(),a.webGlBuffer)},e.prototype.flushBufferData=function(t){var n=this.getGL();this.bindBuffer(t),n.bufferData(t.getType(),t.getArray(),t.getUsage())},e.prototype.deleteBuffer=function(t){var n=this.getGL(),i=Xt(t),a=this.bufferCache_[i];a&&!n.isContextLost()&&n.deleteBuffer(a.webGlBuffer),delete this.bufferCache_[i]},e.prototype.disposeInternal=function(){this.canvas_.removeEventListener(Ms.LOST,this.boundHandleWebGLContextLost_),this.canvas_.removeEventListener(Ms.RESTORED,this.boundHandleWebGLContextRestored_),d1(this.canvasCacheKey_),delete this.gl_,delete this.canvas_},e.prototype.prepareDraw=function(t,n){var i=this.getGL(),a=this.getCanvas(),u=t.size,p=t.pixelRatio;a.width=u[0]*p,a.height=u[1]*p,a.style.width=u[0]+"px",a.style.height=u[1]+"px",i.useProgram(this.currentProgram_);for(var g=this.postProcessPasses_.length-1;g>=0;g--)this.postProcessPasses_[g].init(t);i.bindTexture(i.TEXTURE_2D,null),i.clearColor(0,0,0,0),i.clear(i.COLOR_BUFFER_BIT),i.enable(i.BLEND),i.blendFunc(i.ONE,n?i.ZERO:i.ONE_MINUS_SRC_ALPHA),i.useProgram(this.currentProgram_),this.applyFrameState(t),this.applyUniforms(t)},e.prototype.prepareDrawToRenderTarget=function(t,n,i){var a=this.getGL(),u=n.getSize();a.bindFramebuffer(a.FRAMEBUFFER,n.getFramebuffer()),a.viewport(0,0,u[0],u[1]),a.bindTexture(a.TEXTURE_2D,n.getTexture()),a.clearColor(0,0,0,0),a.clear(a.COLOR_BUFFER_BIT),a.enable(a.BLEND),a.blendFunc(a.ONE,i?a.ZERO:a.ONE_MINUS_SRC_ALPHA),a.useProgram(this.currentProgram_),this.applyFrameState(t),this.applyUniforms(t)},e.prototype.drawElements=function(t,n){var i=this.getGL();this.getExtension("OES_element_index_uint");var a=i.UNSIGNED_INT,u=4,p=n-t,g=t*u;i.drawElements(i.TRIANGLES,p,a,g)},e.prototype.finalizeDraw=function(t,n,i){for(var a=0,u=this.postProcessPasses_.length;a<u;a++)a===u-1?this.postProcessPasses_[a].apply(t,null,n,i):this.postProcessPasses_[a].apply(t,this.postProcessPasses_[a+1])},e.prototype.getCanvas=function(){return this.canvas_},e.prototype.getGL=function(){return this.gl_},e.prototype.applyFrameState=function(t){var n=t.size,i=t.viewState.rotation,a=Ml(this.offsetScaleMatrix_);Lm(a,2/n[0],2/n[1]);var u=Ml(this.offsetRotateMatrix_);i!==0&&Mm(u,-i),this.setUniformMatrixValue(vo.OFFSET_SCALE_MATRIX,js(this.tmpMat4_,a)),this.setUniformMatrixValue(vo.OFFSET_ROTATION_MATRIX,js(this.tmpMat4_,u)),this.setUniformFloatValue(vo.TIME,(Date.now()-this.startTime_)*.001),this.setUniformFloatValue(vo.ZOOM,t.viewState.zoom),this.setUniformFloatValue(vo.RESOLUTION,t.viewState.resolution)},e.prototype.applyUniforms=function(t){var n=this.getGL(),i,a=0;this.uniforms_.forEach(function(u){if(i=typeof u.value=="function"?u.value(t):u.value,i instanceof HTMLCanvasElement||i instanceof HTMLImageElement||i instanceof ImageData){u.texture||(u.prevValue=void 0,u.texture=n.createTexture()),n.activeTexture(n["TEXTURE".concat(a)]),n.bindTexture(n.TEXTURE_2D,u.texture),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE);var p=!(i instanceof HTMLImageElement)||i.complete;p&&u.prevValue!==i&&(u.prevValue=i,n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,i)),n.uniform1i(this.getUniformLocation(u.name),a++)}else if(Array.isArray(i)&&i.length===6)this.setUniformMatrixValue(u.name,js(this.tmpMat4_,i));else if(Array.isArray(i)&&i.length<=4)switch(i.length){case 2:n.uniform2f(this.getUniformLocation(u.name),i[0],i[1]);return;case 3:n.uniform3f(this.getUniformLocation(u.name),i[0],i[1],i[2]);return;case 4:n.uniform4f(this.getUniformLocation(u.name),i[0],i[1],i[2],i[3]);return;default:return}else typeof i=="number"&&n.uniform1f(this.getUniformLocation(u.name),i)}.bind(this))},e.prototype.useProgram=function(t){if(t==this.currentProgram_)return!1;var n=this.getGL();return n.useProgram(t),this.currentProgram_=t,this.uniformLocations_={},this.attribLocations_={},!0},e.prototype.compileShader=function(t,n){var i=this.getGL(),a=i.createShader(n);return i.shaderSource(a,t),i.compileShader(a),a},e.prototype.getProgram=function(t,n){var i=this.getGL(),a=this.compileShader(t,i.FRAGMENT_SHADER),u=this.compileShader(n,i.VERTEX_SHADER),p=i.createProgram();if(i.attachShader(p,a),i.attachShader(p,u),i.linkProgram(p),!i.getShaderParameter(a,i.COMPILE_STATUS)){var g="Fragment shader compliation failed: ".concat(i.getShaderInfoLog(a));throw new Error(g)}if(i.deleteShader(a),!i.getShaderParameter(u,i.COMPILE_STATUS)){var g="Vertex shader compilation failed: ".concat(i.getShaderInfoLog(u));throw new Error(g)}if(i.deleteShader(u),!i.getProgramParameter(p,i.LINK_STATUS)){var g="GL program linking failed: ".concat(i.getShaderInfoLog(u));throw new Error(g)}return p},e.prototype.getUniformLocation=function(t){return this.uniformLocations_[t]===void 0&&(this.uniformLocations_[t]=this.getGL().getUniformLocation(this.currentProgram_,t)),this.uniformLocations_[t]},e.prototype.getAttributeLocation=function(t){return this.attribLocations_[t]===void 0&&(this.attribLocations_[t]=this.getGL().getAttribLocation(this.currentProgram_,t)),this.attribLocations_[t]},e.prototype.makeProjectionTransform=function(t,n){var i=t.size,a=t.viewState.rotation,u=t.viewState.resolution,p=t.viewState.center;return Ml(n),mn(n,0,0,2/(u*i[0]),2/(u*i[1]),-a,-p[0],-p[1]),n},e.prototype.setUniformFloatValue=function(t,n){this.getGL().uniform1f(this.getUniformLocation(t),n)},e.prototype.setUniformFloatVec4=function(t,n){this.getGL().uniform4fv(this.getUniformLocation(t),n)},e.prototype.setUniformMatrixValue=function(t,n){this.getGL().uniformMatrix4fv(this.getUniformLocation(t),!1,n)},e.prototype.enableAttributeArray_=function(t,n,i,a,u){var p=this.getAttributeLocation(t);p<0||(this.getGL().enableVertexAttribArray(p),this.getGL().vertexAttribPointer(p,n,i,!1,a,u))},e.prototype.enableAttributes=function(t){for(var n=g1(t),i=0,a=0;a<t.length;a++){var u=t[a];this.enableAttributeArray_(u.name,u.size,u.type||Cp,n,i),i+=u.size*Pp(u.type)}},e.prototype.handleWebGLContextLost=function(){kr(this.bufferCache_),this.currentProgram_=null},e.prototype.handleWebGLContextRestored=function(){},e.prototype.createTexture=function(t,n,i){var a=this.getGL(),u=i||a.createTexture(),p=0,g=a.RGBA,v=0,m=a.RGBA,b=a.UNSIGNED_BYTE;return a.bindTexture(a.TEXTURE_2D,u),n?a.texImage2D(a.TEXTURE_2D,p,g,m,b,n):a.texImage2D(a.TEXTURE_2D,p,g,t[0],t[1],v,m,b,null),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),u},e}(_a);function g1(r){for(var e=0,t=0;t<r.length;t++){var n=r[t];e+=n.size*Pp(n.type)}return e}function Pp(r){switch(r){case Eo.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case Eo.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case Eo.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case Eo.FLOAT:default:return Float32Array.BYTES_PER_ELEMENT}}var _1=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),v1=function(r){_1(e,r);function e(t,n){var i=r.call(this,t)||this,a=n||{};return i.inversePixelTransform_=ze(),i.pixelContext_=null,i.postProcesses_=a.postProcesses,i.uniforms_=a.uniforms,i.helper,t.addChangeListener(Bt.MAP,i.removeHelper.bind(i)),i.dispatchPreComposeEvent=i.dispatchPreComposeEvent.bind(i),i.dispatchPostComposeEvent=i.dispatchPostComposeEvent.bind(i),i}return e.prototype.dispatchPreComposeEvent=function(t,n){var i=this.getLayer();if(i.hasListener(Be.PRECOMPOSE)){var a=new Ro(Be.PRECOMPOSE,void 0,n,t);i.dispatchEvent(a)}},e.prototype.dispatchPostComposeEvent=function(t,n){var i=this.getLayer();if(i.hasListener(Be.POSTCOMPOSE)){var a=new Ro(Be.POSTCOMPOSE,void 0,n,t);i.dispatchEvent(a)}},e.prototype.reset=function(t){this.uniforms_=t.uniforms,this.helper&&this.helper.setUniforms(this.uniforms_)},e.prototype.removeHelper=function(){this.helper&&(this.helper.dispose(),delete this.helper)},e.prototype.prepareFrame=function(t){if(this.getLayer().getRenderSource()){for(var n=!0,i=-1,a=void 0,u=0,p=t.layerStatesArray.length;u<p;u++){var g=t.layerStatesArray[u].layer,v=g.getRenderer();if(!(v instanceof e)){n=!0;continue}var m=g.getClassName();if((n||m!==a)&&(i+=1,n=!1),a=m,v===this)break}var b="map/"+t.mapId+"/group/"+i;(!this.helper||!this.helper.canvasCacheKeyMatches(b))&&(this.removeHelper(),this.helper=new p1({postProcesses:this.postProcesses_,uniforms:this.uniforms_,canvasCacheKey:b}),a&&(this.helper.getCanvas().className=a),this.afterHelperCreated())}return this.prepareFrameInternal(t)},e.prototype.afterHelperCreated=function(){},e.prototype.prepareFrameInternal=function(t){return!0},e.prototype.disposeInternal=function(){this.removeHelper(),r.prototype.disposeInternal.call(this)},e.prototype.dispatchRenderEvent_=function(t,n,i){var a=this.getLayer();if(a.hasListener(t)){mn(this.inversePixelTransform_,0,0,i.pixelRatio,-i.pixelRatio,0,0,-i.size[1]);var u=new Ro(t,this.inversePixelTransform_,i,n);a.dispatchEvent(u)}},e.prototype.preRender=function(t,n){this.dispatchRenderEvent_(Be.PRERENDER,t,n)},e.prototype.postRender=function(t,n){this.dispatchRenderEvent_(Be.POSTRENDER,t,n)},e.prototype.getDataAtPixel=function(t,n,i){var a=ne([n.pixelRatio,0,0,n.pixelRatio,0,0],t.slice()),u=this.helper.getGL();if(!u)return null;var p=this.getLayer(),g=p.getExtent();if(g){var v=ne(n.pixelToCoordinateTransform,t.slice());if(!Yi(g,v))return null}var m=u.getContextAttributes();if(!m||!m.preserveDrawingBuffer)return new Uint8Array;var b=Math.round(a[0]),E=Math.round(a[1]),w=this.pixelContext_;if(!w){var S=document.createElement("canvas");S.width=1,S.height=1,w=S.getContext("2d"),this.pixelContext_=w}w.clearRect(0,0,1,1);var O;try{w.drawImage(u.canvas,b,E,1,1,0,0,1,1),O=w.getImageData(0,0,1,1).data}catch{return O}return O[3]===0?null:O},e}(bp),y1=v1,m1=.5,_h={imageSmoothingEnabled:!1,msImageSmoothingEnabled:!1},x1=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},dt={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function Mp(r){return Math.pow(r,3)}function Nr(r){return 1-Mp(1-r)}function b1(r){return 3*r*r-2*r*r*r}function E1(r){return r}var T1=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),w1=function(r){T1(e,r);function e(t,n,i){var a=r.call(this)||this,u=i||{};return a.tileCoord=t,a.state=n,a.interimTile=null,a.key="",a.transition_=u.transition===void 0?250:u.transition,a.transitionStarts_={},a.interpolate=!!u.interpolate,a}return e.prototype.changed=function(){this.dispatchEvent(pt.CHANGE)},e.prototype.release=function(){},e.prototype.getKey=function(){return this.key+"/"+this.tileCoord},e.prototype.getInterimTile=function(){if(!this.interimTile)return this;var t=this.interimTile;do{if(t.getState()==dt.LOADED)return this.transition_=0,t;t=t.interimTile}while(t);return this},e.prototype.refreshInterimChain=function(){if(!!this.interimTile){var t=this.interimTile,n=this;do{if(t.getState()==dt.LOADED){t.interimTile=null;break}else t.getState()==dt.LOADING?n=t:t.getState()==dt.IDLE?n.interimTile=t.interimTile:n=t;t=n.interimTile}while(t)}},e.prototype.getTileCoord=function(){return this.tileCoord},e.prototype.getState=function(){return this.state},e.prototype.setState=function(t){if(this.state!==dt.ERROR&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()},e.prototype.load=function(){Rt()},e.prototype.getAlpha=function(t,n){if(!this.transition_)return 1;var i=this.transitionStarts_[t];if(!i)i=n,this.transitionStarts_[t]=i;else if(i===-1)return 1;var a=n-i+1e3/60;return a>=this.transition_?1:Mp(a/this.transition_)},e.prototype.inTransition=function(t){return this.transition_?this.transitionStarts_[t]!==-1:!1},e.prototype.endTransition=function(t){this.transition_&&(this.transitionStarts_[t]=-1)},e}(Zi),Gh=w1,S1=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),R1=function(r){S1(e,r);function e(t,n,i,a,u,p){var g=r.call(this,t,n,p)||this;return g.crossOrigin_=a,g.src_=i,g.key=i,g.image_=new Image,a!==null&&(g.image_.crossOrigin=a),g.unlisten_=null,g.tileLoadFunction_=u,g}return e.prototype.getImage=function(){return this.image_},e.prototype.setImage=function(t){this.image_=t,this.state=dt.LOADED,this.unlistenImage_(),this.changed()},e.prototype.handleImageError_=function(){this.state=dt.ERROR,this.unlistenImage_(),this.image_=C1(),this.changed()},e.prototype.handleImageLoad_=function(){var t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=dt.LOADED:this.state=dt.EMPTY,this.unlistenImage_(),this.changed()},e.prototype.load=function(){this.state==dt.ERROR&&(this.state=dt.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==dt.IDLE&&(this.state=dt.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=kh(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))},e.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)},e}(Gh);function C1(){var r=We(1,1);return r.fillStyle="rgba(0,0,0,0)",r.fillRect(0,0,1,1),r.canvas}var ld=R1,O1=10,hd=.25,I1=function(){function r(e,t,n,i,a,u){this.sourceProj_=e,this.targetProj_=t;var p={},g=na(this.targetProj_,this.sourceProj_);this.transformInv_=function(k){var L=k[0]+"/"+k[1];return p[L]||(p[L]=g(k)),p[L]},this.maxSourceExtent_=i,this.errorThresholdSquared_=a*a,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!i&&!!this.sourceProj_.getExtent()&&Qt(i)==Qt(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?Qt(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?Qt(this.targetProj_.getExtent()):null;var v=Fr(n),m=wa(n),b=Ta(n),E=Ea(n),w=this.transformInv_(v),S=this.transformInv_(m),O=this.transformInv_(b),I=this.transformInv_(E),M=O1+(u?Math.max(0,Math.ceil(Xd(lh(n)/(u*u*256*256)))):0);if(this.addQuad_(v,m,b,E,w,S,O,I,M),this.wrapsXInSource_){var A=1/0;this.triangles_.forEach(function(k,L,B){A=Math.min(A,k.source[0][0],k.source[1][0],k.source[2][0])}),this.triangles_.forEach(function(k){if(Math.max(k.source[0][0],k.source[1][0],k.source[2][0])-A>this.sourceWorldWidth_/2){var L=[[k.source[0][0],k.source[0][1]],[k.source[1][0],k.source[1][1]],[k.source[2][0],k.source[2][1]]];L[0][0]-A>this.sourceWorldWidth_/2&&(L[0][0]-=this.sourceWorldWidth_),L[1][0]-A>this.sourceWorldWidth_/2&&(L[1][0]-=this.sourceWorldWidth_),L[2][0]-A>this.sourceWorldWidth_/2&&(L[2][0]-=this.sourceWorldWidth_);var B=Math.min(L[0][0],L[1][0],L[2][0]),G=Math.max(L[0][0],L[1][0],L[2][0]);G-B<this.sourceWorldWidth_/2&&(k.source=L)}}.bind(this))}p={}}return r.prototype.addTriangle_=function(e,t,n,i,a,u){this.triangles_.push({source:[i,a,u],target:[e,t,n]})},r.prototype.addQuad_=function(e,t,n,i,a,u,p,g,v){var m=xf([a,u,p,g]),b=this.sourceWorldWidth_?Qt(m)/this.sourceWorldWidth_:null,E=this.sourceWorldWidth_,w=this.sourceProj_.canWrapX()&&b>.5&&b<1,S=!1;if(v>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){var O=xf([e,t,n,i]),I=Qt(O)/this.targetWorldWidth_;S=I>hd||S}!w&&this.sourceProj_.isGlobal()&&b&&(S=b>hd||S)}if(!(!S&&this.maxSourceExtent_&&isFinite(m[0])&&isFinite(m[1])&&isFinite(m[2])&&isFinite(m[3])&&!Fe(m,this.maxSourceExtent_))){var M=0;if(!S&&(!isFinite(a[0])||!isFinite(a[1])||!isFinite(u[0])||!isFinite(u[1])||!isFinite(p[0])||!isFinite(p[1])||!isFinite(g[0])||!isFinite(g[1]))){if(v>0)S=!0;else if(M=(!isFinite(a[0])||!isFinite(a[1])?8:0)+(!isFinite(u[0])||!isFinite(u[1])?4:0)+(!isFinite(p[0])||!isFinite(p[1])?2:0)+(!isFinite(g[0])||!isFinite(g[1])?1:0),M!=1&&M!=2&&M!=4&&M!=8)return}if(v>0){if(!S){var A=[(e[0]+n[0])/2,(e[1]+n[1])/2],k=this.transformInv_(A),L=void 0;if(w){var B=(So(a[0],E)+So(p[0],E))/2;L=B-So(k[0],E)}else L=(a[0]+p[0])/2-k[0];var G=(a[1]+p[1])/2-k[1],V=L*L+G*G;S=V>this.errorThresholdSquared_}if(S){if(Math.abs(e[0]-n[0])<=Math.abs(e[1]-n[1])){var U=[(t[0]+n[0])/2,(t[1]+n[1])/2],K=this.transformInv_(U),H=[(i[0]+e[0])/2,(i[1]+e[1])/2],et=this.transformInv_(H);this.addQuad_(e,t,U,H,a,u,K,et,v-1),this.addQuad_(H,U,n,i,et,K,p,g,v-1)}else{var X=[(e[0]+t[0])/2,(e[1]+t[1])/2],j=this.transformInv_(X),J=[(n[0]+i[0])/2,(n[1]+i[1])/2],Q=this.transformInv_(J);this.addQuad_(e,X,J,i,a,j,Q,g,v-1),this.addQuad_(X,t,n,J,j,u,p,Q,v-1)}return}}if(w){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}(M&11)==0&&this.addTriangle_(e,n,i,a,p,g),(M&14)==0&&this.addTriangle_(e,n,t,a,p,u),M&&((M&13)==0&&this.addTriangle_(t,i,e,u,g,a),(M&7)==0&&this.addTriangle_(t,i,n,u,g,p))}},r.prototype.calculateSourceExtent=function(){var e=xn();return this.triangles_.forEach(function(t,n,i){var a=t.source;wo(e,a[0]),wo(e,a[1]),wo(e,a[2])}),e},r.prototype.getTriangles=function(){return this.triangles_},r}(),A1=I1,Ul;function cd(r,e,t,n,i){r.beginPath(),r.moveTo(0,0),r.lineTo(e,t),r.lineTo(n,i),r.closePath(),r.save(),r.clip(),r.fillRect(0,0,Math.max(e,n)+1,Math.max(t,i)),r.restore()}function Vl(r,e){return Math.abs(r[e*4]-210)>2||Math.abs(r[e*4+3]-.75*255)>2}function P1(){if(Ul===void 0){var r=document.createElement("canvas").getContext("2d");r.globalCompositeOperation="lighter",r.fillStyle="rgba(210, 0, 0, 0.75)",cd(r,4,5,4,0),cd(r,4,5,0,5);var e=r.getImageData(0,0,3,3).data;Ul=Vl(e,0)||Vl(e,4)||Vl(e,8)}return Ul}function ud(r,e,t,n){var i=g0(t,e,r),a=Sf(e,n,t),u=e.getMetersPerUnit();u!==void 0&&(a*=u);var p=r.getMetersPerUnit();p!==void 0&&(a/=p);var g=r.getExtent();if(!g||Yi(g,i)){var v=Sf(r,a,i)/a;isFinite(v)&&v>0&&(a/=v)}return a}function M1(r,e,t,n){var i=$i(t),a=ud(r,e,i,n);return(!isFinite(a)||a<=0)&&Ch(t,function(u){return a=ud(r,e,u,n),isFinite(a)&&a>0}),a}function L1(r,e,t,n,i,a,u,p,g,v,m,b){var E=We(Math.round(t*r),Math.round(t*e));if(b||oe(E,_h),g.length===0)return E.canvas;E.scale(t,t);function w(L){return Math.round(L*t)/t}E.globalCompositeOperation="lighter";var S=xn();g.forEach(function(L,B,G){Gm(S,L.extent)});var O=Qt(S),I=sn(S),M=We(Math.round(t*O/n),Math.round(t*I/n));b||oe(M,_h);var A=t/n;g.forEach(function(L,B,G){var V=L.extent[0]-S[0],U=-(L.extent[3]-S[3]),K=Qt(L.extent),H=sn(L.extent);L.image.width>0&&L.image.height>0&&M.drawImage(L.image,v,v,L.image.width-2*v,L.image.height-2*v,V*A,U*A,K*A,H*A)});var k=Fr(u);return p.getTriangles().forEach(function(L,B,G){var V=L.source,U=L.target,K=V[0][0],H=V[0][1],et=V[1][0],X=V[1][1],j=V[2][0],J=V[2][1],Q=w((U[0][0]-k[0])/a),tt=w(-(U[0][1]-k[1])/a),rt=w((U[1][0]-k[0])/a),at=w(-(U[1][1]-k[1])/a),ht=w((U[2][0]-k[0])/a),ut=w(-(U[2][1]-k[1])/a),wt=K,Y=H;K=0,H=0,et-=wt,X-=Y,j-=wt,J-=Y;var Yt=[[et,X,0,0,rt-Q],[j,J,0,0,ht-Q],[0,0,et,X,at-tt],[0,0,j,J,ut-tt]],zt=$m(Yt);if(!!zt){if(E.save(),E.beginPath(),P1()||!b){E.moveTo(rt,at);for(var Zt=4,te=Q-rt,Ue=tt-at,ee=0;ee<Zt;ee++)E.lineTo(rt+w((ee+1)*te/Zt),at+w(ee*Ue/(Zt-1))),ee!=Zt-1&&E.lineTo(rt+w((ee+1)*te/Zt),at+w((ee+1)*Ue/(Zt-1)));E.lineTo(ht,ut)}else E.moveTo(rt,at),E.lineTo(Q,tt),E.lineTo(ht,ut);E.clip(),E.transform(zt[0],zt[2],zt[1],zt[3],Q,tt),E.translate(S[0]-wt,S[3]-Y),E.scale(n/t,-n/t),E.drawImage(M.canvas,0,0),E.restore()}}),m&&(E.save(),E.globalCompositeOperation="source-over",E.strokeStyle="black",E.lineWidth=1,p.getTriangles().forEach(function(L,B,G){var V=L.target,U=(V[0][0]-k[0])/a,K=-(V[0][1]-k[1])/a,H=(V[1][0]-k[0])/a,et=-(V[1][1]-k[1])/a,X=(V[2][0]-k[0])/a,j=-(V[2][1]-k[1])/a;E.beginPath(),E.moveTo(H,et),E.lineTo(U,K),E.lineTo(X,j),E.closePath(),E.stroke()}),E.restore()),E.canvas}var D1=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),k1=function(r){D1(e,r);function e(t,n,i,a,u,p,g,v,m,b,E,w){var S=r.call(this,u,dt.IDLE,{interpolate:!!w})||this;S.renderEdges_=E!==void 0?E:!1,S.pixelRatio_=g,S.gutter_=v,S.canvas_=null,S.sourceTileGrid_=n,S.targetTileGrid_=a,S.wrappedTileCoord_=p||u,S.sourceTiles_=[],S.sourcesListenerKeys_=null,S.sourceZ_=0;var O=a.getTileCoordExtent(S.wrappedTileCoord_),I=S.targetTileGrid_.getExtent(),M=S.sourceTileGrid_.getExtent(),A=I?ji(O,I):O;if(lh(A)===0)return S.state=dt.EMPTY,S;var k=t.getExtent();k&&(M?M=ji(M,k):M=k);var L=a.getResolution(S.wrappedTileCoord_[0]),B=M1(t,i,A,L);if(!isFinite(B)||B<=0)return S.state=dt.EMPTY,S;var G=b!==void 0?b:m1;if(S.triangulation_=new A1(t,i,A,M,B*G,L),S.triangulation_.getTriangles().length===0)return S.state=dt.EMPTY,S;S.sourceZ_=n.getZForResolution(B);var V=S.triangulation_.calculateSourceExtent();if(M&&(t.canWrapX()?(V[1]=se(V[1],M[1],M[3]),V[3]=se(V[3],M[1],M[3])):V=ji(V,M)),!lh(V))S.state=dt.EMPTY;else{for(var U=n.getTileRangeForExtentAndZ(V,S.sourceZ_),K=U.minX;K<=U.maxX;K++)for(var H=U.minY;H<=U.maxY;H++){var et=m(S.sourceZ_,K,H,g);et&&S.sourceTiles_.push(et)}S.sourceTiles_.length===0&&(S.state=dt.EMPTY)}return S}return e.prototype.getImage=function(){return this.canvas_},e.prototype.reproject_=function(){var t=[];if(this.sourceTiles_.forEach(function(m,b,E){m&&m.getState()==dt.LOADED&&t.push({extent:this.sourceTileGrid_.getTileCoordExtent(m.tileCoord),image:m.getImage()})}.bind(this)),this.sourceTiles_.length=0,t.length===0)this.state=dt.ERROR;else{var n=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(n),a=typeof i=="number"?i:i[0],u=typeof i=="number"?i:i[1],p=this.targetTileGrid_.getResolution(n),g=this.sourceTileGrid_.getResolution(this.sourceZ_),v=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=L1(a,u,this.pixelRatio_,g,this.sourceTileGrid_.getExtent(),p,v,this.triangulation_,t,this.gutter_,this.renderEdges_,this.interpolate),this.state=dt.LOADED}this.changed()},e.prototype.load=function(){if(this.state==dt.IDLE){this.state=dt.LOADING,this.changed();var t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(function(n,i,a){var u=n.getState();if(u==dt.IDLE||u==dt.LOADING){t++;var p=Lt(n,pt.CHANGE,function(g){var v=n.getState();(v==dt.LOADED||v==dt.ERROR||v==dt.EMPTY)&&(Kt(p),t--,t===0&&(this.unlistenSources_(),this.reproject_()))},this);this.sourcesListenerKeys_.push(p)}}.bind(this)),t===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function(n,i,a){var u=n.getState();u==dt.IDLE&&n.load()})}},e.prototype.unlistenSources_=function(){this.sourcesListenerKeys_.forEach(Kt),this.sourcesListenerKeys_=null},e}(Gh),F1=k1,Lp=function(){function r(e,t,n,i){this.minX=e,this.maxX=t,this.minY=n,this.maxY=i}return r.prototype.contains=function(e){return this.containsXY(e[1],e[2])},r.prototype.containsTileRange=function(e){return this.minX<=e.minX&&e.maxX<=this.maxX&&this.minY<=e.minY&&e.maxY<=this.maxY},r.prototype.containsXY=function(e,t){return this.minX<=e&&e<=this.maxX&&this.minY<=t&&t<=this.maxY},r.prototype.equals=function(e){return this.minX==e.minX&&this.minY==e.minY&&this.maxX==e.maxX&&this.maxY==e.maxY},r.prototype.extend=function(e){e.minX<this.minX&&(this.minX=e.minX),e.maxX>this.maxX&&(this.maxX=e.maxX),e.minY<this.minY&&(this.minY=e.minY),e.maxY>this.maxY&&(this.maxY=e.maxY)},r.prototype.getHeight=function(){return this.maxY-this.minY+1},r.prototype.getSize=function(){return[this.getWidth(),this.getHeight()]},r.prototype.getWidth=function(){return this.maxX-this.minX+1},r.prototype.intersects=function(e){return this.minX<=e.maxX&&this.maxX>=e.minX&&this.minY<=e.maxY&&this.maxY>=e.minY},r}();function gr(r,e,t,n,i){return i!==void 0?(i.minX=r,i.maxX=e,i.minY=t,i.maxY=n,i):new Lp(r,e,t,n)}var Dp=Lp,Ls={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"},N1=function(){function r(e){this.highWaterMark=e!==void 0?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}return r.prototype.canExpireCache=function(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark},r.prototype.expireCache=function(e){for(;this.canExpireCache();)this.pop()},r.prototype.clear=function(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null},r.prototype.containsKey=function(e){return this.entries_.hasOwnProperty(e)},r.prototype.forEach=function(e){for(var t=this.oldest_;t;)e(t.value_,t.key_,this),t=t.newer},r.prototype.get=function(e,t){var n=this.entries_[e];return Ct(n!==void 0,15),n===this.newest_||(n===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(n.newer.older=n.older,n.older.newer=n.newer),n.newer=null,n.older=this.newest_,this.newest_.newer=n,this.newest_=n),n.value_},r.prototype.remove=function(e){var t=this.entries_[e];return Ct(t!==void 0,15),t===this.newest_?(this.newest_=t.older,this.newest_&&(this.newest_.newer=null)):t===this.oldest_?(this.oldest_=t.newer,this.oldest_&&(this.oldest_.older=null)):(t.newer.older=t.older,t.older.newer=t.newer),delete this.entries_[e],--this.count_,t.value_},r.prototype.getCount=function(){return this.count_},r.prototype.getKeys=function(){var e=new Array(this.count_),t=0,n;for(n=this.newest_;n;n=n.older)e[t++]=n.key_;return e},r.prototype.getValues=function(){var e=new Array(this.count_),t=0,n;for(n=this.newest_;n;n=n.older)e[t++]=n.value_;return e},r.prototype.peekLast=function(){return this.oldest_.value_},r.prototype.peekLastKey=function(){return this.oldest_.key_},r.prototype.peekFirstKey=function(){return this.newest_.key_},r.prototype.pop=function(){var e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_},r.prototype.replace=function(e,t){this.get(e),this.entries_[e].value_=t},r.prototype.set=function(e,t){Ct(!(e in this.entries_),16);var n={key_:e,newer:null,older:this.newest_,value_:t};this.newest_?this.newest_.newer=n:this.oldest_=n,this.newest_=n,this.entries_[e]=n,++this.count_},r.prototype.setSize=function(e){this.highWaterMark=e},r}(),kp=N1;function fa(r,e,t,n){return n!==void 0?(n[0]=r,n[1]=e,n[2]=t,n):[r,e,t]}function zh(r,e,t){return r+"/"+e+"/"+t}function da(r){return zh(r[0],r[1],r[2])}function B1(r){return r.split("/").map(Number)}function G1(r,e){var t=r[0],n=r[1],i=r[2];if(e.getMinZoom()>t||t>e.getMaxZoom())return!1;var a=e.getFullTileRange(t);return a?a.containsXY(n,i):!0}var z1=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),U1=function(r){z1(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.expireCache=function(t){for(;this.canExpireCache();){var n=this.peekLast();if(n.getKey()in t)break;this.pop().release()}},e.prototype.pruneExceptNewestZ=function(){if(this.getCount()!==0){var t=this.peekFirstKey(),n=B1(t),i=n[0];this.forEach(function(a){a.tileCoord[0]!==i&&(this.remove(da(a.tileCoord)),a.release())}.bind(this))}},e}(kp),V1=U1,Xl={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"},X1=42,Uh=256,j1=[0,0,0],ti=5,W1=function(){function r(e){this.minZoom=e.minZoom!==void 0?e.minZoom:0,this.resolutions_=e.resolutions,Ct(hm(this.resolutions_,function(u,p){return p-u},!0),17);var t;if(!e.origins){for(var n=0,i=this.resolutions_.length-1;n<i;++n)if(!t)t=this.resolutions_[n]/this.resolutions_[n+1];else if(this.resolutions_[n]/this.resolutions_[n+1]!==t){t=void 0;break}}this.zoomFactor_=t,this.maxZoom=this.resolutions_.length-1,this.origin_=e.origin!==void 0?e.origin:null,this.origins_=null,e.origins!==void 0&&(this.origins_=e.origins,Ct(this.origins_.length==this.resolutions_.length,20));var a=e.extent;a!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=Fr(a)),Ct(!this.origin_&&this.origins_||this.origin_&&!this.origins_,18),this.tileSizes_=null,e.tileSizes!==void 0&&(this.tileSizes_=e.tileSizes,Ct(this.tileSizes_.length==this.resolutions_.length,19)),this.tileSize_=e.tileSize!==void 0?e.tileSize:this.tileSizes_?null:Uh,Ct(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,22),this.extent_=a!==void 0?a:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],e.sizes!==void 0?this.fullTileRanges_=e.sizes.map(function(u,p){var g=new Dp(Math.min(0,u[0]),Math.max(u[0]-1,-1),Math.min(0,u[1]),Math.max(u[1]-1,-1));if(a){var v=this.getTileRangeForExtentAndZ(a,p);g.minX=Math.max(v.minX,g.minX),g.maxX=Math.min(v.maxX,g.maxX),g.minY=Math.max(v.minY,g.minY),g.maxY=Math.min(v.maxY,g.maxY)}return g},this):a&&this.calculateTileRanges_(a)}return r.prototype.forEachTileCoord=function(e,t,n){for(var i=this.getTileRangeForExtentAndZ(e,t),a=i.minX,u=i.maxX;a<=u;++a)for(var p=i.minY,g=i.maxY;p<=g;++p)n([t,a,p])},r.prototype.forEachTileCoordParentTileRange=function(e,t,n,i){var a,u,p,g=null,v=e[0]-1;for(this.zoomFactor_===2?(u=e[1],p=e[2]):g=this.getTileCoordExtent(e,i);v>=this.minZoom;){if(this.zoomFactor_===2?(u=Math.floor(u/2),p=Math.floor(p/2),a=gr(u,u,p,p,n)):a=this.getTileRangeForExtentAndZ(g,v,n),t(v,a))return!0;--v}return!1},r.prototype.getExtent=function(){return this.extent_},r.prototype.getMaxZoom=function(){return this.maxZoom},r.prototype.getMinZoom=function(){return this.minZoom},r.prototype.getOrigin=function(e){return this.origin_?this.origin_:this.origins_[e]},r.prototype.getResolution=function(e){return this.resolutions_[e]},r.prototype.getResolutions=function(){return this.resolutions_},r.prototype.getTileCoordChildTileRange=function(e,t,n){if(e[0]<this.maxZoom){if(this.zoomFactor_===2){var i=e[1]*2,a=e[2]*2;return gr(i,i+1,a,a+1,t)}var u=this.getTileCoordExtent(e,n||this.tmpExtent_);return this.getTileRangeForExtentAndZ(u,e[0]+1,t)}return null},r.prototype.getTileRangeForTileCoordAndZ=function(e,t,n){if(t>this.maxZoom||t<this.minZoom)return null;var i=e[0],a=e[1],u=e[2];if(t===i)return gr(a,u,a,u,n);if(this.zoomFactor_){var p=Math.pow(this.zoomFactor_,t-i),g=Math.floor(a*p),v=Math.floor(u*p);if(t<i)return gr(g,g,v,v,n);var m=Math.floor(p*(a+1))-1,b=Math.floor(p*(u+1))-1;return gr(g,m,v,b,n)}var E=this.getTileCoordExtent(e,this.tmpExtent_);return this.getTileRangeForExtentAndZ(E,t,n)},r.prototype.getTileRangeExtent=function(e,t,n){var i=this.getOrigin(e),a=this.getResolution(e),u=Ge(this.getTileSize(e),this.tmpSize_),p=i[0]+t.minX*u[0]*a,g=i[0]+(t.maxX+1)*u[0]*a,v=i[1]+t.minY*u[1]*a,m=i[1]+(t.maxY+1)*u[1]*a;return bn(p,v,g,m,n)},r.prototype.getTileRangeForExtentAndZ=function(e,t,n){var i=j1;this.getTileCoordForXYAndZ_(e[0],e[3],t,!1,i);var a=i[1],u=i[2];return this.getTileCoordForXYAndZ_(e[2],e[1],t,!0,i),gr(a,i[1],u,i[2],n)},r.prototype.getTileCoordCenter=function(e){var t=this.getOrigin(e[0]),n=this.getResolution(e[0]),i=Ge(this.getTileSize(e[0]),this.tmpSize_);return[t[0]+(e[1]+.5)*i[0]*n,t[1]-(e[2]+.5)*i[1]*n]},r.prototype.getTileCoordExtent=function(e,t){var n=this.getOrigin(e[0]),i=this.getResolution(e[0]),a=Ge(this.getTileSize(e[0]),this.tmpSize_),u=n[0]+e[1]*a[0]*i,p=n[1]-(e[2]+1)*a[1]*i,g=u+a[0]*i,v=p+a[1]*i;return bn(u,p,g,v,t)},r.prototype.getTileCoordForCoordAndResolution=function(e,t,n){return this.getTileCoordForXYAndResolution_(e[0],e[1],t,!1,n)},r.prototype.getTileCoordForXYAndResolution_=function(e,t,n,i,a){var u=this.getZForResolution(n),p=n/this.getResolution(u),g=this.getOrigin(u),v=Ge(this.getTileSize(u),this.tmpSize_),m=p*(e-g[0])/n/v[0],b=p*(g[1]-t)/n/v[1];return i?(m=Ss(m,ti)-1,b=Ss(b,ti)-1):(m=ws(m,ti),b=ws(b,ti)),fa(u,m,b,a)},r.prototype.getTileCoordForXYAndZ_=function(e,t,n,i,a){var u=this.getOrigin(n),p=this.getResolution(n),g=Ge(this.getTileSize(n),this.tmpSize_),v=(e-u[0])/p/g[0],m=(u[1]-t)/p/g[1];return i?(v=Ss(v,ti)-1,m=Ss(m,ti)-1):(v=ws(v,ti),m=ws(m,ti)),fa(n,v,m,a)},r.prototype.getTileCoordForCoordAndZ=function(e,t,n){return this.getTileCoordForXYAndZ_(e[0],e[1],t,!1,n)},r.prototype.getTileCoordResolution=function(e){return this.resolutions_[e[0]]},r.prototype.getTileSize=function(e){return this.tileSize_?this.tileSize_:this.tileSizes_[e]},r.prototype.getFullTileRange=function(e){return this.fullTileRanges_?this.fullTileRanges_[e]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,e):null},r.prototype.getZForResolution=function(e,t){var n=Sh(this.resolutions_,e,t||0);return se(n,this.minZoom,this.maxZoom)},r.prototype.calculateTileRanges_=function(e){for(var t=this.resolutions_.length,n=new Array(t),i=this.minZoom;i<t;++i)n[i]=this.getTileRangeForExtentAndZ(e,i);this.fullTileRanges_=n},r}(),Vh=W1;function H1(r){var e=r.getDefaultTileGrid();return e||(e=Z1(r),r.setDefaultTileGrid(e)),e}function Y1(r,e,t){var n=e[0],i=r.getTileCoordCenter(e),a=Xh(t);if(Yi(a,i))return e;var u=Qt(a),p=Math.ceil((a[0]-i[0])/u);return i[0]+=u*p,r.getTileCoordForCoordAndZ(i,n)}function $1(r,e,t,n){var i=n!==void 0?n:yo.TOP_LEFT,a=Fp(r,e,t);return new Vh({extent:r,origin:Um(r,i),resolutions:a,tileSize:t})}function K1(r){var e=r||{},t=e.extent||Je("EPSG:3857").getExtent(),n={extent:t,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:Fp(t,e.maxZoom,e.tileSize,e.maxResolution)};return new Vh(n)}function Fp(r,e,t,n){for(var i=e!==void 0?e:X1,a=sn(r),u=Qt(r),p=Ge(t!==void 0?t:Uh),g=n>0?n:Math.max(u/p[0],a/p[1]),v=i+1,m=new Array(v),b=0;b<v;++b)m[b]=g/Math.pow(2,b);return m}function Z1(r,e,t,n){var i=Xh(r);return $1(i,e,t,n)}function Xh(r){r=Je(r);var e=r.getExtent();if(!e){var t=180*yn[ge.DEGREES]/r.getMetersPerUnit();e=bn(-t,-t,t,t)}return e}var Np=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),q1=function(r){Np(e,r);function e(t){var n=r.call(this,{attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,projection:t.projection,state:t.state,wrapX:t.wrapX,interpolate:t.interpolate})||this;n.on,n.once,n.un,n.opaque_=t.opaque!==void 0?t.opaque:!1,n.tilePixelRatio_=t.tilePixelRatio!==void 0?t.tilePixelRatio:1,n.tileGrid=t.tileGrid!==void 0?t.tileGrid:null;var i=[256,256];return n.tileGrid&&Ge(n.tileGrid.getTileSize(n.tileGrid.getMinZoom()),i),n.tileCache=new V1(t.cacheSize||0),n.tmpSize=[0,0],n.key_=t.key||"",n.tileOptions={transition:t.transition,interpolate:t.interpolate},n.zDirection=t.zDirection?t.zDirection:0,n}return e.prototype.canExpireCache=function(){return this.tileCache.canExpireCache()},e.prototype.expireCache=function(t,n){var i=this.getTileCacheForProjection(t);i&&i.expireCache(n)},e.prototype.forEachLoadedTile=function(t,n,i,a){var u=this.getTileCacheForProjection(t);if(!u)return!1;for(var p=!0,g,v,m,b=i.minX;b<=i.maxX;++b)for(var E=i.minY;E<=i.maxY;++E)v=zh(n,b,E),m=!1,u.containsKey(v)&&(g=u.get(v),m=g.getState()===dt.LOADED,m&&(m=a(g)!==!1)),m||(p=!1);return p},e.prototype.getGutterForProjection=function(t){return 0},e.prototype.getKey=function(){return this.key_},e.prototype.setKey=function(t){this.key_!==t&&(this.key_=t,this.changed())},e.prototype.getOpaque=function(t){return this.opaque_},e.prototype.getResolutions=function(){return this.tileGrid?this.tileGrid.getResolutions():null},e.prototype.getTile=function(t,n,i,a,u){return Rt()},e.prototype.getTileGrid=function(){return this.tileGrid},e.prototype.getTileGridForProjection=function(t){return this.tileGrid?this.tileGrid:H1(t)},e.prototype.getTileCacheForProjection=function(t){return Ct(p0(this.getProjection(),t),68),this.tileCache},e.prototype.getTilePixelRatio=function(t){return this.tilePixelRatio_},e.prototype.getTilePixelSize=function(t,n,i){var a=this.getTileGridForProjection(i),u=this.getTilePixelRatio(n),p=Ge(a.getTileSize(t),this.tmpSize);return u==1?p:J0(p,u,this.tmpSize)},e.prototype.getTileCoordForTileUrlFunction=function(t,n){var i=n!==void 0?n:this.getProjection(),a=this.getTileGridForProjection(i);return this.getWrapX()&&i.isGlobal()&&(t=Y1(a,t,i)),G1(t,a)?t:null},e.prototype.clear=function(){this.tileCache.clear()},e.prototype.refresh=function(){this.clear(),r.prototype.refresh.call(this)},e.prototype.updateCacheSize=function(t,n){var i=this.getTileCacheForProjection(n);t>i.highWaterMark&&(i.highWaterMark=t)},e.prototype.useTile=function(t,n,i,a){},e}(wp),J1=function(r){Np(e,r);function e(t,n){var i=r.call(this,t)||this;return i.tile=n,i}return e}(Nn),Q1=q1,tE=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),eE=function(r){tE(e,r);function e(t){var n=r.call(this)||this;return n.map_=t,n}return e.prototype.dispatchRenderEvent=function(t,n){Rt()},e.prototype.calculateMatrices2D=function(t){var n=t.viewState,i=t.coordinateToPixelTransform,a=t.pixelToCoordinateTransform;mn(i,t.size[0]/2,t.size[1]/2,1/n.resolution,-1/n.resolution,-n.rotation,-n.center[0],-n.center[1]),Bd(a,i)},e.prototype.forEachFeatureAtCoordinate=function(t,n,i,a,u,p,g,v){var m,b=n.viewState;function E(Q,tt,rt,at){return u.call(p,tt,Q?rt:null,at)}var w=b.projection,S=Wd(t.slice(),w),O=[[0,0]];if(w.canWrapX()&&a){var I=w.getExtent(),M=Qt(I);O.push([-M,0],[M,0])}for(var A=n.layerStatesArray,k=A.length,L=[],B=[],G=0;G<O.length;G++)for(var V=k-1;V>=0;--V){var U=A[V],K=U.layer;if(K.hasRenderer()&&la(U,b)&&g.call(v,K)){var H=K.getRenderer(),et=K.getSource();if(H&&et){var X=et.getWrapX()?S:t,j=E.bind(null,U.managed);B[0]=X[0]+O[G][0],B[1]=X[1]+O[G][1],m=H.forEachFeatureAtCoordinate(B,n,i,j,L)}if(m)return m}}if(L.length!==0){var J=1/L.length;return L.forEach(function(Q,tt){return Q.distanceSq+=tt*J}),L.sort(function(Q,tt){return Q.distanceSq-tt.distanceSq}),L.some(function(Q){return m=Q.callback(Q.feature,Q.layer,Q.geometry)}),m}},e.prototype.forEachLayerAtPixel=function(t,n,i,a,u){return Rt()},e.prototype.hasFeatureAtCoordinate=function(t,n,i,a,u,p){var g=this.forEachFeatureAtCoordinate(t,n,i,a,wr,this,u,p);return g!==void 0},e.prototype.getMap=function(){return this.map_},e.prototype.renderFrame=function(t){Rt()},e.prototype.scheduleExpireIconCache=function(t){ca.canExpireCache()&&t.postRenderFunctions.push(nE)},e}(_a);function nE(r,e){ca.expire()}var iE=eE,rE=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),oE=function(r){rE(e,r);function e(t){var n=r.call(this,t)||this;n.fontChangeListenerKey_=Lt(Mn,Or.PROPERTYCHANGE,t.redrawText.bind(t)),n.element_=document.createElement("div");var i=n.element_.style;i.position="absolute",i.width="100%",i.height="100%",i.zIndex="0",n.element_.className=Ca+" ol-layers";var a=t.getViewport();return a.insertBefore(n.element_,a.firstChild||null),n.children_=[],n.renderedVisible_=!0,n}return e.prototype.dispatchRenderEvent=function(t,n){var i=this.getMap();if(i.hasListener(t)){var a=new Ro(t,void 0,n);i.dispatchEvent(a)}},e.prototype.disposeInternal=function(){Kt(this.fontChangeListenerKey_),this.element_.parentNode.removeChild(this.element_),r.prototype.disposeInternal.call(this)},e.prototype.renderFrame=function(t){if(!t){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(t),this.dispatchRenderEvent(Be.PRECOMPOSE,t);var n=t.layerStatesArray.sort(function(w,S){return w.zIndex-S.zIndex}),i=t.viewState;this.children_.length=0;for(var a=[],u=null,p=0,g=n.length;p<g;++p){var v=n[p];t.layerIndex=p;var m=v.layer,b=m.getSourceState();if(!la(v,i)||b!=Oe.READY&&b!=Oe.UNDEFINED){m.unrender();continue}var E=m.render(t,u);!E||(E!==u&&(this.children_.push(E),u=E),"getDeclutter"in m&&a.push(m))}for(var p=a.length-1;p>=0;--p)a[p].renderDeclutter(t);ix(this.element_,this.children_),this.dispatchRenderEvent(Be.POSTCOMPOSE,t),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(t)},e.prototype.forEachLayerAtPixel=function(t,n,i,a,u){for(var p=n.viewState,g=n.layerStatesArray,v=g.length,m=v-1;m>=0;--m){var b=g[m],E=b.layer;if(E.hasRenderer()&&la(b,p)&&u(E)){var w=E.getRenderer(),S=w.getDataAtPixel(t,n,i);if(S){var O=a(E,S);if(O)return O}}}},e}(iE),sE=oE,aE=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),lE=function(r){aE(e,r);function e(t,n,i){var a=r.call(this,t)||this;return a.map=n,a.frameState=i!==void 0?i:null,a}return e}(Nn),mr=lE,hE=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),cE=function(r){hE(e,r);function e(t,n,i,a,u){var p=r.call(this,t,n,u)||this;return p.originalEvent=i,p.pixel_=null,p.coordinate_=null,p.dragging=a!==void 0?a:!1,p}return Object.defineProperty(e.prototype,"pixel",{get:function(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_},set:function(t){this.pixel_=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"coordinate",{get:function(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_},set:function(t){this.coordinate_=t},enumerable:!1,configurable:!0}),e.prototype.preventDefault=function(){r.prototype.preventDefault.call(this),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()},e.prototype.stopPropagation=function(){r.prototype.stopPropagation.call(this),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()},e}(mr),ei=cE,$t={SINGLECLICK:"singleclick",CLICK:pt.CLICK,DBLCLICK:pt.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},vh={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},uE=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),fE=function(r){uE(e,r);function e(t,n){var i=r.call(this,t)||this;i.map_=t,i.clickTimeoutId_,i.emulateClicks_=!1,i.dragging_=!1,i.dragListenerKeys_=[],i.moveTolerance_=n===void 0?1:n,i.down_=null;var a=i.map_.getViewport();return i.activePointers_=0,i.trackedTouches_={},i.element_=a,i.pointerdownListenerKey_=Lt(a,vh.POINTERDOWN,i.handlePointerDown_,i),i.originalPointerMoveEvent_,i.relayedListenerKey_=Lt(a,vh.POINTERMOVE,i.relayEvent_,i),i.boundHandleTouchMove_=i.handleTouchMove_.bind(i),i.element_.addEventListener(pt.TOUCHMOVE,i.boundHandleTouchMove_,kd?{passive:!1}:!1),i}return e.prototype.emulateClick_=function(t){var n=new ei($t.CLICK,this.map_,t);this.dispatchEvent(n),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,n=new ei($t.DBLCLICK,this.map_,t),this.dispatchEvent(n)):this.clickTimeoutId_=setTimeout(function(){this.clickTimeoutId_=void 0;var i=new ei($t.SINGLECLICK,this.map_,t);this.dispatchEvent(i)}.bind(this),250)},e.prototype.updateActivePointers_=function(t){var n=t;n.type==$t.POINTERUP||n.type==$t.POINTERCANCEL?delete this.trackedTouches_[n.pointerId]:n.type==$t.POINTERDOWN&&(this.trackedTouches_[n.pointerId]=!0),this.activePointers_=Object.keys(this.trackedTouches_).length},e.prototype.handlePointerUp_=function(t){this.updateActivePointers_(t);var n=new ei($t.POINTERUP,this.map_,t);this.dispatchEvent(n),this.emulateClicks_&&!n.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(t)&&this.emulateClick_(this.down_),this.activePointers_===0&&(this.dragListenerKeys_.forEach(Kt),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)},e.prototype.isMouseActionButton_=function(t){return t.button===0},e.prototype.handlePointerDown_=function(t){this.emulateClicks_=this.activePointers_===0,this.updateActivePointers_(t);var n=new ei($t.POINTERDOWN,this.map_,t);this.dispatchEvent(n),this.down_={};for(var i in t){var a=t[i];this.down_[i]=typeof a=="function"?Hi:a}if(this.dragListenerKeys_.length===0){var u=this.map_.getOwnerDocument();this.dragListenerKeys_.push(Lt(u,$t.POINTERMOVE,this.handlePointerMove_,this),Lt(u,$t.POINTERUP,this.handlePointerUp_,this),Lt(this.element_,$t.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==u&&this.dragListenerKeys_.push(Lt(this.element_.getRootNode(),$t.POINTERUP,this.handlePointerUp_,this))}},e.prototype.handlePointerMove_=function(t){if(this.isMoving_(t)){this.dragging_=!0;var n=new ei($t.POINTERDRAG,this.map_,t,this.dragging_);this.dispatchEvent(n)}},e.prototype.relayEvent_=function(t){this.originalPointerMoveEvent_=t;var n=!!(this.down_&&this.isMoving_(t));this.dispatchEvent(new ei(t.type,this.map_,t,n))},e.prototype.handleTouchMove_=function(t){var n=this.originalPointerMoveEvent_;(!n||n.defaultPrevented)&&(typeof t.cancelable!="boolean"||t.cancelable===!0)&&t.preventDefault()},e.prototype.isMoving_=function(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_},e.prototype.disposeInternal=function(){this.relayedListenerKey_&&(Kt(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(pt.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(Kt(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(Kt),this.dragListenerKeys_.length=0,this.element_=null,r.prototype.disposeInternal.call(this)},e}(Zi),dE=fE,ni={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},be={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"},pa=1/0,pE=function(){function r(e,t){this.priorityFunction_=e,this.keyFunction_=t,this.elements_=[],this.priorities_=[],this.queuedElements_={}}return r.prototype.clear=function(){this.elements_.length=0,this.priorities_.length=0,kr(this.queuedElements_)},r.prototype.dequeue=function(){var e=this.elements_,t=this.priorities_,n=e[0];e.length==1?(e.length=0,t.length=0):(e[0]=e.pop(),t[0]=t.pop(),this.siftUp_(0));var i=this.keyFunction_(n);return delete this.queuedElements_[i],n},r.prototype.enqueue=function(e){Ct(!(this.keyFunction_(e)in this.queuedElements_),31);var t=this.priorityFunction_(e);return t!=pa?(this.elements_.push(e),this.priorities_.push(t),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1},r.prototype.getCount=function(){return this.elements_.length},r.prototype.getLeftChildIndex_=function(e){return e*2+1},r.prototype.getRightChildIndex_=function(e){return e*2+2},r.prototype.getParentIndex_=function(e){return e-1>>1},r.prototype.heapify_=function(){var e;for(e=(this.elements_.length>>1)-1;e>=0;e--)this.siftUp_(e)},r.prototype.isEmpty=function(){return this.elements_.length===0},r.prototype.isKeyQueued=function(e){return e in this.queuedElements_},r.prototype.isQueued=function(e){return this.isKeyQueued(this.keyFunction_(e))},r.prototype.siftUp_=function(e){for(var t=this.elements_,n=this.priorities_,i=t.length,a=t[e],u=n[e],p=e;e<i>>1;){var g=this.getLeftChildIndex_(e),v=this.getRightChildIndex_(e),m=v<i&&n[v]<n[g]?v:g;t[e]=t[m],n[e]=n[m],e=m}t[e]=a,n[e]=u,this.siftDown_(p,e)},r.prototype.siftDown_=function(e,t){for(var n=this.elements_,i=this.priorities_,a=n[t],u=i[t];t>e;){var p=this.getParentIndex_(t);if(i[p]>u)n[t]=n[p],i[t]=i[p],t=p;else break}n[t]=a,i[t]=u},r.prototype.reprioritize=function(){var e=this.priorityFunction_,t=this.elements_,n=this.priorities_,i=0,a=t.length,u,p,g;for(p=0;p<a;++p)u=t[p],g=e(u),g==pa?delete this.queuedElements_[this.keyFunction_(u)]:(n[i]=g,t[i++]=u);t.length=i,n.length=i,this.heapify_()},r}(),gE=pE,_E=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),vE=function(r){_E(e,r);function e(t,n){var i=r.call(this,function(a){return t.apply(null,a)},function(a){return a[0].getKey()})||this;return i.boundHandleTileChange_=i.handleTileChange.bind(i),i.tileChangeCallback_=n,i.tilesLoading_=0,i.tilesLoadingKeys_={},i}return e.prototype.enqueue=function(t){var n=r.prototype.enqueue.call(this,t);if(n){var i=t[0];i.addEventListener(pt.CHANGE,this.boundHandleTileChange_)}return n},e.prototype.getTilesLoading=function(){return this.tilesLoading_},e.prototype.handleTileChange=function(t){var n=t.target,i=n.getState();if(i===dt.LOADED||i===dt.ERROR||i===dt.EMPTY){n.removeEventListener(pt.CHANGE,this.boundHandleTileChange_);var a=n.getKey();a in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[a],--this.tilesLoading_),this.tileChangeCallback_()}},e.prototype.loadMoreTiles=function(t,n){for(var i=0,a,u,p;this.tilesLoading_<t&&i<n&&this.getCount()>0;)u=this.dequeue()[0],p=u.getKey(),a=u.getState(),a===dt.IDLE&&!(p in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[p]=!0,++this.tilesLoading_,++i,u.load())},e}(gE),yE=vE;function mE(r,e,t,n,i){if(!r||!(t in r.wantedTiles)||!r.wantedTiles[t][e.getKey()])return pa;var a=r.viewState.center,u=n[0]-a[0],p=n[1]-a[1];return 65536*Math.log(i)+Math.sqrt(u*u+p*p)/i}var on={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function fd(r,e,t){return function(n,i,a,u,p){if(!!n){if(!i&&!e)return n;var g=e?0:a[0]*i,v=e?0:a[1]*i,m=p?p[0]:0,b=p?p[1]:0,E=r[0]+g/2+m,w=r[2]-g/2+m,S=r[1]+v/2+b,O=r[3]-v/2+b;E>w&&(E=(w+E)/2,w=E),S>O&&(S=(O+S)/2,O=S);var I=se(n[0],E,w),M=se(n[1],S,O);if(u&&t&&i){var A=30*i;I+=-A*Math.log(1+Math.max(0,E-n[0])/A)+A*Math.log(1+Math.max(0,n[0]-w)/A),M+=-A*Math.log(1+Math.max(0,S-n[1])/A)+A*Math.log(1+Math.max(0,n[1]-O)/A)}return[I,M]}}}function xE(r){return r}function jh(r,e,t,n){var i=Qt(e)/t[0],a=sn(e)/t[1];return n?Math.min(r,Math.max(i,a)):Math.min(r,Math.min(i,a))}function Wh(r,e,t){var n=Math.min(r,e),i=50;return n*=Math.log(1+i*Math.max(0,r/e-1))/i+1,t&&(n=Math.max(n,t),n/=Math.log(1+i*Math.max(0,t/r-1))/i+1),se(n,t/2,e*2)}function bE(r,e,t,n){return function(i,a,u,p){if(i!==void 0){var g=r[0],v=r[r.length-1],m=t?jh(g,t,u,n):g;if(p){var b=e!==void 0?e:!0;return b?Wh(i,m,v):se(i,v,m)}var E=Math.min(m,i),w=Math.floor(Sh(r,E,a));return r[w]>m&&w<r.length-1?r[w+1]:r[w]}else return}}function EE(r,e,t,n,i,a){return function(u,p,g,v){if(u!==void 0){var m=i?jh(e,i,g,a):e,b=t!==void 0?t:0;if(v){var E=n!==void 0?n:!0;return E?Wh(u,m,b):se(u,b,m)}var w=1e-9,S=Math.ceil(Math.log(e/m)/Math.log(r)-w),O=-p*(.5-w)+.5,I=Math.min(m,u),M=Math.floor(Math.log(e/I)/Math.log(r)+O),A=Math.max(S,M),k=e/Math.pow(r,A);return se(k,b,m)}else return}}function dd(r,e,t,n,i){return function(a,u,p,g){if(a!==void 0){var v=n?jh(r,n,p,i):r,m=t!==void 0?t:!0;return!m||!g?se(a,e,v):Wh(a,v,e)}else return}}function Hh(r){if(r!==void 0)return 0}function pd(r){if(r!==void 0)return r}function TE(r){var e=2*Math.PI/r;return function(t,n){if(n)return t;if(t!==void 0)return t=Math.floor(t/e+.5)*e,t}}function wE(r){var e=r||Vs(5);return function(t,n){if(n)return t;if(t!==void 0)return Math.abs(t)<=e?0:t}}var SE=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),jl=0,RE=function(r){SE(e,r);function e(t){var n=r.call(this)||this;n.on,n.once,n.un;var i=oe({},t);return n.hints_=[0,0],n.animations_=[],n.updateAnimationKey_,n.projection_=Ah(i.projection,"EPSG:3857"),n.viewportSize_=[100,100],n.targetCenter_=null,n.targetResolution_,n.targetRotation_,n.nextCenter_=null,n.nextResolution_,n.nextRotation_,n.cancelAnchor_=void 0,i.projection&&c0(),i.center&&(i.center=Pn(i.center,n.projection_)),i.extent&&(i.extent=Gi(i.extent,n.projection_)),n.applyOptions_(i),n}return e.prototype.applyOptions_=function(t){var n=oe({},t);for(var i in on)delete n[i];this.setProperties(n,!0);var a=OE(t);this.maxResolution_=a.maxResolution,this.minResolution_=a.minResolution,this.zoomFactor_=a.zoomFactor,this.resolutions_=t.resolutions,this.padding_=t.padding,this.minZoom_=a.minZoom;var u=CE(t),p=a.constraint,g=IE(t);this.constraints_={center:u,resolution:p,rotation:g},this.setRotation(t.rotation!==void 0?t.rotation:0),this.setCenterInternal(t.center!==void 0?t.center:null),t.resolution!==void 0?this.setResolution(t.resolution):t.zoom!==void 0&&this.setZoom(t.zoom)},Object.defineProperty(e.prototype,"padding",{get:function(){return this.padding_},set:function(t){var n=this.padding_;this.padding_=t;var i=this.getCenter();if(i){var a=t||[0,0,0,0];n=n||[0,0,0,0];var u=this.getResolution(),p=u/2*(a[3]-n[3]+n[1]-a[1]),g=u/2*(a[0]-n[0]+n[2]-a[2]);this.setCenterInternal([i[0]+p,i[1]-g])}},enumerable:!1,configurable:!0}),e.prototype.getUpdatedOptions_=function(t){var n=this.getProperties();return n.resolution!==void 0?n.resolution=this.getResolution():n.zoom=this.getZoom(),n.center=this.getCenterInternal(),n.rotation=this.getRotation(),oe({},n,t)},e.prototype.animate=function(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);for(var n=new Array(arguments.length),i=0;i<n.length;++i){var a=arguments[i];a.center&&(a=oe({},a),a.center=Pn(a.center,this.getProjection())),a.anchor&&(a=oe({},a),a.anchor=Pn(a.anchor,this.getProjection())),n[i]=a}this.animateInternal.apply(this,n)},e.prototype.animateInternal=function(t){var n=arguments.length,i;n>1&&typeof arguments[n-1]=="function"&&(i=arguments[n-1],--n);for(var a=0;a<n&&!this.isDef();++a){var u=arguments[a];u.center&&this.setCenterInternal(u.center),u.zoom!==void 0?this.setZoom(u.zoom):u.resolution&&this.setResolution(u.resolution),u.rotation!==void 0&&this.setRotation(u.rotation)}if(a===n){i&&Ds(i,!0);return}for(var p=Date.now(),g=this.targetCenter_.slice(),v=this.targetResolution_,m=this.targetRotation_,b=[];a<n;++a){var E=arguments[a],w={start:p,complete:!1,anchor:E.anchor,duration:E.duration!==void 0?E.duration:1e3,easing:E.easing||b1,callback:i};if(E.center&&(w.sourceCenter=g,w.targetCenter=E.center.slice(),g=w.targetCenter),E.zoom!==void 0?(w.sourceResolution=v,w.targetResolution=this.getResolutionForZoom(E.zoom),v=w.targetResolution):E.resolution&&(w.sourceResolution=v,w.targetResolution=E.resolution,v=w.targetResolution),E.rotation!==void 0){w.sourceRotation=m;var S=So(E.rotation-m+Math.PI,2*Math.PI)-Math.PI;w.targetRotation=m+S,m=w.targetRotation}AE(w)?w.complete=!0:p+=w.duration,b.push(w)}this.animations_.push(b),this.setHint(Ee.ANIMATING,1),this.updateAnimations_()},e.prototype.getAnimating=function(){return this.hints_[Ee.ANIMATING]>0},e.prototype.getInteracting=function(){return this.hints_[Ee.INTERACTING]>0},e.prototype.cancelAnimations=function(){this.setHint(Ee.ANIMATING,-this.hints_[Ee.ANIMATING]);for(var t,n=0,i=this.animations_.length;n<i;++n){var a=this.animations_[n];if(a[0].callback&&Ds(a[0].callback,!1),!t)for(var u=0,p=a.length;u<p;++u){var g=a[u];if(!g.complete){t=g.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN},e.prototype.updateAnimations_=function(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!!this.getAnimating()){for(var t=Date.now(),n=!1,i=this.animations_.length-1;i>=0;--i){for(var a=this.animations_[i],u=!0,p=0,g=a.length;p<g;++p){var v=a[p];if(!v.complete){var m=t-v.start,b=v.duration>0?m/v.duration:1;b>=1?(v.complete=!0,b=1):u=!1;var E=v.easing(b);if(v.sourceCenter){var w=v.sourceCenter[0],S=v.sourceCenter[1],O=v.targetCenter[0],I=v.targetCenter[1];this.nextCenter_=v.targetCenter;var M=w+E*(O-w),A=S+E*(I-S);this.targetCenter_=[M,A]}if(v.sourceResolution&&v.targetResolution){var k=E===1?v.targetResolution:v.sourceResolution+E*(v.targetResolution-v.sourceResolution);if(v.anchor){var L=this.getViewportSize_(this.getRotation()),B=this.constraints_.resolution(k,0,L,!0);this.targetCenter_=this.calculateCenterZoom(B,v.anchor)}this.nextResolution_=v.targetResolution,this.targetResolution_=k,this.applyTargetState_(!0)}if(v.sourceRotation!==void 0&&v.targetRotation!==void 0){var G=E===1?So(v.targetRotation+Math.PI,2*Math.PI)-Math.PI:v.sourceRotation+E*(v.targetRotation-v.sourceRotation);if(v.anchor){var V=this.constraints_.rotation(G,!0);this.targetCenter_=this.calculateCenterRotate(V,v.anchor)}this.nextRotation_=v.targetRotation,this.targetRotation_=G}if(this.applyTargetState_(!0),n=!0,!v.complete)break}}if(u){this.animations_[i]=null,this.setHint(Ee.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;var U=a[0].callback;U&&Ds(U,!0)}}this.animations_=this.animations_.filter(Boolean),n&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}},e.prototype.calculateCenterRotate=function(t,n){var i,a=this.getCenterInternal();return a!==void 0&&(i=[a[0]-n[0],a[1]-n[1]],Oh(i,t-this.getRotation()),s0(i,n)),i},e.prototype.calculateCenterZoom=function(t,n){var i,a=this.getCenterInternal(),u=this.getResolution();if(a!==void 0&&u!==void 0){var p=n[0]-t*(n[0]-a[0])/u,g=n[1]-t*(n[1]-a[1])/u;i=[p,g]}return i},e.prototype.getViewportSize_=function(t){var n=this.viewportSize_;if(t){var i=n[0],a=n[1];return[Math.abs(i*Math.cos(t))+Math.abs(a*Math.sin(t)),Math.abs(i*Math.sin(t))+Math.abs(a*Math.cos(t))]}else return n},e.prototype.setViewportSize=function(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)},e.prototype.getCenter=function(){var t=this.getCenterInternal();return t&&ia(t,this.getProjection())},e.prototype.getCenterInternal=function(){return this.get(on.CENTER)},e.prototype.getConstraints=function(){return this.constraints_},e.prototype.getConstrainResolution=function(){return this.get("constrainResolution")},e.prototype.getHints=function(t){return t!==void 0?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()},e.prototype.calculateExtent=function(t){var n=this.calculateExtentInternal(t);return Mh(n,this.getProjection())},e.prototype.calculateExtentInternal=function(t){var n=t||this.getViewportSizeMinusPadding_(),i=this.getCenterInternal();Ct(i,1);var a=this.getResolution();Ct(a!==void 0,2);var u=this.getRotation();return Ct(u!==void 0,3),hh(i,a,u,n)},e.prototype.getMaxResolution=function(){return this.maxResolution_},e.prototype.getMinResolution=function(){return this.minResolution_},e.prototype.getMaxZoom=function(){return this.getZoomForResolution(this.minResolution_)},e.prototype.setMaxZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))},e.prototype.getMinZoom=function(){return this.getZoomForResolution(this.maxResolution_)},e.prototype.setMinZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))},e.prototype.setConstrainResolution=function(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))},e.prototype.getProjection=function(){return this.projection_},e.prototype.getResolution=function(){return this.get(on.RESOLUTION)},e.prototype.getResolutions=function(){return this.resolutions_},e.prototype.getResolutionForExtent=function(t,n){return this.getResolutionForExtentInternal(Gi(t,this.getProjection()),n)},e.prototype.getResolutionForExtentInternal=function(t,n){var i=n||this.getViewportSizeMinusPadding_(),a=Qt(t)/i[0],u=sn(t)/i[1];return Math.max(a,u)},e.prototype.getResolutionForValueFunction=function(t){var n=t||2,i=this.getConstrainedResolution(this.maxResolution_),a=this.minResolution_,u=Math.log(i/a)/Math.log(n);return function(p){var g=i/Math.pow(n,p*u);return g}},e.prototype.getRotation=function(){return this.get(on.ROTATION)},e.prototype.getValueForResolutionFunction=function(t){var n=Math.log(t||2),i=this.getConstrainedResolution(this.maxResolution_),a=this.minResolution_,u=Math.log(i/a)/n;return function(p){var g=Math.log(i/p)/n/u;return g}},e.prototype.getViewportSizeMinusPadding_=function(t){var n=this.getViewportSize_(t),i=this.padding_;return i&&(n=[n[0]-i[1]-i[3],n[1]-i[0]-i[2]]),n},e.prototype.getState=function(){var t=this.getProjection(),n=this.getResolution(),i=this.getRotation(),a=this.getCenterInternal(),u=this.padding_;if(u){var p=this.getViewportSizeMinusPadding_();a=Wl(a,this.getViewportSize_(),[p[0]/2+u[3],p[1]/2+u[0]],n,i)}return{center:a.slice(0),projection:t!==void 0?t:null,resolution:n,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:i,zoom:this.getZoom()}},e.prototype.getZoom=function(){var t,n=this.getResolution();return n!==void 0&&(t=this.getZoomForResolution(n)),t},e.prototype.getZoomForResolution=function(t){var n=this.minZoom_||0,i,a;if(this.resolutions_){var u=Sh(this.resolutions_,t,1);n=u,i=this.resolutions_[u],u==this.resolutions_.length-1?a=2:a=i/this.resolutions_[u+1]}else i=this.maxResolution_,a=this.zoomFactor_;return n+Math.log(i/t)/Math.log(a)},e.prototype.getResolutionForZoom=function(t){if(this.resolutions_){if(this.resolutions_.length<=1)return 0;var n=se(Math.floor(t),0,this.resolutions_.length-2),i=this.resolutions_[n]/this.resolutions_[n+1];return this.resolutions_[n]/Math.pow(i,se(t-n,0,1))}else return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)},e.prototype.fit=function(t,n){var i;if(Ct(Array.isArray(t)||typeof t.getSimplifiedGeometry=="function",24),Array.isArray(t)){Ct(!Sa(t),25);var a=Gi(t,this.getProjection());i=Df(a)}else if(t.getType()===mt.CIRCLE){var a=Gi(t.getExtent(),this.getProjection());i=Df(a),i.rotate(this.getRotation(),$i(a))}else{var u=v0();u?i=t.clone().transform(u,this.getProjection()):i=t}this.fitInternal(i,n)},e.prototype.rotatedExtentForGeometry=function(t){for(var n=this.getRotation(),i=Math.cos(n),a=Math.sin(-n),u=t.getFlatCoordinates(),p=t.getStride(),g=1/0,v=1/0,m=-1/0,b=-1/0,E=0,w=u.length;E<w;E+=p){var S=u[E]*i-u[E+1]*a,O=u[E]*a+u[E+1]*i;g=Math.min(g,S),v=Math.min(v,O),m=Math.max(m,S),b=Math.max(b,O)}return[g,v,m,b]},e.prototype.fitInternal=function(t,n){var i=n||{},a=i.size;a||(a=this.getViewportSizeMinusPadding_());var u=i.padding!==void 0?i.padding:[0,0,0,0],p=i.nearest!==void 0?i.nearest:!1,g;i.minResolution!==void 0?g=i.minResolution:i.maxZoom!==void 0?g=this.getResolutionForZoom(i.maxZoom):g=0;var v=this.rotatedExtentForGeometry(t),m=this.getResolutionForExtentInternal(v,[a[0]-u[1]-u[3],a[1]-u[0]-u[2]]);m=isNaN(m)?g:Math.max(m,g),m=this.getConstrainedResolution(m,p?0:1);var b=this.getRotation(),E=Math.sin(b),w=Math.cos(b),S=$i(v);S[0]+=(u[1]-u[3])/2*m,S[1]+=(u[0]-u[2])/2*m;var O=S[0]*w-S[1]*E,I=S[1]*w+S[0]*E,M=this.getConstrainedCenter([O,I],m),A=i.callback?i.callback:Hi;i.duration!==void 0?this.animateInternal({resolution:m,center:M,duration:i.duration,easing:i.easing},A):(this.targetResolution_=m,this.targetCenter_=M,this.applyTargetState_(!1,!0),Ds(A,!0))},e.prototype.centerOn=function(t,n,i){this.centerOnInternal(Pn(t,this.getProjection()),n,i)},e.prototype.centerOnInternal=function(t,n,i){this.setCenterInternal(Wl(t,n,i,this.getResolution(),this.getRotation()))},e.prototype.calculateCenterShift=function(t,n,i,a){var u,p=this.padding_;if(p&&t){var g=this.getViewportSizeMinusPadding_(-i),v=Wl(t,a,[g[0]/2+p[3],g[1]/2+p[0]],n,i);u=[t[0]-v[0],t[1]-v[1]]}return u},e.prototype.isDef=function(){return!!this.getCenterInternal()&&this.getResolution()!==void 0},e.prototype.adjustCenter=function(t){var n=ia(this.targetCenter_,this.getProjection());this.setCenter([n[0]+t[0],n[1]+t[1]])},e.prototype.adjustCenterInternal=function(t){var n=this.targetCenter_;this.setCenterInternal([n[0]+t[0],n[1]+t[1]])},e.prototype.adjustResolution=function(t,n){var i=n&&Pn(n,this.getProjection());this.adjustResolutionInternal(t,i)},e.prototype.adjustResolutionInternal=function(t,n){var i=this.getAnimating()||this.getInteracting(),a=this.getViewportSize_(this.getRotation()),u=this.constraints_.resolution(this.targetResolution_*t,0,a,i);n&&(this.targetCenter_=this.calculateCenterZoom(u,n)),this.targetResolution_*=t,this.applyTargetState_()},e.prototype.adjustZoom=function(t,n){this.adjustResolution(Math.pow(this.zoomFactor_,-t),n)},e.prototype.adjustRotation=function(t,n){n&&(n=Pn(n,this.getProjection())),this.adjustRotationInternal(t,n)},e.prototype.adjustRotationInternal=function(t,n){var i=this.getAnimating()||this.getInteracting(),a=this.constraints_.rotation(this.targetRotation_+t,i);n&&(this.targetCenter_=this.calculateCenterRotate(a,n)),this.targetRotation_+=t,this.applyTargetState_()},e.prototype.setCenter=function(t){this.setCenterInternal(t&&Pn(t,this.getProjection()))},e.prototype.setCenterInternal=function(t){this.targetCenter_=t,this.applyTargetState_()},e.prototype.setHint=function(t,n){return this.hints_[t]+=n,this.changed(),this.hints_[t]},e.prototype.setResolution=function(t){this.targetResolution_=t,this.applyTargetState_()},e.prototype.setRotation=function(t){this.targetRotation_=t,this.applyTargetState_()},e.prototype.setZoom=function(t){this.setResolution(this.getResolutionForZoom(t))},e.prototype.applyTargetState_=function(t,n){var i=this.getAnimating()||this.getInteracting()||n,a=this.constraints_.rotation(this.targetRotation_,i),u=this.getViewportSize_(a),p=this.constraints_.resolution(this.targetResolution_,0,u,i),g=this.constraints_.center(this.targetCenter_,p,u,i,this.calculateCenterShift(this.targetCenter_,p,a,u));this.get(on.ROTATION)!==a&&this.set(on.ROTATION,a),this.get(on.RESOLUTION)!==p&&(this.set(on.RESOLUTION,p),this.set("zoom",this.getZoom(),!0)),(!g||!this.get(on.CENTER)||!ea(this.get(on.CENTER),g))&&this.set(on.CENTER,g),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0},e.prototype.resolveConstraints=function(t,n,i){var a=t!==void 0?t:200,u=n||0,p=this.constraints_.rotation(this.targetRotation_),g=this.getViewportSize_(p),v=this.constraints_.resolution(this.targetResolution_,u,g),m=this.constraints_.center(this.targetCenter_,v,g,!1,this.calculateCenterShift(this.targetCenter_,v,p,g));if(a===0&&!this.cancelAnchor_){this.targetResolution_=v,this.targetRotation_=p,this.targetCenter_=m,this.applyTargetState_();return}var b=i||(a===0?this.cancelAnchor_:void 0);this.cancelAnchor_=void 0,(this.getResolution()!==v||this.getRotation()!==p||!this.getCenterInternal()||!ea(this.getCenterInternal(),m))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:p,center:m,resolution:v,duration:a,easing:Nr,anchor:b}))},e.prototype.beginInteraction=function(){this.resolveConstraints(0),this.setHint(Ee.INTERACTING,1)},e.prototype.endInteraction=function(t,n,i){var a=i&&Pn(i,this.getProjection());this.endInteractionInternal(t,n,a)},e.prototype.endInteractionInternal=function(t,n,i){this.setHint(Ee.INTERACTING,-1),this.resolveConstraints(t,n,i)},e.prototype.getConstrainedCenter=function(t,n){var i=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,n||this.getResolution(),i)},e.prototype.getConstrainedZoom=function(t,n){var i=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(i,n))},e.prototype.getConstrainedResolution=function(t,n){var i=n||0,a=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,i,a)},e}(Tn);function Ds(r,e){setTimeout(function(){r(e)},0)}function CE(r){if(r.extent!==void 0){var e=r.smoothExtentConstraint!==void 0?r.smoothExtentConstraint:!0;return fd(r.extent,r.constrainOnlyCenter,e)}var t=Ah(r.projection,"EPSG:3857");if(r.multiWorld!==!0&&t.isGlobal()){var n=t.getExtent().slice();return n[0]=-1/0,n[2]=1/0,fd(n,!1,!1)}return xE}function OE(r){var e,t,n,i=28,a=2,u=r.minZoom!==void 0?r.minZoom:jl,p=r.maxZoom!==void 0?r.maxZoom:i,g=r.zoomFactor!==void 0?r.zoomFactor:a,v=r.multiWorld!==void 0?r.multiWorld:!1,m=r.smoothResolutionConstraint!==void 0?r.smoothResolutionConstraint:!0,b=r.showFullExtent!==void 0?r.showFullExtent:!1,E=Ah(r.projection,"EPSG:3857"),w=E.getExtent(),S=r.constrainOnlyCenter,O=r.extent;if(!v&&!O&&E.isGlobal()&&(S=!1,O=w),r.resolutions!==void 0){var I=r.resolutions;t=I[u],n=I[p]!==void 0?I[p]:I[I.length-1],r.constrainResolution?e=bE(I,m,!S&&O,b):e=dd(t,n,m,!S&&O,b)}else{var M=w?Math.max(Qt(w),sn(w)):360*yn[ge.DEGREES]/E.getMetersPerUnit(),A=M/Uh/Math.pow(a,jl),k=A/Math.pow(a,i-jl);t=r.maxResolution,t!==void 0?u=0:t=A/Math.pow(g,u),n=r.minResolution,n===void 0&&(r.maxZoom!==void 0?r.maxResolution!==void 0?n=t/Math.pow(g,p):n=A/Math.pow(g,p):n=k),p=u+Math.floor(Math.log(t/n)/Math.log(g)),n=t/Math.pow(g,p-u),r.constrainResolution?e=EE(g,t,n,m,!S&&O,b):e=dd(t,n,m,!S&&O,b)}return{constraint:e,maxResolution:t,minResolution:n,minZoom:u,zoomFactor:g}}function IE(r){var e=r.enableRotation!==void 0?r.enableRotation:!0;if(e){var t=r.constrainRotation;return t===void 0||t===!0?wE():t===!1?pd:typeof t=="number"?TE(t):pd}else return Hh}function AE(r){return!(r.sourceCenter&&r.targetCenter&&!ea(r.sourceCenter,r.targetCenter)||r.sourceResolution!==r.targetResolution||r.sourceRotation!==r.targetRotation)}function Wl(r,e,t,n,i){var a=Math.cos(-i),u=Math.sin(-i),p=r[0]*a-r[1]*u,g=r[1]*a+r[0]*u;p+=(e[0]/2-t[0])*n,g+=(t[1]-e[1]/2)*n,u=-u;var v=p*a-g*u,m=g*a+p*u;return[v,m]}var Fi=RE,PE=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();function Bp(r){if(r instanceof Oa){r.setMapInternal(null);return}r instanceof Ia&&r.getLayers().forEach(Bp)}function Gp(r,e){if(r instanceof Oa){r.setMapInternal(e);return}if(r instanceof Ia)for(var t=r.getLayers().getArray(),n=0,i=t.length;n<i;++n)Gp(t[n],e)}var ME=function(r){PE(e,r);function e(t){var n=r.call(this)||this;n.on,n.once,n.un;var i=LE(t);n.renderComplete_,n.loaded_=!0,n.boundHandleBrowserEvent_=n.handleBrowserEvent.bind(n),n.maxTilesLoading_=t.maxTilesLoading!==void 0?t.maxTilesLoading:16,n.pixelRatio_=t.pixelRatio!==void 0?t.pixelRatio:Dd,n.postRenderTimeoutHandle_,n.animationDelayKey_,n.animationDelay_=function(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}.bind(n),n.coordinateToPixelTransform_=ze(),n.pixelToCoordinateTransform_=ze(),n.frameIndex_=0,n.frameState_=null,n.previousExtent_=null,n.viewPropertyListenerKey_=null,n.viewChangeListenerKey_=null,n.layerGroupPropertyListenerKeys_=null,n.viewport_=document.createElement("div"),n.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),n.viewport_.style.position="relative",n.viewport_.style.overflow="hidden",n.viewport_.style.width="100%",n.viewport_.style.height="100%",n.overlayContainer_=document.createElement("div"),n.overlayContainer_.style.position="absolute",n.overlayContainer_.style.zIndex="0",n.overlayContainer_.style.width="100%",n.overlayContainer_.style.height="100%",n.overlayContainer_.style.pointerEvents="none",n.overlayContainer_.className="ol-overlaycontainer",n.viewport_.appendChild(n.overlayContainer_),n.overlayContainerStopEvent_=document.createElement("div"),n.overlayContainerStopEvent_.style.position="absolute",n.overlayContainerStopEvent_.style.zIndex="0",n.overlayContainerStopEvent_.style.width="100%",n.overlayContainerStopEvent_.style.height="100%",n.overlayContainerStopEvent_.style.pointerEvents="none",n.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",n.viewport_.appendChild(n.overlayContainerStopEvent_),n.mapBrowserEventHandler_=null,n.moveTolerance_=t.moveTolerance,n.keyboardEventTarget_=i.keyboardEventTarget,n.targetChangeHandlerKeys_=null,n.controls=i.controls||new qe,n.interactions=i.interactions||new qe,n.overlays_=i.overlays,n.overlayIdIndex_={},n.renderer_=null,n.postRenderFunctions_=[],n.tileQueue_=new yE(n.getTilePriority.bind(n),n.handleTileChange_.bind(n)),n.addChangeListener(be.LAYERGROUP,n.handleLayerGroupChanged_),n.addChangeListener(be.VIEW,n.handleViewChanged_),n.addChangeListener(be.SIZE,n.handleSizeChanged_),n.addChangeListener(be.TARGET,n.handleTargetChanged_),n.setProperties(i.values);var a=n;return t.view&&!(t.view instanceof Fi)&&t.view.then(function(u){a.setView(new Fi(u))}),n.controls.addEventListener(Ne.ADD,function(u){u.element.setMap(this)}.bind(n)),n.controls.addEventListener(Ne.REMOVE,function(u){u.element.setMap(null)}.bind(n)),n.interactions.addEventListener(Ne.ADD,function(u){u.element.setMap(this)}.bind(n)),n.interactions.addEventListener(Ne.REMOVE,function(u){u.element.setMap(null)}.bind(n)),n.overlays_.addEventListener(Ne.ADD,function(u){this.addOverlayInternal_(u.element)}.bind(n)),n.overlays_.addEventListener(Ne.REMOVE,function(u){var p=u.element,g=p.getId();g!==void 0&&delete this.overlayIdIndex_[g.toString()],u.element.setMap(null)}.bind(n)),n.controls.forEach(function(u){u.setMap(this)}.bind(n)),n.interactions.forEach(function(u){u.setMap(this)}.bind(n)),n.overlays_.forEach(n.addOverlayInternal_.bind(n)),n}return e.prototype.createRenderer=function(){throw new Error("Use a map type that has a createRenderer method")},e.prototype.addControl=function(t){this.getControls().push(t)},e.prototype.addInteraction=function(t){this.getInteractions().push(t)},e.prototype.addLayer=function(t){var n=this.getLayerGroup().getLayers();n.push(t)},e.prototype.handleLayerAdd_=function(t){Gp(t.layer,this)},e.prototype.addOverlay=function(t){this.getOverlays().push(t)},e.prototype.addOverlayInternal_=function(t){var n=t.getId();n!==void 0&&(this.overlayIdIndex_[n.toString()]=t),t.setMap(this)},e.prototype.disposeInternal=function(){this.setTarget(null),r.prototype.disposeInternal.call(this)},e.prototype.forEachFeatureAtPixel=function(t,n,i){if(!(!this.frameState_||!this.renderer_)){var a=this.getCoordinateFromPixelInternal(t);i=i!==void 0?i:{};var u=i.hitTolerance!==void 0?i.hitTolerance:0,p=i.layerFilter!==void 0?i.layerFilter:wr,g=i.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(a,this.frameState_,u,g,n,null,p,null)}},e.prototype.getFeaturesAtPixel=function(t,n){var i=[];return this.forEachFeatureAtPixel(t,function(a){i.push(a)},n),i},e.prototype.getAllLayers=function(){var t=[];function n(i){i.forEach(function(a){a instanceof Ia?n(a.getLayers()):t.push(a)})}return n(this.getLayers()),t},e.prototype.forEachLayerAtPixel=function(t,n,i){if(!(!this.frameState_||!this.renderer_)){var a=i||{},u=a.hitTolerance!==void 0?a.hitTolerance:0,p=a.layerFilter||wr;return this.renderer_.forEachLayerAtPixel(t,this.frameState_,u,n,p)}},e.prototype.hasFeatureAtPixel=function(t,n){if(!this.frameState_||!this.renderer_)return!1;var i=this.getCoordinateFromPixelInternal(t);n=n!==void 0?n:{};var a=n.layerFilter!==void 0?n.layerFilter:wr,u=n.hitTolerance!==void 0?n.hitTolerance:0,p=n.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,u,p,a,null)},e.prototype.getEventCoordinate=function(t){return this.getCoordinateFromPixel(this.getEventPixel(t))},e.prototype.getEventCoordinateInternal=function(t){return this.getCoordinateFromPixelInternal(this.getEventPixel(t))},e.prototype.getEventPixel=function(t){var n=this.viewport_.getBoundingClientRect(),i="changedTouches"in t?t.changedTouches[0]:t;return[i.clientX-n.left,i.clientY-n.top]},e.prototype.getTarget=function(){return this.get(be.TARGET)},e.prototype.getTargetElement=function(){var t=this.getTarget();return t!==void 0?typeof t=="string"?document.getElementById(t):t:null},e.prototype.getCoordinateFromPixel=function(t){return ia(this.getCoordinateFromPixelInternal(t),this.getView().getProjection())},e.prototype.getCoordinateFromPixelInternal=function(t){var n=this.frameState_;return n?ne(n.pixelToCoordinateTransform,t.slice()):null},e.prototype.getControls=function(){return this.controls},e.prototype.getOverlays=function(){return this.overlays_},e.prototype.getOverlayById=function(t){var n=this.overlayIdIndex_[t.toString()];return n!==void 0?n:null},e.prototype.getInteractions=function(){return this.interactions},e.prototype.getLayerGroup=function(){return this.get(be.LAYERGROUP)},e.prototype.setLayers=function(t){var n=this.getLayerGroup();if(t instanceof qe){n.setLayers(t);return}var i=n.getLayers();i.clear(),i.extend(t)},e.prototype.getLayers=function(){var t=this.getLayerGroup().getLayers();return t},e.prototype.getLoadingOrNotReady=function(){for(var t=this.getLayerGroup().getLayerStatesArray(),n=0,i=t.length;n<i;++n){var a=t[n];if(!!a.visible){var u=a.layer.getRenderer();if(u&&!u.ready)return!0;var p=a.layer.getSource();if(p&&p.loading)return!0}}return!1},e.prototype.getPixelFromCoordinate=function(t){var n=Pn(t,this.getView().getProjection());return this.getPixelFromCoordinateInternal(n)},e.prototype.getPixelFromCoordinateInternal=function(t){var n=this.frameState_;return n?ne(n.coordinateToPixelTransform,t.slice(0,2)):null},e.prototype.getRenderer=function(){return this.renderer_},e.prototype.getSize=function(){return this.get(be.SIZE)},e.prototype.getView=function(){return this.get(be.VIEW)},e.prototype.getViewport=function(){return this.viewport_},e.prototype.getOverlayContainer=function(){return this.overlayContainer_},e.prototype.getOverlayContainerStopEvent=function(){return this.overlayContainerStopEvent_},e.prototype.getOwnerDocument=function(){var t=this.getTargetElement();return t?t.ownerDocument:document},e.prototype.getTilePriority=function(t,n,i,a){return mE(this.frameState_,t,n,i,a)},e.prototype.handleBrowserEvent=function(t,n){var i=n||t.type,a=new ei(i,this,t);this.handleMapBrowserEvent(a)},e.prototype.handleMapBrowserEvent=function(t){if(!!this.frameState_){var n=t.originalEvent,i=n.type;if(i===vh.POINTERDOWN||i===pt.WHEEL||i===pt.KEYDOWN){var a=this.getOwnerDocument(),u=this.viewport_.getRootNode?this.viewport_.getRootNode():a,p=n.target;if(this.overlayContainerStopEvent_.contains(p)||!(u===a?a.documentElement:u).contains(p))return}if(t.frameState=this.frameState_,this.dispatchEvent(t)!==!1)for(var g=this.getInteractions().getArray().slice(),v=g.length-1;v>=0;v--){var m=g[v];if(!(m.getMap()!==this||!m.getActive()||!this.getTargetElement())){var b=m.handleEvent(t);if(!b||t.propagationStopped)break}}}},e.prototype.handlePostRender=function(){var t=this.frameState_,n=this.tileQueue_;if(!n.isEmpty()){var i=this.maxTilesLoading_,a=i;if(t){var u=t.viewHints;if(u[Ee.ANIMATING]||u[Ee.INTERACTING]){var p=Date.now()-t.time>8;i=p?0:8,a=p?0:2}}n.getTilesLoading()<i&&(n.reprioritize(),n.loadMoreTiles(i,a))}t&&this.renderer_&&!t.animate&&(this.renderComplete_===!0?(this.hasListener(Be.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(Be.RENDERCOMPLETE,t),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new mr(ni.LOADEND,this,t)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new mr(ni.LOADSTART,this,t))));for(var g=this.postRenderFunctions_,v=0,m=g.length;v<m;++v)g[v](this,t);g.length=0},e.prototype.handleSizeChanged_=function(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()},e.prototype.handleTargetChanged_=function(){if(this.mapBrowserEventHandler_){for(var t=0,n=this.targetChangeHandlerKeys_.length;t<n;++t)Kt(this.targetChangeHandlerKeys_[t]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(pt.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(pt.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,fh(this.viewport_)}var i=this.getTargetElement();if(!i)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{i.appendChild(this.viewport_),this.renderer_||(this.renderer_=this.createRenderer()),this.mapBrowserEventHandler_=new dE(this,this.moveTolerance_);for(var a in $t)this.mapBrowserEventHandler_.addEventListener($t[a],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(pt.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(pt.WHEEL,this.boundHandleBrowserEvent_,kd?{passive:!1}:!1);var u=this.getOwnerDocument().defaultView,p=this.keyboardEventTarget_?this.keyboardEventTarget_:i;this.targetChangeHandlerKeys_=[Lt(p,pt.KEYDOWN,this.handleBrowserEvent,this),Lt(p,pt.KEYPRESS,this.handleBrowserEvent,this),Lt(u,pt.RESIZE,this.updateSize,this)]}this.updateSize()},e.prototype.handleTileChange_=function(){this.render()},e.prototype.handleViewPropertyChanged_=function(){this.render()},e.prototype.handleViewChanged_=function(){this.viewPropertyListenerKey_&&(Kt(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(Kt(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);var t=this.getView();t&&(this.updateViewportSize_(),this.viewPropertyListenerKey_=Lt(t,Or.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=Lt(t,pt.CHANGE,this.handleViewPropertyChanged_,this),t.resolveConstraints(0)),this.render()},e.prototype.handleLayerGroupChanged_=function(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(Kt),this.layerGroupPropertyListenerKeys_=null);var t=this.getLayerGroup();t&&(this.handleLayerAdd_(new ri("addlayer",t)),this.layerGroupPropertyListenerKeys_=[Lt(t,Or.PROPERTYCHANGE,this.render,this),Lt(t,pt.CHANGE,this.render,this),Lt(t,"addlayer",this.handleLayerAdd_,this),Lt(t,"removelayer",this.handleLayerRemove_,this)]),this.render()},e.prototype.isRendered=function(){return!!this.frameState_},e.prototype.renderSync=function(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()},e.prototype.redrawText=function(){for(var t=this.getLayerGroup().getLayerStatesArray(),n=0,i=t.length;n<i;++n){var a=t[n].layer;a.hasRenderer()&&a.getRenderer().handleFontsChanged()}},e.prototype.render=function(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))},e.prototype.removeControl=function(t){return this.getControls().remove(t)},e.prototype.removeInteraction=function(t){return this.getInteractions().remove(t)},e.prototype.removeLayer=function(t){var n=this.getLayerGroup().getLayers();return n.remove(t)},e.prototype.handleLayerRemove_=function(t){Bp(t.layer)},e.prototype.removeOverlay=function(t){return this.getOverlays().remove(t)},e.prototype.renderFrame_=function(t){var n=this,i=this.getSize(),a=this.getView(),u=this.frameState_,p=null;if(i!==void 0&&Ff(i)&&a&&a.isDef()){var g=a.getHints(this.frameState_?this.frameState_.viewHints:void 0),v=a.getState();if(p={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutterTree:null,extent:hh(v.center,v.resolution,v.rotation,i),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:i,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:v,viewHints:g,wantedTiles:{},mapId:Xt(this),renderTargets:{}},v.nextCenter&&v.nextResolution){var m=isNaN(v.nextRotation)?v.rotation:v.nextRotation;p.nextExtent=hh(v.nextCenter,v.nextResolution,m,i)}}if(this.frameState_=p,this.renderer_.renderFrame(p),p){if(p.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,p.postRenderFunctions),u){var b=!this.previousExtent_||!Sa(this.previousExtent_)&&!Js(p.extent,this.previousExtent_);b&&(this.dispatchEvent(new mr(ni.MOVESTART,this,u)),this.previousExtent_=ba(this.previousExtent_))}var E=this.previousExtent_&&!p.viewHints[Ee.ANIMATING]&&!p.viewHints[Ee.INTERACTING]&&!Js(p.extent,this.previousExtent_);E&&(this.dispatchEvent(new mr(ni.MOVEEND,this,p)),Gd(p.extent,this.previousExtent_))}this.dispatchEvent(new mr(ni.POSTRENDER,this,p)),this.renderComplete_=this.hasListener(ni.LOADSTART)||this.hasListener(ni.LOADEND)||this.hasListener(Be.RENDERCOMPLETE)?!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady():void 0,this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(function(){n.postRenderTimeoutHandle_=void 0,n.handlePostRender()},0))},e.prototype.setLayerGroup=function(t){var n=this.getLayerGroup();n&&this.handleLayerRemove_(new ri("removelayer",n)),this.set(be.LAYERGROUP,t)},e.prototype.setSize=function(t){this.set(be.SIZE,t)},e.prototype.setTarget=function(t){this.set(be.TARGET,t)},e.prototype.setView=function(t){if(!t||t instanceof Fi){this.set(be.VIEW,t);return}this.set(be.VIEW,new Fi);var n=this;t.then(function(i){n.setView(new Fi(i))})},e.prototype.updateSize=function(){var t=this.getTargetElement(),n=void 0;if(t){var i=getComputedStyle(t),a=t.offsetWidth-parseFloat(i.borderLeftWidth)-parseFloat(i.paddingLeft)-parseFloat(i.paddingRight)-parseFloat(i.borderRightWidth),u=t.offsetHeight-parseFloat(i.borderTopWidth)-parseFloat(i.paddingTop)-parseFloat(i.paddingBottom)-parseFloat(i.borderBottomWidth);!isNaN(a)&&!isNaN(u)&&(n=[a,u],!Ff(n)&&!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)&&console.warn("No map visible because the map container's width or height are 0."))}this.setSize(n),this.updateViewportSize_()},e.prototype.updateViewportSize_=function(){var t=this.getView();if(t){var n=void 0,i=getComputedStyle(this.viewport_);i.width&&i.height&&(n=[parseInt(i.width,10),parseInt(i.height,10)]),t.setViewportSize(n)}},e}(Tn);function LE(r){var e=null;r.keyboardEventTarget!==void 0&&(e=typeof r.keyboardEventTarget=="string"?document.getElementById(r.keyboardEventTarget):r.keyboardEventTarget);var t={},n=r.layers&&typeof r.layers.getLayers=="function"?r.layers:new Ia({layers:r.layers});t[be.LAYERGROUP]=n,t[be.TARGET]=r.target,t[be.VIEW]=r.view instanceof Fi?r.view:new Fi;var i;r.controls!==void 0&&(Array.isArray(r.controls)?i=new qe(r.controls.slice()):(Ct(typeof r.controls.getArray=="function",47),i=r.controls));var a;r.interactions!==void 0&&(Array.isArray(r.interactions)?a=new qe(r.interactions.slice()):(Ct(typeof r.interactions.getArray=="function",48),a=r.interactions));var u;return r.overlays!==void 0?Array.isArray(r.overlays)?u=new qe(r.overlays.slice()):(Ct(typeof r.overlays.getArray=="function",49),u=r.overlays):u=new qe,{controls:i,interactions:a,keyboardEventTarget:e,overlays:u,values:t}}var DE=ME,kE=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),FE=function(r){kE(e,r);function e(t){var n=r.call(this)||this,i=t.element;return i&&!t.target&&!i.style.pointerEvents&&(i.style.pointerEvents="auto"),n.element=i||null,n.target_=null,n.map_=null,n.listenerKeys=[],t.render&&(n.render=t.render),t.target&&n.setTarget(t.target),n}return e.prototype.disposeInternal=function(){fh(this.element),r.prototype.disposeInternal.call(this)},e.prototype.getMap=function(){return this.map_},e.prototype.setMap=function(t){this.map_&&fh(this.element);for(var n=0,i=this.listenerKeys.length;n<i;++n)Kt(this.listenerKeys[n]);if(this.listenerKeys.length=0,this.map_=t,t){var a=this.target_?this.target_:t.getOverlayContainerStopEvent();a.appendChild(this.element),this.render!==Hi&&this.listenerKeys.push(Lt(t,ni.POSTRENDER,this.render,this)),t.render()}},e.prototype.render=function(t){},e.prototype.setTarget=function(t){this.target_=typeof t=="string"?document.getElementById(t):t},e}(Tn),Yh=FE,NE=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),BE=function(r){NE(e,r);function e(t){var n=this,i=t||{};n=r.call(this,{element:document.createElement("div"),render:i.render,target:i.target})||this,n.ulElement_=document.createElement("ul"),n.collapsed_=i.collapsed!==void 0?i.collapsed:!0,n.userCollapsed_=n.collapsed_,n.overrideCollapsible_=i.collapsible!==void 0,n.collapsible_=i.collapsible!==void 0?i.collapsible:!0,n.collapsible_||(n.collapsed_=!1);var a=i.className!==void 0?i.className:"ol-attribution",u=i.tipLabel!==void 0?i.tipLabel:"Attributions",p=i.expandClassName!==void 0?i.expandClassName:a+"-expand",g=i.collapseLabel!==void 0?i.collapseLabel:"\u203A",v=i.collapseClassName!==void 0?i.collapseClassName:a+"-collapse";typeof g=="string"?(n.collapseLabel_=document.createElement("span"),n.collapseLabel_.textContent=g,n.collapseLabel_.className=v):n.collapseLabel_=g;var m=i.label!==void 0?i.label:"i";typeof m=="string"?(n.label_=document.createElement("span"),n.label_.textContent=m,n.label_.className=p):n.label_=m;var b=n.collapsible_&&!n.collapsed_?n.collapseLabel_:n.label_;n.toggleButton_=document.createElement("button"),n.toggleButton_.setAttribute("type","button"),n.toggleButton_.setAttribute("aria-expanded",String(!n.collapsed_)),n.toggleButton_.title=u,n.toggleButton_.appendChild(b),n.toggleButton_.addEventListener(pt.CLICK,n.handleClick_.bind(n),!1);var E=a+" "+Ca+" "+Dh+(n.collapsed_&&n.collapsible_?" "+Gf:"")+(n.collapsible_?"":" ol-uncollapsible"),w=n.element;return w.className=E,w.appendChild(n.toggleButton_),w.appendChild(n.ulElement_),n.renderedAttributions_=[],n.renderedVisible_=!0,n}return e.prototype.collectSourceAttributions_=function(t){for(var n={},i=[],a=!0,u=t.layerStatesArray,p=0,g=u.length;p<g;++p){var v=u[p];if(!!la(v,t.viewState)){var m=v.layer.getSource();if(!!m){var b=m.getAttributions();if(!!b){var E=b(t);if(!!E)if(a=a&&m.getAttributionsCollapsible()!==!1,Array.isArray(E))for(var w=0,S=E.length;w<S;++w)E[w]in n||(i.push(E[w]),n[E[w]]=!0);else E in n||(i.push(E),n[E]=!0)}}}}return this.overrideCollapsible_||this.setCollapsible(a),i},e.prototype.updateElement_=function(t){if(!t){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}var n=this.collectSourceAttributions_(t),i=n.length>0;if(this.renderedVisible_!=i&&(this.element.style.display=i?"":"none",this.renderedVisible_=i),!Ki(n,this.renderedAttributions_)){nx(this.ulElement_);for(var a=0,u=n.length;a<u;++a){var p=document.createElement("li");p.innerHTML=n[a],this.ulElement_.appendChild(p)}this.renderedAttributions_=n}},e.prototype.handleClick_=function(t){t.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_},e.prototype.handleToggle_=function(){this.element.classList.toggle(Gf),this.collapsed_?Bf(this.collapseLabel_,this.label_):Bf(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))},e.prototype.getCollapsible=function(){return this.collapsible_},e.prototype.setCollapsible=function(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())},e.prototype.setCollapsed=function(t){this.userCollapsed_=t,!(!this.collapsible_||this.collapsed_===t)&&this.handleToggle_()},e.prototype.getCollapsed=function(){return this.collapsed_},e.prototype.render=function(t){this.updateElement_(t.frameState)},e}(Yh),GE=BE,zE=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),UE=function(r){zE(e,r);function e(t){var n=this,i=t||{};n=r.call(this,{element:document.createElement("div"),render:i.render,target:i.target})||this;var a=i.className!==void 0?i.className:"ol-rotate",u=i.label!==void 0?i.label:"\u21E7",p=i.compassClassName!==void 0?i.compassClassName:"ol-compass";n.label_=null,typeof u=="string"?(n.label_=document.createElement("span"),n.label_.className=p,n.label_.textContent=u):(n.label_=u,n.label_.classList.add(p));var g=i.tipLabel?i.tipLabel:"Reset rotation",v=document.createElement("button");v.className=a+"-reset",v.setAttribute("type","button"),v.title=g,v.appendChild(n.label_),v.addEventListener(pt.CLICK,n.handleClick_.bind(n),!1);var m=a+" "+Ca+" "+Dh,b=n.element;return b.className=m,b.appendChild(v),n.callResetNorth_=i.resetNorth?i.resetNorth:void 0,n.duration_=i.duration!==void 0?i.duration:250,n.autoHide_=i.autoHide!==void 0?i.autoHide:!0,n.rotation_=void 0,n.autoHide_&&n.element.classList.add(Os),n}return e.prototype.handleClick_=function(t){t.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()},e.prototype.resetNorth_=function(){var t=this.getMap(),n=t.getView();if(!!n){var i=n.getRotation();i!==void 0&&(this.duration_>0&&i%(2*Math.PI)!==0?n.animate({rotation:0,duration:this.duration_,easing:Nr}):n.setRotation(0))}},e.prototype.render=function(t){var n=t.frameState;if(!!n){var i=n.viewState.rotation;if(i!=this.rotation_){var a="rotate("+i+"rad)";if(this.autoHide_){var u=this.element.classList.contains(Os);!u&&i===0?this.element.classList.add(Os):u&&i!==0&&this.element.classList.remove(Os)}this.label_.style.transform=a}this.rotation_=i}},e}(Yh),VE=UE,XE=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),jE=function(r){XE(e,r);function e(t){var n=this,i=t||{};n=r.call(this,{element:document.createElement("div"),target:i.target})||this;var a=i.className!==void 0?i.className:"ol-zoom",u=i.delta!==void 0?i.delta:1,p=i.zoomInClassName!==void 0?i.zoomInClassName:a+"-in",g=i.zoomOutClassName!==void 0?i.zoomOutClassName:a+"-out",v=i.zoomInLabel!==void 0?i.zoomInLabel:"+",m=i.zoomOutLabel!==void 0?i.zoomOutLabel:"\u2013",b=i.zoomInTipLabel!==void 0?i.zoomInTipLabel:"Zoom in",E=i.zoomOutTipLabel!==void 0?i.zoomOutTipLabel:"Zoom out",w=document.createElement("button");w.className=p,w.setAttribute("type","button"),w.title=b,w.appendChild(typeof v=="string"?document.createTextNode(v):v),w.addEventListener(pt.CLICK,n.handleClick_.bind(n,u),!1);var S=document.createElement("button");S.className=g,S.setAttribute("type","button"),S.title=E,S.appendChild(typeof m=="string"?document.createTextNode(m):m),S.addEventListener(pt.CLICK,n.handleClick_.bind(n,-u),!1);var O=a+" "+Ca+" "+Dh,I=n.element;return I.className=O,I.appendChild(w),I.appendChild(S),n.duration_=i.duration!==void 0?i.duration:250,n}return e.prototype.handleClick_=function(t,n){n.preventDefault(),this.zoomByDelta_(t)},e.prototype.zoomByDelta_=function(t){var n=this.getMap(),i=n.getView();if(!!i){var a=i.getZoom();if(a!==void 0){var u=i.getConstrainedZoom(a+t);this.duration_>0?(i.getAnimating()&&i.cancelAnimations(),i.animate({zoom:u,duration:this.duration_,easing:Nr})):i.setZoom(u)}}},e}(Yh),WE=jE;function HE(r){var e=r||{},t=new qe,n=e.zoom!==void 0?e.zoom:!0;n&&t.push(new WE(e.zoomOptions));var i=e.rotate!==void 0?e.rotate:!0;i&&t.push(new VE(e.rotateOptions));var a=e.attribution!==void 0?e.attribution:!0;return a&&t.push(new GE(e.attributionOptions)),t}var gd={ACTIVE:"active"},YE=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),$E=function(r){YE(e,r);function e(t){var n=r.call(this)||this;return n.on,n.once,n.un,t&&t.handleEvent&&(n.handleEvent=t.handleEvent),n.map_=null,n.setActive(!0),n}return e.prototype.getActive=function(){return this.get(gd.ACTIVE)},e.prototype.getMap=function(){return this.map_},e.prototype.handleEvent=function(t){return!0},e.prototype.setActive=function(t){this.set(gd.ACTIVE,t)},e.prototype.setMap=function(t){this.map_=t},e}(Tn);function KE(r,e,t){var n=r.getCenterInternal();if(n){var i=[n[0]+e[0],n[1]+e[1]];r.animateInternal({duration:t!==void 0?t:250,easing:E1,center:r.getConstrainedCenter(i)})}}function $h(r,e,t,n){var i=r.getZoom();if(i!==void 0){var a=r.getConstrainedZoom(i+e),u=r.getResolutionForZoom(a);r.getAnimating()&&r.cancelAnimations(),r.animate({resolution:u,anchor:t,duration:n!==void 0?n:250,easing:Nr})}}var zo=$E,ZE=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),qE=function(r){ZE(e,r);function e(t){var n=r.call(this)||this,i=t||{};return n.delta_=i.delta?i.delta:1,n.duration_=i.duration!==void 0?i.duration:250,n}return e.prototype.handleEvent=function(t){var n=!1;if(t.type==$t.DBLCLICK){var i=t.originalEvent,a=t.map,u=t.coordinate,p=i.shiftKey?-this.delta_:this.delta_,g=a.getView();$h(g,p,u,this.duration_),i.preventDefault(),n=!0}return!n},e}(zo),JE=qE,QE=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),tT=function(r){QE(e,r);function e(t){var n=this,i=t||{};return n=r.call(this,i)||this,i.handleDownEvent&&(n.handleDownEvent=i.handleDownEvent),i.handleDragEvent&&(n.handleDragEvent=i.handleDragEvent),i.handleMoveEvent&&(n.handleMoveEvent=i.handleMoveEvent),i.handleUpEvent&&(n.handleUpEvent=i.handleUpEvent),i.stopDown&&(n.stopDown=i.stopDown),n.handlingDownUpSequence=!1,n.trackedPointers_={},n.targetPointers=[],n}return e.prototype.getPointerCount=function(){return this.targetPointers.length},e.prototype.handleDownEvent=function(t){return!1},e.prototype.handleDragEvent=function(t){},e.prototype.handleEvent=function(t){if(!t.originalEvent)return!0;var n=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==$t.POINTERDRAG)this.handleDragEvent(t),t.originalEvent.preventDefault();else if(t.type==$t.POINTERUP){var i=this.handleUpEvent(t);this.handlingDownUpSequence=i&&this.targetPointers.length>0}}else if(t.type==$t.POINTERDOWN){var a=this.handleDownEvent(t);this.handlingDownUpSequence=a,n=this.stopDown(a)}else t.type==$t.POINTERMOVE&&this.handleMoveEvent(t);return!n},e.prototype.handleMoveEvent=function(t){},e.prototype.handleUpEvent=function(t){return!1},e.prototype.stopDown=function(t){return t},e.prototype.updateTrackedPointers_=function(t){if(eT(t)){var n=t.originalEvent,i=n.pointerId.toString();t.type==$t.POINTERUP?delete this.trackedPointers_[i]:t.type==$t.POINTERDOWN?this.trackedPointers_[i]=n:i in this.trackedPointers_&&(this.trackedPointers_[i]=n),this.targetPointers=Ad(this.trackedPointers_)}},e}(zo);function Kh(r){for(var e=r.length,t=0,n=0,i=0;i<e;i++)t+=r[i].clientX,n+=r[i].clientY;return[t/e,n/e]}function eT(r){var e=r.type;return e===$t.POINTERDOWN||e===$t.POINTERDRAG||e===$t.POINTERUP}var Uo=tT;function yh(r){var e=arguments;return function(t){for(var n=!0,i=0,a=e.length;i<a&&(n=n&&e[i](t),!!n);++i);return n}}var nT=function(r){var e=r.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},iT=function(r){var e=r.map.getTargetElement(),t=r.map.getOwnerDocument().activeElement;return e.contains(t)},zp=function(r){return r.map.getTargetElement().hasAttribute("tabindex")?iT(r):!0},rT=wr,Up=function(r){var e=r.originalEvent;return e.button==0&&!(Om&&Im&&e.ctrlKey)},Vp=function(r){var e=r.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},oT=function(r){var e=r.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},Xp=function(r){var e=r.originalEvent,t=e.target.tagName;return t!=="INPUT"&&t!=="SELECT"&&t!=="TEXTAREA"},Hl=function(r){var e=r.originalEvent;return Ct(e!==void 0,56),e.pointerType=="mouse"},sT=function(r){var e=r.originalEvent;return Ct(e!==void 0,56),e.isPrimary&&e.button===0},aT=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),lT=function(r){aT(e,r);function e(t){var n=r.call(this,{stopDown:va})||this,i=t||{};n.kinetic_=i.kinetic,n.lastCentroid=null,n.lastPointersCount_,n.panning_=!1;var a=i.condition?i.condition:yh(Vp,sT);return n.condition_=i.onFocusOnly?yh(zp,a):a,n.noKinetic_=!1,n}return e.prototype.handleDragEvent=function(t){this.panning_||(this.panning_=!0,this.getMap().getView().beginInteraction());var n=this.targetPointers,i=Kh(n);if(n.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(i[0],i[1]),this.lastCentroid){var a=[this.lastCentroid[0]-i[0],i[1]-this.lastCentroid[1]],u=t.map,p=u.getView();a0(a,p.getResolution()),Oh(a,p.getRotation()),p.adjustCenterInternal(a)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=i,this.lastPointersCount_=n.length,t.originalEvent.preventDefault()},e.prototype.handleUpEvent=function(t){var n=t.map,i=n.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){var a=this.kinetic_.getDistance(),u=this.kinetic_.getAngle(),p=i.getCenterInternal(),g=n.getPixelFromCoordinateInternal(p),v=n.getCoordinateFromPixelInternal([g[0]-a*Math.cos(u),g[1]-a*Math.sin(u)]);i.animateInternal({center:i.getConstrainedCenter(v),duration:500,easing:Nr})}return this.panning_&&(this.panning_=!1,i.endInteraction()),!1}else return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0},e.prototype.handleDownEvent=function(t){if(this.targetPointers.length>0&&this.condition_(t)){var n=t.map,i=n.getView();return this.lastCentroid=null,i.getAnimating()&&i.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}else return!1},e}(Uo),hT=lT,cT=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),uT=function(r){cT(e,r);function e(t){var n=this,i=t||{};return n=r.call(this,{stopDown:va})||this,n.condition_=i.condition?i.condition:nT,n.lastAngle_=void 0,n.duration_=i.duration!==void 0?i.duration:250,n}return e.prototype.handleDragEvent=function(t){if(!!Hl(t)){var n=t.map,i=n.getView();if(i.getConstraints().rotation!==Hh){var a=n.getSize(),u=t.pixel,p=Math.atan2(a[1]/2-u[1],u[0]-a[0]/2);if(this.lastAngle_!==void 0){var g=p-this.lastAngle_;i.adjustRotationInternal(-g)}this.lastAngle_=p}}},e.prototype.handleUpEvent=function(t){if(!Hl(t))return!0;var n=t.map,i=n.getView();return i.endInteraction(this.duration_),!1},e.prototype.handleDownEvent=function(t){if(!Hl(t))return!1;if(Up(t)&&this.condition_(t)){var n=t.map;return n.getView().beginInteraction(),this.lastAngle_=void 0,!0}else return!1},e}(Uo),fT=uT,dT=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),pT=function(r){dT(e,r);function e(t){var n=r.call(this)||this;return n.geometry_=null,n.element_=document.createElement("div"),n.element_.style.position="absolute",n.element_.style.pointerEvents="auto",n.element_.className="ol-box "+t,n.map_=null,n.startPixel_=null,n.endPixel_=null,n}return e.prototype.disposeInternal=function(){this.setMap(null)},e.prototype.render_=function(){var t=this.startPixel_,n=this.endPixel_,i="px",a=this.element_.style;a.left=Math.min(t[0],n[0])+i,a.top=Math.min(t[1],n[1])+i,a.width=Math.abs(n[0]-t[0])+i,a.height=Math.abs(n[1]-t[1])+i},e.prototype.setMap=function(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);var n=this.element_.style;n.left="inherit",n.top="inherit",n.width="inherit",n.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)},e.prototype.setPixels=function(t,n){this.startPixel_=t,this.endPixel_=n,this.createOrUpdateGeometry(),this.render_()},e.prototype.createOrUpdateGeometry=function(){var t=this.startPixel_,n=this.endPixel_,i=[t,[t[0],n[1]],n,[n[0],t[1]]],a=i.map(this.map_.getCoordinateFromPixelInternal,this.map_);a[4]=a[0].slice(),this.geometry_?this.geometry_.setCoordinates([a]):this.geometry_=new ip([a])},e.prototype.getGeometry=function(){return this.geometry_},e}(_a),gT=pT,jp=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),ks={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"},Yl=function(r){jp(e,r);function e(t,n,i){var a=r.call(this,t)||this;return a.coordinate=n,a.mapBrowserEvent=i,a}return e}(Nn),_T=function(r){jp(e,r);function e(t){var n=r.call(this)||this;n.on,n.once,n.un;var i=t||{};return n.box_=new gT(i.className||"ol-dragbox"),n.minArea_=i.minArea!==void 0?i.minArea:64,i.onBoxEnd&&(n.onBoxEnd=i.onBoxEnd),n.startPixel_=null,n.condition_=i.condition?i.condition:Up,n.boxEndCondition_=i.boxEndCondition?i.boxEndCondition:n.defaultBoxEndCondition,n}return e.prototype.defaultBoxEndCondition=function(t,n,i){var a=i[0]-n[0],u=i[1]-n[1];return a*a+u*u>=this.minArea_},e.prototype.getGeometry=function(){return this.box_.getGeometry()},e.prototype.handleDragEvent=function(t){this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new Yl(ks.BOXDRAG,t.coordinate,t))},e.prototype.handleUpEvent=function(t){this.box_.setMap(null);var n=this.boxEndCondition_(t,this.startPixel_,t.pixel);return n&&this.onBoxEnd(t),this.dispatchEvent(new Yl(n?ks.BOXEND:ks.BOXCANCEL,t.coordinate,t)),!1},e.prototype.handleDownEvent=function(t){return this.condition_(t)?(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new Yl(ks.BOXSTART,t.coordinate,t)),!0):!1},e.prototype.onBoxEnd=function(t){},e}(Uo),vT=_T,yT=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),mT=function(r){yT(e,r);function e(t){var n=this,i=t||{},a=i.condition?i.condition:oT;return n=r.call(this,{condition:a,className:i.className||"ol-dragzoom",minArea:i.minArea})||this,n.duration_=i.duration!==void 0?i.duration:200,n.out_=i.out!==void 0?i.out:!1,n}return e.prototype.onBoxEnd=function(t){var n=this.getMap(),i=n.getView(),a=this.getGeometry();if(this.out_){var u=i.rotatedExtentForGeometry(a),p=i.getResolutionForExtentInternal(u),g=i.getResolution()/p;a=a.clone(),a.scale(g*g)}i.fitInternal(a,{duration:this.duration_,easing:Nr})},e}(vT),xT=mT,Mi={LEFT:37,UP:38,RIGHT:39,DOWN:40},bT=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),ET=function(r){bT(e,r);function e(t){var n=r.call(this)||this,i=t||{};return n.defaultCondition_=function(a){return Vp(a)&&Xp(a)},n.condition_=i.condition!==void 0?i.condition:n.defaultCondition_,n.duration_=i.duration!==void 0?i.duration:100,n.pixelDelta_=i.pixelDelta!==void 0?i.pixelDelta:128,n}return e.prototype.handleEvent=function(t){var n=!1;if(t.type==pt.KEYDOWN){var i=t.originalEvent,a=i.keyCode;if(this.condition_(t)&&(a==Mi.DOWN||a==Mi.LEFT||a==Mi.RIGHT||a==Mi.UP)){var u=t.map,p=u.getView(),g=p.getResolution()*this.pixelDelta_,v=0,m=0;a==Mi.DOWN?m=-g:a==Mi.LEFT?v=-g:a==Mi.RIGHT?v=g:m=g;var b=[v,m];Oh(b,p.getRotation()),KE(p,b,this.duration_),i.preventDefault(),n=!0}}return!n},e}(zo),TT=ET,wT=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),ST=function(r){wT(e,r);function e(t){var n=r.call(this)||this,i=t||{};return n.condition_=i.condition?i.condition:Xp,n.delta_=i.delta?i.delta:1,n.duration_=i.duration!==void 0?i.duration:100,n}return e.prototype.handleEvent=function(t){var n=!1;if(t.type==pt.KEYDOWN||t.type==pt.KEYPRESS){var i=t.originalEvent,a=i.charCode;if(this.condition_(t)&&(a=="+".charCodeAt(0)||a=="-".charCodeAt(0))){var u=t.map,p=a=="+".charCodeAt(0)?this.delta_:-this.delta_,g=u.getView();$h(g,p,void 0,this.duration_),i.preventDefault(),n=!0}}return!n},e}(zo),RT=ST,CT=function(){function r(e,t,n){this.decay_=e,this.minVelocity_=t,this.delay_=n,this.points_=[],this.angle_=0,this.initialVelocity_=0}return r.prototype.begin=function(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0},r.prototype.update=function(e,t){this.points_.push(e,t,Date.now())},r.prototype.end=function(){if(this.points_.length<6)return!1;var e=Date.now()-this.delay_,t=this.points_.length-3;if(this.points_[t+2]<e)return!1;for(var n=t-3;n>0&&this.points_[n+2]>e;)n-=3;var i=this.points_[t+2]-this.points_[n+2];if(i<1e3/60)return!1;var a=this.points_[t]-this.points_[n],u=this.points_[t+1]-this.points_[n+1];return this.angle_=Math.atan2(u,a),this.initialVelocity_=Math.sqrt(a*a+u*u)/i,this.initialVelocity_>this.minVelocity_},r.prototype.getDistance=function(){return(this.minVelocity_-this.initialVelocity_)/this.decay_},r.prototype.getAngle=function(){return this.angle_},r}(),OT=CT,IT=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),$l={TRACKPAD:"trackpad",WHEEL:"wheel"},AT=function(r){IT(e,r);function e(t){var n=this,i=t||{};n=r.call(this,i)||this,n.totalDelta_=0,n.lastDelta_=0,n.maxDelta_=i.maxDelta!==void 0?i.maxDelta:1,n.duration_=i.duration!==void 0?i.duration:250,n.timeout_=i.timeout!==void 0?i.timeout:80,n.useAnchor_=i.useAnchor!==void 0?i.useAnchor:!0,n.constrainResolution_=i.constrainResolution!==void 0?i.constrainResolution:!1;var a=i.condition?i.condition:rT;return n.condition_=i.onFocusOnly?yh(zp,a):a,n.lastAnchor_=null,n.startTime_=void 0,n.timeoutId_,n.mode_=void 0,n.trackpadEventGap_=400,n.trackpadTimeoutId_,n.deltaPerZoom_=300,n}return e.prototype.endInteraction_=function(){this.trackpadTimeoutId_=void 0;var t=this.getMap().getView();t.endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_)},e.prototype.handleEvent=function(t){if(!this.condition_(t))return!0;var n=t.type;if(n!==pt.WHEEL)return!0;var i=t.map,a=t.originalEvent;a.preventDefault(),this.useAnchor_&&(this.lastAnchor_=t.coordinate);var u;if(t.type==pt.WHEEL&&(u=a.deltaY,Sm&&a.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(u/=Dd),a.deltaMode===WheelEvent.DOM_DELTA_LINE&&(u*=40)),u===0)return!1;this.lastDelta_=u;var p=Date.now();this.startTime_===void 0&&(this.startTime_=p),(!this.mode_||p-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(u)<4?$l.TRACKPAD:$l.WHEEL);var g=i.getView();if(this.mode_===$l.TRACKPAD&&!(g.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(g.getAnimating()&&g.cancelAnimations(),g.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),g.adjustZoom(-u/this.deltaPerZoom_,this.lastAnchor_),this.startTime_=p,!1;this.totalDelta_+=u;var v=Math.max(this.timeout_-(p-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,i),v),!1},e.prototype.handleWheelZoom_=function(t){var n=t.getView();n.getAnimating()&&n.cancelAnimations();var i=-se(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(n.getConstrainResolution()||this.constrainResolution_)&&(i=i?i>0?1:-1:0),$h(n,i,this.lastAnchor_,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0},e.prototype.setMouseAnchor=function(t){this.useAnchor_=t,t||(this.lastAnchor_=null)},e}(zo),PT=AT,MT=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),LT=function(r){MT(e,r);function e(t){var n=this,i=t||{},a=i;return a.stopDown||(a.stopDown=va),n=r.call(this,a)||this,n.anchor_=null,n.lastAngle_=void 0,n.rotating_=!1,n.rotationDelta_=0,n.threshold_=i.threshold!==void 0?i.threshold:.3,n.duration_=i.duration!==void 0?i.duration:250,n}return e.prototype.handleDragEvent=function(t){var n=0,i=this.targetPointers[0],a=this.targetPointers[1],u=Math.atan2(a.clientY-i.clientY,a.clientX-i.clientX);if(this.lastAngle_!==void 0){var p=u-this.lastAngle_;this.rotationDelta_+=p,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),n=p}this.lastAngle_=u;var g=t.map,v=g.getView();if(v.getConstraints().rotation!==Hh){var m=g.getViewport().getBoundingClientRect(),b=Kh(this.targetPointers);b[0]-=m.left,b[1]-=m.top,this.anchor_=g.getCoordinateFromPixelInternal(b),this.rotating_&&(g.render(),v.adjustRotationInternal(n,this.anchor_))}},e.prototype.handleUpEvent=function(t){if(this.targetPointers.length<2){var n=t.map,i=n.getView();return i.endInteraction(this.duration_),!1}else return!0},e.prototype.handleDownEvent=function(t){if(this.targetPointers.length>=2){var n=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||n.getView().beginInteraction(),!0}else return!1},e}(Uo),DT=LT,kT=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),FT=function(r){kT(e,r);function e(t){var n=this,i=t||{},a=i;return a.stopDown||(a.stopDown=va),n=r.call(this,a)||this,n.anchor_=null,n.duration_=i.duration!==void 0?i.duration:400,n.lastDistance_=void 0,n.lastScaleDelta_=1,n}return e.prototype.handleDragEvent=function(t){var n=1,i=this.targetPointers[0],a=this.targetPointers[1],u=i.clientX-a.clientX,p=i.clientY-a.clientY,g=Math.sqrt(u*u+p*p);this.lastDistance_!==void 0&&(n=this.lastDistance_/g),this.lastDistance_=g;var v=t.map,m=v.getView();n!=1&&(this.lastScaleDelta_=n);var b=v.getViewport().getBoundingClientRect(),E=Kh(this.targetPointers);E[0]-=b.left,E[1]-=b.top,this.anchor_=v.getCoordinateFromPixelInternal(E),v.render(),m.adjustResolutionInternal(n,this.anchor_)},e.prototype.handleUpEvent=function(t){if(this.targetPointers.length<2){var n=t.map,i=n.getView(),a=this.lastScaleDelta_>1?1:-1;return i.endInteraction(this.duration_,a),!1}else return!0},e.prototype.handleDownEvent=function(t){if(this.targetPointers.length>=2){var n=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||n.getView().beginInteraction(),!0}else return!1},e}(Uo),NT=FT;function BT(r){var e=r||{},t=new qe,n=new OT(-.005,.05,100),i=e.altShiftDragRotate!==void 0?e.altShiftDragRotate:!0;i&&t.push(new fT);var a=e.doubleClickZoom!==void 0?e.doubleClickZoom:!0;a&&t.push(new JE({delta:e.zoomDelta,duration:e.zoomDuration}));var u=e.dragPan!==void 0?e.dragPan:!0;u&&t.push(new hT({onFocusOnly:e.onFocusOnly,kinetic:n}));var p=e.pinchRotate!==void 0?e.pinchRotate:!0;p&&t.push(new DT);var g=e.pinchZoom!==void 0?e.pinchZoom:!0;g&&t.push(new NT({duration:e.zoomDuration}));var v=e.keyboard!==void 0?e.keyboard:!0;v&&(t.push(new TT),t.push(new RT({delta:e.zoomDelta,duration:e.zoomDuration})));var m=e.mouseWheelZoom!==void 0?e.mouseWheelZoom:!0;m&&t.push(new PT({onFocusOnly:e.onFocusOnly,duration:e.zoomDuration}));var b=e.shiftDragZoom!==void 0?e.shiftDragZoom:!0;return b&&t.push(new xT({duration:e.zoomDuration})),t}var GT=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),zT=function(r){GT(e,r);function e(t){return t=oe({},t),t.controls||(t.controls=HE()),t.interactions||(t.interactions=BT({onFocusOnly:!0})),r.call(this,t)||this}return e.prototype.createRenderer=function(){return new sE(this)},e}(DE),UT=zT,VT=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),XT=function(r){VT(e,r);function e(t){var n=this,i=t||{},a=oe({},i);return delete a.preload,delete a.useInterimTilesOnError,n=r.call(this,a)||this,n.on,n.once,n.un,n.setPreload(i.preload!==void 0?i.preload:0),n.setUseInterimTilesOnError(i.useInterimTilesOnError!==void 0?i.useInterimTilesOnError:!0),n}return e.prototype.getPreload=function(){return this.get(Ls.PRELOAD)},e.prototype.setPreload=function(t){this.set(Ls.PRELOAD,t)},e.prototype.getUseInterimTilesOnError=function(){return this.get(Ls.USE_INTERIM_TILES_ON_ERROR)},e.prototype.setUseInterimTilesOnError=function(t){this.set(Ls.USE_INTERIM_TILES_ON_ERROR,t)},e.prototype.getData=function(t){return r.prototype.getData.call(this,t)},e}(Oa),jT=XT,WT=function(){function r(e,t){this.name=e,this.data=t,this.texture_=null}return r.prototype.getTexture=function(e){if(!this.texture_){var t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.data.length/4,1,0,e.RGBA,e.UNSIGNED_BYTE,this.data),this.texture_=t}return this.texture_},r}(),HT=WT,YT=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),$T=function(r){YT(e,r);function e(t){var n=this,i=dt.IDLE;return n=r.call(this,t.tileCoord,i,{transition:t.transition,interpolate:t.interpolate})||this,n.loader_=t.loader,n.data_=null,n.error_=null,n}return e.prototype.getData=function(){return this.data_},e.prototype.getError=function(){return this.error_},e.prototype.load=function(){this.state=dt.LOADING,this.changed();var t=this;this.loader_().then(function(n){t.data_=n,t.state=dt.LOADED,t.changed()}).catch(function(n){t.error_=n,t.state=dt.ERROR,t.changed()})},e}(Gh),Wp=$T,KT=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();function Hp(r,e,t){var n=t?r.LINEAR:r.NEAREST;r.bindTexture(r.TEXTURE_2D,e),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,n),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,n)}function ZT(r,e,t,n){Hp(r,e,n),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,t)}function _d(r,e,t,n,i,a){var u=r.getGL(),p,g;if(t instanceof Float32Array){p=u.FLOAT,r.getExtension("OES_texture_float");var v=r.getExtension("OES_texture_float_linear");g=v!==null}else p=u.UNSIGNED_BYTE,g=!0;Hp(u,e,a&&g);var m=t.byteLength/n[1],b=1;m%8===0?b=8:m%4===0?b=4:m%2===0&&(b=2);var E;switch(i){case 1:{E=u.LUMINANCE;break}case 2:{E=u.LUMINANCE_ALPHA;break}case 3:{E=u.RGB;break}case 4:{E=u.RGBA;break}default:throw new Error("Unsupported number of bands: ".concat(i))}var w=u.getParameter(u.UNPACK_ALIGNMENT);u.pixelStorei(u.UNPACK_ALIGNMENT,b),u.texImage2D(u.TEXTURE_2D,0,E,n[0],n[1],0,E,p,t),u.pixelStorei(u.UNPACK_ALIGNMENT,w)}var To=null;function qT(){var r=document.createElement("canvas");r.width=1,r.height=1,To=r.getContext("2d")}var JT=function(r){KT(e,r);function e(t){var n=r.call(this)||this;n.tile,n.textures=[],n.handleTileChange_=n.handleTileChange_.bind(n),n.size=Ge(t.grid.getTileSize(t.tile.tileCoord[0])),n.tilePixelRatio_=t.tilePixelRatio||1,n.gutter_=t.gutter||0,n.bandCount=NaN,n.helper_=t.helper;var i=new Ip(Fh,Bh);return i.fromArray([0,1,1,1,1,0,0,0]),n.helper_.flushBufferData(i),n.coords=i,n.setTile(t.tile),n}return e.prototype.setTile=function(t){if(t!==this.tile)if(this.tile&&this.tile.removeEventListener(pt.CHANGE,this.handleTileChange_),this.tile=t,this.textures.length=0,this.loaded=t.getState()===dt.LOADED,this.loaded)this.uploadTile_();else{if(t instanceof ld){var n=t.getImage();n instanceof Image&&!n.crossOrigin&&(n.crossOrigin="anonymous")}t.addEventListener(pt.CHANGE,this.handleTileChange_)}},e.prototype.uploadTile_=function(){var t=this.helper_,n=t.getGL(),i=this.tile;if(i instanceof ld||i instanceof F1){var a=i.getImage();if(this.gutter_!==0){var u=this.tilePixelRatio_*this.gutter_,p=Math.round(a.width-2*u),g=Math.round(a.height-2*u),v=We(p,g);i.interpolate||oe(v,_h),v.drawImage(a,u,u,p,g,0,0,p,g),a=v.canvas}var m=n.createTexture();this.textures.push(m),this.bandCount=4,ZT(n,m,a,i.interpolate);return}var b=[this.size[0]*this.tilePixelRatio_,this.size[1]*this.tilePixelRatio_],E=i.getData(),w=E instanceof Float32Array,S=b[0]*b[1],O=w?Float32Array:Uint8Array,I=O.BYTES_PER_ELEMENT,M=E.byteLength/b[1];this.bandCount=Math.floor(M/I/b[0]);var A=Math.ceil(this.bandCount/4);if(A===1){var m=n.createTexture();this.textures.push(m),_d(t,m,E,b,this.bandCount,i.interpolate);return}for(var k=new Array(A),L=0;L<A;++L){var m=n.createTexture();this.textures.push(m);var B=L<A-1?4:this.bandCount%4;k[L]=new O(S*B)}for(var G=0,V=0,U=b[0]*this.bandCount,K=0;K<b[1];++K){for(var H=0;H<U;++H){var et=E[V+H],X=Math.floor(G/this.bandCount),j=H%this.bandCount,L=Math.floor(j/4),J=k[L],B=J.length/S,Q=j%4;J[X*B+Q]=et,++G}V+=M/I}for(var L=0;L<A;++L){var m=this.textures[L],J=k[L],B=J.length/S;_d(t,m,J,b,B,i.interpolate)}},e.prototype.handleTileChange_=function(){this.tile.getState()===dt.LOADED&&(this.loaded=!0,this.uploadTile_(),this.dispatchEvent(pt.CHANGE))},e.prototype.disposeInternal=function(){var t=this.helper_.getGL();this.helper_.deleteBuffer(this.coords);for(var n=0;n<this.textures.length;++n)t.deleteTexture(this.textures[n]);this.tile.removeEventListener(pt.CHANGE,this.handleTileChange_)},e.prototype.getPixelData=function(t,n){if(!this.loaded)return null;if(t=Math.floor(this.tilePixelRatio_*t),n=Math.floor(this.tilePixelRatio_*n),this.tile instanceof Wp){var i=this.tile.getData(),a=Math.floor(this.tilePixelRatio_*this.size[0]);if(i instanceof DataView){var u=i.byteLength/(this.size[0]*this.size[1]),p=n*a*u+t*u,g=i.buffer.slice(p,p+u);return new DataView(g)}var v=n*a*this.bandCount+t*this.bandCount;return i.slice(v,v+this.bandCount)}To||qT(),To.clearRect(0,0,1,1);var m,b=this.tile.getImage();try{To.drawImage(b,t,n,1,1,0,0,1,1),m=To.getImageData(0,0,1,1).data}catch{return null}return m},e}(Zi),QT=JT,tw=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),_t={TILE_TEXTURE_ARRAY:"u_tileTextures",TILE_TRANSFORM:"u_tileTransform",TRANSITION_ALPHA:"u_transitionAlpha",DEPTH:"u_depth",TEXTURE_PIXEL_WIDTH:"u_texturePixelWidth",TEXTURE_PIXEL_HEIGHT:"u_texturePixelHeight",TEXTURE_RESOLUTION:"u_textureResolution",TEXTURE_ORIGIN_X:"u_textureOriginX",TEXTURE_ORIGIN_Y:"u_textureOriginY",RENDER_EXTENT:"u_renderExtent",RESOLUTION:"u_resolution",ZOOM:"u_zoom"},Ws={TEXTURE_COORD:"a_textureCoord"},ew=[{name:Ws.TEXTURE_COORD,size:2,type:Eo.FLOAT}],nw={};function iw(r){return 2*(1-1/(r+1))-1}function vd(r,e,t){t in r||(r[t]=[]),r[t].push(e)}function Kl(r,e){var t=r.layerStatesArray[r.layerIndex];t.extent&&(e=ji(e,Gi(t.extent,r.viewState.projection)));var n=t.layer.getRenderSource();if(!n.getWrapX()){var i=n.getTileGridForProjection(r.viewState.projection).getExtent();i&&(e=ji(e,i))}return e}function Zl(r,e){return"".concat(r.getKey(),",").concat(da(e))}var rw=function(r){tw(e,r);function e(t,n){var i=r.call(this,t,{uniforms:n.uniforms})||this;i.renderComplete=!1,i.tileTransform_=ze(),i.tempMat4_=Ap(),i.tempTileRange_=new Dp(0,0,0,0),i.tempTileCoord_=fa(0,0,0),i.tempSize_=[0,0],i.program_,i.vertexShader_=n.vertexShader,i.fragmentShader_=n.fragmentShader,i.indices_=new Ip(Nh,Bh),i.indices_.fromArray([0,1,3,1,2,3]);var a=n.cacheSize!==void 0?n.cacheSize:512;return i.tileTextureCache_=new kp(a),i.paletteTextures_=n.paletteTextures||[],i.frameState_=null,i}return e.prototype.reset=function(t){r.prototype.reset.call(this,{uniforms:t.uniforms}),this.vertexShader_=t.vertexShader,this.fragmentShader_=t.fragmentShader,this.paletteTextures_=t.paletteTextures||[],this.helper&&(this.program_=this.helper.getProgram(this.fragmentShader_,this.vertexShader_))},e.prototype.afterHelperCreated=function(){this.program_=this.helper.getProgram(this.fragmentShader_,this.vertexShader_),this.helper.flushBufferData(this.indices_)},e.prototype.isDrawableTile_=function(t){var n=this.getLayer(),i=t.getState(),a=n.getUseInterimTilesOnError();return i==dt.LOADED||i==dt.EMPTY||i==dt.ERROR&&!a},e.prototype.prepareFrameInternal=function(t){var n=this.getLayer(),i=n.getRenderSource();return!i||Sa(Kl(t,t.extent))?!1:i.getState()===Oe.READY},e.prototype.enqueueTiles=function(t,n,i,a){var u=t.viewState,p=this.getLayer(),g=p.getRenderSource(),v=g.getTileGridForProjection(u.projection),m=g.getTilePixelRatio(t.pixelRatio),b=g.getGutterForProjection(u.projection),E=Xt(g);E in t.wantedTiles||(t.wantedTiles[E]={});for(var w=t.wantedTiles[E],S=this.tileTextureCache_,O=Math.max(i-p.getPreload(),v.getMinZoom(),p.getMinZoom()),I=i;I>=O;--I)for(var M=v.getTileRangeForExtentAndZ(n,I,this.tempTileRange_),A=v.getResolution(I),k=M.minX;k<=M.maxX;++k)for(var L=M.minY;L<=M.maxY;++L){var B=fa(I,k,L,this.tempTileCoord_),G=Zl(g,B),V=void 0,U=void 0;if(S.containsKey(G)&&(V=S.get(G),U=V.tile),!V||V.tile.key!==g.getKey())if(U=g.getTile(I,k,L,t.pixelRatio,u.projection),!V)V=new QT({tile:U,grid:v,helper:this.helper,tilePixelRatio:m,gutter:b}),S.set(G,V);else if(this.isDrawableTile_(U))V.setTile(U);else{var K=U.getInterimTile();V.setTile(K)}vd(a,V,I);var H=U.getKey();w[H]=!0,U.getState()===dt.IDLE&&(t.tileQueue.isKeyQueued(H)||t.tileQueue.enqueue([U,E,v.getTileCoordCenter(B),A]))}},e.prototype.renderFrame=function(t){this.frameState_=t,this.renderComplete=!0;var n=this.helper.getGL();this.preRender(n,t);var i=t.viewState,a=this.getLayer(),u=a.getRenderSource(),p=u.getTileGridForProjection(i.projection),g=Kl(t,t.extent),v=p.getZForResolution(i.resolution,u.zDirection),m={};if(t.nextExtent){var b=p.getZForResolution(i.nextResolution,u.zDirection),E=Kl(t,t.nextExtent);this.enqueueTiles(t,E,b,m)}this.enqueueTiles(t,g,v,m);for(var w={},S=Xt(this),O=t.time,I=!1,M=m[v],A=0,k=M.length;A<k;++A){var L=M[A],B=L.tile,G=B.tileCoord;if(L.loaded){var V=B.getAlpha(S,O);if(V===1){B.endTransition(S);continue}I=!0;var U=da(G);w[U]=V}this.renderComplete=!1;var K=this.findAltTiles_(p,G,v+1,m);if(!K)for(var H=p.getMinZoom(),et=v-1;et>=H;--et){var X=this.findAltTiles_(p,G,et,m);if(X)break}}this.helper.useProgram(this.program_),this.helper.prepareDraw(t,!I);for(var j=Object.keys(m).map(Number).sort(Ir),J=i.center[0],Q=i.center[1],tt=0,rt=j.length;tt<rt;++tt)for(var at=j[tt],ht=p.getResolution(at),ut=Ge(p.getTileSize(at),this.tempSize_),wt=p.getOrigin(at),Y=(J-wt[0])/(ut[0]*ht),Yt=(wt[1]-Q)/(ut[1]*ht),zt=i.resolution/ht,Zt=iw(at),te=m[at],A=0,k=te.length;A<k;++A){var L=te[A];if(!!L.loaded){var B=L.tile,G=B.tileCoord,U=da(G),Ue=G[1],ee=G[2];mn(this.tileTransform_,0,0,2/(t.size[0]*zt/ut[0]),-2/(t.size[1]*zt/ut[1]),i.rotation,-(Y-Ue),-(Yt-ee)),this.helper.setUniformMatrixValue(_t.TILE_TRANSFORM,js(this.tempMat4_,this.tileTransform_)),this.helper.bindBuffer(L.coords),this.helper.bindBuffer(this.indices_),this.helper.enableAttributes(ew);for(var ue=0;ue<L.textures.length;){var wn="TEXTURE"+ue,qi="".concat(_t.TILE_TEXTURE_ARRAY,"[").concat(ue,"]");n.activeTexture(n[wn]),n.bindTexture(n.TEXTURE_2D,L.textures[ue]),n.uniform1i(this.helper.getUniformLocation(qi),ue),++ue}for(var Bn=0;Bn<this.paletteTextures_.length;++Bn){var pi=this.paletteTextures_[Bn];n.activeTexture(n["TEXTURE"+ue]);var He=pi.getTexture(n);n.bindTexture(n.TEXTURE_2D,He),n.uniform1i(this.helper.getUniformLocation(pi.name),ue),++ue}var V=U in w?w[U]:1;V<1&&(t.animate=!0),this.helper.setUniformFloatValue(_t.TRANSITION_ALPHA,V),this.helper.setUniformFloatValue(_t.DEPTH,Zt),this.helper.setUniformFloatValue(_t.TEXTURE_PIXEL_WIDTH,ut[0]),this.helper.setUniformFloatValue(_t.TEXTURE_PIXEL_HEIGHT,ut[1]),this.helper.setUniformFloatValue(_t.TEXTURE_RESOLUTION,ht),this.helper.setUniformFloatValue(_t.TEXTURE_ORIGIN_X,wt[0]+Ue*ut[0]*ht),this.helper.setUniformFloatValue(_t.TEXTURE_ORIGIN_Y,wt[1]-ee*ut[1]*ht),this.helper.setUniformFloatVec4(_t.RENDER_EXTENT,g),this.helper.setUniformFloatValue(_t.RESOLUTION,i.resolution),this.helper.setUniformFloatValue(_t.ZOOM,i.zoom),this.helper.drawElements(0,this.indices_.getSize())}}this.helper.finalizeDraw(t,this.dispatchPreComposeEvent,this.dispatchPostComposeEvent);for(var Gn=this.helper.getCanvas(),gi=this.tileTextureCache_;gi.canExpireCache();){var L=gi.pop();L.dispose()}var _i=function(vi,Te){u.expireCache(Te.viewState.projection,nw)};return t.postRenderFunctions.push(_i),this.postRender(n,t),Gn},e.prototype.getData=function(t){var n=this.helper.getGL();if(!n)return null;var i=this.frameState_;if(!i)return null;var a=this.getLayer(),u=ne(i.pixelToCoordinateTransform,t.slice()),p=i.viewState,g=a.getExtent();if(g&&!Yi(Gi(g,p.projection),u))return null;var v=a.getRenderSource(),m=v.getTileGridForProjection(p.projection);if(!v.getWrapX()){var b=m.getExtent();if(b&&!Yi(b,u))return null}for(var E=this.tileTextureCache_,w=m.getZForResolution(p.resolution);w>=m.getMinZoom();--w){var S=m.getTileCoordForCoordAndZ(u,w),O=Zl(v,S);if(!!E.containsKey(O)){var I=E.get(O);if(!!I.loaded){var M=m.getOrigin(w),A=Ge(m.getTileSize(w)),k=m.getResolution(w),L=(u[0]-M[0])/k-S[1]*A[0],B=(M[1]-u[1])/k-S[2]*A[1];return I.getPixelData(L,B)}}}return null},e.prototype.findAltTiles_=function(t,n,i,a){var u=t.getTileRangeForTileCoordAndZ(n,i,this.tempTileRange_);if(!u)return!1;for(var p=!0,g=this.tileTextureCache_,v=this.getLayer().getRenderSource(),m=u.minX;m<=u.maxX;++m)for(var b=u.minY;b<=u.maxY;++b){var E=Zl(v,[i,m,b]),w=!1;if(g.containsKey(E)){var S=g.get(E);S.loaded&&(vd(a,S,i),w=!0)}w||(p=!1)}return p},e.prototype.removeHelper=function(){if(this.helper){var t=this.tileTextureCache_;t.forEach(function(n){return n.dispose()}),t.clear()}r.prototype.removeHelper.call(this)},e.prototype.disposeInternal=function(){var t=this.helper;if(t){var n=t.getGL();n.deleteProgram(this.program_),delete this.program_,t.deleteBuffer(this.indices_)}r.prototype.disposeInternal.call(this),delete this.indices_,delete this.tileTextureCache_,delete this.frameState_},e}(y1),ow=rw,it={NUMBER:1,STRING:2,COLOR:4,BOOLEAN:8,NUMBER_ARRAY:16,ANY:31,NONE:0},xt={};function En(r){if(typeof r=="number")return it.NUMBER;if(typeof r=="boolean")return it.BOOLEAN;if(typeof r=="string")return ex(r)?it.COLOR|it.STRING:it.STRING;if(!Array.isArray(r))throw new Error("Unhandled value type: ".concat(JSON.stringify(r)));var e=r,t=e.every(function(i){return typeof i=="number"});if(t)return e.length===3||e.length===4?it.COLOR|it.NUMBER_ARRAY:it.NUMBER_ARRAY;if(typeof e[0]!="string")throw new Error("Expected an expression operator but received: ".concat(JSON.stringify(e)));var n=xt[e[0]];if(n===void 0)throw new Error("Unrecognized expression operator: ".concat(JSON.stringify(e)));return n.getReturnType(e.slice(1))}function sw(r){return Xd(r)%1===0}function Aa(r){var e=r.toString();return e.indexOf(".")===-1?e+".0":e}function Yp(r){if(r.length<2||r.length>4)throw new Error("`formatArray` can only output `vec2`, `vec3` or `vec4` arrays.");return"vec".concat(r.length,"(").concat(r.map(Aa).join(", "),")")}function aw(r){var e=Io(r).slice();return e.length<4&&e.push(1),Yp(e.map(function(t,n){return n<3?t/255:t}))}function $p(r,e){return r.stringLiteralsMap[e]===void 0&&(r.stringLiteralsMap[e]=Object.keys(r.stringLiteralsMap).length),r.stringLiteralsMap[e]}function lw(r,e){return Aa($p(r,e))}function st(r,e,t){if(Array.isArray(e)&&typeof e[0]=="string"){var n=xt[e[0]];if(n===void 0)throw new Error("Unrecognized expression operator: ".concat(JSON.stringify(e)));return n.toGlsl(r,e.slice(1),t)}var i=En(e);if((i&it.NUMBER)>0)return Aa(e);if((i&it.BOOLEAN)>0)return e.toString();if((i&it.STRING)>0&&(t===void 0||t==it.STRING))return lw(r,e.toString());if((i&it.COLOR)>0&&(t===void 0||t==it.COLOR))return aw(e);if((i&it.NUMBER_ARRAY)>0)return Yp(e);throw new Error("Unexpected expression ".concat(e," (expected type ").concat(t,")"))}function Kp(r){if(!(En(r)&it.NUMBER))throw new Error("A numeric value was expected, got ".concat(JSON.stringify(r)," instead"))}function ae(r){for(var e=0;e<r.length;e++)Kp(r[e])}function Zp(r){if(!(En(r)&it.STRING))throw new Error("A string value was expected, got ".concat(JSON.stringify(r)," instead"))}function Zh(r){if(!(En(r)&it.BOOLEAN))throw new Error("A boolean value was expected, got ".concat(JSON.stringify(r)," instead"))}function Ht(r,e){if(r.length!==e)throw new Error("Exactly ".concat(e," arguments were expected, got ").concat(r.length," instead"))}function fi(r,e){if(r.length<e)throw new Error("At least ".concat(e," arguments were expected, got ").concat(r.length," instead"))}function Pa(r,e){if(r.length>e)throw new Error("At most ".concat(e," arguments were expected, got ").concat(r.length," instead"))}function qp(r){if(r.length%2!==0)throw new Error("An even amount of arguments was expected, got ".concat(r," instead"))}function hw(r){if(r.length%2===0)throw new Error("An odd amount of arguments was expected, got ".concat(r," instead"))}function qh(r,e){if(!sw(e))throw new Error("Could not infer only one type from the following expression: ".concat(JSON.stringify(r)))}xt.get={getReturnType:function(r){return it.ANY},toGlsl:function(r,e){Ht(e,1),Zp(e[0]);var t=e[0].toString();r.attributes.indexOf(t)===-1&&r.attributes.push(t);var n=r.inFragmentShader?"v_":"a_";return n+t}};function Jp(r){return"u_var_"+r}xt.var={getReturnType:function(r){return it.ANY},toGlsl:function(r,e){Ht(e,1),Zp(e[0]);var t=e[0].toString();return r.variables.indexOf(t)===-1&&r.variables.push(t),Jp(t)}};var Qp="u_paletteTextures";xt.palette={getReturnType:function(r){return it.COLOR},toGlsl:function(r,e){Ht(e,2),Kp(e[0]);var t=st(r,e[0]),n=e[1];if(!Array.isArray(n))throw new Error("The second argument of palette must be an array");for(var i=n.length,a=new Uint8Array(i*4),u=0;u<i;u++){var p=n[u],g=void 0;if(typeof p=="string")g=up(p);else{if(!Array.isArray(p))throw new Error("The second argument of palette must be an array of strings or colors");var v=p.length;if(v===4)g=p;else{if(v!==3)throw new Error("Expected palette color to have 3 or 4 values, got ".concat(v));g=[p[0],p[1],p[2],1]}}var m=u*4;a[m]=g[0],a[m+1]=g[1],a[m+2]=g[2],a[m+3]=g[3]*255}r.paletteTextures||(r.paletteTextures=[]);var b="".concat(Qp,"[").concat(r.paletteTextures.length,"]"),E=new HT(b,a);return r.paletteTextures.push(E),"texture2D(".concat(b,", vec2((").concat(t," + 0.5) / ").concat(i,".0, 0.5))")}};var ql="getBandValue";xt.band={getReturnType:function(r){return it.NUMBER},toGlsl:function(r,e){fi(e,1),Pa(e,3);var t=e[0];if(!(ql in r.functions)){for(var n="",i=r.bandCount||1,a=0;a<i;a++){var u=Math.floor(a/4),p=a%4;p===i-1&&p===1&&(p=3);var g="".concat(_t.TILE_TEXTURE_ARRAY,"[").concat(u,"]");n+=`
          if (band == `.concat(a+1,`.0) {
            return texture2D(`).concat(g,", v_textureCoord + vec2(dx, dy))[").concat(p,`];
          }
        `)}r.functions[ql]=`
        float getBandValue(float band, float xOffset, float yOffset) {
          float dx = xOffset / `.concat(_t.TEXTURE_PIXEL_WIDTH,`;
          float dy = yOffset / `).concat(_t.TEXTURE_PIXEL_HEIGHT,`;
          `).concat(n,`
        }
      `)}var v=st(r,t),m=st(r,e[1]||0),b=st(r,e[2]||0);return"".concat(ql,"(").concat(v,", ").concat(m,", ").concat(b,")")}};xt.time={getReturnType:function(r){return it.NUMBER},toGlsl:function(r,e){return Ht(e,0),"u_time"}};xt.zoom={getReturnType:function(r){return it.NUMBER},toGlsl:function(r,e){return Ht(e,0),"u_zoom"}};xt.resolution={getReturnType:function(r){return it.NUMBER},toGlsl:function(r,e){return Ht(e,0),"u_resolution"}};xt["*"]={getReturnType:function(r){return it.NUMBER},toGlsl:function(r,e){return Ht(e,2),ae(e),"(".concat(st(r,e[0])," * ").concat(st(r,e[1]),")")}};xt["/"]={getReturnType:function(r){return it.NUMBER},toGlsl:function(r,e){return Ht(e,2),ae(e),"(".concat(st(r,e[0])," / ").concat(st(r,e[1]),")")}};xt["+"]={getReturnType:function(r){return it.NUMBER},toGlsl:function(r,e){return Ht(e,2),ae(e),"(".concat(st(r,e[0])," + ").concat(st(r,e[1]),")")}};xt["-"]={getReturnType:function(r){return it.NUMBER},toGlsl:function(r,e){return Ht(e,2),ae(e),"(".concat(st(r,e[0])," - ").concat(st(r,e[1]),")")}};xt.clamp={getReturnType:function(r){return it.NUMBER},toGlsl:function(r,e){Ht(e,3),ae(e);var t=st(r,e[1]),n=st(r,e[2]);return"clamp(".concat(st(r,e[0]),", ").concat(t,", ").concat(n,")")}};xt["%"]={getReturnType:function(r){return it.NUMBER},toGlsl:function(r,e){return Ht(e,2),ae(e),"mod(".concat(st(r,e[0]),", ").concat(st(r,e[1]),")")}};xt["^"]={getReturnType:function(r){return it.NUMBER},toGlsl:function(r,e){return Ht(e,2),ae(e),"pow(".concat(st(r,e[0]),", ").concat(st(r,e[1]),")")}};xt.abs={getReturnType:function(r){return it.NUMBER},toGlsl:function(r,e){return Ht(e,1),ae(e),"abs(".concat(st(r,e[0]),")")}};xt.floor={getReturnType:function(r){return it.NUMBER},toGlsl:function(r,e){return Ht(e,1),ae(e),"floor(".concat(st(r,e[0]),")")}};xt.round={getReturnType:function(r){return it.NUMBER},toGlsl:function(r,e){return Ht(e,1),ae(e),"floor(".concat(st(r,e[0])," + 0.5)")}};xt.ceil={getReturnType:function(r){return it.NUMBER},toGlsl:function(r,e){return Ht(e,1),ae(e),"ceil(".concat(st(r,e[0]),")")}};xt.sin={getReturnType:function(r){return it.NUMBER},toGlsl:function(r,e){return Ht(e,1),ae(e),"sin(".concat(st(r,e[0]),")")}};xt.cos={getReturnType:function(r){return it.NUMBER},toGlsl:function(r,e){return Ht(e,1),ae(e),"cos(".concat(st(r,e[0]),")")}};xt.atan={getReturnType:function(r){return it.NUMBER},toGlsl:function(r,e){return fi(e,1),Pa(e,2),ae(e),e.length===2?"atan(".concat(st(r,e[0]),", ").concat(st(r,e[1]),")"):"atan(".concat(st(r,e[0]),")")}};xt[">"]={getReturnType:function(r){return it.BOOLEAN},toGlsl:function(r,e){return Ht(e,2),ae(e),"(".concat(st(r,e[0])," > ").concat(st(r,e[1]),")")}};xt[">="]={getReturnType:function(r){return it.BOOLEAN},toGlsl:function(r,e){return Ht(e,2),ae(e),"(".concat(st(r,e[0])," >= ").concat(st(r,e[1]),")")}};xt["<"]={getReturnType:function(r){return it.BOOLEAN},toGlsl:function(r,e){return Ht(e,2),ae(e),"(".concat(st(r,e[0])," < ").concat(st(r,e[1]),")")}};xt["<="]={getReturnType:function(r){return it.BOOLEAN},toGlsl:function(r,e){return Ht(e,2),ae(e),"(".concat(st(r,e[0])," <= ").concat(st(r,e[1]),")")}};function tg(r){return{getReturnType:function(e){return it.BOOLEAN},toGlsl:function(e,t){Ht(t,2);for(var n=it.ANY,i=0;i<t.length;i++)n&=En(t[i]);if(n===it.NONE)throw new Error("All arguments should be of compatible type, got ".concat(JSON.stringify(t)," instead"));return n&=~it.COLOR,"(".concat(st(e,t[0],n)," ").concat(r," ").concat(st(e,t[1],n),")")}}}xt["=="]=tg("==");xt["!="]=tg("!=");xt["!"]={getReturnType:function(r){return it.BOOLEAN},toGlsl:function(r,e){return Ht(e,1),Zh(e[0]),"(!".concat(st(r,e[0]),")")}};function eg(r){return{getReturnType:function(e){return it.BOOLEAN},toGlsl:function(e,t){fi(t,2);for(var n=0;n<t.length;n++)Zh(t[n]);var i="";return i=t.map(function(a){return st(e,a)}).join(" ".concat(r," ")),i="(".concat(i,")"),i}}}xt.all=eg("&&");xt.any=eg("||");xt.between={getReturnType:function(r){return it.BOOLEAN},toGlsl:function(r,e){Ht(e,3),ae(e);var t=st(r,e[1]),n=st(r,e[2]),i=st(r,e[0]);return"(".concat(i," >= ").concat(t," && ").concat(i," <= ").concat(n,")")}};xt.array={getReturnType:function(r){return it.NUMBER_ARRAY},toGlsl:function(r,e){fi(e,2),Pa(e,4),ae(e);var t=e.map(function(n){return st(r,n,it.NUMBER)});return"vec".concat(e.length,"(").concat(t.join(", "),")")}};xt.color={getReturnType:function(r){return it.COLOR},toGlsl:function(r,e){fi(e,3),Pa(e,4),ae(e);var t=e;e.length===3&&t.push(1);var n=e.map(function(i,a){return st(r,i,it.NUMBER)+(a<3?" / 255.0":"")});return"vec".concat(e.length,"(").concat(n.join(", "),")")}};xt.interpolate={getReturnType:function(r){for(var e=it.COLOR|it.NUMBER,t=3;t<r.length;t+=2)e=e&En(r[t]);return e},toGlsl:function(r,e,t){qp(e),fi(e,6);var n=e[0],i;switch(n[0]){case"linear":i=1;break;case"exponential":i=n[1];break;default:i=null}if(!i)throw new Error('Invalid interpolation type for "interpolate" operator, received: '.concat(JSON.stringify(n)));var a=t!==void 0?t:it.ANY,u=xt.interpolate.getReturnType(e)&a;qh(e,u);for(var p=st(r,e[1]),g=Aa(i),v="",m=2;m<e.length-2;m+=2){var b=st(r,e[m]),E=v||st(r,e[m+1],u),w=st(r,e[m+2]),S=st(r,e[m+3],u);v="mix(".concat(E,", ").concat(S,", pow(clamp((").concat(p," - ").concat(b,") / (").concat(w," - ").concat(b,"), 0.0, 1.0), ").concat(g,"))")}return v}};xt.match={getReturnType:function(r){for(var e=it.ANY,t=2;t<r.length;t+=2)e=e&En(r[t]);return e=e&En(r[r.length-1]),e},toGlsl:function(r,e,t){qp(e),fi(e,4);var n=t!==void 0?t:it.ANY,i=xt.match.getReturnType(e)&n;qh(e,i);for(var a=st(r,e[0]),u=st(r,e[e.length-1],i),p=null,g=e.length-3;g>=1;g-=2){var v=st(r,e[g]),m=st(r,e[g+1],i);p="(".concat(a," == ").concat(v," ? ").concat(m," : ").concat(p||u,")")}return p}};xt.case={getReturnType:function(r){for(var e=it.ANY,t=1;t<r.length;t+=2)e=e&En(r[t]);return e=e&En(r[r.length-1]),e},toGlsl:function(r,e,t){hw(e),fi(e,3);var n=t!==void 0?t:it.ANY,i=xt.case.getReturnType(e)&n;qh(e,i);for(var a=0;a<e.length-1;a+=2)Zh(e[a]);for(var u=st(r,e[e.length-1],i),p=null,a=e.length-3;a>=0;a-=2){var g=st(r,e[a]),v=st(r,e[a+1],i);p="(".concat(g," ? ").concat(v," : ").concat(p||u,")")}return p}};var cw=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();function yd(r,e){var t=`
    attribute vec2 `.concat(Ws.TEXTURE_COORD,`;
    uniform mat4 `).concat(_t.TILE_TRANSFORM,`;
    uniform float `).concat(_t.TEXTURE_PIXEL_WIDTH,`;
    uniform float `).concat(_t.TEXTURE_PIXEL_HEIGHT,`;
    uniform float `).concat(_t.TEXTURE_RESOLUTION,`;
    uniform float `).concat(_t.TEXTURE_ORIGIN_X,`;
    uniform float `).concat(_t.TEXTURE_ORIGIN_Y,`;
    uniform float `).concat(_t.DEPTH,`;

    varying vec2 v_textureCoord;
    varying vec2 v_mapCoord;

    void main() {
      v_textureCoord = `).concat(Ws.TEXTURE_COORD,`;
      v_mapCoord = vec2(
        `).concat(_t.TEXTURE_ORIGIN_X," + ").concat(_t.TEXTURE_RESOLUTION," * ").concat(_t.TEXTURE_PIXEL_WIDTH,` * v_textureCoord[0],
        `).concat(_t.TEXTURE_ORIGIN_Y," - ").concat(_t.TEXTURE_RESOLUTION," * ").concat(_t.TEXTURE_PIXEL_HEIGHT,` * v_textureCoord[1]
      );
      gl_Position = `).concat(_t.TILE_TRANSFORM," * vec4(").concat(Ws.TEXTURE_COORD,", ").concat(_t.DEPTH,`, 1.0);
    }
  `),n={inFragmentShader:!0,variables:[],attributes:[],stringLiteralsMap:{},functions:{},bandCount:e},i=[];if(r.color!==void 0){var a=st(n,r.color,it.COLOR);i.push("color = ".concat(a,";"))}if(r.contrast!==void 0){var u=st(n,r.contrast,it.NUMBER);i.push("color.rgb = clamp((".concat(u," + 1.0) * color.rgb - (").concat(u," / 2.0), vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));"))}if(r.exposure!==void 0){var p=st(n,r.exposure,it.NUMBER);i.push("color.rgb = clamp((".concat(p," + 1.0) * color.rgb, vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));"))}if(r.saturation!==void 0){var g=st(n,r.saturation,it.NUMBER);i.push(`
      float saturation = `.concat(g,` + 1.0;
      float sr = (1.0 - saturation) * 0.2126;
      float sg = (1.0 - saturation) * 0.7152;
      float sb = (1.0 - saturation) * 0.0722;
      mat3 saturationMatrix = mat3(
        sr + saturation, sr, sr,
        sg, sg + saturation, sg,
        sb, sb, sb + saturation
      );
      color.rgb = clamp(saturationMatrix * color.rgb, vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));
    `))}if(r.gamma!==void 0){var v=st(n,r.gamma,it.NUMBER);i.push("color.rgb = pow(color.rgb, vec3(1.0 / ".concat(v,"));"))}if(r.brightness!==void 0){var m=st(n,r.brightness,it.NUMBER);i.push("color.rgb = clamp(color.rgb + ".concat(m,", vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));"))}var b={},E=n.variables.length;if(E>1&&!r.variables)throw new Error("Missing variables in style (expected ".concat(n.variables,")"));for(var w=function(k){var L=n.variables[k];if(!(L in r.variables))throw new Error("Missing '".concat(L,"' in style variables"));var B=Jp(L);b[B]=function(){var G=r.variables[L];return typeof G=="string"&&(G=$p(n,G)),G!==void 0?G:-9999999}},S=0;S<E;++S)w(S);var O=Object.keys(b).map(function(k){return"uniform float ".concat(k,";")}),I=Math.ceil(e/4);O.push("uniform sampler2D ".concat(_t.TILE_TEXTURE_ARRAY,"[").concat(I,"];")),n.paletteTextures&&O.push("uniform sampler2D ".concat(Qp,"[").concat(n.paletteTextures.length,"];"));var M=Object.keys(n.functions).map(function(k){return n.functions[k]}),A=`
    #ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    #else
    precision mediump float;
    #endif

    varying vec2 v_textureCoord;
    varying vec2 v_mapCoord;
    uniform vec4 `.concat(_t.RENDER_EXTENT,`;
    uniform float `).concat(_t.TRANSITION_ALPHA,`;
    uniform float `).concat(_t.TEXTURE_PIXEL_WIDTH,`;
    uniform float `).concat(_t.TEXTURE_PIXEL_HEIGHT,`;
    uniform float `).concat(_t.RESOLUTION,`;
    uniform float `).concat(_t.ZOOM,`;

    `).concat(O.join(`
`),`

    `).concat(M.join(`
`),`

    void main() {
      if (
        v_mapCoord[0] < `).concat(_t.RENDER_EXTENT,`[0] ||
        v_mapCoord[1] < `).concat(_t.RENDER_EXTENT,`[1] ||
        v_mapCoord[0] > `).concat(_t.RENDER_EXTENT,`[2] ||
        v_mapCoord[1] > `).concat(_t.RENDER_EXTENT,`[3]
      ) {
        discard;
      }

      vec4 color = texture2D(`).concat(_t.TILE_TEXTURE_ARRAY,`[0],  v_textureCoord);

      `).concat(i.join(`
`),`

      if (color.a == 0.0) {
        discard;
      }

      gl_FragColor = color;
      gl_FragColor.rgb *= gl_FragColor.a;
      gl_FragColor *= `).concat(_t.TRANSITION_ALPHA,`;
    }`);return{vertexShader:t,fragmentShader:A,uniforms:b,paletteTextures:n.paletteTextures}}var ng=function(r){cw(e,r);function e(t){var n=this,i=t?oe({},t):{},a=i.style||{};delete i.style;var u=i.cacheSize;return delete i.cacheSize,n=r.call(this,i)||this,n.sources_=i.sources,n.renderedSource_=null,n.renderedResolution_=NaN,n.style_=a,n.cacheSize_=u,n.styleVariables_=n.style_.variables||{},n.addChangeListener(Bt.SOURCE,n.handleSourceUpdate_),n}return e.prototype.getSources=function(t,n){var i=this.getSource();return this.sources_?typeof this.sources_=="function"?this.sources_(t,n):this.sources_:i?[i]:[]},e.prototype.getRenderSource=function(){return this.renderedSource_||this.getSource()},e.prototype.getSourceState=function(){var t=this.getRenderSource();return t?t.getState():Oe.UNDEFINED},e.prototype.handleSourceUpdate_=function(){this.getSource()&&this.setStyle(this.style_)},e.prototype.getSourceBandCount_=function(){var t=this.getSource();return t&&"bandCount"in t?t.bandCount:4},e.prototype.createRenderer=function(){var t=yd(this.style_,this.getSourceBandCount_());return new ow(this,{vertexShader:t.vertexShader,fragmentShader:t.fragmentShader,uniforms:t.uniforms,cacheSize:this.cacheSize_,paletteTextures:t.paletteTextures})},e.prototype.renderSources=function(t,n){for(var i=this.getRenderer(),a,u=0,p=n.length;u<p;++u)this.renderedSource_=n[u],i.prepareFrame(t)&&(a=i.renderFrame(t));return a},e.prototype.render=function(t,n){var i=this;this.rendered=!0;for(var a=t.viewState,u=this.getSources(t.extent,a.resolution),p=!0,g=function(w,S){var O=u[w],I=O.getState();if(I==Oe.LOADING){var M=function(){O.getState()==Oe.READY&&(O.removeEventListener("change",M),i.changed())};O.addEventListener("change",M)}p=p&&I==Oe.READY},v=0,m=u.length;v<m;++v)g(v);var b=this.renderSources(t,u);if(this.getRenderer().renderComplete&&p)return this.renderedResolution_=a.resolution,b;if(this.renderedResolution_>.5*a.resolution){var E=this.getSources(t.extent,this.renderedResolution_).filter(function(w){return!u.includes(w)});if(E.length>0)return this.renderSources(t,E)}return b},e.prototype.setStyle=function(t){this.styleVariables_=t.variables||{},this.style_=t;var n=yd(this.style_,this.getSourceBandCount_()),i=this.getRenderer();i.reset({vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,uniforms:n.uniforms,paletteTextures:n.paletteTextures}),this.changed()},e.prototype.updateStyleVariables=function(t){oe(this.styleVariables_,t),this.changed()},e}(jT);ng.prototype.dispose;var uw=ng;var fw=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),dw=function(r){fw(e,r);function e(t){var n=this,i=t.projection===void 0?"EPSG:3857":t.projection,a=t.tileGrid;return a===void 0&&i&&(a=K1({extent:Xh(i),maxResolution:t.maxResolution,maxZoom:t.maxZoom,minZoom:t.minZoom,tileSize:t.tileSize})),n=r.call(this,{cacheSize:.1,attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,projection:i,tileGrid:a,opaque:t.opaque,state:t.state,tilePixelRatio:t.tilePixelRatio,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate})||this,n.tileLoadingKeys_={},n.loader_=t.loader,n.handleTileChange_=n.handleTileChange_.bind(n),n.bandCount=t.bandCount===void 0?4:t.bandCount,n}return e.prototype.setLoader=function(t){this.loader_=t},e.prototype.getTile=function(t,n,i,a,u){var p=zh(t,n,i);if(this.tileCache.containsKey(p))return this.tileCache.get(p);var g=this.loader_;function v(){return um(function(){return g(t,n,i)})}var m=new Wp(oe({tileCoord:[t,n,i],loader:v},this.tileOptions));return m.key=this.getKey(),m.addEventListener(pt.CHANGE,this.handleTileChange_),this.tileCache.set(p,m),m},e.prototype.handleTileChange_=function(t){var n=t.target,i=Xt(n),a=n.getState(),u;a==dt.LOADING?(this.tileLoadingKeys_[i]=!0,u=Xl.TILELOADSTART):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],u=a==dt.ERROR?Xl.TILELOADERROR:a==dt.LOADED?Xl.TILELOADEND:void 0),u&&this.dispatchEvent(new J1(u,n))},e}(Q1),pw=dw;function xe(r){return(e,...t)=>gw(r,e,t)}function Br(r,e){return xe(ig(r,e).get)}const{apply:gw,construct:GR,defineProperty:zR,get:UR,getOwnPropertyDescriptor:ig,getPrototypeOf:Jh,has:VR,ownKeys:_w,set:XR,setPrototypeOf:jR}=Reflect,{iterator:Vo,species:WR,toStringTag:vw,for:HR}=Symbol,yw=Object,{create:Qh,defineProperty:mw,freeze:YR,is:$R}=yw,xw=Array,bw=xw.prototype,rg=bw[Vo],Ew=xe(rg),og=ArrayBuffer,Tw=og.prototype;Br(Tw,"byteLength");const md=typeof SharedArrayBuffer!="undefined"?SharedArrayBuffer:null;md&&Br(md.prototype,"byteLength");const sg=Jh(Uint8Array);sg.from;const Ie=sg.prototype;Ie[Vo];xe(Ie.keys);xe(Ie.values);xe(Ie.entries);xe(Ie.set);xe(Ie.reverse);xe(Ie.fill);xe(Ie.copyWithin);xe(Ie.sort);xe(Ie.slice);xe(Ie.subarray);Br(Ie,"buffer");Br(Ie,"byteOffset");Br(Ie,"length");Br(Ie,vw);const Gr=Uint32Array,ww=Float32Array,ga=Jh([][Vo]()),Sw=xe(ga.next),Rw=xe(function*(){}().next),Cw=Jh(ga),Ow=DataView.prototype,Iw=xe(Ow.getUint16),tc=WeakMap,ag=tc.prototype,lg=xe(ag.get),Aw=xe(ag.set),hg=new tc,Pw=Qh(null,{next:{value:function(){const e=lg(hg,this);return Sw(e)}},[Vo]:{value:function(){return this}}});function Mw(r){if(r[Vo]===rg)return r;const e=Qh(Pw);return Aw(hg,e,Ew(r)),e}const Lw=new tc,Dw=Qh(Cw,{next:{value:function(){const e=lg(Lw,this);return Rw(e)},writable:!0,configurable:!0}});for(const r of _w(ga))r!=="next"&&mw(Dw,r,ig(ga,r));const cg=new og(4),kw=new ww(cg),Fw=new Gr(cg),dn=new Gr(512),pn=new Gr(512);for(let r=0;r<256;++r){const e=r-127;e<-27?(dn[r]=0,dn[r|256]=32768,pn[r]=24,pn[r|256]=24):e<-14?(dn[r]=1024>>-e-14,dn[r|256]=1024>>-e-14|32768,pn[r]=-e-1,pn[r|256]=-e-1):e<=15?(dn[r]=e+15<<10,dn[r|256]=e+15<<10|32768,pn[r]=13,pn[r|256]=13):e<128?(dn[r]=31744,dn[r|256]=64512,pn[r]=24,pn[r|256]=24):(dn[r]=31744,dn[r|256]=64512,pn[r]=13,pn[r|256]=13)}const ec=new Gr(2048),zr=new Gr(64),ug=new Gr(64);for(let r=1;r<1024;++r){let e=r<<13,t=0;for(;(e&8388608)===0;)e<<=1,t-=8388608;e&=-8388609,t+=947912704,ec[r]=e|t}for(let r=1024;r<2048;++r)ec[r]=939524096+(r-1024<<13);for(let r=1;r<31;++r)zr[r]=r<<23;zr[31]=1199570944;zr[32]=2147483648;for(let r=33;r<63;++r)zr[r]=2147483648+(r-32<<23);zr[63]=3347054592;for(let r=1;r<64;++r)r!==32&&(ug[r]=1024);function Nw(r){const e=r>>10;return Fw[0]=ec[ug[e]+(r&1023)]+zr[e],kw[0]}function fg(r,e,...t){return Nw(Iw(r,e,...Mw(t)))}function Bw(r,e,t){const n=t&&t.debug||!1;n&&console.log("getting "+e+" in "+r);const i=typeof r=="object"?r.outer:r,a=`${e}\\="([^"]*)"`;n&&console.log("pattern:",a);const p=new RegExp(a).exec(i);if(n&&console.log("match:",p),p)return p[1]}var Jl=Bw;function Gw(r,e,t){const i=new RegExp(e).exec(r.slice(t));return i?t+i.index:-1}var zw=Gw;const Ql=zw;function Uw(r,e,t){const n=t&&t.debug||!1,i=t&&t.startIndex||0;n&&console.log("starting findTagByName with",e," and ",t);const a=Ql(r,`<${e}[ >]`,i);if(n&&console.log("start:",a),a===-1)return;const u=r.slice(a+e.length);let p=Ql(u,"[ /]"+e+">",0);const g=p===-1;g&&(p=Ql(u,"[ /]>",0));const v=a+e.length+p+1+(g?0:e.length)+1;if(n&&console.log("end:",v),v===-1)return;const m=r.slice(a,v);let b;return g?b=null:b=m.slice(m.indexOf(">")+1,m.lastIndexOf("<")),{inner:b,outer:m,start:a,end:v}}var Vw=Uw;const Xw=Vw;function jw(r,e,t){const n=[],i=t&&t.debug||!1;let a=t&&t.startIndex||0,u;for(;u=Xw(r,e,{debug:i,startIndex:a});)a=u.end,n.push(u);return i&&console.log("findTagsByName found",n.length,"tags"),n}var Ww=jw;const Co={315:"Artist",258:"BitsPerSample",265:"CellLength",264:"CellWidth",320:"ColorMap",259:"Compression",33432:"Copyright",306:"DateTime",338:"ExtraSamples",266:"FillOrder",289:"FreeByteCounts",288:"FreeOffsets",291:"GrayResponseCurve",290:"GrayResponseUnit",316:"HostComputer",270:"ImageDescription",257:"ImageLength",256:"ImageWidth",271:"Make",281:"MaxSampleValue",280:"MinSampleValue",272:"Model",254:"NewSubfileType",274:"Orientation",262:"PhotometricInterpretation",284:"PlanarConfiguration",296:"ResolutionUnit",278:"RowsPerStrip",277:"SamplesPerPixel",305:"Software",279:"StripByteCounts",273:"StripOffsets",255:"SubfileType",263:"Threshholding",282:"XResolution",283:"YResolution",326:"BadFaxLines",327:"CleanFaxData",343:"ClipPath",328:"ConsecutiveBadFaxLines",433:"Decode",434:"DefaultImageColor",269:"DocumentName",336:"DotRange",321:"HalftoneHints",346:"Indexed",347:"JPEGTables",285:"PageName",297:"PageNumber",317:"Predictor",319:"PrimaryChromaticities",532:"ReferenceBlackWhite",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",559:"StripRowCounts",330:"SubIFDs",292:"T4Options",293:"T6Options",325:"TileByteCounts",323:"TileLength",324:"TileOffsets",322:"TileWidth",301:"TransferFunction",318:"WhitePoint",344:"XClipPathUnits",286:"XPosition",529:"YCbCrCoefficients",531:"YCbCrPositioning",530:"YCbCrSubSampling",345:"YClipPathUnits",287:"YPosition",37378:"ApertureValue",40961:"ColorSpace",36868:"DateTimeDigitized",36867:"DateTimeOriginal",34665:"Exif IFD",36864:"ExifVersion",33434:"ExposureTime",41728:"FileSource",37385:"Flash",40960:"FlashpixVersion",33437:"FNumber",42016:"ImageUniqueID",37384:"LightSource",37500:"MakerNote",37377:"ShutterSpeedValue",37510:"UserComment",33723:"IPTC",34675:"ICC Profile",700:"XMP",42112:"GDAL_METADATA",42113:"GDAL_NODATA",34377:"Photoshop",33550:"ModelPixelScale",33922:"ModelTiepoint",34264:"ModelTransformation",34735:"GeoKeyDirectory",34736:"GeoDoubleParams",34737:"GeoAsciiParams",50674:"LercParameters"},gn={};for(const r in Co)Co.hasOwnProperty(r)&&(gn[Co[r]]=parseInt(r,10));const Hw=[gn.BitsPerSample,gn.ExtraSamples,gn.SampleFormat,gn.StripByteCounts,gn.StripOffsets,gn.StripRowCounts,gn.TileByteCounts,gn.TileOffsets,gn.SubIFDs],th={1:"BYTE",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",6:"SBYTE",7:"UNDEFINED",8:"SSHORT",9:"SLONG",10:"SRATIONAL",11:"FLOAT",12:"DOUBLE",13:"IFD",16:"LONG8",17:"SLONG8",18:"IFD8"},yt={};for(const r in th)th.hasOwnProperty(r)&&(yt[th[r]]=parseInt(r,10));const Xe={WhiteIsZero:0,BlackIsZero:1,RGB:2,Palette:3,TransparencyMask:4,CMYK:5,YCbCr:6,CIELab:8,ICCLab:9},Yw={Unspecified:0,Assocalpha:1,Unassalpha:2},KR={Version:0,AddCompression:1},ZR={None:0,Deflate:1},Hs={1024:"GTModelTypeGeoKey",1025:"GTRasterTypeGeoKey",1026:"GTCitationGeoKey",2048:"GeographicTypeGeoKey",2049:"GeogCitationGeoKey",2050:"GeogGeodeticDatumGeoKey",2051:"GeogPrimeMeridianGeoKey",2052:"GeogLinearUnitsGeoKey",2053:"GeogLinearUnitSizeGeoKey",2054:"GeogAngularUnitsGeoKey",2055:"GeogAngularUnitSizeGeoKey",2056:"GeogEllipsoidGeoKey",2057:"GeogSemiMajorAxisGeoKey",2058:"GeogSemiMinorAxisGeoKey",2059:"GeogInvFlatteningGeoKey",2060:"GeogAzimuthUnitsGeoKey",2061:"GeogPrimeMeridianLongGeoKey",2062:"GeogTOWGS84GeoKey",3072:"ProjectedCSTypeGeoKey",3073:"PCSCitationGeoKey",3074:"ProjectionGeoKey",3075:"ProjCoordTransGeoKey",3076:"ProjLinearUnitsGeoKey",3077:"ProjLinearUnitSizeGeoKey",3078:"ProjStdParallel1GeoKey",3079:"ProjStdParallel2GeoKey",3080:"ProjNatOriginLongGeoKey",3081:"ProjNatOriginLatGeoKey",3082:"ProjFalseEastingGeoKey",3083:"ProjFalseNorthingGeoKey",3084:"ProjFalseOriginLongGeoKey",3085:"ProjFalseOriginLatGeoKey",3086:"ProjFalseOriginEastingGeoKey",3087:"ProjFalseOriginNorthingGeoKey",3088:"ProjCenterLongGeoKey",3089:"ProjCenterLatGeoKey",3090:"ProjCenterEastingGeoKey",3091:"ProjCenterNorthingGeoKey",3092:"ProjScaleAtNatOriginGeoKey",3093:"ProjScaleAtCenterGeoKey",3094:"ProjAzimuthAngleGeoKey",3095:"ProjStraightVertPoleLongGeoKey",3096:"ProjRectifiedGridAngleGeoKey",4096:"VerticalCSTypeGeoKey",4097:"VerticalCitationGeoKey",4098:"VerticalDatumGeoKey",4099:"VerticalUnitsGeoKey"},$w={};for(const r in Hs)Hs.hasOwnProperty(r)&&($w[Hs[r]]=parseInt(r,10));function Kw(r,e){const{width:t,height:n}=r,i=new Uint8Array(t*n*3);let a;for(let u=0,p=0;u<r.length;++u,p+=3)a=256-r[u]/e*256,i[p]=a,i[p+1]=a,i[p+2]=a;return i}function Zw(r,e){const{width:t,height:n}=r,i=new Uint8Array(t*n*3);let a;for(let u=0,p=0;u<r.length;++u,p+=3)a=r[u]/e*256,i[p]=a,i[p+1]=a,i[p+2]=a;return i}function qw(r,e){const{width:t,height:n}=r,i=new Uint8Array(t*n*3),a=e.length/3,u=e.length/3*2;for(let p=0,g=0;p<r.length;++p,g+=3){const v=r[p];i[g]=e[v]/65536*256,i[g+1]=e[v+a]/65536*256,i[g+2]=e[v+u]/65536*256}return i}function Jw(r){const{width:e,height:t}=r,n=new Uint8Array(e*t*3);for(let i=0,a=0;i<r.length;i+=4,a+=3){const u=r[i],p=r[i+1],g=r[i+2],v=r[i+3];n[a]=255*((255-u)/256)*((255-v)/256),n[a+1]=255*((255-p)/256)*((255-v)/256),n[a+2]=255*((255-g)/256)*((255-v)/256)}return n}function Qw(r){const{width:e,height:t}=r,n=new Uint8ClampedArray(e*t*3);for(let i=0,a=0;i<r.length;i+=3,a+=3){const u=r[i],p=r[i+1],g=r[i+2];n[a]=u+1.402*(g-128),n[a+1]=u-.34414*(p-128)-.71414*(g-128),n[a+2]=u+1.772*(p-128)}return n}const tS=.95047,eS=1,nS=1.08883;function iS(r){const{width:e,height:t}=r,n=new Uint8Array(e*t*3);for(let i=0,a=0;i<r.length;i+=3,a+=3){const u=r[i+0],p=r[i+1]<<24>>24,g=r[i+2]<<24>>24;let v=(u+16)/116,m=p/500+v,b=v-g/200,E,w,S;m=tS*(m*m*m>.008856?m*m*m:(m-16/116)/7.787),v=eS*(v*v*v>.008856?v*v*v:(v-16/116)/7.787),b=nS*(b*b*b>.008856?b*b*b:(b-16/116)/7.787),E=m*3.2406+v*-1.5372+b*-.4986,w=m*-.9689+v*1.8758+b*.0415,S=m*.0557+v*-.204+b*1.057,E=E>.0031308?1.055*E**(1/2.4)-.055:12.92*E,w=w>.0031308?1.055*w**(1/2.4)-.055:12.92*w,S=S>.0031308?1.055*S**(1/2.4)-.055:12.92*S,n[a]=Math.max(0,Math.min(1,E))*255,n[a+1]=Math.max(0,Math.min(1,w))*255,n[a+2]=Math.max(0,Math.min(1,S))*255}return n}const dg=new Map;function di(r,e){Array.isArray(r)||(r=[r]),r.forEach(t=>dg.set(t,e))}async function pg(r){const e=dg.get(r.Compression);if(!e)throw new Error(`Unknown compression method identifier: ${r.Compression}`);const t=await e();return new t(r)}di([void 0,1],()=>import("./raw-ccb56981.js").then(r=>r.default));di(5,()=>import("./lzw-05abbee1.js").then(r=>r.default));di(6,()=>{throw new Error("old style JPEG compression is not supported.")});di(7,()=>import("./jpeg-5aaea2f6.js").then(r=>r.default));di([8,32946],()=>import("./deflate-ed6ab470.js").then(r=>r.default));di(32773,()=>import("./packbits-60c5dccc.js").then(r=>r.default));di(34887,()=>import("./lerc-d5260e96.js").then(r=>r.default));di(50001,()=>import("./webimage-a471043f.js").then(r=>r.default));function Ma(r,e,t,n=1){return new(Object.getPrototypeOf(r)).constructor(e*t*n)}function rS(r,e,t,n,i){const a=e/n,u=t/i;return r.map(p=>{const g=Ma(p,n,i);for(let v=0;v<i;++v){const m=Math.min(Math.round(u*v),t-1);for(let b=0;b<n;++b){const E=Math.min(Math.round(a*b),e-1),w=p[m*e+E];g[v*n+b]=w}}return g})}function Cr(r,e,t){return(1-t)*r+t*e}function oS(r,e,t,n,i){const a=e/n,u=t/i;return r.map(p=>{const g=Ma(p,n,i);for(let v=0;v<i;++v){const m=u*v,b=Math.floor(m),E=Math.min(Math.ceil(m),t-1);for(let w=0;w<n;++w){const S=a*w,O=S%1,I=Math.floor(S),M=Math.min(Math.ceil(S),e-1),A=p[b*e+I],k=p[b*e+M],L=p[E*e+I],B=p[E*e+M],G=Cr(Cr(A,k,O),Cr(L,B,O),m%1);g[v*n+w]=G}}return g})}function sS(r,e,t,n,i,a="nearest"){switch(a.toLowerCase()){case"nearest":return rS(r,e,t,n,i);case"bilinear":case"linear":return oS(r,e,t,n,i);default:throw new Error(`Unsupported resampling method: '${a}'`)}}function aS(r,e,t,n,i,a){const u=e/n,p=t/i,g=Ma(r,n,i,a);for(let v=0;v<i;++v){const m=Math.min(Math.round(p*v),t-1);for(let b=0;b<n;++b){const E=Math.min(Math.round(u*b),e-1);for(let w=0;w<a;++w){const S=r[m*e*a+E*a+w];g[v*n*a+b*a+w]=S}}}return g}function lS(r,e,t,n,i,a){const u=e/n,p=t/i,g=Ma(r,n,i,a);for(let v=0;v<i;++v){const m=p*v,b=Math.floor(m),E=Math.min(Math.ceil(m),t-1);for(let w=0;w<n;++w){const S=u*w,O=S%1,I=Math.floor(S),M=Math.min(Math.ceil(S),e-1);for(let A=0;A<a;++A){const k=r[b*e*a+I*a+A],L=r[b*e*a+M*a+A],B=r[E*e*a+I*a+A],G=r[E*e*a+M*a+A],V=Cr(Cr(k,L,O),Cr(B,G,O),m%1);g[v*n*a+w*a+A]=V}}}return g}function hS(r,e,t,n,i,a,u="nearest"){switch(u.toLowerCase()){case"nearest":return aS(r,e,t,n,i,a);case"bilinear":case"linear":return lS(r,e,t,n,i,a);default:throw new Error(`Unsupported resampling method: '${u}'`)}}function cS(r,e,t){let n=0;for(let i=e;i<t;++i)n+=r[i];return n}function mh(r,e,t){switch(r){case 1:if(e<=8)return new Uint8Array(t);if(e<=16)return new Uint16Array(t);if(e<=32)return new Uint32Array(t);break;case 2:if(e===8)return new Int8Array(t);if(e===16)return new Int16Array(t);if(e===32)return new Int32Array(t);break;case 3:switch(e){case 16:case 32:return new Float32Array(t);case 64:return new Float64Array(t)}break}throw Error("Unsupported data format/bitsPerSample")}function uS(r,e){return(r===1||r===2)&&e<=32&&e%8===0?!1:!(r===3&&(e===16||e===32||e===64))}function fS(r,e,t,n,i,a,u){const p=new DataView(r),g=t===2?u*a:u*a*n,v=t===2?1:n,m=mh(e,i,g),b=parseInt("1".repeat(i),2);if(e===1){let E;t===1?E=n*i:E=i;let w=a*E;(w&7)!==0&&(w=w+7&-8);for(let S=0;S<u;++S){const O=S*w;for(let I=0;I<a;++I){const M=O+I*v*i;for(let A=0;A<v;++A){const k=M+A*i,L=(S*a+I)*v+A,B=Math.floor(k/8),G=k%8;if(G+i<=8)m[L]=p.getUint8(B)>>8-i-G&b;else if(G+i<=16)m[L]=p.getUint16(B)>>16-i-G&b;else if(G+i<=24){const V=p.getUint16(B)<<8|p.getUint8(B+2);m[L]=V>>24-i-G&b}else m[L]=p.getUint32(B)>>32-i-G&b}}}}return m.buffer}class dS{constructor(e,t,n,i,a,u){this.fileDirectory=e,this.geoKeys=t,this.dataView=n,this.littleEndian=i,this.tiles=a?{}:null,this.isTiled=!e.StripOffsets;const p=e.PlanarConfiguration;if(this.planarConfiguration=typeof p=="undefined"?1:p,this.planarConfiguration!==1&&this.planarConfiguration!==2)throw new Error("Invalid planar configuration.");this.source=u}getFileDirectory(){return this.fileDirectory}getGeoKeys(){return this.geoKeys}getWidth(){return this.fileDirectory.ImageWidth}getHeight(){return this.fileDirectory.ImageLength}getSamplesPerPixel(){return typeof this.fileDirectory.SamplesPerPixel!="undefined"?this.fileDirectory.SamplesPerPixel:1}getTileWidth(){return this.isTiled?this.fileDirectory.TileWidth:this.getWidth()}getTileHeight(){return this.isTiled?this.fileDirectory.TileLength:typeof this.fileDirectory.RowsPerStrip!="undefined"?Math.min(this.fileDirectory.RowsPerStrip,this.getHeight()):this.getHeight()}getBlockWidth(){return this.getTileWidth()}getBlockHeight(e){return this.isTiled||(e+1)*this.getTileHeight()<=this.getHeight()?this.getTileHeight():this.getHeight()-e*this.getTileHeight()}getBytesPerPixel(){let e=0;for(let t=0;t<this.fileDirectory.BitsPerSample.length;++t)e+=this.getSampleByteSize(t);return e}getSampleByteSize(e){if(e>=this.fileDirectory.BitsPerSample.length)throw new RangeError(`Sample index ${e} is out of range.`);return Math.ceil(this.fileDirectory.BitsPerSample[e]/8)}getReaderForSample(e){const t=this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[e]:1,n=this.fileDirectory.BitsPerSample[e];switch(t){case 1:if(n<=8)return DataView.prototype.getUint8;if(n<=16)return DataView.prototype.getUint16;if(n<=32)return DataView.prototype.getUint32;break;case 2:if(n<=8)return DataView.prototype.getInt8;if(n<=16)return DataView.prototype.getInt16;if(n<=32)return DataView.prototype.getInt32;break;case 3:switch(n){case 16:return function(i,a){return fg(this,i,a)};case 32:return DataView.prototype.getFloat32;case 64:return DataView.prototype.getFloat64}break}throw Error("Unsupported data format/bitsPerSample")}getSampleFormat(e=0){return this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[e]:1}getBitsPerSample(e=0){return this.fileDirectory.BitsPerSample[e]}getArrayForSample(e,t){const n=this.getSampleFormat(e),i=this.getBitsPerSample(e);return mh(n,i,t)}async getTileOrStrip(e,t,n,i,a){const u=Math.ceil(this.getWidth()/this.getTileWidth()),p=Math.ceil(this.getHeight()/this.getTileHeight());let g;const{tiles:v}=this;this.planarConfiguration===1?g=t*u+e:this.planarConfiguration===2&&(g=n*u*p+t*u+e);let m,b;this.isTiled?(m=this.fileDirectory.TileOffsets[g],b=this.fileDirectory.TileByteCounts[g]):(m=this.fileDirectory.StripOffsets[g],b=this.fileDirectory.StripByteCounts[g]);const E=(await this.source.fetch([{offset:m,length:b}],a))[0];let w;return v===null||!v[g]?(w=(async()=>{let S=await i.decode(this.fileDirectory,E);const O=this.getSampleFormat(),I=this.getBitsPerSample();return uS(O,I)&&(S=fS(S,O,this.planarConfiguration,this.getSamplesPerPixel(),I,this.getTileWidth(),this.getBlockHeight(t))),S})(),v!==null&&(v[g]=w)):w=v[g],{x:e,y:t,sample:n,data:await w}}async _readRaster(e,t,n,i,a,u,p,g,v){const m=this.getTileWidth(),b=this.getTileHeight(),E=this.getWidth(),w=this.getHeight(),S=Math.max(Math.floor(e[0]/m),0),O=Math.min(Math.ceil(e[2]/m),Math.ceil(E/m)),I=Math.max(Math.floor(e[1]/b),0),M=Math.min(Math.ceil(e[3]/b),Math.ceil(w/b)),A=e[2]-e[0];let k=this.getBytesPerPixel();const L=[],B=[];for(let U=0;U<t.length;++U)this.planarConfiguration===1?L.push(cS(this.fileDirectory.BitsPerSample,0,t[U])/8):L.push(0),B.push(this.getReaderForSample(t[U]));const G=[],{littleEndian:V}=this;for(let U=I;U<M;++U)for(let K=S;K<O;++K)for(let H=0;H<t.length;++H){const et=H,X=t[H];this.planarConfiguration===2&&(k=this.getSampleByteSize(H));const j=this.getTileOrStrip(K,U,X,a,v).then(J=>{const Q=J.data,tt=new DataView(Q),rt=this.getBlockHeight(J.y),at=J.y*b,ht=J.x*m,ut=at+rt,wt=(J.x+1)*m,Y=B[et],Yt=Math.min(rt,rt-(ut-e[3]),w-at),zt=Math.min(m,m-(wt-e[2]),E-ht);for(let Zt=Math.max(0,e[1]-at);Zt<Yt;++Zt)for(let te=Math.max(0,e[0]-ht);te<zt;++te){const Ue=(Zt*m+te)*k,ee=Y.call(tt,Ue+L[et],V);let ue;i?(ue=(Zt+at-e[1])*A*t.length+(te+ht-e[0])*t.length+et,n[ue]=ee):(ue=(Zt+at-e[1])*A+te+ht-e[0],n[et][ue]=ee)}});G.push(j)}if(await Promise.all(G),u&&e[2]-e[0]!==u||p&&e[3]-e[1]!==p){let U;return i?U=hS(n,e[2]-e[0],e[3]-e[1],u,p,t.length,g):U=sS(n,e[2]-e[0],e[3]-e[1],u,p,g),U.width=u,U.height=p,U}return n.width=u||e[2]-e[0],n.height=p||e[3]-e[1],n}async readRasters({window:e,samples:t=[],interleave:n,pool:i=null,width:a,height:u,resampleMethod:p,fillValue:g,signal:v}={}){const m=e||[0,0,this.getWidth(),this.getHeight()];if(m[0]>m[2]||m[1]>m[3])throw new Error("Invalid subsets");const b=m[2]-m[0],E=m[3]-m[1],w=b*E,S=this.getSamplesPerPixel();if(!t||!t.length)for(let A=0;A<S;++A)t.push(A);else for(let A=0;A<t.length;++A)if(t[A]>=S)return Promise.reject(new RangeError(`Invalid sample index '${t[A]}'.`));let O;if(n){const A=this.fileDirectory.SampleFormat?Math.max.apply(null,this.fileDirectory.SampleFormat):1,k=Math.max.apply(null,this.fileDirectory.BitsPerSample);O=mh(A,k,w*t.length),g&&O.fill(g)}else{O=[];for(let A=0;A<t.length;++A){const k=this.getArrayForSample(t[A],w);Array.isArray(g)&&A<g.length?k.fill(g[A]):g&&!Array.isArray(g)&&k.fill(g),O.push(k)}}const I=i||await pg(this.fileDirectory);return await this._readRaster(m,t,O,n,I,a,u,p,v)}async readRGB({window:e,interleave:t=!0,pool:n=null,width:i,height:a,resampleMethod:u,enableAlpha:p=!1,signal:g}={}){const v=e||[0,0,this.getWidth(),this.getHeight()];if(v[0]>v[2]||v[1]>v[3])throw new Error("Invalid subsets");const m=this.fileDirectory.PhotometricInterpretation;if(m===Xe.RGB){let M=[0,1,2];if(this.fileDirectory.ExtraSamples!==Yw.Unspecified&&p){M=[];for(let A=0;A<this.fileDirectory.BitsPerSample.length;A+=1)M.push(A)}return this.readRasters({window:e,interleave:t,samples:M,pool:n,width:i,height:a,resampleMethod:u,signal:g})}let b;switch(m){case Xe.WhiteIsZero:case Xe.BlackIsZero:case Xe.Palette:b=[0];break;case Xe.CMYK:b=[0,1,2,3];break;case Xe.YCbCr:case Xe.CIELab:b=[0,1,2];break;default:throw new Error("Invalid or unsupported photometric interpretation.")}const E={window:v,interleave:!0,samples:b,pool:n,width:i,height:a,resampleMethod:u,signal:g},{fileDirectory:w}=this,S=await this.readRasters(E),O=2**this.fileDirectory.BitsPerSample[0];let I;switch(m){case Xe.WhiteIsZero:I=Kw(S,O);break;case Xe.BlackIsZero:I=Zw(S,O);break;case Xe.Palette:I=qw(S,w.ColorMap);break;case Xe.CMYK:I=Jw(S);break;case Xe.YCbCr:I=Qw(S);break;case Xe.CIELab:I=iS(S);break;default:throw new Error("Unsupported photometric interpretation.")}if(!t){const M=new Uint8Array(I.length/3),A=new Uint8Array(I.length/3),k=new Uint8Array(I.length/3);for(let L=0,B=0;L<I.length;L+=3,++B)M[B]=I[L],A[B]=I[L+1],k[B]=I[L+2];I=[M,A,k]}return I.width=S.width,I.height=S.height,I}getTiePoints(){if(!this.fileDirectory.ModelTiepoint)return[];const e=[];for(let t=0;t<this.fileDirectory.ModelTiepoint.length;t+=6)e.push({i:this.fileDirectory.ModelTiepoint[t],j:this.fileDirectory.ModelTiepoint[t+1],k:this.fileDirectory.ModelTiepoint[t+2],x:this.fileDirectory.ModelTiepoint[t+3],y:this.fileDirectory.ModelTiepoint[t+4],z:this.fileDirectory.ModelTiepoint[t+5]});return e}getGDALMetadata(e=null){const t={};if(!this.fileDirectory.GDAL_METADATA)return null;const n=this.fileDirectory.GDAL_METADATA;let i=Ww(n,"Item");e===null?i=i.filter(a=>Jl(a,"sample")===void 0):i=i.filter(a=>Number(Jl(a,"sample"))===e);for(let a=0;a<i.length;++a){const u=i[a];t[Jl(u,"name")]=u.inner}return t}getGDALNoData(){if(!this.fileDirectory.GDAL_NODATA)return null;const e=this.fileDirectory.GDAL_NODATA;return Number(e.substring(0,e.length-1))}getOrigin(){const e=this.fileDirectory.ModelTiepoint,t=this.fileDirectory.ModelTransformation;if(e&&e.length===6)return[e[3],e[4],e[5]];if(t)return[t[3],t[7],t[11]];throw new Error("The image does not have an affine transformation.")}getResolution(e=null){const t=this.fileDirectory.ModelPixelScale,n=this.fileDirectory.ModelTransformation;if(t)return[t[0],-t[1],t[2]];if(n)return[n[0],n[5],n[10]];if(e){const[i,a,u]=e.getResolution();return[i*e.getWidth()/this.getWidth(),a*e.getHeight()/this.getHeight(),u*e.getWidth()/this.getWidth()]}throw new Error("The image does not have an affine transformation.")}pixelIsArea(){return this.geoKeys.GTRasterTypeGeoKey===1}getBoundingBox(){const e=this.getOrigin(),t=this.getResolution(),n=e[0],i=e[1],a=n+t[0]*this.getWidth(),u=i+t[1]*this.getHeight();return[Math.min(n,a),Math.min(i,u),Math.max(n,a),Math.max(i,u)]}}var gg=dS;class pS{constructor(e){this._dataView=new DataView(e)}get buffer(){return this._dataView.buffer}getUint64(e,t){const n=this.getUint32(e,t),i=this.getUint32(e+4,t);let a;if(t){if(a=n+2**32*i,!Number.isSafeInteger(a))throw new Error(`${a} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return a}if(a=2**32*n+i,!Number.isSafeInteger(a))throw new Error(`${a} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return a}getInt64(e,t){let n=0;const i=(this._dataView.getUint8(e+(t?7:0))&128)>0;let a=!0;for(let u=0;u<8;u++){let p=this._dataView.getUint8(e+(t?u:7-u));i&&(a?p!==0&&(p=~(p-1)&255,a=!1):p=~p&255),n+=p*256**u}return i&&(n=-n),n}getUint8(e,t){return this._dataView.getUint8(e,t)}getInt8(e,t){return this._dataView.getInt8(e,t)}getUint16(e,t){return this._dataView.getUint16(e,t)}getInt16(e,t){return this._dataView.getInt16(e,t)}getUint32(e,t){return this._dataView.getUint32(e,t)}getInt32(e,t){return this._dataView.getInt32(e,t)}getFloat16(e,t){return fg(this._dataView,e,t)}getFloat32(e,t){return this._dataView.getFloat32(e,t)}getFloat64(e,t){return this._dataView.getFloat64(e,t)}}class gS{constructor(e,t,n,i){this._dataView=new DataView(e),this._sliceOffset=t,this._littleEndian=n,this._bigTiff=i}get sliceOffset(){return this._sliceOffset}get sliceTop(){return this._sliceOffset+this.buffer.byteLength}get littleEndian(){return this._littleEndian}get bigTiff(){return this._bigTiff}get buffer(){return this._dataView.buffer}covers(e,t){return this.sliceOffset<=e&&this.sliceTop>=e+t}readUint8(e){return this._dataView.getUint8(e-this._sliceOffset,this._littleEndian)}readInt8(e){return this._dataView.getInt8(e-this._sliceOffset,this._littleEndian)}readUint16(e){return this._dataView.getUint16(e-this._sliceOffset,this._littleEndian)}readInt16(e){return this._dataView.getInt16(e-this._sliceOffset,this._littleEndian)}readUint32(e){return this._dataView.getUint32(e-this._sliceOffset,this._littleEndian)}readInt32(e){return this._dataView.getInt32(e-this._sliceOffset,this._littleEndian)}readFloat32(e){return this._dataView.getFloat32(e-this._sliceOffset,this._littleEndian)}readFloat64(e){return this._dataView.getFloat64(e-this._sliceOffset,this._littleEndian)}readUint64(e){const t=this.readUint32(e),n=this.readUint32(e+4);let i;if(this._littleEndian){if(i=t+2**32*n,!Number.isSafeInteger(i))throw new Error(`${i} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return i}if(i=2**32*t+n,!Number.isSafeInteger(i))throw new Error(`${i} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return i}readInt64(e){let t=0;const n=(this._dataView.getUint8(e+(this._littleEndian?7:0))&128)>0;let i=!0;for(let a=0;a<8;a++){let u=this._dataView.getUint8(e+(this._littleEndian?a:7-a));n&&(i?u!==0&&(u=~(u-1)&255,i=!1):u=~u&255),t+=u*256**a}return n&&(t=-t),t}readOffset(e){return this._bigTiff?this.readUint64(e):this.readUint32(e)}}const _S=typeof navigator!="undefined"&&navigator.hardwareConcurrency||2;class vS{constructor(e=_S,t){this.workers=null,this._awaitingDecoder=null,this.size=e,this.messageId=0,e&&(this._awaitingDecoder=t?Promise.resolve(t):new Promise(n=>{import("./decoder-0d3742f1.js").then(i=>{n(i.create)})}),this._awaitingDecoder.then(n=>{this._awaitingDecoder=null,this.workers=[];for(let i=0;i<e;i++)this.workers.push({worker:n(),idle:!0})}))}async decode(e,t){return this._awaitingDecoder&&await this._awaitingDecoder,this.size===0?pg(e).then(n=>n.decode(e,t)):new Promise(n=>{const i=this.workers.find(p=>p.idle)||this.workers[Math.floor(Math.random()*this.size)];i.idle=!1;const a=this.messageId++,u=p=>{p.data.id===a&&(i.idle=!0,n(p.data.decoded),i.worker.removeEventListener("message",u))};i.worker.addEventListener("message",u),i.worker.postMessage({fileDirectory:e,buffer:t,id:a},[t])})}destroy(){this.workers&&(this.workers.forEach(e=>{e.worker.terminate()}),this.workers=null)}}var yS=vS;const xd=`\r
\r
`;function _g(r){if(typeof Object.fromEntries!="undefined")return Object.fromEntries(r);const e={};for(const[t,n]of r)e[t.toLowerCase()]=n;return e}function mS(r){const e=r.split(`\r
`).map(t=>{const n=t.split(":").map(i=>i.trim());return n[0]=n[0].toLowerCase(),n});return _g(e)}function xS(r){const[e,...t]=r.split(";").map(i=>i.trim()),n=t.map(i=>i.split("="));return{type:e,params:_g(n)}}function xh(r){let e,t,n;return r&&([,e,t,n]=r.match(/bytes (\d+)-(\d+)\/(\d+)/),e=parseInt(e,10),t=parseInt(t,10),n=parseInt(n,10)),{start:e,end:t,total:n}}function bS(r,e){let t=null;const n=new TextDecoder("ascii"),i=[],a=`--${e}`,u=`${a}--`;for(let p=0;p<10;++p)n.decode(new Uint8Array(r,p,a.length))===a&&(t=p);if(t===null)throw new Error("Could not find initial boundary");for(;t<r.byteLength;){const p=n.decode(new Uint8Array(r,t,Math.min(a.length+1024,r.byteLength-t)));if(p.length===0||p.startsWith(u))break;if(!p.startsWith(a))throw new Error("Part does not start with boundary");const g=p.substr(a.length+2);if(g.length===0)break;const v=g.indexOf(xd),m=mS(g.substr(0,v)),{start:b,end:E,total:w}=xh(m["content-range"]),S=t+a.length+v+xd.length,O=parseInt(E,10)+1-parseInt(b,10);i.push({headers:m,data:r.slice(S,S+O),offset:b,length:O,fileSize:w}),t=S+O+4}return i}class vg{async fetch(e,t=void 0){return Promise.all(e.map(n=>this.fetchSlice(n,t)))}async fetchSlice(e){throw new Error(`fetching of slice ${e} not possible, not implemented`)}get fileSize(){return null}async close(){}}class ES extends Map{constructor(e={}){super();if(!(e.maxSize&&e.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");if(typeof e.maxAge=="number"&&e.maxAge===0)throw new TypeError("`maxAge` must be a number greater than 0");this.maxSize=e.maxSize,this.maxAge=e.maxAge||Number.POSITIVE_INFINITY,this.onEviction=e.onEviction,this.cache=new Map,this.oldCache=new Map,this._size=0}_emitEvictions(e){if(typeof this.onEviction=="function")for(const[t,n]of e)this.onEviction(t,n.value)}_deleteIfExpired(e,t){return typeof t.expiry=="number"&&t.expiry<=Date.now()?(typeof this.onEviction=="function"&&this.onEviction(e,t.value),this.delete(e)):!1}_getOrDeleteIfExpired(e,t){if(this._deleteIfExpired(e,t)===!1)return t.value}_getItemValue(e,t){return t.expiry?this._getOrDeleteIfExpired(e,t):t.value}_peek(e,t){const n=t.get(e);return this._getItemValue(e,n)}_set(e,t){this.cache.set(e,t),this._size++,this._size>=this.maxSize&&(this._size=0,this._emitEvictions(this.oldCache),this.oldCache=this.cache,this.cache=new Map)}_moveToRecent(e,t){this.oldCache.delete(e),this._set(e,t)}*_entriesAscending(){for(const e of this.oldCache){const[t,n]=e;this.cache.has(t)||this._deleteIfExpired(t,n)===!1&&(yield e)}for(const e of this.cache){const[t,n]=e;this._deleteIfExpired(t,n)===!1&&(yield e)}}get(e){if(this.cache.has(e)){const t=this.cache.get(e);return this._getItemValue(e,t)}if(this.oldCache.has(e)){const t=this.oldCache.get(e);if(this._deleteIfExpired(e,t)===!1)return this._moveToRecent(e,t),t.value}}set(e,t,{maxAge:n=this.maxAge}={}){const i=typeof n=="number"&&n!==Number.POSITIVE_INFINITY?Date.now()+n:void 0;this.cache.has(e)?this.cache.set(e,{value:t,expiry:i}):this._set(e,{value:t,expiry:i})}has(e){return this.cache.has(e)?!this._deleteIfExpired(e,this.cache.get(e)):this.oldCache.has(e)?!this._deleteIfExpired(e,this.oldCache.get(e)):!1}peek(e){if(this.cache.has(e))return this._peek(e,this.cache);if(this.oldCache.has(e))return this._peek(e,this.oldCache)}delete(e){const t=this.cache.delete(e);return t&&this._size--,this.oldCache.delete(e)||t}clear(){this.cache.clear(),this.oldCache.clear(),this._size=0}resize(e){if(!(e&&e>0))throw new TypeError("`maxSize` must be a number greater than 0");const t=[...this._entriesAscending()],n=t.length-e;n<0?(this.cache=new Map(t),this.oldCache=new Map,this._size=t.length):(n>0&&this._emitEvictions(t.slice(0,n)),this.oldCache=new Map(t.slice(n)),this.cache=new Map,this._size=0),this.maxSize=e}*keys(){for(const[e]of this)yield e}*values(){for(const[,e]of this)yield e}*[Symbol.iterator](){for(const e of this.cache){const[t,n]=e;this._deleteIfExpired(t,n)===!1&&(yield[t,n.value])}for(const e of this.oldCache){const[t,n]=e;this.cache.has(t)||this._deleteIfExpired(t,n)===!1&&(yield[t,n.value])}}*entriesDescending(){let e=[...this.cache];for(let t=e.length-1;t>=0;--t){const n=e[t],[i,a]=n;this._deleteIfExpired(i,a)===!1&&(yield[i,a.value])}e=[...this.oldCache];for(let t=e.length-1;t>=0;--t){const n=e[t],[i,a]=n;this.cache.has(i)||this._deleteIfExpired(i,a)===!1&&(yield[i,a.value])}}*entriesAscending(){for(const[e,t]of this._entriesAscending())yield[e,t.value]}get size(){if(!this._size)return this.oldCache.size;let e=0;for(const t of this.oldCache.keys())this.cache.has(t)||e++;return Math.min(this._size+e,this.maxSize)}entries(){return this.entriesAscending()}forEach(e,t=this){for(const[n,i]of this.entriesAscending())e.call(t,i,n,this)}get[Symbol.toStringTag](){return JSON.stringify([...this.entriesAscending()])}}async function TS(r){return new Promise(e=>setTimeout(e,r))}function wS(r,e){const t=Array.isArray(r)?r:Array.from(r),n=Array.isArray(e)?e:Array.from(e);return t.map((i,a)=>[i,n[a]])}class Pr extends Error{constructor(e){super(e);Error.captureStackTrace&&Error.captureStackTrace(this,Pr),this.name="AbortError"}}class SS extends Error{constructor(e,t){super(t);this.errors=e,this.message=t,this.name="AggregateError"}}const RS=SS;class CS{constructor(e,t,n=null){this.offset=e,this.length=t,this.data=n}get top(){return this.offset+this.length}}class bd{constructor(e,t,n){this.offset=e,this.length=t,this.blockIds=n}}class OS extends vg{constructor(e,{blockSize:t=65536,cacheSize:n=100}={}){super();this.source=e,this.blockSize=t,this.blockCache=new ES({maxSize:n}),this.blockRequests=new Map,this.blockIdsToFetch=new Set,this.abortedBlockIds=new Set}get fileSize(){return this.source.fileSize}async fetch(e,t){const n=[],i=[],a=[];for(const{offset:E,length:w}of e){let S=E+w;const{fileSize:O}=this;O!==null&&(S=Math.min(S,O));const I=Math.floor(E/this.blockSize)*this.blockSize;for(let M=I;M<S;M+=this.blockSize){const A=Math.floor(M/this.blockSize);!this.blockCache.has(A)&&!this.blockRequests.has(A)&&(this.blockIdsToFetch.add(A),i.push(A)),this.blockRequests.has(A)&&n.push(this.blockRequests.get(A)),a.push(A)}}await TS(),this.fetchBlocks(t);const u=[];for(const E of i)this.blockRequests.has(E)&&u.push(this.blockRequests.get(E));await Promise.allSettled(n),await Promise.allSettled(u);const p=[],g=a.filter(E=>this.abortedBlockIds.has(E)||!this.blockCache.has(E));if(g.forEach(E=>this.blockIdsToFetch.add(E)),g.length>0&&t&&!t.aborted){this.fetchBlocks(null);for(const E of g){const w=this.blockRequests.get(E);if(!w)throw new Error(`Block ${E} is not in the block requests`);p.push(w)}await Promise.allSettled(p)}if(t&&t.aborted)throw new Pr("Request was aborted");const v=a.map(E=>this.blockCache.get(E)),m=v.filter(E=>!E);if(m.length)throw new RS(m,"Request failed");const b=new Map(wS(a,v));return this.readSliceData(e,b)}fetchBlocks(e){if(this.blockIdsToFetch.size>0){const t=this.groupBlocks(this.blockIdsToFetch),n=this.source.fetch(t,e);for(let i=0;i<t.length;++i){const a=t[i];for(const u of a.blockIds)this.blockRequests.set(u,(async()=>{try{const p=(await n)[i],g=u*this.blockSize,v=g-p.offset,m=Math.min(v+this.blockSize,p.data.byteLength),b=p.data.slice(v,m),E=new CS(g,b.byteLength,b,u);this.blockCache.set(u,E),this.abortedBlockIds.delete(u)}catch(p){if(p.name==="AbortError")p.signal=e,this.blockCache.delete(u),this.abortedBlockIds.add(u);else throw p}finally{this.blockRequests.delete(u)}})())}this.blockIdsToFetch.clear()}}groupBlocks(e){const t=Array.from(e).sort((u,p)=>u-p);if(t.length===0)return[];let n=[],i=null;const a=[];for(const u of t)i===null||i+1===u?(n.push(u),i=u):(a.push(new bd(n[0]*this.blockSize,n.length*this.blockSize,n)),n=[u],i=u);return a.push(new bd(n[0]*this.blockSize,n.length*this.blockSize,n)),a}readSliceData(e,t){return e.map(n=>{let i=n.offset+n.length;this.fileSize!==null&&(i=Math.min(this.fileSize,i));const a=Math.floor(n.offset/this.blockSize),u=Math.floor(i/this.blockSize),p=new ArrayBuffer(n.length),g=new Uint8Array(p);for(let v=a;v<=u;++v){const m=t.get(v),b=m.offset-n.offset,E=m.top-i;let w=0,S=0,O;b<0?w=-b:b>0&&(S=b),E<0?O=m.length-w:O=i-m.offset-w;const I=new Uint8Array(m.data,w,O);g.set(I,S)}return p})}}class nc{get ok(){return this.status>=200&&this.status<=299}get status(){throw new Error("not implemented")}getHeader(e){throw new Error("not implemented")}async getData(){throw new Error("not implemented")}}class ic{constructor(e){this.url=e}async request({headers:e,credentials:t,signal:n}={}){throw new Error("request is not implemented")}}class IS extends nc{constructor(e){super();this.response=e}get status(){return this.response.status}getHeader(e){return this.response.headers.get(e)}async getData(){return this.response.arrayBuffer?await this.response.arrayBuffer():(await this.response.buffer()).buffer}}class AS extends ic{constructor(e,t){super(e);this.credentials=t}async request({headers:e,credentials:t,signal:n}={}){const i=await fetch(this.url,{headers:e,credentials:t,signal:n});return new IS(i)}}class PS extends nc{constructor(e,t){super();this.xhr=e,this.data=t}get status(){return this.xhr.status}getHeader(e){return this.xhr.getResponseHeader(e)}async getData(){return this.data}}class MS extends ic{constructRequest(e,t){return new Promise((n,i)=>{const a=new XMLHttpRequest;a.open("GET",this.url),a.responseType="arraybuffer";for(const[u,p]of Object.entries(e))a.setRequestHeader(u,p);a.onload=()=>{const u=a.response;n(new PS(a,u))},a.onerror=i,a.onabort=()=>i(new Pr("Request aborted")),a.send(),t&&(t.aborted&&a.abort(),t.addEventListener("abort",()=>a.abort()))})}async request({headers:e,signal:t}={}){return await this.constructRequest(e,t)}}var eh={};class LS extends nc{constructor(e,t){super();this.response=e,this.dataPromise=t}get status(){return this.response.statusCode}getHeader(e){return this.response.headers[e]}async getData(){return await this.dataPromise}}class DS extends ic{constructor(e){super(e);this.parsedUrl=eh.parse(this.url),this.httpApi=(this.parsedUrl.protocol==="http:",eh)}constructRequest(e,t){return new Promise((n,i)=>{const a=this.httpApi.get(Zn(On({},this.parsedUrl),{headers:e}),u=>{const p=new Promise(g=>{const v=[];u.on("data",m=>{v.push(m)}),u.on("end",()=>{const m=Buffer.concat(v).buffer;g(m)}),u.on("error",i)});n(new LS(u,p))});a.on("error",i),t&&(t.aborted&&a.destroy(new Pr("Request aborted")),t.addEventListener("abort",()=>a.destroy(new Pr("Request aborted"))))})}async request({headers:e,signal:t}={}){return await this.constructRequest(e,t)}}class rc extends vg{constructor(e,t,n,i){super();this.client=e,this.headers=t,this.maxRanges=n,this.allowFullFile=i,this._fileSize=null}async fetch(e,t){return this.maxRanges>=e.length?this.fetchSlices(e,t):(this.maxRanges>0&&e.length>1,Promise.all(e.map(n=>this.fetchSlice(n,t))))}async fetchSlices(e,t){const n=await this.client.request({headers:Zn(On({},this.headers),{Range:`bytes=${e.map(({offset:i,length:a})=>`${i}-${i+a}`).join(",")}`}),signal:t});if(n.ok)if(n.status===206){const{type:i,params:a}=xS(n.getHeader("content-type"));if(i==="multipart/byteranges"){const b=bS(await n.getData(),a.boundary);return this._fileSize=b[0].fileSize||null,b}const u=await n.getData(),{start:p,end:g,total:v}=xh(n.getHeader("content-range"));this._fileSize=v||null;const m=[{data:u,offset:p,length:g-p}];if(e.length>1){const b=await Promise.all(e.slice(1).map(E=>this.fetchSlice(E,t)));return m.concat(b)}return m}else{if(!this.allowFullFile)throw new Error("Server responded with full file");const i=await n.getData();return this._fileSize=i.byteLength,[{data:i,offset:0,length:i.byteLength}]}else throw new Error("Error fetching data.")}async fetchSlice(e,t){const{offset:n,length:i}=e,a=await this.client.request({headers:Zn(On({},this.headers),{Range:`bytes=${n}-${n+i}`}),signal:t});if(a.ok)if(a.status===206){const u=await a.getData(),{total:p}=xh(a.getHeader("content-range"));return this._fileSize=p||null,{data:u,offset:n,length:i}}else{if(!this.allowFullFile)throw new Error("Server responded with full file");const u=await a.getData();return this._fileSize=u.byteLength,{data:u,offset:0,length:u.byteLength}}else throw new Error("Error fetching data.")}get fileSize(){return this._fileSize}}function oc(r,{blockSize:e,cacheSize:t}){return e===null?r:new OS(r,{blockSize:e,cacheSize:t})}function kS(r,u={}){var p=u,{headers:e={},credentials:t,maxRanges:n=0,allowFullFile:i=!1}=p,a=fo(p,["headers","credentials","maxRanges","allowFullFile"]);const g=new AS(r,t),v=new rc(g,e,n,i);return oc(v,a)}function FS(r,a={}){var u=a,{headers:e={},maxRanges:t=0,allowFullFile:n=!1}=u,i=fo(u,["headers","maxRanges","allowFullFile"]);const p=new MS(r),g=new rc(p,e,t,n);return oc(g,i)}function NS(r,a={}){var u=a,{headers:e={},maxRanges:t=0,allowFullFile:n=!1}=u,i=fo(u,["headers","maxRanges","allowFullFile"]);const p=new DS(r),g=new rc(p,e,t,n);return oc(g,i)}function bh(r,n={}){var i=n,{forceXHR:e=!1}=i,t=fo(i,["forceXHR"]);return typeof fetch=="function"&&!e?kS(r,t):typeof XMLHttpRequest!="undefined"?FS(r,t):NS(r,t)}function Eh(r){switch(r){case yt.BYTE:case yt.ASCII:case yt.SBYTE:case yt.UNDEFINED:return 1;case yt.SHORT:case yt.SSHORT:return 2;case yt.LONG:case yt.SLONG:case yt.FLOAT:case yt.IFD:return 4;case yt.RATIONAL:case yt.SRATIONAL:case yt.DOUBLE:case yt.LONG8:case yt.SLONG8:case yt.IFD8:return 8;default:throw new RangeError(`Invalid field type: ${r}`)}}function BS(r){const e=r.GeoKeyDirectory;if(!e)return null;const t={};for(let n=4;n<=e[3]*4;n+=4){const i=Hs[e[n]],a=e[n+1]?Co[e[n+1]]:null,u=e[n+2],p=e[n+3];let g=null;if(!a)g=p;else{if(g=r[a],typeof g=="undefined"||g===null)throw new Error(`Could not get value of geoKey '${i}'.`);typeof g=="string"?g=g.substring(p,p+u-1):g.subarray&&(g=g.subarray(p,p+u),u===1&&(g=g[0]))}t[i]=g}return t}function _r(r,e,t,n){let i=null,a=null;const u=Eh(e);switch(e){case yt.BYTE:case yt.ASCII:case yt.UNDEFINED:i=new Uint8Array(t),a=r.readUint8;break;case yt.SBYTE:i=new Int8Array(t),a=r.readInt8;break;case yt.SHORT:i=new Uint16Array(t),a=r.readUint16;break;case yt.SSHORT:i=new Int16Array(t),a=r.readInt16;break;case yt.LONG:case yt.IFD:i=new Uint32Array(t),a=r.readUint32;break;case yt.SLONG:i=new Int32Array(t),a=r.readInt32;break;case yt.LONG8:case yt.IFD8:i=new Array(t),a=r.readUint64;break;case yt.SLONG8:i=new Array(t),a=r.readInt64;break;case yt.RATIONAL:i=new Uint32Array(t*2),a=r.readUint32;break;case yt.SRATIONAL:i=new Int32Array(t*2),a=r.readInt32;break;case yt.FLOAT:i=new Float32Array(t),a=r.readFloat32;break;case yt.DOUBLE:i=new Float64Array(t),a=r.readFloat64;break;default:throw new RangeError(`Invalid field type: ${e}`)}if(e===yt.RATIONAL||e===yt.SRATIONAL)for(let p=0;p<t;p+=2)i[p]=a.call(r,n+p*u),i[p+1]=a.call(r,n+(p*u+4));else for(let p=0;p<t;++p)i[p]=a.call(r,n+p*u);return e===yt.ASCII?new TextDecoder("utf-8").decode(i):i}class GS{constructor(e,t,n){this.fileDirectory=e,this.geoKeyDirectory=t,this.nextIFDByteOffset=n}}class Fs extends Error{constructor(e){super(`No image at index ${e}`);this.index=e}}class yg{async readRasters(e={}){const{window:t,width:n,height:i}=e;let{resX:a,resY:u,bbox:p}=e;const g=await this.getImage();let v=g;const m=await this.getImageCount(),b=g.getBoundingBox();if(t&&p)throw new Error('Both "bbox" and "window" passed.');if(n||i){if(t){const[S,O]=g.getOrigin(),[I,M]=g.getResolution();p=[S+t[0]*I,O+t[1]*M,S+t[2]*I,O+t[3]*M]}const w=p||b;if(n){if(a)throw new Error("Both width and resX passed");a=(w[2]-w[0])/n}if(i){if(u)throw new Error("Both width and resY passed");u=(w[3]-w[1])/i}}if(a||u){const w=[];for(let S=0;S<m;++S){const O=await this.getImage(S),{SubfileType:I,NewSubfileType:M}=O.fileDirectory;(S===0||I===2||M&1)&&w.push(O)}w.sort((S,O)=>S.getWidth()-O.getWidth());for(let S=0;S<w.length;++S){const O=w[S],I=(b[2]-b[0])/O.getWidth(),M=(b[3]-b[1])/O.getHeight();if(v=O,a&&a>I||u&&u>M)break}}let E=t;if(p){const[w,S]=g.getOrigin(),[O,I]=v.getResolution(g);E=[Math.round((p[0]-w)/O),Math.round((p[1]-S)/I),Math.round((p[2]-w)/O),Math.round((p[3]-S)/I)],E=[Math.min(E[0],E[2]),Math.min(E[1],E[3]),Math.max(E[0],E[2]),Math.max(E[1],E[3])]}return v.readRasters(Zn(On({},e),{window:E}))}}class Fo extends yg{constructor(e,t,n,i,a={}){super();this.source=e,this.littleEndian=t,this.bigTiff=n,this.firstIFDOffset=i,this.cache=a.cache||!1,this.ifdRequests=[],this.ghostValues=null}async getSlice(e,t){const n=this.bigTiff?4048:1024;return new gS((await this.source.fetch([{offset:e,length:typeof t!="undefined"?t:n}]))[0],e,this.littleEndian,this.bigTiff)}async parseFileDirectoryAt(e){const t=this.bigTiff?20:12,n=this.bigTiff?8:2;let i=await this.getSlice(e);const a=this.bigTiff?i.readUint64(e):i.readUint16(e),u=a*t+(this.bigTiff?16:6);i.covers(e,u)||(i=await this.getSlice(e,u));const p={};let g=e+(this.bigTiff?8:2);for(let b=0;b<a;g+=t,++b){const E=i.readUint16(g),w=i.readUint16(g+2),S=this.bigTiff?i.readUint64(g+4):i.readUint32(g+4);let O,I;const M=Eh(w),A=g+(this.bigTiff?12:8);if(M*S<=(this.bigTiff?8:4))O=_r(i,w,S,A);else{const k=i.readOffset(A),L=Eh(w)*S;if(i.covers(k,L))O=_r(i,w,S,k);else{const B=await this.getSlice(k,L);O=_r(B,w,S,k)}}S===1&&Hw.indexOf(E)===-1&&!(w===yt.RATIONAL||w===yt.SRATIONAL)?I=O[0]:I=O,p[Co[E]]=I}const v=BS(p),m=i.readOffset(e+n+t*a);return new GS(p,v,m)}async requestIFD(e){if(this.ifdRequests[e])return this.ifdRequests[e];if(e===0)return this.ifdRequests[e]=this.parseFileDirectoryAt(this.firstIFDOffset),this.ifdRequests[e];if(!this.ifdRequests[e-1])try{this.ifdRequests[e-1]=this.requestIFD(e-1)}catch(t){throw t instanceof Fs?new Fs(e):t}return this.ifdRequests[e]=(async()=>{const t=await this.ifdRequests[e-1];if(t.nextIFDByteOffset===0)throw new Fs(e);return this.parseFileDirectoryAt(t.nextIFDByteOffset)})(),this.ifdRequests[e]}async getImage(e=0){const t=await this.requestIFD(e);return new gg(t.fileDirectory,t.geoKeyDirectory,this.dataView,this.littleEndian,this.cache,this.source)}async getImageCount(){let e=0,t=!0;for(;t;)try{await this.requestIFD(e),++e}catch(n){if(n instanceof Fs)t=!1;else throw n}return e}async getGhostValues(){const e=this.bigTiff?16:8;if(this.ghostValues)return this.ghostValues;const t="GDAL_STRUCTURAL_METADATA_SIZE=",n=t.length+100;let i=await this.getSlice(e,n);if(t===_r(i,yt.ASCII,t.length,e)){const u=_r(i,yt.ASCII,n,e).split(`
`)[0],p=Number(u.split("=")[1].split(" ")[0])+u.length;p>n&&(i=await this.getSlice(e,p));const g=_r(i,yt.ASCII,p,e);this.ghostValues={},g.split(`
`).filter(v=>v.length>0).map(v=>v.split("=")).forEach(([v,m])=>{this.ghostValues[v]=m})}return this.ghostValues}static async fromSource(e,t,n){const i=(await e.fetch([{offset:0,length:1024}],n))[0],a=new pS(i),u=a.getUint16(0,0);let p;if(u===18761)p=!0;else if(u===19789)p=!1;else throw new TypeError("Invalid byte order value.");const g=a.getUint16(2,p);let v;if(g===42)v=!1;else if(g===43){if(v=!0,a.getUint16(4,p)!==8)throw new Error("Unsupported offset byte-size.")}else throw new TypeError("Invalid magic number.");const m=v?a.getUint64(8,p):a.getUint32(4,p);return new Fo(e,p,v,m,t)}close(){return typeof this.source.close=="function"?this.source.close():!1}}class zS extends yg{constructor(e,t){super();this.mainFile=e,this.overviewFiles=t,this.imageFiles=[e].concat(t),this.fileDirectoriesPerFile=null,this.fileDirectoriesPerFileParsing=null,this.imageCount=null}async parseFileDirectoriesPerFile(){const e=[this.mainFile.parseFileDirectoryAt(this.mainFile.firstIFDOffset)].concat(this.overviewFiles.map(t=>t.parseFileDirectoryAt(t.firstIFDOffset)));return this.fileDirectoriesPerFile=await Promise.all(e),this.fileDirectoriesPerFile}async getImage(e=0){await this.getImageCount(),await this.parseFileDirectoriesPerFile();let t=0,n=0;for(let i=0;i<this.imageFiles.length;i++){const a=this.imageFiles[i];for(let u=0;u<this.imageCounts[i];u++){if(e===t){const p=await a.requestIFD(n);return new gg(p.fileDirectory,p.geoKeyDirectory,a.dataView,a.littleEndian,a.cache,a.source)}t++,n++}n=0}throw new RangeError("Invalid image index")}async getImageCount(){if(this.imageCount!==null)return this.imageCount;const e=[this.mainFile.getImageCount()].concat(this.overviewFiles.map(t=>t.getImageCount()));return this.imageCounts=await Promise.all(e),this.imageCount=this.imageCounts.reduce((t,n)=>t+n,0),this.imageCount}}async function US(r,e={},t){return Fo.fromSource(bh(r,e),t)}async function VS(r,e=[],t={},n){const i=await Fo.fromSource(bh(r,t),n),a=await Promise.all(e.map(u=>Fo.fromSource(bh(u,t))));return new zS(i,a)}var XS=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Ed="STATISTICS_MAXIMUM",Td="STATISTICS_MINIMUM",nh;function jS(){return nh||(nh=new yS),nh}function WS(r){try{return r.getBoundingBox()}catch{var e=r.fileDirectory;return[0,0,e.ImageWidth,e.ImageLength]}}function HS(r){try{return r.getOrigin().slice(0,2)}catch{return[0,r.fileDirectory.ImageLength]}}function YS(r,e){try{return r.getResolution(e)[0]}catch{return e.fileDirectory.ImageWidth/r.fileDirectory.ImageWidth}}function $S(r){var e=r.geoKeys;if(!e)return null;if(e.ProjectedCSTypeGeoKey){var t="EPSG:"+e.ProjectedCSTypeGeoKey,n=Je(t);if(!n){var i=yf(e.ProjLinearUnitsGeoKey);i&&(n=new Qs({code:t,units:i}))}return n}if(e.GeographicTypeGeoKey){var t="EPSG:"+e.GeographicTypeGeoKey,n=Je(t);if(!n){var i=yf(e.GeogAngularUnitsGeoKey);i&&(n=new Qs({code:t,units:i}))}return n}return null}function KS(r){return r.getImageCount().then(function(e){for(var t=new Array(e),n=0;n<e;++n)t[n]=r.getImage(n);return Promise.all(t)})}function ZS(r,e){var t;return r.overviews?t=VS(r.url,r.overviews,e):t=US(r.url,e),t.then(KS)}function Ys(r,e,t,n,i){if(Array.isArray(r)){var a=r.length;if(!Array.isArray(e)||a!=e.length){var u=new Error(n);throw i(u),u}for(var p=0;p<a;++p)Ys(r[p],e[p],t,n,i);return}if(e=e,Math.abs(r-e)>t*r)throw new Error(n)}function qS(r){return r instanceof Int8Array?-128:r instanceof Int16Array?-32768:r instanceof Int32Array?-2147483648:r instanceof Float32Array?12e-39:0}function JS(r){return r instanceof Int8Array?127:r instanceof Uint8Array||r instanceof Uint8ClampedArray?255:r instanceof Int16Array?32767:r instanceof Uint16Array?65535:r instanceof Int32Array?2147483647:r instanceof Uint32Array?4294967295:r instanceof Float32Array?34e37:255}var mg=function(r){XS(e,r);function e(t){var n=r.call(this,{state:Oe.LOADING,tileGrid:null,projection:null,opaque:t.opaque,transition:t.transition,interpolate:t.interpolate!==!1,wrapX:t.wrapX})||this;n.sourceInfo_=t.sources;var i=n.sourceInfo_.length;n.sourceOptions_=t.sourceOptions,n.sourceImagery_=new Array(i),n.resolutionFactors_=new Array(i),n.samplesPerPixel_,n.nodataValues_,n.metadata_,n.normalize_=t.normalize!==!1,n.addAlpha_=!1,n.error_=null,n.readMethod_=t.convertToRGB?"readRGB":"readRasters",n.setKey(n.sourceInfo_.map(function(g){return g.url}).join(","));for(var a=n,u=new Array(i),p=0;p<i;++p)u[p]=ZS(n.sourceInfo_[p],n.sourceOptions_);return Promise.all(u).then(function(g){a.configure_(g)}).catch(function(g){console.error(g),a.error_=g,a.setState(Oe.ERROR)}),n}return e.prototype.getError=function(){return this.error_},e.prototype.configure_=function(t){for(var n,i,a,u,p=new Array(t.length),g=new Array(t.length),v=new Array(t.length),m=0,b=t.length,E=function(H){var et=t[H],X=et.length,j=void 0,J=void 0,Q=new Array(X),tt=new Array(X);g[H]=new Array(X),v[H]=new Array(X);for(var rt=0;rt<X;++rt){var at=et[rt],ht=at.getGDALNoData();v[H][rt]=at.getGDALMetadata(0),g[H][rt]=ht===null?NaN:ht;var ut=w.sourceInfo_[H].bands;p[H]=ut?ut.length:at.getSamplesPerPixel();var wt=X-(rt+1);j||(j=WS(at)),J||(J=HS(at)),tt[wt]=YS(at,et[0]),Q[wt]=[at.getTileWidth(),at.getTileHeight()]}if(n?ji(n,j,n):n=j,!i)i=J;else{var Y="Origin mismatch for source ".concat(H,", got [").concat(J,"] but expected [").concat(i,"]");Ys(i,J,0,Y,w.viewRejector)}if(!u)u=tt,w.resolutionFactors_[H]=1;else{u.length-m>tt.length&&(m=u.length-tt.length);var Yt=u[u.length-1]/tt[tt.length-1];w.resolutionFactors_[H]=Yt;var zt=tt.map(function(te){return te*=Yt}),Y="Resolution mismatch for source ".concat(H,", got [").concat(zt,"] but expected [").concat(u,"]");Ys(u.slice(m,u.length),zt,.02,Y,w.viewRejector)}a?Ys(a.slice(m,a.length),Q,0,"Tile size mismatch for source ".concat(H),w.viewRejector):a=Q,w.sourceImagery_[H]=et.reverse()},w=this,S=0;S<b;++S)E(S);for(var O=0,I=this.sourceImagery_.length;O<I;++O)for(var M=this.sourceImagery_[O];M.length<u.length;)M.unshift(void 0);if(!this.getProjection())for(var A=t[0],O=A.length-1;O>=0;--O){var k=A[O],L=$S(k);if(L){this.projection=L;break}}this.samplesPerPixel_=p,this.nodataValues_=g,this.metadata_=v;t:for(var S=0;S<b;++S){if(this.sourceInfo_[S].nodata!==void 0){this.addAlpha_=!0;break}var B=g[S],G=this.sourceInfo_[S].bands;if(G){for(var O=0;O<G.length;++O)if(!isNaN(B[G[O]-1])){this.addAlpha_=!0;break t}continue}for(var V=0;V<B.length;++V)if(!isNaN(B[V])){this.addAlpha_=!0;break t}}var U=this.addAlpha_?1:0;this.bandCount=p.reduce(function(H,et){return H+=et,H},0)+U;var K=new Vh({extent:n,minZoom:m,origin:i,resolutions:u,tileSizes:a});this.tileGrid=K,this.setLoader(this.loadTile_.bind(this)),this.setState(Oe.READY),this.viewResolver({projection:this.projection,resolutions:u,center:ia($i(n),this.projection),extent:Mh(n,this.projection),zoom:0})},e.prototype.loadTile_=function(t,n,i){for(var a=Ge(this.tileGrid.getTileSize(t)),u=this.sourceImagery_.length,p=new Array(u),g=this.addAlpha_,v=this.bandCount,m=this.samplesPerPixel_,b=this.nodataValues_,E=this.sourceInfo_,w=function(L){var B=E[L],G=S.resolutionFactors_[L],V=[Math.round(n*(a[0]*G)),Math.round(i*(a[1]*G)),Math.round((n+1)*(a[0]*G)),Math.round((i+1)*(a[1]*G))],U=S.sourceImagery_[L][t],K=void 0;B.bands&&(K=B.bands.map(function(et){return et-1}));var H=void 0;isNaN(B.nodata)?K?H=K.map(function(et){return b[L][et]}):H=b[L]:H=B.nodata,p[L]=U[S.readMethod_]({window:V,width:a[0],height:a[1],samples:K,fillValue:H,pool:jS(),interleave:!1})},S=this,O=0;O<u;++O)w(O);var I=a[0]*a[1],M=I*v,A=this.normalize_,k=this.metadata_;return Promise.all(p).then(function(L){var B;A?B=new Uint8Array(M):B=new Float32Array(M);for(var G=0,V=0;V<I;++V){for(var U=g,K=0;K<u;++K){var H=E[K],et=H.min,X=H.max,j=void 0,J=void 0;if(A){var Q=k[K][0];et===void 0&&(Q&&Td in Q?et=parseFloat(Q[Td]):et=qS(L[K][0])),X===void 0&&(Q&&Ed in Q?X=parseFloat(Q[Ed]):X=JS(L[K][0])),j=255/(X-et),J=-et*j}for(var tt=0;tt<m[K];++tt){var rt=L[K][tt][V],at=void 0;if(A?at=se(j*rt+J,0,255):at=rt,!g)B[G]=at;else{var ht=H.nodata;if(ht===void 0){var ut=void 0;H.bands?ut=H.bands[tt]-1:ut=tt,ht=b[K][ut]}rt!==ht&&(U=!1,B[G]=at)}G++}}g&&(U||(B[G]=255),G++)}return B})},e}(pw);mg.prototype.getView;var QS=mg;function wd(r,e,t){const n=r.slice();return n[6]=e[t],n}function Sd(r){let e,t=r[6]+"",n,i,a,u;function p(){return r[4](r[6])}return{c(){e=ie("button"),n=Ni(t),this.h()},l(g){e=re(g,"BUTTON",{class:!0});var v=_e(e);n=Bi(v,t),v.forEach(Mt),this.h()},h(){St(e,"class",i=`${Tr(r[2],r[0]===r[6])} button-base border-t border-b border-r`)},m(g,v){Le(g,e,v),Ut(e,n),a||(u=Ln(e,"click",p),a=!0)},p(g,v){r=g,v&2&&t!==(t=r[6]+"")&&sh(n,t),v&7&&i!==(i=`${Tr(r[2],r[0]===r[6])} button-base border-t border-b border-r`)&&St(e,"class",i)},d(g){g&&Mt(e),a=!1,u()}}}function tR(r){let e,t,n=r[1][0]+"",i,a,u,p,g,v=r[1][r[1].length-1]+"",m,b,E,w,S=r[1].slice(1,-1),O=[];for(let I=0;I<S.length;I+=1)O[I]=Sd(wd(r,S,I));return{c(){e=ie("div"),t=ie("button"),i=Ni(n),u=De();for(let I=0;I<O.length;I+=1)O[I].c();p=De(),g=ie("button"),m=Ni(v),this.h()},l(I){e=re(I,"DIV",{class:!0,role:!0});var M=_e(e);t=re(M,"BUTTON",{class:!0});var A=_e(t);i=Bi(A,n),A.forEach(Mt),u=ke(M);for(let L=0;L<O.length;L+=1)O[L].l(M);p=ke(M),g=re(M,"BUTTON",{class:!0});var k=_e(g);m=Bi(k,v),k.forEach(Mt),M.forEach(Mt),this.h()},h(){St(t,"class",a=`${Tr(r[2],r[0]===r[1][0])} button-base rounded-l-lg border`),St(g,"class",b=`${Tr(r[2],r[0]===r[1][r[1].length-1])} button-base rounded-r-lg border-t border-b border-r`),St(e,"class","inline-flex flex-wrap rounded-md shadow-sm"),St(e,"role","group")},m(I,M){Le(I,e,M),Ut(e,t),Ut(t,i),Ut(e,u);for(let A=0;A<O.length;A+=1)O[A].m(e,null);Ut(e,p),Ut(e,g),Ut(g,m),E||(w=[Ln(t,"click",r[3]),Ln(g,"click",r[5])],E=!0)},p(I,[M]){if(M&2&&n!==(n=I[1][0]+"")&&sh(i,n),M&7&&a!==(a=`${Tr(I[2],I[0]===I[1][0])} button-base rounded-l-lg border`)&&St(t,"class",a),M&7){S=I[1].slice(1,-1);let A;for(A=0;A<S.length;A+=1){const k=wd(I,S,A);O[A]?O[A].p(k,M):(O[A]=Sd(k),O[A].c(),O[A].m(e,p))}for(;A<O.length;A+=1)O[A].d(1);O.length=S.length}M&2&&v!==(v=I[1][I[1].length-1]+"")&&sh(m,v),M&7&&b!==(b=`${Tr(I[2],I[0]===I[1][I[1].length-1])} button-base rounded-r-lg border-t border-b border-r`)&&St(g,"class",b)},i:ce,o:ce,d(I){I&&Mt(e),nm(O,I),E=!1,Od(w)}}}function Tr(r,e){switch(r){case"blue":return`border-blue-700/50 ${e?"bg-blue-700 hover:bg-blue-600":"bg-blue-900/50 hover:bg-blue-800 active:bg-blue-700"}`;case"green":return`border-green-700/50 ${e?"bg-green-700 hover:bg-green-700":"bg-green-900/50 hover:bg-green-800 active:bg-green-700"}`;case"red":return`border-red-700/50 ${e?"bg-red-800 hover:bg-red-700 active:bg-red-600":"bg-red-900/50 hover:bg-red-800 active:bg-red-700"}`;case"slate":return`border-slate-700/50 ${e?"bg-slate-700 hover:bg-slate-700":"bg-slate-900/50 hover:bg-slate-800 active:bg-slate-700"}`;default:console.error("Incorrect color")}}function eR(r,e,t){let{names:n}=e,{color:i}=e,{curr:a}=e;const u=()=>t(0,a=n[0]),p=v=>t(0,a=v),g=()=>t(0,a=n[n.length-1]);return r.$$set=v=>{"names"in v&&t(1,n=v.names),"color"in v&&t(2,i=v.color),"curr"in v&&t(0,a=v.curr)},[a,n,i,u,p,g]}class $s extends Mr{constructor(e){super();Lr(this,e,eR,tR,Dr,{names:1,color:2,curr:0})}}const Xi=om({lockedIdx:-1,currIdx:0});function nR(r){let e,t,n,i,a,u,p,g,v,m,b,E,w,S,O,I,M,A,k,L,B,G;function V(j){r[11](j)}let U={names:r[2],color:"blue"};r[1][0]!==void 0&&(U.curr=r[1][0]),n=new $s({props:U}),Bs.push(()=>Gs(n,"curr",V));function K(j){r[12](j)}let H={names:r[2],color:"green"};r[1][1]!==void 0&&(H.curr=r[1][1]),u=new $s({props:H}),Bs.push(()=>Gs(u,"curr",K));function et(j){r[13](j)}let X={names:r[2],color:"red"};return r[1][2]!==void 0&&(X.curr=r[1][2]),v=new $s({props:X}),Bs.push(()=>Gs(v,"curr",et)),{c(){e=ie("div"),t=ie("div"),si(n.$$.fragment),a=De(),si(u.$$.fragment),g=De(),si(v.$$.fragment),b=De(),E=ie("div"),w=ie("input"),S=De(),O=ie("input"),I=De(),M=ie("input"),A=De(),k=ie("div"),this.h()},l(j){e=re(j,"DIV",{class:!0});var J=_e(e);t=re(J,"DIV",{class:!0});var Q=_e(t);ai(n.$$.fragment,Q),a=ke(Q),ai(u.$$.fragment,Q),g=ke(Q),ai(v.$$.fragment,Q),Q.forEach(Mt),b=ke(J),E=re(J,"DIV",{class:!0});var tt=_e(E);w=re(tt,"INPUT",{type:!0,min:!0,max:!0,class:!0}),S=ke(tt),O=re(tt,"INPUT",{type:!0,min:!0,max:!0,class:!0}),I=ke(tt),M=re(tt,"INPUT",{type:!0,min:!0,max:!0,class:!0}),tt.forEach(Mt),A=ke(J),k=re(J,"DIV",{id:!0,class:!0});var rt=_e(k);rt.forEach(Mt),J.forEach(Mt),this.h()},h(){St(t,"class","flex flex-col"),St(w,"type","range"),St(w,"min","0"),St(w,"max","254"),St(w,"class",""),St(O,"type","range"),St(O,"min","0"),St(O,"max","254"),St(O,"class",""),St(M,"type","range"),St(M,"min","0"),St(M,"max","254"),St(M,"class",""),St(E,"class","grid max-w-[600px] grid-cols-3 gap-x-4"),St(k,"id","map"),St(k,"class","relative h-[600px] max-w-[600px] shadow-lg"),St(e,"class","flex flex-grow flex-col gap-y-6")},m(j,J){Le(j,e,J),Ut(e,t),li(n,t,null),Ut(t,a),li(u,t,null),Ut(t,g),li(v,t,null),Ut(e,b),Ut(e,E),Ut(E,w),ur(w,r[0][0]),Ut(E,S),Ut(E,O),ur(O,r[0][1]),Ut(E,I),Ut(E,M),ur(M,r[0][2]),Ut(e,A),Ut(e,k),L=!0,B||(G=[Ln(w,"change",r[14]),Ln(w,"input",r[14]),Ln(O,"change",r[15]),Ln(O,"input",r[15]),Ln(M,"change",r[16]),Ln(M,"input",r[16])],B=!0)},p(j,[J]){const Q={};!i&&J&2&&(i=!0,Q.curr=j[1][0],zs(()=>i=!1)),n.$set(Q);const tt={};!p&&J&2&&(p=!0,tt.curr=j[1][1],zs(()=>p=!1)),u.$set(tt);const rt={};!m&&J&2&&(m=!0,rt.curr=j[1][2],zs(()=>m=!1)),v.$set(rt),J&1&&ur(w,j[0][0]),J&1&&ur(O,j[0][1]),J&1&&ur(M,j[0][2])},i(j){L||(Dn(n.$$.fragment,j),Dn(u.$$.fragment,j),Dn(v.$$.fragment,j),L=!0)},o(j){kn(n.$$.fragment,j),kn(u.$$.fragment,j),kn(v.$$.fragment,j),L=!1},d(j){j&&Mt(e),hi(n),hi(u),hi(v),B=!1,Od(G)}}}function iR(r,e,t){let n;Th(r,Xi,X=>t(10,n=X));let{sample:i}=e,{dataPromise:a}=e,u,p,g,v,m=[100,100,100],b=["DAPI","TMEM119","Olig2"],E=0,w=!1;const S={DAPI:2,TMEM119:6,Olig2:5,GFAP:3,NeuN:4,Lipofuschin:1,None:7},O=Object.keys(S);function I(X,j){const J=O.length-1;return{blue:Math.min(S[X[0]],J),green:Math.min(S[X[1]],J),red:Math.min(S[X[2]],J),blueMax:255-j[0],greenMax:255-j[1],redMax:255-j[2],blueMask:S[X[0]]>J?0:1,greenMask:S[X[1]]>J?0:1,redMask:S[X[2]]>J?0:1}}const M=new vf({geometry:new If([14e3,6e3],130.75/2)});new Qf({source:new id({features:[M]}),style:new Dl({stroke:new Xs({color:"#eeeeee",width:1})})}),g=new QS({normalize:!1,sources:[{url:`https://chaichontat-host.s3.us-west-004.backblazeb2.com/libd-rotation/${i}/${i}_1.tif`},{url:`https://chaichontat-host.s3.us-west-004.backblazeb2.com/libd-rotation/${i}/${i}_2.tif`}]});const A=new Dl({stroke:new Xs({color:"#ffffff55",width:1}),fill:new op({color:"transparent"})}),k=new Dl({stroke:new Xs({color:"#ffffffff",width:1})}),L=new id({features:[]}),B=new Qf({minZoom:4,source:L,style:A});wh(()=>{a.then(({coords:X})=>(t(5,u=X),u.map(({x:j,y:J},Q)=>{const tt=new vf({geometry:new If([j,J],65.375)});return tt.setId(Q),tt}))).then(X=>L.addFeatures(X)).catch(console.error),t(6,p=new uw({style:{variables:I(b,m),color:["array",["*",["/",["band",["var","red"]],["var","redMax"]],["var","redMask"]],["*",["/",["band",["var","green"]],["var","greenMax"]],["var","greenMask"]],["*",["/",["band",["var","blue"]],["var","blueMax"]],["var","blueMask"]],1]},source:g})),t(7,v=new UT({target:"map",layers:[p,B],view:g.getView()})),v.on("pointermove",X=>{v.forEachFeatureAtPixel(X.pixel,j=>(Us(Xi,n.currIdx=j.getId(),n),t(9,w=!0),!0))})});function G(X){r.$$.not_equal(b[0],X)&&(b[0]=X,t(1,b))}function V(X){r.$$.not_equal(b[1],X)&&(b[1]=X,t(1,b))}function U(X){r.$$.not_equal(b[2],X)&&(b[2]=X,t(1,b))}function K(){m[0]=Pl(this.value),t(0,m)}function H(){m[1]=Pl(this.value),t(0,m)}function et(){m[2]=Pl(this.value),t(0,m)}return r.$$set=X=>{"sample"in X&&t(3,i=X.sample),"dataPromise"in X&&t(4,a=X.dataPromise)},r.$$.update=()=>{var X,j,J;if(r.$$.dirty&1280&&n.currIdx!==E&&((X=L.getFeatureById(E))==null||X.setStyle(A),(j=L.getFeatureById(n.currIdx))==null||j.setStyle(k),t(8,E=n.currIdx)),r.$$.dirty&67&&p&&p.updateStyleVariables(I(b,m)),r.$$.dirty&1696&&v&&u){let Q,tt;w?t(9,w=!1):(n.lockedIdx!==-1?({x:Q,y:tt}=u[n.lockedIdx],v.getView().animate({center:[Q,tt],duration:200,zoom:5})):({x:Q,y:tt}=u[n.currIdx],v.getView().animate({center:[Q,tt],duration:200,zoom:4.5})),(J=M.getGeometry())==null||J.setCenter([Q,tt]))}},[m,b,O,i,a,u,p,v,E,w,n,G,V,U,K,H,et]}class rR extends Mr{constructor(e){super();Lr(this,e,iR,nR,Dr,{sample:3,dataPromise:4})}}var xg={exports:{}};/*!
 * Chart.js v3.7.1
 * https://www.chartjs.org
 * (c) 2022 Chart.js Contributors
 * Released under the MIT License
 */(function(r,e){(function(t,n){r.exports=n()})(x1,function(){function t(l,o,s){return o+" "+l+"px "+s}const n=function(){return typeof window=="undefined"?function(l){return l()}:window.requestAnimationFrame}();function i(l,o,s){const h=s||(d=>Array.prototype.slice.call(d));let c=!1,f=[];return function(...d){f=h(d),c||(c=!0,n.call(window,()=>{c=!1,l.apply(o,f)}))}}function a(l,o){let s;return function(...h){return o?(clearTimeout(s),s=setTimeout(l,o,h)):l.apply(this,h),o}}const u=l=>l==="start"?"left":l==="end"?"right":"center",p=(l,o,s)=>l==="start"?o:l==="end"?s:(o+s)/2,g=(l,o,s,h)=>l===(h?"left":"right")?s:l==="center"?(o+s)/2:o;class v{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(o,s,h,c){const f=s.listeners[c],d=s.duration;f.forEach(_=>_({chart:o,initial:s.initial,numSteps:d,currentStep:Math.min(h-s.start,d)}))}_refresh(){this._request||(this._running=!0,this._request=n.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(o=Date.now()){let s=0;this._charts.forEach((h,c)=>{if(!h.running||!h.items.length)return;const f=h.items;let d=f.length-1,_=!1,y;for(;d>=0;--d)y=f[d],y._active?(y._total>h.duration&&(h.duration=y._total),y.tick(o),_=!0):(f[d]=f[f.length-1],f.pop());_&&(c.draw(),this._notify(c,h,o,"progress")),f.length||(h.running=!1,this._notify(c,h,o,"complete"),h.initial=!1),s+=f.length}),this._lastDate=o,s===0&&(this._running=!1)}_getAnims(o){const s=this._charts;let h=s.get(o);return h||(h={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},s.set(o,h)),h}listen(o,s,h){this._getAnims(o).listeners[s].push(h)}add(o,s){!s||!s.length||this._getAnims(o).items.push(...s)}has(o){return this._getAnims(o).items.length>0}start(o){const s=this._charts.get(o);!s||(s.running=!0,s.start=Date.now(),s.duration=s.items.reduce((h,c)=>Math.max(h,c._duration),0),this._refresh())}running(o){if(!this._running)return!1;const s=this._charts.get(o);return!(!s||!s.running||!s.items.length)}stop(o){const s=this._charts.get(o);if(!s||!s.items.length)return;const h=s.items;let c=h.length-1;for(;c>=0;--c)h[c].cancel();s.items=[],this._notify(o,s,Date.now(),"complete")}remove(o){return this._charts.delete(o)}}var m=new v;/*!
 * @kurkle/color v0.1.9
 * https://github.com/kurkle/color#readme
 * (c) 2020 Jukka Kurkela
 * Released under the MIT License
 */const b={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},E="0123456789ABCDEF",w=l=>E[l&15],S=l=>E[(l&240)>>4]+E[l&15],O=l=>(l&240)>>4===(l&15);function I(l){return O(l.r)&&O(l.g)&&O(l.b)&&O(l.a)}function M(l){var o=l.length,s;return l[0]==="#"&&(o===4||o===5?s={r:255&b[l[1]]*17,g:255&b[l[2]]*17,b:255&b[l[3]]*17,a:o===5?b[l[4]]*17:255}:(o===7||o===9)&&(s={r:b[l[1]]<<4|b[l[2]],g:b[l[3]]<<4|b[l[4]],b:b[l[5]]<<4|b[l[6]],a:o===9?b[l[7]]<<4|b[l[8]]:255})),s}function A(l){var o=I(l)?w:S;return l&&"#"+o(l.r)+o(l.g)+o(l.b)+(l.a<255?o(l.a):"")}function k(l){return l+.5|0}const L=(l,o,s)=>Math.max(Math.min(l,s),o);function B(l){return L(k(l*2.55),0,255)}function G(l){return L(k(l*255),0,255)}function V(l){return L(k(l/2.55)/100,0,1)}function U(l){return L(k(l*100),0,100)}const K=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function H(l){const o=K.exec(l);let s=255,h,c,f;if(!!o){if(o[7]!==h){const d=+o[7];s=255&(o[8]?B(d):d*255)}return h=+o[1],c=+o[3],f=+o[5],h=255&(o[2]?B(h):h),c=255&(o[4]?B(c):c),f=255&(o[6]?B(f):f),{r:h,g:c,b:f,a:s}}}function et(l){return l&&(l.a<255?`rgba(${l.r}, ${l.g}, ${l.b}, ${V(l.a)})`:`rgb(${l.r}, ${l.g}, ${l.b})`)}const X=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function j(l,o,s){const h=o*Math.min(s,1-s),c=(f,d=(f+l/30)%12)=>s-h*Math.max(Math.min(d-3,9-d,1),-1);return[c(0),c(8),c(4)]}function J(l,o,s){const h=(c,f=(c+l/60)%6)=>s-s*o*Math.max(Math.min(f,4-f,1),0);return[h(5),h(3),h(1)]}function Q(l,o,s){const h=j(l,1,.5);let c;for(o+s>1&&(c=1/(o+s),o*=c,s*=c),c=0;c<3;c++)h[c]*=1-o-s,h[c]+=o;return h}function tt(l){const s=l.r/255,h=l.g/255,c=l.b/255,f=Math.max(s,h,c),d=Math.min(s,h,c),_=(f+d)/2;let y,x,T;return f!==d&&(T=f-d,x=_>.5?T/(2-f-d):T/(f+d),y=f===s?(h-c)/T+(h<c?6:0):f===h?(c-s)/T+2:(s-h)/T+4,y=y*60+.5),[y|0,x||0,_]}function rt(l,o,s,h){return(Array.isArray(o)?l(o[0],o[1],o[2]):l(o,s,h)).map(G)}function at(l,o,s){return rt(j,l,o,s)}function ht(l,o,s){return rt(Q,l,o,s)}function ut(l,o,s){return rt(J,l,o,s)}function wt(l){return(l%360+360)%360}function Y(l){const o=X.exec(l);let s=255,h;if(!o)return;o[5]!==h&&(s=o[6]?B(+o[5]):G(+o[5]));const c=wt(+o[2]),f=+o[3]/100,d=+o[4]/100;return o[1]==="hwb"?h=ht(c,f,d):o[1]==="hsv"?h=ut(c,f,d):h=at(c,f,d),{r:h[0],g:h[1],b:h[2],a:s}}function Yt(l,o){var s=tt(l);s[0]=wt(s[0]+o),s=at(s),l.r=s[0],l.g=s[1],l.b=s[2]}function zt(l){if(!l)return;const o=tt(l),s=o[0],h=U(o[1]),c=U(o[2]);return l.a<255?`hsla(${s}, ${h}%, ${c}%, ${V(l.a)})`:`hsl(${s}, ${h}%, ${c}%)`}const Zt={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},te={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function Ue(){const l={},o=Object.keys(te),s=Object.keys(Zt);let h,c,f,d,_;for(h=0;h<o.length;h++){for(d=_=o[h],c=0;c<s.length;c++)f=s[c],_=_.replace(f,Zt[f]);f=parseInt(te[d],16),l[_]=[f>>16&255,f>>8&255,f&255]}return l}let ee;function ue(l){ee||(ee=Ue(),ee.transparent=[0,0,0,0]);const o=ee[l.toLowerCase()];return o&&{r:o[0],g:o[1],b:o[2],a:o.length===4?o[3]:255}}function wn(l,o,s){if(l){let h=tt(l);h[o]=Math.max(0,Math.min(h[o]+h[o]*s,o===0?360:1)),h=at(h),l.r=h[0],l.g=h[1],l.b=h[2]}}function qi(l,o){return l&&Object.assign(o||{},l)}function Bn(l){var o={r:0,g:0,b:0,a:255};return Array.isArray(l)?l.length>=3&&(o={r:l[0],g:l[1],b:l[2],a:255},l.length>3&&(o.a=G(l[3]))):(o=qi(l,{r:0,g:0,b:0,a:1}),o.a=G(o.a)),o}function pi(l){return l.charAt(0)==="r"?H(l):Y(l)}class He{constructor(o){if(o instanceof He)return o;const s=typeof o;let h;s==="object"?h=Bn(o):s==="string"&&(h=M(o)||ue(o)||pi(o)),this._rgb=h,this._valid=!!h}get valid(){return this._valid}get rgb(){var o=qi(this._rgb);return o&&(o.a=V(o.a)),o}set rgb(o){this._rgb=Bn(o)}rgbString(){return this._valid?et(this._rgb):this._rgb}hexString(){return this._valid?A(this._rgb):this._rgb}hslString(){return this._valid?zt(this._rgb):this._rgb}mix(o,s){const h=this;if(o){const c=h.rgb,f=o.rgb;let d;const _=s===d?.5:s,y=2*_-1,x=c.a-f.a,T=((y*x===-1?y:(y+x)/(1+y*x))+1)/2;d=1-T,c.r=255&T*c.r+d*f.r+.5,c.g=255&T*c.g+d*f.g+.5,c.b=255&T*c.b+d*f.b+.5,c.a=_*c.a+(1-_)*f.a,h.rgb=c}return h}clone(){return new He(this.rgb)}alpha(o){return this._rgb.a=G(o),this}clearer(o){const s=this._rgb;return s.a*=1-o,this}greyscale(){const o=this._rgb,s=k(o.r*.3+o.g*.59+o.b*.11);return o.r=o.g=o.b=s,this}opaquer(o){const s=this._rgb;return s.a*=1+o,this}negate(){const o=this._rgb;return o.r=255-o.r,o.g=255-o.g,o.b=255-o.b,this}lighten(o){return wn(this._rgb,2,o),this}darken(o){return wn(this._rgb,2,-o),this}saturate(o){return wn(this._rgb,1,o),this}desaturate(o){return wn(this._rgb,1,-o),this}rotate(o){return Yt(this._rgb,o),this}}function Gn(l){return new He(l)}const gi=l=>l instanceof CanvasGradient||l instanceof CanvasPattern;function _i(l){return gi(l)?l:Gn(l)}function vi(l){return gi(l)?l:Gn(l).saturate(.5).darken(.1).hexString()}function Te(){}const Ji=function(){let l=0;return function(){return l++}}();function Ot(l){return l===null||typeof l=="undefined"}function Dt(l){if(Array.isArray&&Array.isArray(l))return!0;const o=Object.prototype.toString.call(l);return o.substr(0,7)==="[object"&&o.substr(-6)==="Array]"}function vt(l){return l!==null&&Object.prototype.toString.call(l)==="[object Object]"}const jt=l=>(typeof l=="number"||l instanceof Number)&&isFinite(+l);function we(l,o){return jt(l)?l:o}function gt(l,o){return typeof l=="undefined"?o:l}const Qi=(l,o)=>typeof l=="string"&&l.endsWith("%")?parseFloat(l)/100:l/o,yi=(l,o)=>typeof l=="string"&&l.endsWith("%")?parseFloat(l)/100*o:+l;function kt(l,o,s){if(l&&typeof l.call=="function")return l.apply(s,o)}function It(l,o,s,h){let c,f,d;if(Dt(l))if(f=l.length,h)for(c=f-1;c>=0;c--)o.call(s,l[c],c);else for(c=0;c<f;c++)o.call(s,l[c],c);else if(vt(l))for(d=Object.keys(l),f=d.length,c=0;c<f;c++)o.call(s,l[d[c]],d[c])}function mi(l,o){let s,h,c,f;if(!l||!o||l.length!==o.length)return!1;for(s=0,h=l.length;s<h;++s)if(c=l[s],f=o[s],c.datasetIndex!==f.datasetIndex||c.index!==f.index)return!1;return!0}function Se(l){if(Dt(l))return l.map(Se);if(vt(l)){const o=Object.create(null),s=Object.keys(l),h=s.length;let c=0;for(;c<h;++c)o[s[c]]=Se(l[s[c]]);return o}return l}function Ur(l){return["__proto__","prototype","constructor"].indexOf(l)===-1}function xi(l,o,s,h){if(!Ur(l))return;const c=o[l],f=s[l];vt(c)&&vt(f)?an(c,f,h):o[l]=Se(f)}function an(l,o,s){const h=Dt(o)?o:[o],c=h.length;if(!vt(l))return l;s=s||{};const f=s.merger||xi;for(let d=0;d<c;++d){if(o=h[d],!vt(o))continue;const _=Object.keys(o);for(let y=0,x=_.length;y<x;++y)f(_[y],l,o,s)}return l}function Qe(l,o){return an(l,o,{merger:Vr})}function Vr(l,o,s){if(!Ur(l))return;const h=o[l],c=s[l];vt(h)&&vt(c)?Qe(h,c):Object.prototype.hasOwnProperty.call(o,l)||(o[l]=Se(c))}function Xo(l,o,s,h){o!==void 0&&console.warn(l+': "'+s+'" is deprecated. Please use "'+h+'" instead')}const Xr="",Da=".";function jo(l,o){const s=l.indexOf(Da,o);return s===-1?l.length:s}function tn(l,o){if(o===Xr)return l;let s=0,h=jo(o,s);for(;l&&h>s;)l=l[o.substr(s,h-s)],s=h+1,h=jo(o,s);return l}function bi(l){return l.charAt(0).toUpperCase()+l.slice(1)}const ve=l=>typeof l!="undefined",Ye=l=>typeof l=="function",Ei=(l,o)=>{if(l.size!==o.size)return!1;for(const s of l)if(!o.has(s))return!1;return!0};function zn(l){return l.type==="mouseup"||l.type==="click"||l.type==="contextmenu"}const Ve=Object.create(null),Sn=Object.create(null);function Un(l,o){if(!o)return l;const s=o.split(".");for(let h=0,c=s.length;h<c;++h){const f=s[h];l=l[f]||(l[f]=Object.create(null))}return l}function tr(l,o,s){return typeof o=="string"?an(Un(l,o),s):an(Un(l,""),o)}class ka{constructor(o){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=s=>s.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(s,h)=>vi(h.backgroundColor),this.hoverBorderColor=(s,h)=>vi(h.borderColor),this.hoverColor=(s,h)=>vi(h.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(o)}set(o,s){return tr(this,o,s)}get(o){return Un(this,o)}describe(o,s){return tr(Sn,o,s)}override(o,s){return tr(Ve,o,s)}route(o,s,h,c){const f=Un(this,o),d=Un(this,h),_="_"+s;Object.defineProperties(f,{[_]:{value:f[s],writable:!0},[s]:{enumerable:!0,get(){const y=this[_],x=d[c];return vt(y)?Object.assign({},x,y):gt(y,x)},set(y){this[_]=y}}})}}var Et=new ka({_scriptable:l=>!l.startsWith("on"),_indexable:l=>l!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}});const Nt=Math.PI,At=2*Nt,en=At+Nt,ln=Number.POSITIVE_INFINITY,Ti=Nt/180,bt=Nt/2,fe=Nt/4,wi=Nt*2/3,Re=Math.log10,Ae=Math.sign;function Fa(l){const o=Math.round(l);l=nr(l,o,l/1e3)?o:l;const s=Math.pow(10,Math.floor(Re(l))),h=l/s;return(h<=1?1:h<=2?2:h<=5?5:10)*s}function lc(l){const o=[],s=Math.sqrt(l);let h;for(h=1;h<s;h++)l%h===0&&(o.push(h),o.push(l/h));return s===(s|0)&&o.push(s),o.sort((c,f)=>c-f).pop(),o}function er(l){return!isNaN(parseFloat(l))&&isFinite(l)}function nr(l,o,s){return Math.abs(l-o)<s}function hc(l,o){const s=Math.round(l);return s-o<=l&&s+o>=l}function Na(l,o,s){let h,c,f;for(h=0,c=l.length;h<c;h++)f=l[h][s],isNaN(f)||(o.min=Math.min(o.min,f),o.max=Math.max(o.max,f))}function $e(l){return l*(Nt/180)}function Wo(l){return l*(180/Nt)}function Ba(l){if(!jt(l))return;let o=1,s=0;for(;Math.round(l*o)/o!==l;)o*=10,s++;return s}function Ga(l,o){const s=o.x-l.x,h=o.y-l.y,c=Math.sqrt(s*s+h*h);let f=Math.atan2(h,s);return f<-.5*Nt&&(f+=At),{angle:f,distance:c}}function Ho(l,o){return Math.sqrt(Math.pow(o.x-l.x,2)+Math.pow(o.y-l.y,2))}function cc(l,o){return(l-o+en)%At-Nt}function Pe(l){return(l%At+At)%At}function ir(l,o,s,h){const c=Pe(l),f=Pe(o),d=Pe(s),_=Pe(f-c),y=Pe(d-c),x=Pe(c-f),T=Pe(c-d);return c===f||c===d||h&&f===d||_>y&&x<T}function de(l,o,s){return Math.max(o,Math.min(s,l))}function uc(l){return de(l,-32768,32767)}function hn(l,o,s,h=1e-6){return l>=Math.min(o,s)-h&&l<=Math.max(o,s)+h}function fc(l){return!l||Ot(l.size)||Ot(l.family)?null:(l.style?l.style+" ":"")+(l.weight?l.weight+" ":"")+l.size+"px "+l.family}function jr(l,o,s,h,c){let f=o[c];return f||(f=o[c]=l.measureText(c).width,s.push(c)),f>h&&(h=f),h}function dc(l,o,s,h){h=h||{};let c=h.data=h.data||{},f=h.garbageCollect=h.garbageCollect||[];h.font!==o&&(c=h.data={},f=h.garbageCollect=[],h.font=o),l.save(),l.font=o;let d=0;const _=s.length;let y,x,T,R,C;for(y=0;y<_;y++)if(R=s[y],R!=null&&Dt(R)!==!0)d=jr(l,c,f,d,R);else if(Dt(R))for(x=0,T=R.length;x<T;x++)C=R[x],C!=null&&!Dt(C)&&(d=jr(l,c,f,d,C));l.restore();const P=f.length/2;if(P>s.length){for(y=0;y<P;y++)delete c[f[y]];f.splice(0,P)}return d}function Vn(l,o,s){const h=l.currentDevicePixelRatio,c=s!==0?Math.max(s/2,.5):0;return Math.round((o-c)*h)/h+c}function za(l,o){o=o||l.getContext("2d"),o.save(),o.resetTransform(),o.clearRect(0,0,l.width,l.height),o.restore()}function Wr(l,o,s,h){let c,f,d,_,y;const x=o.pointStyle,T=o.rotation,R=o.radius;let C=(T||0)*Ti;if(x&&typeof x=="object"&&(c=x.toString(),c==="[object HTMLImageElement]"||c==="[object HTMLCanvasElement]")){l.save(),l.translate(s,h),l.rotate(C),l.drawImage(x,-x.width/2,-x.height/2,x.width,x.height),l.restore();return}if(!(isNaN(R)||R<=0)){switch(l.beginPath(),x){default:l.arc(s,h,R,0,At),l.closePath();break;case"triangle":l.moveTo(s+Math.sin(C)*R,h-Math.cos(C)*R),C+=wi,l.lineTo(s+Math.sin(C)*R,h-Math.cos(C)*R),C+=wi,l.lineTo(s+Math.sin(C)*R,h-Math.cos(C)*R),l.closePath();break;case"rectRounded":y=R*.516,_=R-y,f=Math.cos(C+fe)*_,d=Math.sin(C+fe)*_,l.arc(s-f,h-d,y,C-Nt,C-bt),l.arc(s+d,h-f,y,C-bt,C),l.arc(s+f,h+d,y,C,C+bt),l.arc(s-d,h+f,y,C+bt,C+Nt),l.closePath();break;case"rect":if(!T){_=Math.SQRT1_2*R,l.rect(s-_,h-_,2*_,2*_);break}C+=fe;case"rectRot":f=Math.cos(C)*R,d=Math.sin(C)*R,l.moveTo(s-f,h-d),l.lineTo(s+d,h-f),l.lineTo(s+f,h+d),l.lineTo(s-d,h+f),l.closePath();break;case"crossRot":C+=fe;case"cross":f=Math.cos(C)*R,d=Math.sin(C)*R,l.moveTo(s-f,h-d),l.lineTo(s+f,h+d),l.moveTo(s+d,h-f),l.lineTo(s-d,h+f);break;case"star":f=Math.cos(C)*R,d=Math.sin(C)*R,l.moveTo(s-f,h-d),l.lineTo(s+f,h+d),l.moveTo(s+d,h-f),l.lineTo(s-d,h+f),C+=fe,f=Math.cos(C)*R,d=Math.sin(C)*R,l.moveTo(s-f,h-d),l.lineTo(s+f,h+d),l.moveTo(s+d,h-f),l.lineTo(s-d,h+f);break;case"line":f=Math.cos(C)*R,d=Math.sin(C)*R,l.moveTo(s-f,h-d),l.lineTo(s+f,h+d);break;case"dash":l.moveTo(s,h),l.lineTo(s+Math.cos(C)*R,h+Math.sin(C)*R);break}l.fill(),o.borderWidth>0&&l.stroke()}}function Xn(l,o,s){return s=s||.5,!o||l&&l.x>o.left-s&&l.x<o.right+s&&l.y>o.top-s&&l.y<o.bottom+s}function Hr(l,o){l.save(),l.beginPath(),l.rect(o.left,o.top,o.right-o.left,o.bottom-o.top),l.clip()}function Yr(l){l.restore()}function pc(l,o,s,h,c){if(!o)return l.lineTo(s.x,s.y);if(c==="middle"){const f=(o.x+s.x)/2;l.lineTo(f,o.y),l.lineTo(f,s.y)}else c==="after"!=!!h?l.lineTo(o.x,s.y):l.lineTo(s.x,o.y);l.lineTo(s.x,s.y)}function gc(l,o,s,h){if(!o)return l.lineTo(s.x,s.y);l.bezierCurveTo(h?o.cp1x:o.cp2x,h?o.cp1y:o.cp2y,h?s.cp2x:s.cp1x,h?s.cp2y:s.cp1y,s.x,s.y)}function jn(l,o,s,h,c,f={}){const d=Dt(o)?o:[o],_=f.strokeWidth>0&&f.strokeColor!=="";let y,x;for(l.save(),l.font=c.string,wg(l,f),y=0;y<d.length;++y)x=d[y],_&&(f.strokeColor&&(l.strokeStyle=f.strokeColor),Ot(f.strokeWidth)||(l.lineWidth=f.strokeWidth),l.strokeText(x,s,h,f.maxWidth)),l.fillText(x,s,h,f.maxWidth),Sg(l,s,h,x,f),h+=c.lineHeight;l.restore()}function wg(l,o){o.translation&&l.translate(o.translation[0],o.translation[1]),Ot(o.rotation)||l.rotate(o.rotation),o.color&&(l.fillStyle=o.color),o.textAlign&&(l.textAlign=o.textAlign),o.textBaseline&&(l.textBaseline=o.textBaseline)}function Sg(l,o,s,h,c){if(c.strikethrough||c.underline){const f=l.measureText(h),d=o-f.actualBoundingBoxLeft,_=o+f.actualBoundingBoxRight,y=s-f.actualBoundingBoxAscent,x=s+f.actualBoundingBoxDescent,T=c.strikethrough?(y+x)/2:x;l.strokeStyle=l.fillStyle,l.beginPath(),l.lineWidth=c.decorationWidth||2,l.moveTo(d,T),l.lineTo(_,T),l.stroke()}}function $r(l,o){const{x:s,y:h,w:c,h:f,radius:d}=o;l.arc(s+d.topLeft,h+d.topLeft,d.topLeft,-bt,Nt,!0),l.lineTo(s,h+f-d.bottomLeft),l.arc(s+d.bottomLeft,h+f-d.bottomLeft,d.bottomLeft,Nt,bt,!0),l.lineTo(s+c-d.bottomRight,h+f),l.arc(s+c-d.bottomRight,h+f-d.bottomRight,d.bottomRight,bt,0,!0),l.lineTo(s+c,h+d.topRight),l.arc(s+c-d.topRight,h+d.topRight,d.topRight,0,-bt,!0),l.lineTo(s+d.topLeft,h)}function Yo(l,o,s){s=s||(d=>l[d]<o);let h=l.length-1,c=0,f;for(;h-c>1;)f=c+h>>1,s(f)?c=f:h=f;return{lo:c,hi:h}}const cn=(l,o,s)=>Yo(l,s,h=>l[h][o]<s),_c=(l,o,s)=>Yo(l,s,h=>l[h][o]>=s);function vc(l,o,s){let h=0,c=l.length;for(;h<c&&l[h]<o;)h++;for(;c>h&&l[c-1]>s;)c--;return h>0||c<l.length?l.slice(h,c):l}const yc=["push","pop","shift","splice","unshift"];function mc(l,o){if(l._chartjs){l._chartjs.listeners.push(o);return}Object.defineProperty(l,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[o]}}),yc.forEach(s=>{const h="_onData"+bi(s),c=l[s];Object.defineProperty(l,s,{configurable:!0,enumerable:!1,value(...f){const d=c.apply(this,f);return l._chartjs.listeners.forEach(_=>{typeof _[h]=="function"&&_[h](...f)}),d}})})}function Ua(l,o){const s=l._chartjs;if(!s)return;const h=s.listeners,c=h.indexOf(o);c!==-1&&h.splice(c,1),!(h.length>0)&&(yc.forEach(f=>{delete l[f]}),delete l._chartjs)}function Va(l){const o=new Set;let s,h;for(s=0,h=l.length;s<h;++s)o.add(l[s]);return o.size===h?l:Array.from(o)}function Xa(){return typeof window!="undefined"&&typeof document!="undefined"}function $o(l){let o=l.parentNode;return o&&o.toString()==="[object ShadowRoot]"&&(o=o.host),o}function Ko(l,o,s){let h;return typeof l=="string"?(h=parseInt(l,10),l.indexOf("%")!==-1&&(h=h/100*o.parentNode[s])):h=l,h}const Zo=l=>window.getComputedStyle(l,null);function xc(l,o){return Zo(l).getPropertyValue(o)}const Rg=["top","right","bottom","left"];function Si(l,o,s){const h={};s=s?"-"+s:"";for(let c=0;c<4;c++){const f=Rg[c];h[f]=parseFloat(l[o+"-"+f+s])||0}return h.width=h.left+h.right,h.height=h.top+h.bottom,h}const Cg=(l,o,s)=>(l>0||o>0)&&(!s||!s.shadowRoot);function Og(l,o){const s=l.native||l,h=s.touches,c=h&&h.length?h[0]:s,{offsetX:f,offsetY:d}=c;let _=!1,y,x;if(Cg(f,d,s.target))y=f,x=d;else{const T=o.getBoundingClientRect();y=c.clientX-T.left,x=c.clientY-T.top,_=!0}return{x:y,y:x,box:_}}function ja(l,o){const{canvas:s,currentDevicePixelRatio:h}=o,c=Zo(s),f=c.boxSizing==="border-box",d=Si(c,"padding"),_=Si(c,"border","width"),{x:y,y:x,box:T}=Og(l,s),R=d.left+(T&&_.left),C=d.top+(T&&_.top);let{width:P,height:D}=o;return f&&(P-=d.width+_.width,D-=d.height+_.height),{x:Math.round((y-R)/P*s.width/h),y:Math.round((x-C)/D*s.height/h)}}function Ig(l,o,s){let h,c;if(o===void 0||s===void 0){const f=$o(l);if(!f)o=l.clientWidth,s=l.clientHeight;else{const d=f.getBoundingClientRect(),_=Zo(f),y=Si(_,"border","width"),x=Si(_,"padding");o=d.width-x.width-y.width,s=d.height-x.height-y.height,h=Ko(_.maxWidth,f,"clientWidth"),c=Ko(_.maxHeight,f,"clientHeight")}}return{width:o,height:s,maxWidth:h||ln,maxHeight:c||ln}}const Wa=l=>Math.round(l*10)/10;function bc(l,o,s,h){const c=Zo(l),f=Si(c,"margin"),d=Ko(c.maxWidth,l,"clientWidth")||ln,_=Ko(c.maxHeight,l,"clientHeight")||ln,y=Ig(l,o,s);let{width:x,height:T}=y;if(c.boxSizing==="content-box"){const R=Si(c,"border","width"),C=Si(c,"padding");x-=C.width+R.width,T-=C.height+R.height}return x=Math.max(0,x-f.width),T=Math.max(0,h?Math.floor(x/h):T-f.height),x=Wa(Math.min(x,d,y.maxWidth)),T=Wa(Math.min(T,_,y.maxHeight)),x&&!T&&(T=Wa(x/2)),{width:x,height:T}}function Ha(l,o,s){const h=o||1,c=Math.floor(l.height*h),f=Math.floor(l.width*h);l.height=c/h,l.width=f/h;const d=l.canvas;return d.style&&(s||!d.style.height&&!d.style.width)&&(d.style.height=`${l.height}px`,d.style.width=`${l.width}px`),l.currentDevicePixelRatio!==h||d.height!==c||d.width!==f?(l.currentDevicePixelRatio=h,d.height=c,d.width=f,l.ctx.setTransform(h,0,0,h,0,0),!0):!1}const Ec=function(){let l=!1;try{const o={get passive(){return l=!0,!1}};window.addEventListener("test",null,o),window.removeEventListener("test",null,o)}catch{}return l}();function Ya(l,o){const s=xc(l,o),h=s&&s.match(/^(\d+)(\.\d+)?px$/);return h?+h[1]:void 0}function Kr(l,o){return"native"in l?{x:l.x,y:l.y}:ja(l,o)}function Ag(l,o){const s=l.getSortedVisibleDatasetMetas();let h,c,f;for(let d=0,_=s.length;d<_;++d){({index:h,data:c}=s[d]);for(let y=0,x=c.length;y<x;++y)f=c[y],f.skip||o(f,h,y)}}function Pg(l,o,s,h){const{controller:c,data:f,_sorted:d}=l,_=c._cachedMeta.iScale;if(_&&o===_.axis&&o!=="r"&&d&&f.length){const y=_._reversePixels?_c:cn;if(h){if(c._sharedOptions){const x=f[0],T=typeof x.getRange=="function"&&x.getRange(o);if(T){const R=y(f,o,s-T),C=y(f,o,s+T);return{lo:R.lo,hi:C.hi}}}}else return y(f,o,s)}return{lo:0,hi:f.length-1}}function $a(l,o,s,h,c){const f=l.getSortedVisibleDatasetMetas(),d=s[o];for(let _=0,y=f.length;_<y;++_){const{index:x,data:T}=f[_],{lo:R,hi:C}=Pg(f[_],o,d,c);for(let P=R;P<=C;++P){const D=T[P];D.skip||h(D,x,P)}}}function Mg(l){const o=l.indexOf("x")!==-1,s=l.indexOf("y")!==-1;return function(h,c){const f=o?Math.abs(h.x-c.x):0,d=s?Math.abs(h.y-c.y):0;return Math.sqrt(Math.pow(f,2)+Math.pow(d,2))}}function Ka(l,o,s,h){const c=[];return Xn(o,l.chartArea,l._minPadding)&&$a(l,s,o,function(d,_,y){d.inRange(o.x,o.y,h)&&c.push({element:d,datasetIndex:_,index:y})},!0),c}function Lg(l,o,s,h){let c=[];function f(d,_,y){const{startAngle:x,endAngle:T}=d.getProps(["startAngle","endAngle"],h),{angle:R}=Ga(d,{x:o.x,y:o.y});ir(R,x,T)&&c.push({element:d,datasetIndex:_,index:y})}return $a(l,s,o,f),c}function Dg(l,o,s,h,c){let f=[];const d=Mg(s);let _=Number.POSITIVE_INFINITY;function y(x,T,R){const C=x.inRange(o.x,o.y,c);if(h&&!C)return;const P=x.getCenterPoint(c);if(!Xn(P,l.chartArea,l._minPadding)&&!C)return;const F=d(o,P);F<_?(f=[{element:x,datasetIndex:T,index:R}],_=F):F===_&&f.push({element:x,datasetIndex:T,index:R})}return $a(l,s,o,y),f}function Za(l,o,s,h,c){return Xn(o,l.chartArea,l._minPadding)?s==="r"&&!h?Lg(l,o,s,c):Dg(l,o,s,h,c):[]}function Tc(l,o,s,h){const c=Kr(o,l),f=[],d=s.axis,_=d==="x"?"inXRange":"inYRange";let y=!1;return Ag(l,(x,T,R)=>{x[_](c[d],h)&&f.push({element:x,datasetIndex:T,index:R}),x.inRange(c.x,c.y,h)&&(y=!0)}),s.intersect&&!y?[]:f}var wc={modes:{index(l,o,s,h){const c=Kr(o,l),f=s.axis||"x",d=s.intersect?Ka(l,c,f,h):Za(l,c,f,!1,h),_=[];return d.length?(l.getSortedVisibleDatasetMetas().forEach(y=>{const x=d[0].index,T=y.data[x];T&&!T.skip&&_.push({element:T,datasetIndex:y.index,index:x})}),_):[]},dataset(l,o,s,h){const c=Kr(o,l),f=s.axis||"xy";let d=s.intersect?Ka(l,c,f,h):Za(l,c,f,!1,h);if(d.length>0){const _=d[0].datasetIndex,y=l.getDatasetMeta(_).data;d=[];for(let x=0;x<y.length;++x)d.push({element:y[x],datasetIndex:_,index:x})}return d},point(l,o,s,h){const c=Kr(o,l),f=s.axis||"xy";return Ka(l,c,f,h)},nearest(l,o,s,h){const c=Kr(o,l),f=s.axis||"xy";return Za(l,c,f,s.intersect,h)},x(l,o,s,h){return Tc(l,o,{axis:"x",intersect:s.intersect},h)},y(l,o,s,h){return Tc(l,o,{axis:"y",intersect:s.intersect},h)}}};const kg=new RegExp(/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/),Fg=new RegExp(/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/);function Sc(l,o){const s=(""+l).match(kg);if(!s||s[1]==="normal")return o*1.2;switch(l=+s[2],s[3]){case"px":return l;case"%":l/=100;break}return o*l}const Ng=l=>+l||0;function qo(l,o){const s={},h=vt(o),c=h?Object.keys(o):o,f=vt(l)?h?d=>gt(l[d],l[o[d]]):d=>l[d]:()=>l;for(const d of c)s[d]=Ng(f(d));return s}function qa(l){return qo(l,{top:"y",right:"x",bottom:"y",left:"x"})}function Ri(l){return qo(l,["topLeft","topRight","bottomLeft","bottomRight"])}function ye(l){const o=qa(l);return o.width=o.left+o.right,o.height=o.top+o.bottom,o}function le(l,o){l=l||{},o=o||Et.font;let s=gt(l.size,o.size);typeof s=="string"&&(s=parseInt(s,10));let h=gt(l.style,o.style);h&&!(""+h).match(Fg)&&(console.warn('Invalid font style specified: "'+h+'"'),h="");const c={family:gt(l.family,o.family),lineHeight:Sc(gt(l.lineHeight,o.lineHeight),s),size:s,style:h,weight:gt(l.weight,o.weight),string:""};return c.string=fc(c),c}function rr(l,o,s,h){let c=!0,f,d,_;for(f=0,d=l.length;f<d;++f)if(_=l[f],_!==void 0&&(o!==void 0&&typeof _=="function"&&(_=_(o),c=!1),s!==void 0&&Dt(_)&&(_=_[s%_.length],c=!1),_!==void 0))return h&&!c&&(h.cacheable=!1),_}function Rc(l,o,s){const{min:h,max:c}=l,f=yi(o,(c-h)/2),d=(_,y)=>s&&_===0?0:_+y;return{min:d(h,-Math.abs(f)),max:d(c,f)}}function Rn(l,o){return Object.assign(Object.create(l),o)}const Cc=["left","top","right","bottom"];function Zr(l,o){return l.filter(s=>s.pos===o)}function Oc(l,o){return l.filter(s=>Cc.indexOf(s.pos)===-1&&s.box.axis===o)}function qr(l,o){return l.sort((s,h)=>{const c=o?h:s,f=o?s:h;return c.weight===f.weight?c.index-f.index:c.weight-f.weight})}function Bg(l){const o=[];let s,h,c,f,d,_;for(s=0,h=(l||[]).length;s<h;++s)c=l[s],{position:f,options:{stack:d,stackWeight:_=1}}=c,o.push({index:s,box:c,pos:f,horizontal:c.isHorizontal(),weight:c.weight,stack:d&&f+d,stackWeight:_});return o}function Gg(l){const o={};for(const s of l){const{stack:h,pos:c,stackWeight:f}=s;if(!h||!Cc.includes(c))continue;const d=o[h]||(o[h]={count:0,placed:0,weight:0,size:0});d.count++,d.weight+=f}return o}function zg(l,o){const s=Gg(l),{vBoxMaxWidth:h,hBoxMaxHeight:c}=o;let f,d,_;for(f=0,d=l.length;f<d;++f){_=l[f];const{fullSize:y}=_.box,x=s[_.stack],T=x&&_.stackWeight/x.weight;_.horizontal?(_.width=T?T*h:y&&o.availableWidth,_.height=c):(_.width=h,_.height=T?T*c:y&&o.availableHeight)}return s}function Ug(l){const o=Bg(l),s=qr(o.filter(x=>x.box.fullSize),!0),h=qr(Zr(o,"left"),!0),c=qr(Zr(o,"right")),f=qr(Zr(o,"top"),!0),d=qr(Zr(o,"bottom")),_=Oc(o,"x"),y=Oc(o,"y");return{fullSize:s,leftAndTop:h.concat(f),rightAndBottom:c.concat(y).concat(d).concat(_),chartArea:Zr(o,"chartArea"),vertical:h.concat(c).concat(y),horizontal:f.concat(d).concat(_)}}function Ic(l,o,s,h){return Math.max(l[s],o[s])+Math.max(l[h],o[h])}function Ac(l,o){l.top=Math.max(l.top,o.top),l.left=Math.max(l.left,o.left),l.bottom=Math.max(l.bottom,o.bottom),l.right=Math.max(l.right,o.right)}function Vg(l,o,s,h){const{pos:c,box:f}=s,d=l.maxPadding;if(!vt(c)){s.size&&(l[c]-=s.size);const R=h[s.stack]||{size:0,count:1};R.size=Math.max(R.size,s.horizontal?f.height:f.width),s.size=R.size/R.count,l[c]+=s.size}f.getPadding&&Ac(d,f.getPadding());const _=Math.max(0,o.outerWidth-Ic(d,l,"left","right")),y=Math.max(0,o.outerHeight-Ic(d,l,"top","bottom")),x=_!==l.w,T=y!==l.h;return l.w=_,l.h=y,s.horizontal?{same:x,other:T}:{same:T,other:x}}function Xg(l){const o=l.maxPadding;function s(h){const c=Math.max(o[h]-l[h],0);return l[h]+=c,c}l.y+=s("top"),l.x+=s("left"),s("right"),s("bottom")}function jg(l,o){const s=o.maxPadding;function h(c){const f={left:0,top:0,right:0,bottom:0};return c.forEach(d=>{f[d]=Math.max(o[d],s[d])}),f}return h(l?["left","right"]:["top","bottom"])}function Jr(l,o,s,h){const c=[];let f,d,_,y,x,T;for(f=0,d=l.length,x=0;f<d;++f){_=l[f],y=_.box,y.update(_.width||o.w,_.height||o.h,jg(_.horizontal,o));const{same:R,other:C}=Vg(o,s,_,h);x|=R&&c.length,T=T||C,y.fullSize||c.push(_)}return x&&Jr(c,o,s,h)||T}function Jo(l,o,s,h,c){l.top=s,l.left=o,l.right=o+h,l.bottom=s+c,l.width=h,l.height=c}function Pc(l,o,s,h){const c=s.padding;let{x:f,y:d}=o;for(const _ of l){const y=_.box,x=h[_.stack]||{count:1,placed:0,weight:1},T=_.stackWeight/x.weight||1;if(_.horizontal){const R=o.w*T,C=x.size||y.height;ve(x.start)&&(d=x.start),y.fullSize?Jo(y,c.left,d,s.outerWidth-c.right-c.left,C):Jo(y,o.left+x.placed,d,R,C),x.start=d,x.placed+=R,d=y.bottom}else{const R=o.h*T,C=x.size||y.width;ve(x.start)&&(f=x.start),y.fullSize?Jo(y,f,c.top,C,s.outerHeight-c.bottom-c.top):Jo(y,f,o.top+x.placed,C,R),x.start=f,x.placed+=R,f=y.right}}o.x=f,o.y=d}Et.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}});var me={addBox(l,o){l.boxes||(l.boxes=[]),o.fullSize=o.fullSize||!1,o.position=o.position||"top",o.weight=o.weight||0,o._layers=o._layers||function(){return[{z:0,draw(s){o.draw(s)}}]},l.boxes.push(o)},removeBox(l,o){const s=l.boxes?l.boxes.indexOf(o):-1;s!==-1&&l.boxes.splice(s,1)},configure(l,o,s){o.fullSize=s.fullSize,o.position=s.position,o.weight=s.weight},update(l,o,s,h){if(!l)return;const c=ye(l.options.layout.padding),f=Math.max(o-c.width,0),d=Math.max(s-c.height,0),_=Ug(l.boxes),y=_.vertical,x=_.horizontal;It(l.boxes,F=>{typeof F.beforeLayout=="function"&&F.beforeLayout()});const T=y.reduce((F,N)=>N.box.options&&N.box.options.display===!1?F:F+1,0)||1,R=Object.freeze({outerWidth:o,outerHeight:s,padding:c,availableWidth:f,availableHeight:d,vBoxMaxWidth:f/2/T,hBoxMaxHeight:d/2}),C=Object.assign({},c);Ac(C,ye(h));const P=Object.assign({maxPadding:C,w:f,h:d,x:c.left,y:c.top},c),D=zg(y.concat(x),R);Jr(_.fullSize,P,R,D),Jr(y,P,R,D),Jr(x,P,R,D)&&Jr(y,P,R,D),Xg(P),Pc(_.leftAndTop,P,R,D),P.x+=P.w,P.y+=P.h,Pc(_.rightAndBottom,P,R,D),l.chartArea={left:P.left,top:P.top,right:P.left+P.w,bottom:P.top+P.h,height:P.h,width:P.w},It(_.chartArea,F=>{const N=F.box;Object.assign(N,l.chartArea),N.update(P.w,P.h,{left:0,top:0,right:0,bottom:0})})}};function Qo(l,o=[""],s=l,h,c=()=>l[0]){ve(h)||(h=kc("_fallback",l));const f={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:l,_rootScopes:s,_fallback:h,_getTarget:c,override:d=>Qo([d,...l],o,s,h)};return new Proxy(f,{deleteProperty(d,_){return delete d[_],delete d._keys,delete l[0][_],!0},get(d,_){return Mc(d,_,()=>Jg(_,o,l,d))},getOwnPropertyDescriptor(d,_){return Reflect.getOwnPropertyDescriptor(d._scopes[0],_)},getPrototypeOf(){return Reflect.getPrototypeOf(l[0])},has(d,_){return Fc(d).includes(_)},ownKeys(d){return Fc(d)},set(d,_,y){const x=d._storage||(d._storage=c());return d[_]=x[_]=y,delete d._keys,!0}})}function Ci(l,o,s,h){const c={_cacheable:!1,_proxy:l,_context:o,_subProxy:s,_stack:new Set,_descriptors:Ja(l,h),setContext:f=>Ci(l,f,s,h),override:f=>Ci(l.override(f),o,s,h)};return new Proxy(c,{deleteProperty(f,d){return delete f[d],delete l[d],!0},get(f,d,_){return Mc(f,d,()=>Hg(f,d,_))},getOwnPropertyDescriptor(f,d){return f._descriptors.allKeys?Reflect.has(l,d)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(l,d)},getPrototypeOf(){return Reflect.getPrototypeOf(l)},has(f,d){return Reflect.has(l,d)},ownKeys(){return Reflect.ownKeys(l)},set(f,d,_){return l[d]=_,delete f[d],!0}})}function Ja(l,o={scriptable:!0,indexable:!0}){const{_scriptable:s=o.scriptable,_indexable:h=o.indexable,_allKeys:c=o.allKeys}=l;return{allKeys:c,scriptable:s,indexable:h,isScriptable:Ye(s)?s:()=>s,isIndexable:Ye(h)?h:()=>h}}const Wg=(l,o)=>l?l+bi(o):o,Qa=(l,o)=>vt(o)&&l!=="adapters"&&(Object.getPrototypeOf(o)===null||o.constructor===Object);function Mc(l,o,s){if(Object.prototype.hasOwnProperty.call(l,o))return l[o];const h=s();return l[o]=h,h}function Hg(l,o,s){const{_proxy:h,_context:c,_subProxy:f,_descriptors:d}=l;let _=h[o];return Ye(_)&&d.isScriptable(o)&&(_=Yg(o,_,l,s)),Dt(_)&&_.length&&(_=$g(o,_,l,d.isIndexable)),Qa(o,_)&&(_=Ci(_,c,f&&f[o],d)),_}function Yg(l,o,s,h){const{_proxy:c,_context:f,_subProxy:d,_stack:_}=s;if(_.has(l))throw new Error("Recursion detected: "+Array.from(_).join("->")+"->"+l);return _.add(l),o=o(f,d||h),_.delete(l),Qa(l,o)&&(o=tl(c._scopes,c,l,o)),o}function $g(l,o,s,h){const{_proxy:c,_context:f,_subProxy:d,_descriptors:_}=s;if(ve(f.index)&&h(l))o=o[f.index%o.length];else if(vt(o[0])){const y=o,x=c._scopes.filter(T=>T!==y);o=[];for(const T of y){const R=tl(x,c,l,T);o.push(Ci(R,f,d&&d[l],_))}}return o}function Lc(l,o,s){return Ye(l)?l(o,s):l}const Kg=(l,o)=>l===!0?o:typeof l=="string"?tn(o,l):void 0;function Zg(l,o,s,h,c){for(const f of o){const d=Kg(s,f);if(d){l.add(d);const _=Lc(d._fallback,s,c);if(ve(_)&&_!==s&&_!==h)return _}else if(d===!1&&ve(h)&&s!==h)return null}return!1}function tl(l,o,s,h){const c=o._rootScopes,f=Lc(o._fallback,s,h),d=[...l,...c],_=new Set;_.add(h);let y=Dc(_,d,s,f||s,h);return y===null||ve(f)&&f!==s&&(y=Dc(_,d,f,y,h),y===null)?!1:Qo(Array.from(_),[""],c,f,()=>qg(o,s,h))}function Dc(l,o,s,h,c){for(;s;)s=Zg(l,o,s,h,c);return s}function qg(l,o,s){const h=l._getTarget();o in h||(h[o]={});const c=h[o];return Dt(c)&&vt(s)?s:c}function Jg(l,o,s,h){let c;for(const f of o)if(c=kc(Wg(f,l),s),ve(c))return Qa(l,c)?tl(s,h,l,c):c}function kc(l,o){for(const s of o){if(!s)continue;const h=s[l];if(ve(h))return h}}function Fc(l){let o=l._keys;return o||(o=l._keys=Qg(l._scopes)),o}function Qg(l){const o=new Set;for(const s of l)for(const h of Object.keys(s).filter(c=>!c.startsWith("_")))o.add(h);return Array.from(o)}const t_=Number.EPSILON||1e-14,or=(l,o)=>o<l.length&&!l[o].skip&&l[o],Nc=l=>l==="x"?"y":"x";function Bc(l,o,s,h){const c=l.skip?o:l,f=o,d=s.skip?o:s,_=Ho(f,c),y=Ho(d,f);let x=_/(_+y),T=y/(_+y);x=isNaN(x)?0:x,T=isNaN(T)?0:T;const R=h*x,C=h*T;return{previous:{x:f.x-R*(d.x-c.x),y:f.y-R*(d.y-c.y)},next:{x:f.x+C*(d.x-c.x),y:f.y+C*(d.y-c.y)}}}function e_(l,o,s){const h=l.length;let c,f,d,_,y,x=or(l,0);for(let T=0;T<h-1;++T)if(y=x,x=or(l,T+1),!(!y||!x)){if(nr(o[T],0,t_)){s[T]=s[T+1]=0;continue}c=s[T]/o[T],f=s[T+1]/o[T],_=Math.pow(c,2)+Math.pow(f,2),!(_<=9)&&(d=3/Math.sqrt(_),s[T]=c*d*o[T],s[T+1]=f*d*o[T])}}function n_(l,o,s="x"){const h=Nc(s),c=l.length;let f,d,_,y=or(l,0);for(let x=0;x<c;++x){if(d=_,_=y,y=or(l,x+1),!_)continue;const T=_[s],R=_[h];d&&(f=(T-d[s])/3,_[`cp1${s}`]=T-f,_[`cp1${h}`]=R-f*o[x]),y&&(f=(y[s]-T)/3,_[`cp2${s}`]=T+f,_[`cp2${h}`]=R+f*o[x])}}function Gc(l,o="x"){const s=Nc(o),h=l.length,c=Array(h).fill(0),f=Array(h);let d,_,y,x=or(l,0);for(d=0;d<h;++d)if(_=y,y=x,x=or(l,d+1),!!y){if(x){const T=x[o]-y[o];c[d]=T!==0?(x[s]-y[s])/T:0}f[d]=_?x?Ae(c[d-1])!==Ae(c[d])?0:(c[d-1]+c[d])/2:c[d-1]:c[d]}e_(l,c,f),n_(l,f,o)}function ts(l,o,s){return Math.max(Math.min(l,s),o)}function i_(l,o){let s,h,c,f,d,_=Xn(l[0],o);for(s=0,h=l.length;s<h;++s)d=f,f=_,_=s<h-1&&Xn(l[s+1],o),f&&(c=l[s],d&&(c.cp1x=ts(c.cp1x,o.left,o.right),c.cp1y=ts(c.cp1y,o.top,o.bottom)),_&&(c.cp2x=ts(c.cp2x,o.left,o.right),c.cp2y=ts(c.cp2y,o.top,o.bottom)))}function zc(l,o,s,h,c){let f,d,_,y;if(o.spanGaps&&(l=l.filter(x=>!x.skip)),o.cubicInterpolationMode==="monotone")Gc(l,c);else{let x=h?l[l.length-1]:l[0];for(f=0,d=l.length;f<d;++f)_=l[f],y=Bc(x,_,l[Math.min(f+1,d-(h?0:1))%d],o.tension),_.cp1x=y.previous.x,_.cp1y=y.previous.y,_.cp2x=y.next.x,_.cp2y=y.next.y,x=_}o.capBezierPoints&&i_(l,s)}const es=l=>l===0||l===1,Uc=(l,o,s)=>-(Math.pow(2,10*(l-=1))*Math.sin((l-o)*At/s)),Vc=(l,o,s)=>Math.pow(2,-10*l)*Math.sin((l-o)*At/s)+1,sr={linear:l=>l,easeInQuad:l=>l*l,easeOutQuad:l=>-l*(l-2),easeInOutQuad:l=>(l/=.5)<1?.5*l*l:-.5*(--l*(l-2)-1),easeInCubic:l=>l*l*l,easeOutCubic:l=>(l-=1)*l*l+1,easeInOutCubic:l=>(l/=.5)<1?.5*l*l*l:.5*((l-=2)*l*l+2),easeInQuart:l=>l*l*l*l,easeOutQuart:l=>-((l-=1)*l*l*l-1),easeInOutQuart:l=>(l/=.5)<1?.5*l*l*l*l:-.5*((l-=2)*l*l*l-2),easeInQuint:l=>l*l*l*l*l,easeOutQuint:l=>(l-=1)*l*l*l*l+1,easeInOutQuint:l=>(l/=.5)<1?.5*l*l*l*l*l:.5*((l-=2)*l*l*l*l+2),easeInSine:l=>-Math.cos(l*bt)+1,easeOutSine:l=>Math.sin(l*bt),easeInOutSine:l=>-.5*(Math.cos(Nt*l)-1),easeInExpo:l=>l===0?0:Math.pow(2,10*(l-1)),easeOutExpo:l=>l===1?1:-Math.pow(2,-10*l)+1,easeInOutExpo:l=>es(l)?l:l<.5?.5*Math.pow(2,10*(l*2-1)):.5*(-Math.pow(2,-10*(l*2-1))+2),easeInCirc:l=>l>=1?l:-(Math.sqrt(1-l*l)-1),easeOutCirc:l=>Math.sqrt(1-(l-=1)*l),easeInOutCirc:l=>(l/=.5)<1?-.5*(Math.sqrt(1-l*l)-1):.5*(Math.sqrt(1-(l-=2)*l)+1),easeInElastic:l=>es(l)?l:Uc(l,.075,.3),easeOutElastic:l=>es(l)?l:Vc(l,.075,.3),easeInOutElastic(l){return es(l)?l:l<.5?.5*Uc(l*2,.1125,.45):.5+.5*Vc(l*2-1,.1125,.45)},easeInBack(l){return l*l*((1.70158+1)*l-1.70158)},easeOutBack(l){return(l-=1)*l*((1.70158+1)*l+1.70158)+1},easeInOutBack(l){let o=1.70158;return(l/=.5)<1?.5*(l*l*(((o*=1.525)+1)*l-o)):.5*((l-=2)*l*(((o*=1.525)+1)*l+o)+2)},easeInBounce:l=>1-sr.easeOutBounce(1-l),easeOutBounce(l){return l<1/2.75?7.5625*l*l:l<2/2.75?7.5625*(l-=1.5/2.75)*l+.75:l<2.5/2.75?7.5625*(l-=2.25/2.75)*l+.9375:7.5625*(l-=2.625/2.75)*l+.984375},easeInOutBounce:l=>l<.5?sr.easeInBounce(l*2)*.5:sr.easeOutBounce(l*2-1)*.5+.5};function Wn(l,o,s,h){return{x:l.x+s*(o.x-l.x),y:l.y+s*(o.y-l.y)}}function Xc(l,o,s,h){return{x:l.x+s*(o.x-l.x),y:h==="middle"?s<.5?l.y:o.y:h==="after"?s<1?l.y:o.y:s>0?o.y:l.y}}function jc(l,o,s,h){const c={x:l.cp2x,y:l.cp2y},f={x:o.cp1x,y:o.cp1y},d=Wn(l,c,s),_=Wn(c,f,s),y=Wn(f,o,s),x=Wn(d,_,s),T=Wn(_,y,s);return Wn(x,T,s)}const Wc=new Map;function r_(l,o){o=o||{};const s=l+JSON.stringify(o);let h=Wc.get(s);return h||(h=new Intl.NumberFormat(l,o),Wc.set(s,h)),h}function ar(l,o,s){return r_(o,s).format(l)}const o_=function(l,o){return{x(s){return l+l+o-s},setWidth(s){o=s},textAlign(s){return s==="center"?s:s==="right"?"left":"right"},xPlus(s,h){return s-h},leftForLtr(s,h){return s-h}}},s_=function(){return{x(l){return l},setWidth(l){},textAlign(l){return l},xPlus(l,o){return l+o},leftForLtr(l,o){return l}}};function Oi(l,o,s){return l?o_(o,s):s_()}function el(l,o){let s,h;(o==="ltr"||o==="rtl")&&(s=l.canvas.style,h=[s.getPropertyValue("direction"),s.getPropertyPriority("direction")],s.setProperty("direction",o,"important"),l.prevTextDirection=h)}function nl(l,o){o!==void 0&&(delete l.prevTextDirection,l.canvas.style.setProperty("direction",o[0],o[1]))}function Hc(l){return l==="angle"?{between:ir,compare:cc,normalize:Pe}:{between:hn,compare:(o,s)=>o-s,normalize:o=>o}}function Yc({start:l,end:o,count:s,loop:h,style:c}){return{start:l%s,end:o%s,loop:h&&(o-l+1)%s===0,style:c}}function a_(l,o,s){const{property:h,start:c,end:f}=s,{between:d,normalize:_}=Hc(h),y=o.length;let{start:x,end:T,loop:R}=l,C,P;if(R){for(x+=y,T+=y,C=0,P=y;C<P&&d(_(o[x%y][h]),c,f);++C)x--,T--;x%=y,T%=y}return T<x&&(T+=y),{start:x,end:T,loop:R,style:l.style}}function il(l,o,s){if(!s)return[l];const{property:h,start:c,end:f}=s,d=o.length,{compare:_,between:y,normalize:x}=Hc(h),{start:T,end:R,loop:C,style:P}=a_(l,o,s),D=[];let F=!1,N=null,z,W,q;const Z=()=>y(c,q,z)&&_(c,q)!==0,$=()=>_(f,z)===0||y(f,q,z),ot=()=>F||Z(),nt=()=>!F||$();for(let ct=T,lt=T;ct<=R;++ct)W=o[ct%d],!W.skip&&(z=x(W[h]),z!==q&&(F=y(z,c,f),N===null&&ot()&&(N=_(z,c)===0?ct:lt),N!==null&&nt()&&(D.push(Yc({start:N,end:ct,loop:C,count:d,style:P})),N=null),lt=ct,q=z));return N!==null&&D.push(Yc({start:N,end:R,loop:C,count:d,style:P})),D}function rl(l,o){const s=[],h=l.segments;for(let c=0;c<h.length;c++){const f=il(h[c],l.points,o);f.length&&s.push(...f)}return s}function l_(l,o,s,h){let c=0,f=o-1;if(s&&!h)for(;c<o&&!l[c].skip;)c++;for(;c<o&&l[c].skip;)c++;for(c%=o,s&&(f+=c);f>c&&l[f%o].skip;)f--;return f%=o,{start:c,end:f}}function h_(l,o,s,h){const c=l.length,f=[];let d=o,_=l[o],y;for(y=o+1;y<=s;++y){const x=l[y%c];x.skip||x.stop?_.skip||(h=!1,f.push({start:o%c,end:(y-1)%c,loop:h}),o=d=x.stop?y:null):(d=y,_.skip&&(o=y)),_=x}return d!==null&&f.push({start:o%c,end:d%c,loop:h}),f}function $c(l,o){const s=l.points,h=l.options.spanGaps,c=s.length;if(!c)return[];const f=!!l._loop,{start:d,end:_}=l_(s,c,f,h);if(h===!0)return Kc(l,[{start:d,end:_,loop:f}],s,o);const y=_<d?_+c:_,x=!!l._fullLoop&&d===0&&_===c-1;return Kc(l,h_(s,d,y,x),s,o)}function Kc(l,o,s,h){return!h||!h.setContext||!s?o:c_(l,o,s,h)}function c_(l,o,s,h){const c=l._chart.getContext(),f=Zc(l.options),{_datasetIndex:d,options:{spanGaps:_}}=l,y=s.length,x=[];let T=f,R=o[0].start,C=R;function P(D,F,N,z){const W=_?-1:1;if(D!==F){for(D+=y;s[D%y].skip;)D-=W;for(;s[F%y].skip;)F+=W;D%y!==F%y&&(x.push({start:D%y,end:F%y,loop:N,style:z}),T=z,R=F%y)}}for(const D of o){R=_?R:D.start;let F=s[R%y],N;for(C=R+1;C<=D.end;C++){const z=s[C%y];N=Zc(h.setContext(Rn(c,{type:"segment",p0:F,p1:z,p0DataIndex:(C-1)%y,p1DataIndex:C%y,datasetIndex:d}))),u_(N,T)&&P(R,C-1,D.loop,T),F=z,T=N}R<C-1&&P(R,C-1,D.loop,T)}return x}function Zc(l){return{backgroundColor:l.backgroundColor,borderCapStyle:l.borderCapStyle,borderDash:l.borderDash,borderDashOffset:l.borderDashOffset,borderJoinStyle:l.borderJoinStyle,borderWidth:l.borderWidth,borderColor:l.borderColor}}function u_(l,o){return o&&JSON.stringify(l)!==JSON.stringify(o)}var f_=Object.freeze({__proto__:null,easingEffects:sr,color:_i,getHoverColor:vi,noop:Te,uid:Ji,isNullOrUndef:Ot,isArray:Dt,isObject:vt,isFinite:jt,finiteOrDefault:we,valueOrDefault:gt,toPercentage:Qi,toDimension:yi,callback:kt,each:It,_elementsEqual:mi,clone:Se,_merger:xi,merge:an,mergeIf:Qe,_mergerIf:Vr,_deprecated:Xo,resolveObjectKey:tn,_capitalize:bi,defined:ve,isFunction:Ye,setsEqual:Ei,_isClickEvent:zn,toFontString:fc,_measureText:jr,_longestText:dc,_alignPixel:Vn,clearCanvas:za,drawPoint:Wr,_isPointInArea:Xn,clipArea:Hr,unclipArea:Yr,_steppedLineTo:pc,_bezierCurveTo:gc,renderText:jn,addRoundedRectPath:$r,_lookup:Yo,_lookupByKey:cn,_rlookupByKey:_c,_filterBetween:vc,listenArrayEvents:mc,unlistenArrayEvents:Ua,_arrayUnique:Va,_createResolver:Qo,_attachContext:Ci,_descriptors:Ja,splineCurve:Bc,splineCurveMonotone:Gc,_updateBezierControlPoints:zc,_isDomSupported:Xa,_getParentNode:$o,getStyle:xc,getRelativePosition:ja,getMaximumSize:bc,retinaScale:Ha,supportsEventListenerOptions:Ec,readUsedSize:Ya,fontString:t,requestAnimFrame:n,throttled:i,debounce:a,_toLeftRightCenter:u,_alignStartEnd:p,_textX:g,_pointInLine:Wn,_steppedInterpolation:Xc,_bezierInterpolation:jc,formatNumber:ar,toLineHeight:Sc,_readValueToProps:qo,toTRBL:qa,toTRBLCorners:Ri,toPadding:ye,toFont:le,resolve:rr,_addGrace:Rc,createContext:Rn,PI:Nt,TAU:At,PITAU:en,INFINITY:ln,RAD_PER_DEG:Ti,HALF_PI:bt,QUARTER_PI:fe,TWO_THIRDS_PI:wi,log10:Re,sign:Ae,niceNum:Fa,_factorize:lc,isNumber:er,almostEquals:nr,almostWhole:hc,_setMinAndMaxByKey:Na,toRadians:$e,toDegrees:Wo,_decimalPlaces:Ba,getAngleFromPoint:Ga,distanceBetweenPoints:Ho,_angleDiff:cc,_normalizeAngle:Pe,_angleBetween:ir,_limitValue:de,_int16Range:uc,_isBetween:hn,getRtlAdapter:Oi,overrideTextDirection:el,restoreTextDirection:nl,_boundSegment:il,_boundSegments:rl,_computeSegments:$c});class ol{acquireContext(o,s){}releaseContext(o){return!1}addEventListener(o,s,h){}removeEventListener(o,s,h){}getDevicePixelRatio(){return 1}getMaximumSize(o,s,h,c){return s=Math.max(0,s||o.width),h=h||o.height,{width:s,height:Math.max(0,c?Math.floor(s/c):h)}}isAttached(o){return!0}updateConfig(o){}}class qc extends ol{acquireContext(o){return o&&o.getContext&&o.getContext("2d")||null}updateConfig(o){o.options.animation=!1}}const ns="$chartjs",d_={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},Jc=l=>l===null||l==="";function p_(l,o){const s=l.style,h=l.getAttribute("height"),c=l.getAttribute("width");if(l[ns]={initial:{height:h,width:c,style:{display:s.display,height:s.height,width:s.width}}},s.display=s.display||"block",s.boxSizing=s.boxSizing||"border-box",Jc(c)){const f=Ya(l,"width");f!==void 0&&(l.width=f)}if(Jc(h))if(l.style.height==="")l.height=l.width/(o||2);else{const f=Ya(l,"height");f!==void 0&&(l.height=f)}return l}const Qc=Ec?{passive:!0}:!1;function g_(l,o,s){l.addEventListener(o,s,Qc)}function __(l,o,s){l.canvas.removeEventListener(o,s,Qc)}function v_(l,o){const s=d_[l.type]||l.type,{x:h,y:c}=ja(l,o);return{type:s,chart:o,native:l,x:h!==void 0?h:null,y:c!==void 0?c:null}}function is(l,o){for(const s of l)if(s===o||s.contains(o))return!0}function y_(l,o,s){const h=l.canvas,c=new MutationObserver(f=>{let d=!1;for(const _ of f)d=d||is(_.addedNodes,h),d=d&&!is(_.removedNodes,h);d&&s()});return c.observe(document,{childList:!0,subtree:!0}),c}function m_(l,o,s){const h=l.canvas,c=new MutationObserver(f=>{let d=!1;for(const _ of f)d=d||is(_.removedNodes,h),d=d&&!is(_.addedNodes,h);d&&s()});return c.observe(document,{childList:!0,subtree:!0}),c}const Qr=new Map;let tu=0;function eu(){const l=window.devicePixelRatio;l!==tu&&(tu=l,Qr.forEach((o,s)=>{s.currentDevicePixelRatio!==l&&o()}))}function x_(l,o){Qr.size||window.addEventListener("resize",eu),Qr.set(l,o)}function b_(l){Qr.delete(l),Qr.size||window.removeEventListener("resize",eu)}function E_(l,o,s){const h=l.canvas,c=h&&$o(h);if(!c)return;const f=i((_,y)=>{const x=c.clientWidth;s(_,y),x<c.clientWidth&&s()},window),d=new ResizeObserver(_=>{const y=_[0],x=y.contentRect.width,T=y.contentRect.height;x===0&&T===0||f(x,T)});return d.observe(c),x_(l,f),d}function sl(l,o,s){s&&s.disconnect(),o==="resize"&&b_(l)}function T_(l,o,s){const h=l.canvas,c=i(f=>{l.ctx!==null&&s(v_(f,l))},l,f=>{const d=f[0];return[d,d.offsetX,d.offsetY]});return g_(h,o,c),c}class nu extends ol{acquireContext(o,s){const h=o&&o.getContext&&o.getContext("2d");return h&&h.canvas===o?(p_(o,s),h):null}releaseContext(o){const s=o.canvas;if(!s[ns])return!1;const h=s[ns].initial;["height","width"].forEach(f=>{const d=h[f];Ot(d)?s.removeAttribute(f):s.setAttribute(f,d)});const c=h.style||{};return Object.keys(c).forEach(f=>{s.style[f]=c[f]}),s.width=s.width,delete s[ns],!0}addEventListener(o,s,h){this.removeEventListener(o,s);const c=o.$proxies||(o.$proxies={}),d={attach:y_,detach:m_,resize:E_}[s]||T_;c[s]=d(o,s,h)}removeEventListener(o,s){const h=o.$proxies||(o.$proxies={}),c=h[s];if(!c)return;({attach:sl,detach:sl,resize:sl}[s]||__)(o,s,c),h[s]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(o,s,h,c){return bc(o,s,h,c)}isAttached(o){const s=$o(o);return!!(s&&s.isConnected)}}function iu(l){return!Xa()||typeof OffscreenCanvas!="undefined"&&l instanceof OffscreenCanvas?qc:nu}var ru=Object.freeze({__proto__:null,_detectPlatform:iu,BasePlatform:ol,BasicPlatform:qc,DomPlatform:nu});const ou="transparent",w_={boolean(l,o,s){return s>.5?o:l},color(l,o,s){const h=_i(l||ou),c=h.valid&&_i(o||ou);return c&&c.valid?c.mix(h,s).hexString():o},number(l,o,s){return l+(o-l)*s}};class su{constructor(o,s,h,c){const f=s[h];c=rr([o.to,c,f,o.from]);const d=rr([o.from,f,c]);this._active=!0,this._fn=o.fn||w_[o.type||typeof d],this._easing=sr[o.easing]||sr.linear,this._start=Math.floor(Date.now()+(o.delay||0)),this._duration=this._total=Math.floor(o.duration),this._loop=!!o.loop,this._target=s,this._prop=h,this._from=d,this._to=c,this._promises=void 0}active(){return this._active}update(o,s,h){if(this._active){this._notify(!1);const c=this._target[this._prop],f=h-this._start,d=this._duration-f;this._start=h,this._duration=Math.floor(Math.max(d,o.duration)),this._total+=f,this._loop=!!o.loop,this._to=rr([o.to,s,c,o.from]),this._from=rr([o.from,c,s])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(o){const s=o-this._start,h=this._duration,c=this._prop,f=this._from,d=this._loop,_=this._to;let y;if(this._active=f!==_&&(d||s<h),!this._active){this._target[c]=_,this._notify(!0);return}if(s<0){this._target[c]=f;return}y=s/h%2,y=d&&y>1?2-y:y,y=this._easing(Math.min(1,Math.max(0,y))),this._target[c]=this._fn(f,_,y)}wait(){const o=this._promises||(this._promises=[]);return new Promise((s,h)=>{o.push({res:s,rej:h})})}_notify(o){const s=o?"res":"rej",h=this._promises||[];for(let c=0;c<h.length;c++)h[c][s]()}}const S_=["x","y","borderWidth","radius","tension"],R_=["color","borderColor","backgroundColor"];Et.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0});const C_=Object.keys(Et.animation);Et.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:l=>l!=="onProgress"&&l!=="onComplete"&&l!=="fn"}),Et.set("animations",{colors:{type:"color",properties:R_},numbers:{type:"number",properties:S_}}),Et.describe("animations",{_fallback:"animation"}),Et.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:l=>l|0}}}});class al{constructor(o,s){this._chart=o,this._properties=new Map,this.configure(s)}configure(o){if(!vt(o))return;const s=this._properties;Object.getOwnPropertyNames(o).forEach(h=>{const c=o[h];if(!vt(c))return;const f={};for(const d of C_)f[d]=c[d];(Dt(c.properties)&&c.properties||[h]).forEach(d=>{(d===h||!s.has(d))&&s.set(d,f)})})}_animateOptions(o,s){const h=s.options,c=I_(o,h);if(!c)return[];const f=this._createAnimations(c,h);return h.$shared&&O_(o.options.$animations,h).then(()=>{o.options=h},()=>{}),f}_createAnimations(o,s){const h=this._properties,c=[],f=o.$animations||(o.$animations={}),d=Object.keys(s),_=Date.now();let y;for(y=d.length-1;y>=0;--y){const x=d[y];if(x.charAt(0)==="$")continue;if(x==="options"){c.push(...this._animateOptions(o,s));continue}const T=s[x];let R=f[x];const C=h.get(x);if(R)if(C&&R.active()){R.update(C,T,_);continue}else R.cancel();if(!C||!C.duration){o[x]=T;continue}f[x]=R=new su(C,o,x,T),c.push(R)}return c}update(o,s){if(this._properties.size===0){Object.assign(o,s);return}const h=this._createAnimations(o,s);if(h.length)return m.add(this._chart,h),!0}}function O_(l,o){const s=[],h=Object.keys(o);for(let c=0;c<h.length;c++){const f=l[h[c]];f&&f.active()&&s.push(f.wait())}return Promise.all(s)}function I_(l,o){if(!o)return;let s=l.options;if(!s){l.options=o;return}return s.$shared&&(l.options=s=Object.assign({},s,{$shared:!1,$animations:{}})),s}function au(l,o){const s=l&&l.options||{},h=s.reverse,c=s.min===void 0?o:0,f=s.max===void 0?o:0;return{start:h?f:c,end:h?c:f}}function A_(l,o,s){if(s===!1)return!1;const h=au(l,s),c=au(o,s);return{top:c.end,right:h.end,bottom:c.start,left:h.start}}function P_(l){let o,s,h,c;return vt(l)?(o=l.top,s=l.right,h=l.bottom,c=l.left):o=s=h=c=l,{top:o,right:s,bottom:h,left:c,disabled:l===!1}}function lu(l,o){const s=[],h=l._getSortedDatasetMetas(o);let c,f;for(c=0,f=h.length;c<f;++c)s.push(h[c].index);return s}function hu(l,o,s,h={}){const c=l.keys,f=h.mode==="single";let d,_,y,x;if(o!==null){for(d=0,_=c.length;d<_;++d){if(y=+c[d],y===s){if(h.all)continue;break}x=l.values[y],jt(x)&&(f||o===0||Ae(o)===Ae(x))&&(o+=x)}return o}}function M_(l){const o=Object.keys(l),s=new Array(o.length);let h,c,f;for(h=0,c=o.length;h<c;++h)f=o[h],s[h]={x:f,y:l[f]};return s}function cu(l,o){const s=l&&l.options.stacked;return s||s===void 0&&o.stack!==void 0}function L_(l,o,s){return`${l.id}.${o.id}.${s.stack||s.type}`}function D_(l){const{min:o,max:s,minDefined:h,maxDefined:c}=l.getUserBounds();return{min:h?o:Number.NEGATIVE_INFINITY,max:c?s:Number.POSITIVE_INFINITY}}function k_(l,o,s){const h=l[o]||(l[o]={});return h[s]||(h[s]={})}function uu(l,o,s,h){for(const c of o.getMatchingVisibleMetas(h).reverse()){const f=l[c.index];if(s&&f>0||!s&&f<0)return c.index}return null}function fu(l,o){const{chart:s,_cachedMeta:h}=l,c=s._stacks||(s._stacks={}),{iScale:f,vScale:d,index:_}=h,y=f.axis,x=d.axis,T=L_(f,d,h),R=o.length;let C;for(let P=0;P<R;++P){const D=o[P],{[y]:F,[x]:N}=D,z=D._stacks||(D._stacks={});C=z[x]=k_(c,T,F),C[_]=N,C._top=uu(C,d,!0,h.type),C._bottom=uu(C,d,!1,h.type)}}function ll(l,o){const s=l.scales;return Object.keys(s).filter(h=>s[h].axis===o).shift()}function F_(l,o){return Rn(l,{active:!1,dataset:void 0,datasetIndex:o,index:o,mode:"default",type:"dataset"})}function N_(l,o,s){return Rn(l,{active:!1,dataIndex:o,parsed:void 0,raw:void 0,element:s,index:o,mode:"default",type:"data"})}function to(l,o){const s=l.controller.index,h=l.vScale&&l.vScale.axis;if(!!h){o=o||l._parsed;for(const c of o){const f=c._stacks;if(!f||f[h]===void 0||f[h][s]===void 0)return;delete f[h][s]}}}const hl=l=>l==="reset"||l==="none",du=(l,o)=>o?l:Object.assign({},l),B_=(l,o,s)=>l&&!o.hidden&&o._stacked&&{keys:lu(s,!0),values:null};class nn{constructor(o,s){this.chart=o,this._ctx=o.ctx,this.index=s,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.$context=void 0,this._syncList=[],this.initialize()}initialize(){const o=this._cachedMeta;this.configure(),this.linkScales(),o._stacked=cu(o.vScale,o),this.addElements()}updateIndex(o){this.index!==o&&to(this._cachedMeta),this.index=o}linkScales(){const o=this.chart,s=this._cachedMeta,h=this.getDataset(),c=(R,C,P,D)=>R==="x"?C:R==="r"?D:P,f=s.xAxisID=gt(h.xAxisID,ll(o,"x")),d=s.yAxisID=gt(h.yAxisID,ll(o,"y")),_=s.rAxisID=gt(h.rAxisID,ll(o,"r")),y=s.indexAxis,x=s.iAxisID=c(y,f,d,_),T=s.vAxisID=c(y,d,f,_);s.xScale=this.getScaleForId(f),s.yScale=this.getScaleForId(d),s.rScale=this.getScaleForId(_),s.iScale=this.getScaleForId(x),s.vScale=this.getScaleForId(T)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(o){return this.chart.scales[o]}_getOtherScale(o){const s=this._cachedMeta;return o===s.iScale?s.vScale:s.iScale}reset(){this._update("reset")}_destroy(){const o=this._cachedMeta;this._data&&Ua(this._data,this),o._stacked&&to(o)}_dataCheck(){const o=this.getDataset(),s=o.data||(o.data=[]),h=this._data;if(vt(s))this._data=M_(s);else if(h!==s){if(h){Ua(h,this);const c=this._cachedMeta;to(c),c._parsed=[]}s&&Object.isExtensible(s)&&mc(s,this),this._syncList=[],this._data=s}}addElements(){const o=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(o.dataset=new this.datasetElementType)}buildOrUpdateElements(o){const s=this._cachedMeta,h=this.getDataset();let c=!1;this._dataCheck();const f=s._stacked;s._stacked=cu(s.vScale,s),s.stack!==h.stack&&(c=!0,to(s),s.stack=h.stack),this._resyncElements(o),(c||f!==s._stacked)&&fu(this,s._parsed)}configure(){const o=this.chart.config,s=o.datasetScopeKeys(this._type),h=o.getOptionScopes(this.getDataset(),s,!0);this.options=o.createResolver(h,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(o,s){const{_cachedMeta:h,_data:c}=this,{iScale:f,_stacked:d}=h,_=f.axis;let y=o===0&&s===c.length?!0:h._sorted,x=o>0&&h._parsed[o-1],T,R,C;if(this._parsing===!1)h._parsed=c,h._sorted=!0,C=c;else{Dt(c[o])?C=this.parseArrayData(h,c,o,s):vt(c[o])?C=this.parseObjectData(h,c,o,s):C=this.parsePrimitiveData(h,c,o,s);const P=()=>R[_]===null||x&&R[_]<x[_];for(T=0;T<s;++T)h._parsed[T+o]=R=C[T],y&&(P()&&(y=!1),x=R);h._sorted=y}d&&fu(this,C)}parsePrimitiveData(o,s,h,c){const{iScale:f,vScale:d}=o,_=f.axis,y=d.axis,x=f.getLabels(),T=f===d,R=new Array(c);let C,P,D;for(C=0,P=c;C<P;++C)D=C+h,R[C]={[_]:T||f.parse(x[D],D),[y]:d.parse(s[D],D)};return R}parseArrayData(o,s,h,c){const{xScale:f,yScale:d}=o,_=new Array(c);let y,x,T,R;for(y=0,x=c;y<x;++y)T=y+h,R=s[T],_[y]={x:f.parse(R[0],T),y:d.parse(R[1],T)};return _}parseObjectData(o,s,h,c){const{xScale:f,yScale:d}=o,{xAxisKey:_="x",yAxisKey:y="y"}=this._parsing,x=new Array(c);let T,R,C,P;for(T=0,R=c;T<R;++T)C=T+h,P=s[C],x[T]={x:f.parse(tn(P,_),C),y:d.parse(tn(P,y),C)};return x}getParsed(o){return this._cachedMeta._parsed[o]}getDataElement(o){return this._cachedMeta.data[o]}applyStack(o,s,h){const c=this.chart,f=this._cachedMeta,d=s[o.axis],_={keys:lu(c,!0),values:s._stacks[o.axis]};return hu(_,d,f.index,{mode:h})}updateRangeFromParsed(o,s,h,c){const f=h[s.axis];let d=f===null?NaN:f;const _=c&&h._stacks[s.axis];c&&_&&(c.values=_,d=hu(c,f,this._cachedMeta.index)),o.min=Math.min(o.min,d),o.max=Math.max(o.max,d)}getMinMax(o,s){const h=this._cachedMeta,c=h._parsed,f=h._sorted&&o===h.iScale,d=c.length,_=this._getOtherScale(o),y=B_(s,h,this.chart),x={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:T,max:R}=D_(_);let C,P;function D(){P=c[C];const F=P[_.axis];return!jt(P[o.axis])||T>F||R<F}for(C=0;C<d&&!(!D()&&(this.updateRangeFromParsed(x,o,P,y),f));++C);if(f){for(C=d-1;C>=0;--C)if(!D()){this.updateRangeFromParsed(x,o,P,y);break}}return x}getAllParsedValues(o){const s=this._cachedMeta._parsed,h=[];let c,f,d;for(c=0,f=s.length;c<f;++c)d=s[c][o.axis],jt(d)&&h.push(d);return h}getMaxOverflow(){return!1}getLabelAndValue(o){const s=this._cachedMeta,h=s.iScale,c=s.vScale,f=this.getParsed(o);return{label:h?""+h.getLabelForValue(f[h.axis]):"",value:c?""+c.getLabelForValue(f[c.axis]):""}}_update(o){const s=this._cachedMeta;this.update(o||"default"),s._clip=P_(gt(this.options.clip,A_(s.xScale,s.yScale,this.getMaxOverflow())))}update(o){}draw(){const o=this._ctx,s=this.chart,h=this._cachedMeta,c=h.data||[],f=s.chartArea,d=[],_=this._drawStart||0,y=this._drawCount||c.length-_,x=this.options.drawActiveElementsOnTop;let T;for(h.dataset&&h.dataset.draw(o,f,_,y),T=_;T<_+y;++T){const R=c[T];R.hidden||(R.active&&x?d.push(R):R.draw(o,f))}for(T=0;T<d.length;++T)d[T].draw(o,f)}getStyle(o,s){const h=s?"active":"default";return o===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(h):this.resolveDataElementOptions(o||0,h)}getContext(o,s,h){const c=this.getDataset();let f;if(o>=0&&o<this._cachedMeta.data.length){const d=this._cachedMeta.data[o];f=d.$context||(d.$context=N_(this.getContext(),o,d)),f.parsed=this.getParsed(o),f.raw=c.data[o],f.index=f.dataIndex=o}else f=this.$context||(this.$context=F_(this.chart.getContext(),this.index)),f.dataset=c,f.index=f.datasetIndex=this.index;return f.active=!!s,f.mode=h,f}resolveDatasetElementOptions(o){return this._resolveElementOptions(this.datasetElementType.id,o)}resolveDataElementOptions(o,s){return this._resolveElementOptions(this.dataElementType.id,s,o)}_resolveElementOptions(o,s="default",h){const c=s==="active",f=this._cachedDataOpts,d=o+"-"+s,_=f[d],y=this.enableOptionSharing&&ve(h);if(_)return du(_,y);const x=this.chart.config,T=x.datasetElementScopeKeys(this._type,o),R=c?[`${o}Hover`,"hover",o,""]:[o,""],C=x.getOptionScopes(this.getDataset(),T),P=Object.keys(Et.elements[o]),D=()=>this.getContext(h,c),F=x.resolveNamedOptions(C,P,D,R);return F.$shared&&(F.$shared=y,f[d]=Object.freeze(du(F,y))),F}_resolveAnimations(o,s,h){const c=this.chart,f=this._cachedDataOpts,d=`animation-${s}`,_=f[d];if(_)return _;let y;if(c.options.animation!==!1){const T=this.chart.config,R=T.datasetAnimationScopeKeys(this._type,s),C=T.getOptionScopes(this.getDataset(),R);y=T.createResolver(C,this.getContext(o,h,s))}const x=new al(c,y&&y.animations);return y&&y._cacheable&&(f[d]=Object.freeze(x)),x}getSharedOptions(o){if(!!o.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},o))}includeOptions(o,s){return!s||hl(o)||this.chart._animationsDisabled}updateElement(o,s,h,c){hl(c)?Object.assign(o,h):this._resolveAnimations(s,c).update(o,h)}updateSharedOptions(o,s,h){o&&!hl(s)&&this._resolveAnimations(void 0,s).update(o,h)}_setStyle(o,s,h,c){o.active=c;const f=this.getStyle(s,c);this._resolveAnimations(s,h,c).update(o,{options:!c&&this.getSharedOptions(f)||f})}removeHoverStyle(o,s,h){this._setStyle(o,h,"active",!1)}setHoverStyle(o,s,h){this._setStyle(o,h,"active",!0)}_removeDatasetHoverStyle(){const o=this._cachedMeta.dataset;o&&this._setStyle(o,void 0,"active",!1)}_setDatasetHoverStyle(){const o=this._cachedMeta.dataset;o&&this._setStyle(o,void 0,"active",!0)}_resyncElements(o){const s=this._data,h=this._cachedMeta.data;for(const[_,y,x]of this._syncList)this[_](y,x);this._syncList=[];const c=h.length,f=s.length,d=Math.min(f,c);d&&this.parse(0,d),f>c?this._insertElements(c,f-c,o):f<c&&this._removeElements(f,c-f)}_insertElements(o,s,h=!0){const c=this._cachedMeta,f=c.data,d=o+s;let _;const y=x=>{for(x.length+=s,_=x.length-1;_>=d;_--)x[_]=x[_-s]};for(y(f),_=o;_<d;++_)f[_]=new this.dataElementType;this._parsing&&y(c._parsed),this.parse(o,s),h&&this.updateElements(f,o,s,"reset")}updateElements(o,s,h,c){}_removeElements(o,s){const h=this._cachedMeta;if(this._parsing){const c=h._parsed.splice(o,s);h._stacked&&to(h,c)}h.data.splice(o,s)}_sync(o){if(this._parsing)this._syncList.push(o);else{const[s,h,c]=o;this[s](h,c)}this.chart._dataChanges.push([this.index,...o])}_onDataPush(){const o=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-o,o])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(o,s){s&&this._sync(["_removeElements",o,s]);const h=arguments.length-2;h&&this._sync(["_insertElements",o,h])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}nn.defaults={},nn.prototype.datasetElementType=null,nn.prototype.dataElementType=null;class Ke{constructor(){this.x=void 0,this.y=void 0,this.active=!1,this.options=void 0,this.$animations=void 0}tooltipPosition(o){const{x:s,y:h}=this.getProps(["x","y"],o);return{x:s,y:h}}hasValue(){return er(this.x)&&er(this.y)}getProps(o,s){const h=this.$animations;if(!s||!h)return this;const c={};return o.forEach(f=>{c[f]=h[f]&&h[f].active()?h[f]._to:this[f]}),c}}Ke.defaults={},Ke.defaultRoutes=void 0;const pu={values(l){return Dt(l)?l:""+l},numeric(l,o,s){if(l===0)return"0";const h=this.chart.options.locale;let c,f=l;if(s.length>1){const x=Math.max(Math.abs(s[0].value),Math.abs(s[s.length-1].value));(x<1e-4||x>1e15)&&(c="scientific"),f=G_(l,s)}const d=Re(Math.abs(f)),_=Math.max(Math.min(-1*Math.floor(d),20),0),y={notation:c,minimumFractionDigits:_,maximumFractionDigits:_};return Object.assign(y,this.options.ticks.format),ar(l,h,y)},logarithmic(l,o,s){if(l===0)return"0";const h=l/Math.pow(10,Math.floor(Re(l)));return h===1||h===2||h===5?pu.numeric.call(this,l,o,s):""}};function G_(l,o){let s=o.length>3?o[2].value-o[1].value:o[1].value-o[0].value;return Math.abs(s)>=1&&l!==Math.floor(l)&&(s=l-Math.floor(l)),s}var eo={formatters:pu};Et.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",grace:0,grid:{display:!0,lineWidth:1,drawBorder:!0,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(l,o)=>o.lineWidth,tickColor:(l,o)=>o.color,offset:!1,borderDash:[],borderDashOffset:0,borderWidth:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:eo.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),Et.route("scale.ticks","color","","color"),Et.route("scale.grid","color","","borderColor"),Et.route("scale.grid","borderColor","","borderColor"),Et.route("scale.title","color","","color"),Et.describe("scale",{_fallback:!1,_scriptable:l=>!l.startsWith("before")&&!l.startsWith("after")&&l!=="callback"&&l!=="parser",_indexable:l=>l!=="borderDash"&&l!=="tickBorderDash"}),Et.describe("scales",{_fallback:"scale"}),Et.describe("scale.ticks",{_scriptable:l=>l!=="backdropPadding"&&l!=="callback",_indexable:l=>l!=="backdropPadding"});function z_(l,o){const s=l.options.ticks,h=s.maxTicksLimit||U_(l),c=s.major.enabled?X_(o):[],f=c.length,d=c[0],_=c[f-1],y=[];if(f>h)return j_(o,y,c,f/h),y;const x=V_(c,o,h);if(f>0){let T,R;const C=f>1?Math.round((_-d)/(f-1)):null;for(rs(o,y,x,Ot(C)?0:d-C,d),T=0,R=f-1;T<R;T++)rs(o,y,x,c[T],c[T+1]);return rs(o,y,x,_,Ot(C)?o.length:_+C),y}return rs(o,y,x),y}function U_(l){const o=l.options.offset,s=l._tickSize(),h=l._length/s+(o?0:1),c=l._maxLength/s;return Math.floor(Math.min(h,c))}function V_(l,o,s){const h=W_(l),c=o.length/s;if(!h)return Math.max(c,1);const f=lc(h);for(let d=0,_=f.length-1;d<_;d++){const y=f[d];if(y>c)return y}return Math.max(c,1)}function X_(l){const o=[];let s,h;for(s=0,h=l.length;s<h;s++)l[s].major&&o.push(s);return o}function j_(l,o,s,h){let c=0,f=s[0],d;for(h=Math.ceil(h),d=0;d<l.length;d++)d===f&&(o.push(l[d]),c++,f=s[c*h])}function rs(l,o,s,h,c){const f=gt(h,0),d=Math.min(gt(c,l.length),l.length);let _=0,y,x,T;for(s=Math.ceil(s),c&&(y=c-h,s=y/Math.floor(y/s)),T=f;T<0;)_++,T=Math.round(f+_*s);for(x=Math.max(f,0);x<d;x++)x===T&&(o.push(l[x]),_++,T=Math.round(f+_*s))}function W_(l){const o=l.length;let s,h;if(o<2)return!1;for(h=l[0],s=1;s<o;++s)if(l[s]-l[s-1]!==h)return!1;return h}const H_=l=>l==="left"?"right":l==="right"?"left":l,gu=(l,o,s)=>o==="top"||o==="left"?l[o]+s:l[o]-s;function _u(l,o){const s=[],h=l.length/o,c=l.length;let f=0;for(;f<c;f+=h)s.push(l[Math.floor(f)]);return s}function Y_(l,o,s){const h=l.ticks.length,c=Math.min(o,h-1),f=l._startPixel,d=l._endPixel,_=1e-6;let y=l.getPixelForTick(c),x;if(!(s&&(h===1?x=Math.max(y-f,d-y):o===0?x=(l.getPixelForTick(1)-y)/2:x=(y-l.getPixelForTick(c-1))/2,y+=c<o?x:-x,y<f-_||y>d+_)))return y}function $_(l,o){It(l,s=>{const h=s.gc,c=h.length/2;let f;if(c>o){for(f=0;f<c;++f)delete s.data[h[f]];h.splice(0,c)}})}function no(l){return l.drawTicks?l.tickLength:0}function vu(l,o){if(!l.display)return 0;const s=le(l.font,o),h=ye(l.padding);return(Dt(l.text)?l.text.length:1)*s.lineHeight+h.height}function K_(l,o){return Rn(l,{scale:o,type:"scale"})}function Z_(l,o,s){return Rn(l,{tick:s,index:o,type:"tick"})}function q_(l,o,s){let h=u(l);return(s&&o!=="right"||!s&&o==="right")&&(h=H_(h)),h}function J_(l,o,s,h){const{top:c,left:f,bottom:d,right:_,chart:y}=l,{chartArea:x,scales:T}=y;let R=0,C,P,D;const F=d-c,N=_-f;if(l.isHorizontal()){if(P=p(h,f,_),vt(s)){const z=Object.keys(s)[0],W=s[z];D=T[z].getPixelForValue(W)+F-o}else s==="center"?D=(x.bottom+x.top)/2+F-o:D=gu(l,s,o);C=_-f}else{if(vt(s)){const z=Object.keys(s)[0],W=s[z];P=T[z].getPixelForValue(W)-N+o}else s==="center"?P=(x.left+x.right)/2-N+o:P=gu(l,s,o);D=p(h,d,c),R=s==="left"?-bt:bt}return{titleX:P,titleY:D,maxWidth:C,rotation:R}}class Hn extends Ke{constructor(o){super();this.id=o.id,this.type=o.type,this.options=void 0,this.ctx=o.ctx,this.chart=o.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(o){this.options=o.setContext(this.getContext()),this.axis=o.axis,this._userMin=this.parse(o.min),this._userMax=this.parse(o.max),this._suggestedMin=this.parse(o.suggestedMin),this._suggestedMax=this.parse(o.suggestedMax)}parse(o,s){return o}getUserBounds(){let{_userMin:o,_userMax:s,_suggestedMin:h,_suggestedMax:c}=this;return o=we(o,Number.POSITIVE_INFINITY),s=we(s,Number.NEGATIVE_INFINITY),h=we(h,Number.POSITIVE_INFINITY),c=we(c,Number.NEGATIVE_INFINITY),{min:we(o,h),max:we(s,c),minDefined:jt(o),maxDefined:jt(s)}}getMinMax(o){let{min:s,max:h,minDefined:c,maxDefined:f}=this.getUserBounds(),d;if(c&&f)return{min:s,max:h};const _=this.getMatchingVisibleMetas();for(let y=0,x=_.length;y<x;++y)d=_[y].controller.getMinMax(this,o),c||(s=Math.min(s,d.min)),f||(h=Math.max(h,d.max));return s=f&&s>h?h:s,h=c&&s>h?s:h,{min:we(s,we(h,s)),max:we(h,we(s,h))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const o=this.chart.data;return this.options.labels||(this.isHorizontal()?o.xLabels:o.yLabels)||o.labels||[]}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){kt(this.options.beforeUpdate,[this])}update(o,s,h){const{beginAtZero:c,grace:f,ticks:d}=this.options,_=d.sampleSize;this.beforeUpdate(),this.maxWidth=o,this.maxHeight=s,this._margins=h=Object.assign({left:0,right:0,top:0,bottom:0},h),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+h.left+h.right:this.height+h.top+h.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=Rc(this,f,c),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const y=_<this.ticks.length;this._convertTicksToLabels(y?_u(this.ticks,_):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),d.display&&(d.autoSkip||d.source==="auto")&&(this.ticks=z_(this,this.ticks),this._labelSizes=null),y&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let o=this.options.reverse,s,h;this.isHorizontal()?(s=this.left,h=this.right):(s=this.top,h=this.bottom,o=!o),this._startPixel=s,this._endPixel=h,this._reversePixels=o,this._length=h-s,this._alignToPixels=this.options.alignToPixels}afterUpdate(){kt(this.options.afterUpdate,[this])}beforeSetDimensions(){kt(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){kt(this.options.afterSetDimensions,[this])}_callHooks(o){this.chart.notifyPlugins(o,this.getContext()),kt(this.options[o],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){kt(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(o){const s=this.options.ticks;let h,c,f;for(h=0,c=o.length;h<c;h++)f=o[h],f.label=kt(s.callback,[f.value,h,o],this)}afterTickToLabelConversion(){kt(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){kt(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const o=this.options,s=o.ticks,h=this.ticks.length,c=s.minRotation||0,f=s.maxRotation;let d=c,_,y,x;if(!this._isVisible()||!s.display||c>=f||h<=1||!this.isHorizontal()){this.labelRotation=c;return}const T=this._getLabelSizes(),R=T.widest.width,C=T.highest.height,P=de(this.chart.width-R,0,this.maxWidth);_=o.offset?this.maxWidth/h:P/(h-1),R+6>_&&(_=P/(h-(o.offset?.5:1)),y=this.maxHeight-no(o.grid)-s.padding-vu(o.title,this.chart.options.font),x=Math.sqrt(R*R+C*C),d=Wo(Math.min(Math.asin(de((T.highest.height+6)/_,-1,1)),Math.asin(de(y/x,-1,1))-Math.asin(de(C/x,-1,1)))),d=Math.max(c,Math.min(f,d))),this.labelRotation=d}afterCalculateLabelRotation(){kt(this.options.afterCalculateLabelRotation,[this])}beforeFit(){kt(this.options.beforeFit,[this])}fit(){const o={width:0,height:0},{chart:s,options:{ticks:h,title:c,grid:f}}=this,d=this._isVisible(),_=this.isHorizontal();if(d){const y=vu(c,s.options.font);if(_?(o.width=this.maxWidth,o.height=no(f)+y):(o.height=this.maxHeight,o.width=no(f)+y),h.display&&this.ticks.length){const{first:x,last:T,widest:R,highest:C}=this._getLabelSizes(),P=h.padding*2,D=$e(this.labelRotation),F=Math.cos(D),N=Math.sin(D);if(_){const z=h.mirror?0:N*R.width+F*C.height;o.height=Math.min(this.maxHeight,o.height+z+P)}else{const z=h.mirror?0:F*R.width+N*C.height;o.width=Math.min(this.maxWidth,o.width+z+P)}this._calculatePadding(x,T,N,F)}}this._handleMargins(),_?(this.width=this._length=s.width-this._margins.left-this._margins.right,this.height=o.height):(this.width=o.width,this.height=this._length=s.height-this._margins.top-this._margins.bottom)}_calculatePadding(o,s,h,c){const{ticks:{align:f,padding:d},position:_}=this.options,y=this.labelRotation!==0,x=_!=="top"&&this.axis==="x";if(this.isHorizontal()){const T=this.getPixelForTick(0)-this.left,R=this.right-this.getPixelForTick(this.ticks.length-1);let C=0,P=0;y?x?(C=c*o.width,P=h*s.height):(C=h*o.height,P=c*s.width):f==="start"?P=s.width:f==="end"?C=o.width:(C=o.width/2,P=s.width/2),this.paddingLeft=Math.max((C-T+d)*this.width/(this.width-T),0),this.paddingRight=Math.max((P-R+d)*this.width/(this.width-R),0)}else{let T=s.height/2,R=o.height/2;f==="start"?(T=0,R=o.height):f==="end"&&(T=s.height,R=0),this.paddingTop=T+d,this.paddingBottom=R+d}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){kt(this.options.afterFit,[this])}isHorizontal(){const{axis:o,position:s}=this.options;return s==="top"||s==="bottom"||o==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(o){this.beforeTickToLabelConversion(),this.generateTickLabels(o);let s,h;for(s=0,h=o.length;s<h;s++)Ot(o[s].label)&&(o.splice(s,1),h--,s--);this.afterTickToLabelConversion()}_getLabelSizes(){let o=this._labelSizes;if(!o){const s=this.options.ticks.sampleSize;let h=this.ticks;s<h.length&&(h=_u(h,s)),this._labelSizes=o=this._computeLabelSizes(h,h.length)}return o}_computeLabelSizes(o,s){const{ctx:h,_longestTextCache:c}=this,f=[],d=[];let _=0,y=0,x,T,R,C,P,D,F,N,z,W,q;for(x=0;x<s;++x){if(C=o[x].label,P=this._resolveTickFontOptions(x),h.font=D=P.string,F=c[D]=c[D]||{data:{},gc:[]},N=P.lineHeight,z=W=0,!Ot(C)&&!Dt(C))z=jr(h,F.data,F.gc,z,C),W=N;else if(Dt(C))for(T=0,R=C.length;T<R;++T)q=C[T],!Ot(q)&&!Dt(q)&&(z=jr(h,F.data,F.gc,z,q),W+=N);f.push(z),d.push(W),_=Math.max(z,_),y=Math.max(W,y)}$_(c,s);const Z=f.indexOf(_),$=d.indexOf(y),ot=nt=>({width:f[nt]||0,height:d[nt]||0});return{first:ot(0),last:ot(s-1),widest:ot(Z),highest:ot($),widths:f,heights:d}}getLabelForValue(o){return o}getPixelForValue(o,s){return NaN}getValueForPixel(o){}getPixelForTick(o){const s=this.ticks;return o<0||o>s.length-1?null:this.getPixelForValue(s[o].value)}getPixelForDecimal(o){this._reversePixels&&(o=1-o);const s=this._startPixel+o*this._length;return uc(this._alignToPixels?Vn(this.chart,s,0):s)}getDecimalForPixel(o){const s=(o-this._startPixel)/this._length;return this._reversePixels?1-s:s}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:o,max:s}=this;return o<0&&s<0?s:o>0&&s>0?o:0}getContext(o){const s=this.ticks||[];if(o>=0&&o<s.length){const h=s[o];return h.$context||(h.$context=Z_(this.getContext(),o,h))}return this.$context||(this.$context=K_(this.chart.getContext(),this))}_tickSize(){const o=this.options.ticks,s=$e(this.labelRotation),h=Math.abs(Math.cos(s)),c=Math.abs(Math.sin(s)),f=this._getLabelSizes(),d=o.autoSkipPadding||0,_=f?f.widest.width+d:0,y=f?f.highest.height+d:0;return this.isHorizontal()?y*h>_*c?_/h:y/c:y*c<_*h?y/h:_/c}_isVisible(){const o=this.options.display;return o!=="auto"?!!o:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(o){const s=this.axis,h=this.chart,c=this.options,{grid:f,position:d}=c,_=f.offset,y=this.isHorizontal(),T=this.ticks.length+(_?1:0),R=no(f),C=[],P=f.setContext(this.getContext()),D=P.drawBorder?P.borderWidth:0,F=D/2,N=function(Tt){return Vn(h,Tt,D)};let z,W,q,Z,$,ot,nt,ct,lt,Gt,Ft,Pt;if(d==="top")z=N(this.bottom),ot=this.bottom-R,ct=z-F,Gt=N(o.top)+F,Pt=o.bottom;else if(d==="bottom")z=N(this.top),Gt=o.top,Pt=N(o.bottom)-F,ot=z+F,ct=this.top+R;else if(d==="left")z=N(this.right),$=this.right-R,nt=z-F,lt=N(o.left)+F,Ft=o.right;else if(d==="right")z=N(this.left),lt=o.left,Ft=N(o.right)-F,$=z+F,nt=this.left+R;else if(s==="x"){if(d==="center")z=N((o.top+o.bottom)/2+.5);else if(vt(d)){const Tt=Object.keys(d)[0],Vt=d[Tt];z=N(this.chart.scales[Tt].getPixelForValue(Vt))}Gt=o.top,Pt=o.bottom,ot=z+F,ct=ot+R}else if(s==="y"){if(d==="center")z=N((o.left+o.right)/2);else if(vt(d)){const Tt=Object.keys(d)[0],Vt=d[Tt];z=N(this.chart.scales[Tt].getPixelForValue(Vt))}$=z-F,nt=$-R,lt=o.left,Ft=o.right}const he=gt(c.ticks.maxTicksLimit,T),Ce=Math.max(1,Math.ceil(T/he));for(W=0;W<T;W+=Ce){const Tt=f.setContext(this.getContext(W)),Vt=Tt.lineWidth,lo=Tt.color,Ai=f.borderDash||[],ho=Tt.borderDashOffset,Es=Tt.tickWidth,cr=Tt.tickColor,co=Tt.tickBorderDash||[],uo=Tt.tickBorderDashOffset;q=Y_(this,W,_),q!==void 0&&(Z=Vn(h,q,Vt),y?$=nt=lt=Ft=Z:ot=ct=Gt=Pt=Z,C.push({tx1:$,ty1:ot,tx2:nt,ty2:ct,x1:lt,y1:Gt,x2:Ft,y2:Pt,width:Vt,color:lo,borderDash:Ai,borderDashOffset:ho,tickWidth:Es,tickColor:cr,tickBorderDash:co,tickBorderDashOffset:uo}))}return this._ticksLength=T,this._borderValue=z,C}_computeLabelItems(o){const s=this.axis,h=this.options,{position:c,ticks:f}=h,d=this.isHorizontal(),_=this.ticks,{align:y,crossAlign:x,padding:T,mirror:R}=f,C=no(h.grid),P=C+T,D=R?-T:P,F=-$e(this.labelRotation),N=[];let z,W,q,Z,$,ot,nt,ct,lt,Gt,Ft,Pt,he="middle";if(c==="top")ot=this.bottom-D,nt=this._getXAxisLabelAlignment();else if(c==="bottom")ot=this.top+D,nt=this._getXAxisLabelAlignment();else if(c==="left"){const Tt=this._getYAxisLabelAlignment(C);nt=Tt.textAlign,$=Tt.x}else if(c==="right"){const Tt=this._getYAxisLabelAlignment(C);nt=Tt.textAlign,$=Tt.x}else if(s==="x"){if(c==="center")ot=(o.top+o.bottom)/2+P;else if(vt(c)){const Tt=Object.keys(c)[0],Vt=c[Tt];ot=this.chart.scales[Tt].getPixelForValue(Vt)+P}nt=this._getXAxisLabelAlignment()}else if(s==="y"){if(c==="center")$=(o.left+o.right)/2-P;else if(vt(c)){const Tt=Object.keys(c)[0],Vt=c[Tt];$=this.chart.scales[Tt].getPixelForValue(Vt)}nt=this._getYAxisLabelAlignment(C).textAlign}s==="y"&&(y==="start"?he="top":y==="end"&&(he="bottom"));const Ce=this._getLabelSizes();for(z=0,W=_.length;z<W;++z){q=_[z],Z=q.label;const Tt=f.setContext(this.getContext(z));ct=this.getPixelForTick(z)+f.labelOffset,lt=this._resolveTickFontOptions(z),Gt=lt.lineHeight,Ft=Dt(Z)?Z.length:1;const Vt=Ft/2,lo=Tt.color,Ai=Tt.textStrokeColor,ho=Tt.textStrokeWidth;d?($=ct,c==="top"?x==="near"||F!==0?Pt=-Ft*Gt+Gt/2:x==="center"?Pt=-Ce.highest.height/2-Vt*Gt+Gt:Pt=-Ce.highest.height+Gt/2:x==="near"||F!==0?Pt=Gt/2:x==="center"?Pt=Ce.highest.height/2-Vt*Gt:Pt=Ce.highest.height-Ft*Gt,R&&(Pt*=-1)):(ot=ct,Pt=(1-Ft)*Gt/2);let Es;if(Tt.showLabelBackdrop){const cr=ye(Tt.backdropPadding),co=Ce.heights[z],uo=Ce.widths[z];let Il=ot+Pt-cr.top,Al=$-cr.left;switch(he){case"middle":Il-=co/2;break;case"bottom":Il-=co;break}switch(nt){case"center":Al-=uo/2;break;case"right":Al-=uo;break}Es={left:Al,top:Il,width:uo+cr.width,height:co+cr.height,color:Tt.backdropColor}}N.push({rotation:F,label:Z,font:lt,color:lo,strokeColor:Ai,strokeWidth:ho,textOffset:Pt,textAlign:nt,textBaseline:he,translation:[$,ot],backdrop:Es})}return N}_getXAxisLabelAlignment(){const{position:o,ticks:s}=this.options;if(-$e(this.labelRotation))return o==="top"?"left":"right";let c="center";return s.align==="start"?c="left":s.align==="end"&&(c="right"),c}_getYAxisLabelAlignment(o){const{position:s,ticks:{crossAlign:h,mirror:c,padding:f}}=this.options,d=this._getLabelSizes(),_=o+f,y=d.widest.width;let x,T;return s==="left"?c?(T=this.right+f,h==="near"?x="left":h==="center"?(x="center",T+=y/2):(x="right",T+=y)):(T=this.right-_,h==="near"?x="right":h==="center"?(x="center",T-=y/2):(x="left",T=this.left)):s==="right"?c?(T=this.left+f,h==="near"?x="right":h==="center"?(x="center",T-=y/2):(x="left",T-=y)):(T=this.left+_,h==="near"?x="left":h==="center"?(x="center",T+=y/2):(x="right",T=this.right)):x="right",{textAlign:x,x:T}}_computeLabelArea(){if(this.options.ticks.mirror)return;const o=this.chart,s=this.options.position;if(s==="left"||s==="right")return{top:0,left:this.left,bottom:o.height,right:this.right};if(s==="top"||s==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:o.width}}drawBackground(){const{ctx:o,options:{backgroundColor:s},left:h,top:c,width:f,height:d}=this;s&&(o.save(),o.fillStyle=s,o.fillRect(h,c,f,d),o.restore())}getLineWidthForValue(o){const s=this.options.grid;if(!this._isVisible()||!s.display)return 0;const c=this.ticks.findIndex(f=>f.value===o);return c>=0?s.setContext(this.getContext(c)).lineWidth:0}drawGrid(o){const s=this.options.grid,h=this.ctx,c=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(o));let f,d;const _=(y,x,T)=>{!T.width||!T.color||(h.save(),h.lineWidth=T.width,h.strokeStyle=T.color,h.setLineDash(T.borderDash||[]),h.lineDashOffset=T.borderDashOffset,h.beginPath(),h.moveTo(y.x,y.y),h.lineTo(x.x,x.y),h.stroke(),h.restore())};if(s.display)for(f=0,d=c.length;f<d;++f){const y=c[f];s.drawOnChartArea&&_({x:y.x1,y:y.y1},{x:y.x2,y:y.y2},y),s.drawTicks&&_({x:y.tx1,y:y.ty1},{x:y.tx2,y:y.ty2},{color:y.tickColor,width:y.tickWidth,borderDash:y.tickBorderDash,borderDashOffset:y.tickBorderDashOffset})}}drawBorder(){const{chart:o,ctx:s,options:{grid:h}}=this,c=h.setContext(this.getContext()),f=h.drawBorder?c.borderWidth:0;if(!f)return;const d=h.setContext(this.getContext(0)).lineWidth,_=this._borderValue;let y,x,T,R;this.isHorizontal()?(y=Vn(o,this.left,f)-f/2,x=Vn(o,this.right,d)+d/2,T=R=_):(T=Vn(o,this.top,f)-f/2,R=Vn(o,this.bottom,d)+d/2,y=x=_),s.save(),s.lineWidth=c.borderWidth,s.strokeStyle=c.borderColor,s.beginPath(),s.moveTo(y,T),s.lineTo(x,R),s.stroke(),s.restore()}drawLabels(o){if(!this.options.ticks.display)return;const h=this.ctx,c=this._computeLabelArea();c&&Hr(h,c);const f=this._labelItems||(this._labelItems=this._computeLabelItems(o));let d,_;for(d=0,_=f.length;d<_;++d){const y=f[d],x=y.font,T=y.label;y.backdrop&&(h.fillStyle=y.backdrop.color,h.fillRect(y.backdrop.left,y.backdrop.top,y.backdrop.width,y.backdrop.height));let R=y.textOffset;jn(h,T,0,R,x,y)}c&&Yr(h)}drawTitle(){const{ctx:o,options:{position:s,title:h,reverse:c}}=this;if(!h.display)return;const f=le(h.font),d=ye(h.padding),_=h.align;let y=f.lineHeight/2;s==="bottom"||s==="center"||vt(s)?(y+=d.bottom,Dt(h.text)&&(y+=f.lineHeight*(h.text.length-1))):y+=d.top;const{titleX:x,titleY:T,maxWidth:R,rotation:C}=J_(this,y,s,_);jn(o,h.text,0,0,f,{color:h.color,maxWidth:R,rotation:C,textAlign:q_(_,s,c),textBaseline:"middle",translation:[x,T]})}draw(o){!this._isVisible()||(this.drawBackground(),this.drawGrid(o),this.drawBorder(),this.drawTitle(),this.drawLabels(o))}_layers(){const o=this.options,s=o.ticks&&o.ticks.z||0,h=gt(o.grid&&o.grid.z,-1);return!this._isVisible()||this.draw!==Hn.prototype.draw?[{z:s,draw:c=>{this.draw(c)}}]:[{z:h,draw:c=>{this.drawBackground(),this.drawGrid(c),this.drawTitle()}},{z:h+1,draw:()=>{this.drawBorder()}},{z:s,draw:c=>{this.drawLabels(c)}}]}getMatchingVisibleMetas(o){const s=this.chart.getSortedVisibleDatasetMetas(),h=this.axis+"AxisID",c=[];let f,d;for(f=0,d=s.length;f<d;++f){const _=s[f];_[h]===this.id&&(!o||_.type===o)&&c.push(_)}return c}_resolveTickFontOptions(o){const s=this.options.ticks.setContext(this.getContext(o));return le(s.font)}_maxDigits(){const o=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/o}}class os{constructor(o,s,h){this.type=o,this.scope=s,this.override=h,this.items=Object.create(null)}isForType(o){return Object.prototype.isPrototypeOf.call(this.type.prototype,o.prototype)}register(o){const s=Object.getPrototypeOf(o);let h;ev(s)&&(h=this.register(s));const c=this.items,f=o.id,d=this.scope+"."+f;if(!f)throw new Error("class does not have id: "+o);return f in c||(c[f]=o,Q_(o,d,h),this.override&&Et.override(o.id,o.overrides)),d}get(o){return this.items[o]}unregister(o){const s=this.items,h=o.id,c=this.scope;h in s&&delete s[h],c&&h in Et[c]&&(delete Et[c][h],this.override&&delete Ve[h])}}function Q_(l,o,s){const h=an(Object.create(null),[s?Et.get(s):{},Et.get(o),l.defaults]);Et.set(o,h),l.defaultRoutes&&tv(o,l.defaultRoutes),l.descriptors&&Et.describe(o,l.descriptors)}function tv(l,o){Object.keys(o).forEach(s=>{const h=s.split("."),c=h.pop(),f=[l].concat(h).join("."),d=o[s].split("."),_=d.pop(),y=d.join(".");Et.route(f,c,y,_)})}function ev(l){return"id"in l&&"defaults"in l}class nv{constructor(){this.controllers=new os(nn,"datasets",!0),this.elements=new os(Ke,"elements"),this.plugins=new os(Object,"plugins"),this.scales=new os(Hn,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...o){this._each("register",o)}remove(...o){this._each("unregister",o)}addControllers(...o){this._each("register",o,this.controllers)}addElements(...o){this._each("register",o,this.elements)}addPlugins(...o){this._each("register",o,this.plugins)}addScales(...o){this._each("register",o,this.scales)}getController(o){return this._get(o,this.controllers,"controller")}getElement(o){return this._get(o,this.elements,"element")}getPlugin(o){return this._get(o,this.plugins,"plugin")}getScale(o){return this._get(o,this.scales,"scale")}removeControllers(...o){this._each("unregister",o,this.controllers)}removeElements(...o){this._each("unregister",o,this.elements)}removePlugins(...o){this._each("unregister",o,this.plugins)}removeScales(...o){this._each("unregister",o,this.scales)}_each(o,s,h){[...s].forEach(c=>{const f=h||this._getRegistryForType(c);h||f.isForType(c)||f===this.plugins&&c.id?this._exec(o,f,c):It(c,d=>{const _=h||this._getRegistryForType(d);this._exec(o,_,d)})})}_exec(o,s,h){const c=bi(o);kt(h["before"+c],[],h),s[o](h),kt(h["after"+c],[],h)}_getRegistryForType(o){for(let s=0;s<this._typedRegistries.length;s++){const h=this._typedRegistries[s];if(h.isForType(o))return h}return this.plugins}_get(o,s,h){const c=s.get(o);if(c===void 0)throw new Error('"'+o+'" is not a registered '+h+".");return c}}var un=new nv;class iv{constructor(){this._init=[]}notify(o,s,h,c){s==="beforeInit"&&(this._init=this._createDescriptors(o,!0),this._notify(this._init,o,"install"));const f=c?this._descriptors(o).filter(c):this._descriptors(o),d=this._notify(f,o,s,h);return s==="afterDestroy"&&(this._notify(f,o,"stop"),this._notify(this._init,o,"uninstall")),d}_notify(o,s,h,c){c=c||{};for(const f of o){const d=f.plugin,_=d[h],y=[s,c,f.options];if(kt(_,y,d)===!1&&c.cancelable)return!1}return!0}invalidate(){Ot(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(o){if(this._cache)return this._cache;const s=this._cache=this._createDescriptors(o);return this._notifyStateChanges(o),s}_createDescriptors(o,s){const h=o&&o.config,c=gt(h.options&&h.options.plugins,{}),f=rv(h);return c===!1&&!s?[]:sv(o,f,c,s)}_notifyStateChanges(o){const s=this._oldCache||[],h=this._cache,c=(f,d)=>f.filter(_=>!d.some(y=>_.plugin.id===y.plugin.id));this._notify(c(s,h),o,"stop"),this._notify(c(h,s),o,"start")}}function rv(l){const o=[],s=Object.keys(un.plugins.items);for(let c=0;c<s.length;c++)o.push(un.getPlugin(s[c]));const h=l.plugins||[];for(let c=0;c<h.length;c++){const f=h[c];o.indexOf(f)===-1&&o.push(f)}return o}function ov(l,o){return!o&&l===!1?null:l===!0?{}:l}function sv(l,o,s,h){const c=[],f=l.getContext();for(let d=0;d<o.length;d++){const _=o[d],y=_.id,x=ov(s[y],h);x!==null&&c.push({plugin:_,options:av(l.config,_,x,f)})}return c}function av(l,o,s,h){const c=l.pluginScopeKeys(o),f=l.getOptionScopes(s,c);return l.createResolver(f,h,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function cl(l,o){const s=Et.datasets[l]||{};return((o.datasets||{})[l]||{}).indexAxis||o.indexAxis||s.indexAxis||"x"}function lv(l,o){let s=l;return l==="_index_"?s=o:l==="_value_"&&(s=o==="x"?"y":"x"),s}function hv(l,o){return l===o?"_index_":"_value_"}function cv(l){if(l==="top"||l==="bottom")return"x";if(l==="left"||l==="right")return"y"}function ul(l,o){return l==="x"||l==="y"?l:o.axis||cv(o.position)||l.charAt(0).toLowerCase()}function uv(l,o){const s=Ve[l.type]||{scales:{}},h=o.scales||{},c=cl(l.type,o),f=Object.create(null),d=Object.create(null);return Object.keys(h).forEach(_=>{const y=h[_];if(!vt(y))return console.error(`Invalid scale configuration for scale: ${_}`);if(y._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${_}`);const x=ul(_,y),T=hv(x,c),R=s.scales||{};f[x]=f[x]||_,d[_]=Qe(Object.create(null),[{axis:x},y,R[x],R[T]])}),l.data.datasets.forEach(_=>{const y=_.type||l.type,x=_.indexAxis||cl(y,o),R=(Ve[y]||{}).scales||{};Object.keys(R).forEach(C=>{const P=lv(C,x),D=_[P+"AxisID"]||f[P]||P;d[D]=d[D]||Object.create(null),Qe(d[D],[{axis:P},h[D],R[C]])})}),Object.keys(d).forEach(_=>{const y=d[_];Qe(y,[Et.scales[y.type],Et.scale])}),d}function yu(l){const o=l.options||(l.options={});o.plugins=gt(o.plugins,{}),o.scales=uv(l,o)}function mu(l){return l=l||{},l.datasets=l.datasets||[],l.labels=l.labels||[],l}function fv(l){return l=l||{},l.data=mu(l.data),yu(l),l}const xu=new Map,bu=new Set;function ss(l,o){let s=xu.get(l);return s||(s=o(),xu.set(l,s),bu.add(s)),s}const io=(l,o,s)=>{const h=tn(o,s);h!==void 0&&l.add(h)};class dv{constructor(o){this._config=fv(o),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(o){this._config.type=o}get data(){return this._config.data}set data(o){this._config.data=mu(o)}get options(){return this._config.options}set options(o){this._config.options=o}get plugins(){return this._config.plugins}update(){const o=this._config;this.clearCache(),yu(o)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(o){return ss(o,()=>[[`datasets.${o}`,""]])}datasetAnimationScopeKeys(o,s){return ss(`${o}.transition.${s}`,()=>[[`datasets.${o}.transitions.${s}`,`transitions.${s}`],[`datasets.${o}`,""]])}datasetElementScopeKeys(o,s){return ss(`${o}-${s}`,()=>[[`datasets.${o}.elements.${s}`,`datasets.${o}`,`elements.${s}`,""]])}pluginScopeKeys(o){const s=o.id,h=this.type;return ss(`${h}-plugin-${s}`,()=>[[`plugins.${s}`,...o.additionalOptionScopes||[]]])}_cachedScopes(o,s){const h=this._scopeCache;let c=h.get(o);return(!c||s)&&(c=new Map,h.set(o,c)),c}getOptionScopes(o,s,h){const{options:c,type:f}=this,d=this._cachedScopes(o,h),_=d.get(s);if(_)return _;const y=new Set;s.forEach(T=>{o&&(y.add(o),T.forEach(R=>io(y,o,R))),T.forEach(R=>io(y,c,R)),T.forEach(R=>io(y,Ve[f]||{},R)),T.forEach(R=>io(y,Et,R)),T.forEach(R=>io(y,Sn,R))});const x=Array.from(y);return x.length===0&&x.push(Object.create(null)),bu.has(s)&&d.set(s,x),x}chartOptionScopes(){const{options:o,type:s}=this;return[o,Ve[s]||{},Et.datasets[s]||{},{type:s},Et,Sn]}resolveNamedOptions(o,s,h,c=[""]){const f={$shared:!0},{resolver:d,subPrefixes:_}=Eu(this._resolverCache,o,c);let y=d;if(gv(d,s)){f.$shared=!1,h=Ye(h)?h():h;const x=this.createResolver(o,h,_);y=Ci(d,h,x)}for(const x of s)f[x]=y[x];return f}createResolver(o,s,h=[""],c){const{resolver:f}=Eu(this._resolverCache,o,h);return vt(s)?Ci(f,s,void 0,c):f}}function Eu(l,o,s){let h=l.get(o);h||(h=new Map,l.set(o,h));const c=s.join();let f=h.get(c);return f||(f={resolver:Qo(o,s),subPrefixes:s.filter(_=>!_.toLowerCase().includes("hover"))},h.set(c,f)),f}const pv=l=>vt(l)&&Object.getOwnPropertyNames(l).reduce((o,s)=>o||Ye(l[s]),!1);function gv(l,o){const{isScriptable:s,isIndexable:h}=Ja(l);for(const c of o){const f=s(c),d=h(c),_=(d||f)&&l[c];if(f&&(Ye(_)||pv(_))||d&&Dt(_))return!0}return!1}var _v="3.7.1";const vv=["top","bottom","left","right","chartArea"];function Tu(l,o){return l==="top"||l==="bottom"||vv.indexOf(l)===-1&&o==="x"}function wu(l,o){return function(s,h){return s[l]===h[l]?s[o]-h[o]:s[l]-h[l]}}function Su(l){const o=l.chart,s=o.options.animation;o.notifyPlugins("afterRender"),kt(s&&s.onComplete,[l],o)}function yv(l){const o=l.chart,s=o.options.animation;kt(s&&s.onProgress,[l],o)}function Ru(l){return Xa()&&typeof l=="string"?l=document.getElementById(l):l&&l.length&&(l=l[0]),l&&l.canvas&&(l=l.canvas),l}const as={},Cu=l=>{const o=Ru(l);return Object.values(as).filter(s=>s.canvas===o).pop()};function mv(l,o,s){const h=Object.keys(l);for(const c of h){const f=+c;if(f>=o){const d=l[c];delete l[c],(s>0||f>o)&&(l[f+s]=d)}}}function xv(l,o,s,h){return!s||l.type==="mouseout"?null:h?o:l}class Jt{constructor(o,s){const h=this.config=new dv(s),c=Ru(o),f=Cu(c);if(f)throw new Error("Canvas is already in use. Chart with ID '"+f.id+"' must be destroyed before the canvas can be reused.");const d=h.createResolver(h.chartOptionScopes(),this.getContext());this.platform=new(h.platform||iu(c)),this.platform.updateConfig(h);const _=this.platform.acquireContext(c,d.aspectRatio),y=_&&_.canvas,x=y&&y.height,T=y&&y.width;if(this.id=Ji(),this.ctx=_,this.canvas=y,this.width=T,this.height=x,this._options=d,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new iv,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=a(R=>this.update(R),d.resizeDelay||0),this._dataChanges=[],as[this.id]=this,!_||!y){console.error("Failed to create chart: can't acquire context from the given item");return}m.listen(this,"complete",Su),m.listen(this,"progress",yv),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:o,maintainAspectRatio:s},width:h,height:c,_aspectRatio:f}=this;return Ot(o)?s&&f?f:c?h/c:null:o}get data(){return this.config.data}set data(o){this.config.data=o}get options(){return this._options}set options(o){this.config.options=o}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():Ha(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return za(this.canvas,this.ctx),this}stop(){return m.stop(this),this}resize(o,s){m.running(this)?this._resizeBeforeDraw={width:o,height:s}:this._resize(o,s)}_resize(o,s){const h=this.options,c=this.canvas,f=h.maintainAspectRatio&&this.aspectRatio,d=this.platform.getMaximumSize(c,o,s,f),_=h.devicePixelRatio||this.platform.getDevicePixelRatio(),y=this.width?"resize":"attach";this.width=d.width,this.height=d.height,this._aspectRatio=this.aspectRatio,Ha(this,_,!0)&&(this.notifyPlugins("resize",{size:d}),kt(h.onResize,[this,d],this),this.attached&&this._doResize(y)&&this.render())}ensureScalesHaveIDs(){const s=this.options.scales||{};It(s,(h,c)=>{h.id=c})}buildOrUpdateScales(){const o=this.options,s=o.scales,h=this.scales,c=Object.keys(h).reduce((d,_)=>(d[_]=!1,d),{});let f=[];s&&(f=f.concat(Object.keys(s).map(d=>{const _=s[d],y=ul(d,_),x=y==="r",T=y==="x";return{options:_,dposition:x?"chartArea":T?"bottom":"left",dtype:x?"radialLinear":T?"category":"linear"}}))),It(f,d=>{const _=d.options,y=_.id,x=ul(y,_),T=gt(_.type,d.dtype);(_.position===void 0||Tu(_.position,x)!==Tu(d.dposition))&&(_.position=d.dposition),c[y]=!0;let R=null;if(y in h&&h[y].type===T)R=h[y];else{const C=un.getScale(T);R=new C({id:y,type:T,ctx:this.ctx,chart:this}),h[R.id]=R}R.init(_,o)}),It(c,(d,_)=>{d||delete h[_]}),It(h,d=>{me.configure(this,d,d.options),me.addBox(this,d)})}_updateMetasets(){const o=this._metasets,s=this.data.datasets.length,h=o.length;if(o.sort((c,f)=>c.index-f.index),h>s){for(let c=s;c<h;++c)this._destroyDatasetMeta(c);o.splice(s,h-s)}this._sortedMetasets=o.slice(0).sort(wu("order","index"))}_removeUnreferencedMetasets(){const{_metasets:o,data:{datasets:s}}=this;o.length>s.length&&delete this._stacks,o.forEach((h,c)=>{s.filter(f=>f===h._dataset).length===0&&this._destroyDatasetMeta(c)})}buildOrUpdateControllers(){const o=[],s=this.data.datasets;let h,c;for(this._removeUnreferencedMetasets(),h=0,c=s.length;h<c;h++){const f=s[h];let d=this.getDatasetMeta(h);const _=f.type||this.config.type;if(d.type&&d.type!==_&&(this._destroyDatasetMeta(h),d=this.getDatasetMeta(h)),d.type=_,d.indexAxis=f.indexAxis||cl(_,this.options),d.order=f.order||0,d.index=h,d.label=""+f.label,d.visible=this.isDatasetVisible(h),d.controller)d.controller.updateIndex(h),d.controller.linkScales();else{const y=un.getController(_),{datasetElementType:x,dataElementType:T}=Et.datasets[_];Object.assign(y.prototype,{dataElementType:un.getElement(T),datasetElementType:x&&un.getElement(x)}),d.controller=new y(this,h),o.push(d.controller)}}return this._updateMetasets(),o}_resetElements(){It(this.data.datasets,(o,s)=>{this.getDatasetMeta(s).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(o){const s=this.config;s.update();const h=this._options=s.createResolver(s.chartOptionScopes(),this.getContext()),c=this._animationsDisabled=!h.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:o,cancelable:!0})===!1)return;const f=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let d=0;for(let x=0,T=this.data.datasets.length;x<T;x++){const{controller:R}=this.getDatasetMeta(x),C=!c&&f.indexOf(R)===-1;R.buildOrUpdateElements(C),d=Math.max(+R.getMaxOverflow(),d)}d=this._minPadding=h.layout.autoPadding?d:0,this._updateLayout(d),c||It(f,x=>{x.reset()}),this._updateDatasets(o),this.notifyPlugins("afterUpdate",{mode:o}),this._layers.sort(wu("z","_idx"));const{_active:_,_lastEvent:y}=this;y?this._eventHandler(y,!0):_.length&&this._updateHoverStyles(_,_,!0),this.render()}_updateScales(){It(this.scales,o=>{me.removeBox(this,o)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const o=this.options,s=new Set(Object.keys(this._listeners)),h=new Set(o.events);(!Ei(s,h)||!!this._responsiveListeners!==o.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:o}=this,s=this._getUniformDataChanges()||[];for(const{method:h,start:c,count:f}of s){const d=h==="_removeElements"?-f:f;mv(o,c,d)}}_getUniformDataChanges(){const o=this._dataChanges;if(!o||!o.length)return;this._dataChanges=[];const s=this.data.datasets.length,h=f=>new Set(o.filter(d=>d[0]===f).map((d,_)=>_+","+d.splice(1).join(","))),c=h(0);for(let f=1;f<s;f++)if(!Ei(c,h(f)))return;return Array.from(c).map(f=>f.split(",")).map(f=>({method:f[1],start:+f[2],count:+f[3]}))}_updateLayout(o){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;me.update(this,this.width,this.height,o);const s=this.chartArea,h=s.width<=0||s.height<=0;this._layers=[],It(this.boxes,c=>{h&&c.position==="chartArea"||(c.configure&&c.configure(),this._layers.push(...c._layers()))},this),this._layers.forEach((c,f)=>{c._idx=f}),this.notifyPlugins("afterLayout")}_updateDatasets(o){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:o,cancelable:!0})!==!1){for(let s=0,h=this.data.datasets.length;s<h;++s)this.getDatasetMeta(s).controller.configure();for(let s=0,h=this.data.datasets.length;s<h;++s)this._updateDataset(s,Ye(o)?o({datasetIndex:s}):o);this.notifyPlugins("afterDatasetsUpdate",{mode:o})}}_updateDataset(o,s){const h=this.getDatasetMeta(o),c={meta:h,index:o,mode:s,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",c)!==!1&&(h.controller._update(s),c.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",c))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(m.has(this)?this.attached&&!m.running(this)&&m.start(this):(this.draw(),Su({chart:this})))}draw(){let o;if(this._resizeBeforeDraw){const{width:h,height:c}=this._resizeBeforeDraw;this._resize(h,c),this._resizeBeforeDraw=null}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const s=this._layers;for(o=0;o<s.length&&s[o].z<=0;++o)s[o].draw(this.chartArea);for(this._drawDatasets();o<s.length;++o)s[o].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(o){const s=this._sortedMetasets,h=[];let c,f;for(c=0,f=s.length;c<f;++c){const d=s[c];(!o||d.visible)&&h.push(d)}return h}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const o=this.getSortedVisibleDatasetMetas();for(let s=o.length-1;s>=0;--s)this._drawDataset(o[s]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(o){const s=this.ctx,h=o._clip,c=!h.disabled,f=this.chartArea,d={meta:o,index:o.index,cancelable:!0};this.notifyPlugins("beforeDatasetDraw",d)!==!1&&(c&&Hr(s,{left:h.left===!1?0:f.left-h.left,right:h.right===!1?this.width:f.right+h.right,top:h.top===!1?0:f.top-h.top,bottom:h.bottom===!1?this.height:f.bottom+h.bottom}),o.controller.draw(),c&&Yr(s),d.cancelable=!1,this.notifyPlugins("afterDatasetDraw",d))}getElementsAtEventForMode(o,s,h,c){const f=wc.modes[s];return typeof f=="function"?f(this,o,h,c):[]}getDatasetMeta(o){const s=this.data.datasets[o],h=this._metasets;let c=h.filter(f=>f&&f._dataset===s).pop();return c||(c={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:s&&s.order||0,index:o,_dataset:s,_parsed:[],_sorted:!1},h.push(c)),c}getContext(){return this.$context||(this.$context=Rn(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(o){const s=this.data.datasets[o];if(!s)return!1;const h=this.getDatasetMeta(o);return typeof h.hidden=="boolean"?!h.hidden:!s.hidden}setDatasetVisibility(o,s){const h=this.getDatasetMeta(o);h.hidden=!s}toggleDataVisibility(o){this._hiddenIndices[o]=!this._hiddenIndices[o]}getDataVisibility(o){return!this._hiddenIndices[o]}_updateVisibility(o,s,h){const c=h?"show":"hide",f=this.getDatasetMeta(o),d=f.controller._resolveAnimations(void 0,c);ve(s)?(f.data[s].hidden=!h,this.update()):(this.setDatasetVisibility(o,h),d.update(f,{visible:h}),this.update(_=>_.datasetIndex===o?c:void 0))}hide(o,s){this._updateVisibility(o,s,!1)}show(o,s){this._updateVisibility(o,s,!0)}_destroyDatasetMeta(o){const s=this._metasets[o];s&&s.controller&&s.controller._destroy(),delete this._metasets[o]}_stop(){let o,s;for(this.stop(),m.remove(this),o=0,s=this.data.datasets.length;o<s;++o)this._destroyDatasetMeta(o)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:o,ctx:s}=this;this._stop(),this.config.clearCache(),o&&(this.unbindEvents(),za(o,s),this.platform.releaseContext(s),this.canvas=null,this.ctx=null),this.notifyPlugins("destroy"),delete as[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...o){return this.canvas.toDataURL(...o)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const o=this._listeners,s=this.platform,h=(f,d)=>{s.addEventListener(this,f,d),o[f]=d},c=(f,d,_)=>{f.offsetX=d,f.offsetY=_,this._eventHandler(f)};It(this.options.events,f=>h(f,c))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const o=this._responsiveListeners,s=this.platform,h=(y,x)=>{s.addEventListener(this,y,x),o[y]=x},c=(y,x)=>{o[y]&&(s.removeEventListener(this,y,x),delete o[y])},f=(y,x)=>{this.canvas&&this.resize(y,x)};let d;const _=()=>{c("attach",_),this.attached=!0,this.resize(),h("resize",f),h("detach",d)};d=()=>{this.attached=!1,c("resize",f),this._stop(),this._resize(0,0),h("attach",_)},s.isAttached(this.canvas)?_():d()}unbindEvents(){It(this._listeners,(o,s)=>{this.platform.removeEventListener(this,s,o)}),this._listeners={},It(this._responsiveListeners,(o,s)=>{this.platform.removeEventListener(this,s,o)}),this._responsiveListeners=void 0}updateHoverStyle(o,s,h){const c=h?"set":"remove";let f,d,_,y;for(s==="dataset"&&(f=this.getDatasetMeta(o[0].datasetIndex),f.controller["_"+c+"DatasetHoverStyle"]()),_=0,y=o.length;_<y;++_){d=o[_];const x=d&&this.getDatasetMeta(d.datasetIndex).controller;x&&x[c+"HoverStyle"](d.element,d.datasetIndex,d.index)}}getActiveElements(){return this._active||[]}setActiveElements(o){const s=this._active||[],h=o.map(({datasetIndex:f,index:d})=>{const _=this.getDatasetMeta(f);if(!_)throw new Error("No dataset found at index "+f);return{datasetIndex:f,element:_.data[d],index:d}});!mi(h,s)&&(this._active=h,this._lastEvent=null,this._updateHoverStyles(h,s))}notifyPlugins(o,s,h){return this._plugins.notify(this,o,s,h)}_updateHoverStyles(o,s,h){const c=this.options.hover,f=(y,x)=>y.filter(T=>!x.some(R=>T.datasetIndex===R.datasetIndex&&T.index===R.index)),d=f(s,o),_=h?o:f(o,s);d.length&&this.updateHoverStyle(d,c.mode,!1),_.length&&c.mode&&this.updateHoverStyle(_,c.mode,!0)}_eventHandler(o,s){const h={event:o,replay:s,cancelable:!0,inChartArea:Xn(o,this.chartArea,this._minPadding)},c=d=>(d.options.events||this.options.events).includes(o.native.type);if(this.notifyPlugins("beforeEvent",h,c)===!1)return;const f=this._handleEvent(o,s,h.inChartArea);return h.cancelable=!1,this.notifyPlugins("afterEvent",h,c),(f||h.changed)&&this.render(),this}_handleEvent(o,s,h){const{_active:c=[],options:f}=this,d=s,_=this._getActiveElements(o,c,h,d),y=zn(o),x=xv(o,this._lastEvent,h,y);h&&(this._lastEvent=null,kt(f.onHover,[o,_,this],this),y&&kt(f.onClick,[o,_,this],this));const T=!mi(_,c);return(T||s)&&(this._active=_,this._updateHoverStyles(_,c,s)),this._lastEvent=x,T}_getActiveElements(o,s,h,c){if(o.type==="mouseout")return[];if(!h)return s;const f=this.options.hover;return this.getElementsAtEventForMode(o,f.mode,f,c)}}const Ou=()=>It(Jt.instances,l=>l._plugins.invalidate()),Yn=!0;Object.defineProperties(Jt,{defaults:{enumerable:Yn,value:Et},instances:{enumerable:Yn,value:as},overrides:{enumerable:Yn,value:Ve},registry:{enumerable:Yn,value:un},version:{enumerable:Yn,value:_v},getChart:{enumerable:Yn,value:Cu},register:{enumerable:Yn,value:(...l)=>{un.add(...l),Ou()}},unregister:{enumerable:Yn,value:(...l)=>{un.remove(...l),Ou()}}});function Ii(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class fl{constructor(o){this.options=o||{}}formats(){return Ii()}parse(o,s){return Ii()}format(o,s){return Ii()}add(o,s,h){return Ii()}diff(o,s,h){return Ii()}startOf(o,s,h){return Ii()}endOf(o,s){return Ii()}}fl.override=function(l){Object.assign(fl.prototype,l)};var Iu={_date:fl};function bv(l,o){if(!l._cache.$bar){const s=l.getMatchingVisibleMetas(o);let h=[];for(let c=0,f=s.length;c<f;c++)h=h.concat(s[c].controller.getAllParsedValues(l));l._cache.$bar=Va(h.sort((c,f)=>c-f))}return l._cache.$bar}function Ev(l){const o=l.iScale,s=bv(o,l.type);let h=o._length,c,f,d,_;const y=()=>{d===32767||d===-32768||(ve(_)&&(h=Math.min(h,Math.abs(d-_)||h)),_=d)};for(c=0,f=s.length;c<f;++c)d=o.getPixelForValue(s[c]),y();for(_=void 0,c=0,f=o.ticks.length;c<f;++c)d=o.getPixelForTick(c),y();return h}function Tv(l,o,s,h){const c=s.barThickness;let f,d;return Ot(c)?(f=o.min*s.categoryPercentage,d=s.barPercentage):(f=c*h,d=1),{chunk:f/h,ratio:d,start:o.pixels[l]-f/2}}function wv(l,o,s,h){const c=o.pixels,f=c[l];let d=l>0?c[l-1]:null,_=l<c.length-1?c[l+1]:null;const y=s.categoryPercentage;d===null&&(d=f-(_===null?o.end-o.start:_-f)),_===null&&(_=f+f-d);const x=f-(f-Math.min(d,_))/2*y;return{chunk:Math.abs(_-d)/2*y/h,ratio:s.barPercentage,start:x}}function Sv(l,o,s,h){const c=s.parse(l[0],h),f=s.parse(l[1],h),d=Math.min(c,f),_=Math.max(c,f);let y=d,x=_;Math.abs(d)>Math.abs(_)&&(y=_,x=d),o[s.axis]=x,o._custom={barStart:y,barEnd:x,start:c,end:f,min:d,max:_}}function Au(l,o,s,h){return Dt(l)?Sv(l,o,s,h):o[s.axis]=s.parse(l,h),o}function Pu(l,o,s,h){const c=l.iScale,f=l.vScale,d=c.getLabels(),_=c===f,y=[];let x,T,R,C;for(x=s,T=s+h;x<T;++x)C=o[x],R={},R[c.axis]=_||c.parse(d[x],x),y.push(Au(C,R,f,x));return y}function dl(l){return l&&l.barStart!==void 0&&l.barEnd!==void 0}function Rv(l,o,s){return l!==0?Ae(l):(o.isHorizontal()?1:-1)*(o.min>=s?1:-1)}function Cv(l){let o,s,h,c,f;return l.horizontal?(o=l.base>l.x,s="left",h="right"):(o=l.base<l.y,s="bottom",h="top"),o?(c="end",f="start"):(c="start",f="end"),{start:s,end:h,reverse:o,top:c,bottom:f}}function Ov(l,o,s,h){let c=o.borderSkipped;const f={};if(!c){l.borderSkipped=f;return}const{start:d,end:_,reverse:y,top:x,bottom:T}=Cv(l);c==="middle"&&s&&(l.enableBorderRadius=!0,(s._top||0)===h?c=x:(s._bottom||0)===h?c=T:(f[Mu(T,d,_,y)]=!0,c=x)),f[Mu(c,d,_,y)]=!0,l.borderSkipped=f}function Mu(l,o,s,h){return h?(l=Iv(l,o,s),l=Lu(l,s,o)):l=Lu(l,o,s),l}function Iv(l,o,s){return l===o?s:l===s?o:l}function Lu(l,o,s){return l==="start"?o:l==="end"?s:l}function Av(l,{inflateAmount:o},s){l.inflateAmount=o==="auto"?s===1?.33:0:o}class ls extends nn{parsePrimitiveData(o,s,h,c){return Pu(o,s,h,c)}parseArrayData(o,s,h,c){return Pu(o,s,h,c)}parseObjectData(o,s,h,c){const{iScale:f,vScale:d}=o,{xAxisKey:_="x",yAxisKey:y="y"}=this._parsing,x=f.axis==="x"?_:y,T=d.axis==="x"?_:y,R=[];let C,P,D,F;for(C=h,P=h+c;C<P;++C)F=s[C],D={},D[f.axis]=f.parse(tn(F,x),C),R.push(Au(tn(F,T),D,d,C));return R}updateRangeFromParsed(o,s,h,c){super.updateRangeFromParsed(o,s,h,c);const f=h._custom;f&&s===this._cachedMeta.vScale&&(o.min=Math.min(o.min,f.min),o.max=Math.max(o.max,f.max))}getMaxOverflow(){return 0}getLabelAndValue(o){const s=this._cachedMeta,{iScale:h,vScale:c}=s,f=this.getParsed(o),d=f._custom,_=dl(d)?"["+d.start+", "+d.end+"]":""+c.getLabelForValue(f[c.axis]);return{label:""+h.getLabelForValue(f[h.axis]),value:_}}initialize(){this.enableOptionSharing=!0,super.initialize();const o=this._cachedMeta;o.stack=this.getDataset().stack}update(o){const s=this._cachedMeta;this.updateElements(s.data,0,s.data.length,o)}updateElements(o,s,h,c){const f=c==="reset",{index:d,_cachedMeta:{vScale:_}}=this,y=_.getBasePixel(),x=_.isHorizontal(),T=this._getRuler(),R=this.resolveDataElementOptions(s,c),C=this.getSharedOptions(R),P=this.includeOptions(c,C);this.updateSharedOptions(C,c,R);for(let D=s;D<s+h;D++){const F=this.getParsed(D),N=f||Ot(F[_.axis])?{base:y,head:y}:this._calculateBarValuePixels(D),z=this._calculateBarIndexPixels(D,T),W=(F._stacks||{})[_.axis],q={horizontal:x,base:N.base,enableBorderRadius:!W||dl(F._custom)||d===W._top||d===W._bottom,x:x?N.head:z.center,y:x?z.center:N.head,height:x?z.size:Math.abs(N.size),width:x?Math.abs(N.size):z.size};P&&(q.options=C||this.resolveDataElementOptions(D,o[D].active?"active":c));const Z=q.options||o[D].options;Ov(q,Z,W,d),Av(q,Z,T.ratio),this.updateElement(o[D],D,q,c)}}_getStacks(o,s){const c=this._cachedMeta.iScale,f=c.getMatchingVisibleMetas(this._type),d=c.options.stacked,_=f.length,y=[];let x,T;for(x=0;x<_;++x)if(T=f[x],!!T.controller.options.grouped){if(typeof s!="undefined"){const R=T.controller.getParsed(s)[T.controller._cachedMeta.vScale.axis];if(Ot(R)||isNaN(R))continue}if((d===!1||y.indexOf(T.stack)===-1||d===void 0&&T.stack===void 0)&&y.push(T.stack),T.index===o)break}return y.length||y.push(void 0),y}_getStackCount(o){return this._getStacks(void 0,o).length}_getStackIndex(o,s,h){const c=this._getStacks(o,h),f=s!==void 0?c.indexOf(s):-1;return f===-1?c.length-1:f}_getRuler(){const o=this.options,s=this._cachedMeta,h=s.iScale,c=[];let f,d;for(f=0,d=s.data.length;f<d;++f)c.push(h.getPixelForValue(this.getParsed(f)[h.axis],f));const _=o.barThickness;return{min:_||Ev(s),pixels:c,start:h._startPixel,end:h._endPixel,stackCount:this._getStackCount(),scale:h,grouped:o.grouped,ratio:_?1:o.categoryPercentage*o.barPercentage}}_calculateBarValuePixels(o){const{_cachedMeta:{vScale:s,_stacked:h},options:{base:c,minBarLength:f}}=this,d=c||0,_=this.getParsed(o),y=_._custom,x=dl(y);let T=_[s.axis],R=0,C=h?this.applyStack(s,_,h):T,P,D;C!==T&&(R=C-T,C=T),x&&(T=y.barStart,C=y.barEnd-y.barStart,T!==0&&Ae(T)!==Ae(y.barEnd)&&(R=0),R+=T);const F=!Ot(c)&&!x?c:R;let N=s.getPixelForValue(F);if(this.chart.getDataVisibility(o)?P=s.getPixelForValue(R+C):P=N,D=P-N,Math.abs(D)<f&&(D=Rv(D,s,d)*f,T===d&&(N-=D/2),P=N+D),N===s.getPixelForValue(d)){const z=Ae(D)*s.getLineWidthForValue(d)/2;N+=z,D-=z}return{size:D,base:N,head:P,center:P+D/2}}_calculateBarIndexPixels(o,s){const h=s.scale,c=this.options,f=c.skipNull,d=gt(c.maxBarThickness,1/0);let _,y;if(s.grouped){const x=f?this._getStackCount(o):s.stackCount,T=c.barThickness==="flex"?wv(o,s,c,x):Tv(o,s,c,x),R=this._getStackIndex(this.index,this._cachedMeta.stack,f?o:void 0);_=T.start+T.chunk*R+T.chunk/2,y=Math.min(d,T.chunk*T.ratio)}else _=h.getPixelForValue(this.getParsed(o)[h.axis],o),y=Math.min(d,s.min*s.ratio);return{base:_-y/2,head:_+y/2,center:_,size:y}}draw(){const o=this._cachedMeta,s=o.vScale,h=o.data,c=h.length;let f=0;for(;f<c;++f)this.getParsed(f)[s.axis]!==null&&h[f].draw(this._ctx)}}ls.id="bar",ls.defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}},ls.overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};class hs extends nn{initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(o,s,h,c){const f=super.parsePrimitiveData(o,s,h,c);for(let d=0;d<f.length;d++)f[d]._custom=this.resolveDataElementOptions(d+h).radius;return f}parseArrayData(o,s,h,c){const f=super.parseArrayData(o,s,h,c);for(let d=0;d<f.length;d++){const _=s[h+d];f[d]._custom=gt(_[2],this.resolveDataElementOptions(d+h).radius)}return f}parseObjectData(o,s,h,c){const f=super.parseObjectData(o,s,h,c);for(let d=0;d<f.length;d++){const _=s[h+d];f[d]._custom=gt(_&&_.r&&+_.r,this.resolveDataElementOptions(d+h).radius)}return f}getMaxOverflow(){const o=this._cachedMeta.data;let s=0;for(let h=o.length-1;h>=0;--h)s=Math.max(s,o[h].size(this.resolveDataElementOptions(h))/2);return s>0&&s}getLabelAndValue(o){const s=this._cachedMeta,{xScale:h,yScale:c}=s,f=this.getParsed(o),d=h.getLabelForValue(f.x),_=c.getLabelForValue(f.y),y=f._custom;return{label:s.label,value:"("+d+", "+_+(y?", "+y:"")+")"}}update(o){const s=this._cachedMeta.data;this.updateElements(s,0,s.length,o)}updateElements(o,s,h,c){const f=c==="reset",{iScale:d,vScale:_}=this._cachedMeta,y=this.resolveDataElementOptions(s,c),x=this.getSharedOptions(y),T=this.includeOptions(c,x),R=d.axis,C=_.axis;for(let P=s;P<s+h;P++){const D=o[P],F=!f&&this.getParsed(P),N={},z=N[R]=f?d.getPixelForDecimal(.5):d.getPixelForValue(F[R]),W=N[C]=f?_.getBasePixel():_.getPixelForValue(F[C]);N.skip=isNaN(z)||isNaN(W),T&&(N.options=this.resolveDataElementOptions(P,D.active?"active":c),f&&(N.options.radius=0)),this.updateElement(D,P,N,c)}this.updateSharedOptions(x,c,y)}resolveDataElementOptions(o,s){const h=this.getParsed(o);let c=super.resolveDataElementOptions(o,s);c.$shared&&(c=Object.assign({},c,{$shared:!1}));const f=c.radius;return s!=="active"&&(c.radius=0),c.radius+=gt(h&&h._custom,f),c}}hs.id="bubble",hs.defaults={datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}},hs.overrides={scales:{x:{type:"linear"},y:{type:"linear"}},plugins:{tooltip:{callbacks:{title(){return""}}}}};function Pv(l,o,s){let h=1,c=1,f=0,d=0;if(o<At){const _=l,y=_+o,x=Math.cos(_),T=Math.sin(_),R=Math.cos(y),C=Math.sin(y),P=(q,Z,$)=>ir(q,_,y,!0)?1:Math.max(Z,Z*s,$,$*s),D=(q,Z,$)=>ir(q,_,y,!0)?-1:Math.min(Z,Z*s,$,$*s),F=P(0,x,R),N=P(bt,T,C),z=D(Nt,x,R),W=D(Nt+bt,T,C);h=(F-z)/2,c=(N-W)/2,f=-(F+z)/2,d=-(N+W)/2}return{ratioX:h,ratioY:c,offsetX:f,offsetY:d}}class lr extends nn{constructor(o,s){super(o,s);this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(o,s){const h=this.getDataset().data,c=this._cachedMeta;if(this._parsing===!1)c._parsed=h;else{let f=y=>+h[y];if(vt(h[o])){const{key:y="value"}=this._parsing;f=x=>+tn(h[x],y)}let d,_;for(d=o,_=o+s;d<_;++d)c._parsed[d]=f(d)}}_getRotation(){return $e(this.options.rotation-90)}_getCircumference(){return $e(this.options.circumference)}_getRotationExtents(){let o=At,s=-At;for(let h=0;h<this.chart.data.datasets.length;++h)if(this.chart.isDatasetVisible(h)){const c=this.chart.getDatasetMeta(h).controller,f=c._getRotation(),d=c._getCircumference();o=Math.min(o,f),s=Math.max(s,f+d)}return{rotation:o,circumference:s-o}}update(o){const s=this.chart,{chartArea:h}=s,c=this._cachedMeta,f=c.data,d=this.getMaxBorderWidth()+this.getMaxOffset(f)+this.options.spacing,_=Math.max((Math.min(h.width,h.height)-d)/2,0),y=Math.min(Qi(this.options.cutout,_),1),x=this._getRingWeight(this.index),{circumference:T,rotation:R}=this._getRotationExtents(),{ratioX:C,ratioY:P,offsetX:D,offsetY:F}=Pv(R,T,y),N=(h.width-d)/C,z=(h.height-d)/P,W=Math.max(Math.min(N,z)/2,0),q=yi(this.options.radius,W),Z=Math.max(q*y,0),$=(q-Z)/this._getVisibleDatasetWeightTotal();this.offsetX=D*q,this.offsetY=F*q,c.total=this.calculateTotal(),this.outerRadius=q-$*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-$*x,0),this.updateElements(f,0,f.length,o)}_circumference(o,s){const h=this.options,c=this._cachedMeta,f=this._getCircumference();return s&&h.animation.animateRotate||!this.chart.getDataVisibility(o)||c._parsed[o]===null||c.data[o].hidden?0:this.calculateCircumference(c._parsed[o]*f/At)}updateElements(o,s,h,c){const f=c==="reset",d=this.chart,_=d.chartArea,x=d.options.animation,T=(_.left+_.right)/2,R=(_.top+_.bottom)/2,C=f&&x.animateScale,P=C?0:this.innerRadius,D=C?0:this.outerRadius,F=this.resolveDataElementOptions(s,c),N=this.getSharedOptions(F),z=this.includeOptions(c,N);let W=this._getRotation(),q;for(q=0;q<s;++q)W+=this._circumference(q,f);for(q=s;q<s+h;++q){const Z=this._circumference(q,f),$=o[q],ot={x:T+this.offsetX,y:R+this.offsetY,startAngle:W,endAngle:W+Z,circumference:Z,outerRadius:D,innerRadius:P};z&&(ot.options=N||this.resolveDataElementOptions(q,$.active?"active":c)),W+=Z,this.updateElement($,q,ot,c)}this.updateSharedOptions(N,c,F)}calculateTotal(){const o=this._cachedMeta,s=o.data;let h=0,c;for(c=0;c<s.length;c++){const f=o._parsed[c];f!==null&&!isNaN(f)&&this.chart.getDataVisibility(c)&&!s[c].hidden&&(h+=Math.abs(f))}return h}calculateCircumference(o){const s=this._cachedMeta.total;return s>0&&!isNaN(o)?At*(Math.abs(o)/s):0}getLabelAndValue(o){const s=this._cachedMeta,h=this.chart,c=h.data.labels||[],f=ar(s._parsed[o],h.options.locale);return{label:c[o]||"",value:f}}getMaxBorderWidth(o){let s=0;const h=this.chart;let c,f,d,_,y;if(!o){for(c=0,f=h.data.datasets.length;c<f;++c)if(h.isDatasetVisible(c)){d=h.getDatasetMeta(c),o=d.data,_=d.controller;break}}if(!o)return 0;for(c=0,f=o.length;c<f;++c)y=_.resolveDataElementOptions(c),y.borderAlign!=="inner"&&(s=Math.max(s,y.borderWidth||0,y.hoverBorderWidth||0));return s}getMaxOffset(o){let s=0;for(let h=0,c=o.length;h<c;++h){const f=this.resolveDataElementOptions(h);s=Math.max(s,f.offset||0,f.hoverOffset||0)}return s}_getRingWeightOffset(o){let s=0;for(let h=0;h<o;++h)this.chart.isDatasetVisible(h)&&(s+=this._getRingWeight(h));return s}_getRingWeight(o){return Math.max(gt(this.chart.data.datasets[o].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}lr.id="doughnut",lr.defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"},lr.descriptors={_scriptable:l=>l!=="spacing",_indexable:l=>l!=="spacing"},lr.overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(l){const o=l.data;if(o.labels.length&&o.datasets.length){const{labels:{pointStyle:s}}=l.legend.options;return o.labels.map((h,c)=>{const d=l.getDatasetMeta(0).controller.getStyle(c);return{text:h,fillStyle:d.backgroundColor,strokeStyle:d.borderColor,lineWidth:d.borderWidth,pointStyle:s,hidden:!l.getDataVisibility(c),index:c}})}return[]}},onClick(l,o,s){s.chart.toggleDataVisibility(o.index),s.chart.update()}},tooltip:{callbacks:{title(){return""},label(l){let o=l.label;const s=": "+l.formattedValue;return Dt(o)?(o=o.slice(),o[0]+=s):o+=s,o}}}}};class ro extends nn{initialize(){this.enableOptionSharing=!0,super.initialize()}update(o){const s=this._cachedMeta,{dataset:h,data:c=[],_dataset:f}=s,d=this.chart._animationsDisabled;let{start:_,count:y}=Mv(s,c,d);this._drawStart=_,this._drawCount=y,Lv(s)&&(_=0,y=c.length),h._chart=this.chart,h._datasetIndex=this.index,h._decimated=!!f._decimated,h.points=c;const x=this.resolveDatasetElementOptions(o);this.options.showLine||(x.borderWidth=0),x.segment=this.options.segment,this.updateElement(h,void 0,{animated:!d,options:x},o),this.updateElements(c,_,y,o)}updateElements(o,s,h,c){const f=c==="reset",{iScale:d,vScale:_,_stacked:y,_dataset:x}=this._cachedMeta,T=this.resolveDataElementOptions(s,c),R=this.getSharedOptions(T),C=this.includeOptions(c,R),P=d.axis,D=_.axis,{spanGaps:F,segment:N}=this.options,z=er(F)?F:Number.POSITIVE_INFINITY,W=this.chart._animationsDisabled||f||c==="none";let q=s>0&&this.getParsed(s-1);for(let Z=s;Z<s+h;++Z){const $=o[Z],ot=this.getParsed(Z),nt=W?$:{},ct=Ot(ot[D]),lt=nt[P]=d.getPixelForValue(ot[P],Z),Gt=nt[D]=f||ct?_.getBasePixel():_.getPixelForValue(y?this.applyStack(_,ot,y):ot[D],Z);nt.skip=isNaN(lt)||isNaN(Gt)||ct,nt.stop=Z>0&&ot[P]-q[P]>z,N&&(nt.parsed=ot,nt.raw=x.data[Z]),C&&(nt.options=R||this.resolveDataElementOptions(Z,$.active?"active":c)),W||this.updateElement($,Z,nt,c),q=ot}this.updateSharedOptions(R,c,T)}getMaxOverflow(){const o=this._cachedMeta,s=o.dataset,h=s.options&&s.options.borderWidth||0,c=o.data||[];if(!c.length)return h;const f=c[0].size(this.resolveDataElementOptions(0)),d=c[c.length-1].size(this.resolveDataElementOptions(c.length-1));return Math.max(h,f,d)/2}draw(){const o=this._cachedMeta;o.dataset.updateControlPoints(this.chart.chartArea,o.iScale.axis),super.draw()}}ro.id="line",ro.defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1},ro.overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};function Mv(l,o,s){const h=o.length;let c=0,f=h;if(l._sorted){const{iScale:d,_parsed:_}=l,y=d.axis,{min:x,max:T,minDefined:R,maxDefined:C}=d.getUserBounds();R&&(c=de(Math.min(cn(_,d.axis,x).lo,s?h:cn(o,y,d.getPixelForValue(x)).lo),0,h-1)),C?f=de(Math.max(cn(_,d.axis,T).hi+1,s?0:cn(o,y,d.getPixelForValue(T)).hi+1),c,h)-c:f=h-c}return{start:c,count:f}}function Lv(l){const{xScale:o,yScale:s,_scaleRanges:h}=l,c={xmin:o.min,xmax:o.max,ymin:s.min,ymax:s.max};if(!h)return l._scaleRanges=c,!0;const f=h.xmin!==o.min||h.xmax!==o.max||h.ymin!==s.min||h.ymax!==s.max;return Object.assign(h,c),f}class cs extends nn{constructor(o,s){super(o,s);this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(o){const s=this._cachedMeta,h=this.chart,c=h.data.labels||[],f=ar(s._parsed[o].r,h.options.locale);return{label:c[o]||"",value:f}}update(o){const s=this._cachedMeta.data;this._updateRadius(),this.updateElements(s,0,s.length,o)}_updateRadius(){const o=this.chart,s=o.chartArea,h=o.options,c=Math.min(s.right-s.left,s.bottom-s.top),f=Math.max(c/2,0),d=Math.max(h.cutoutPercentage?f/100*h.cutoutPercentage:1,0),_=(f-d)/o.getVisibleDatasetCount();this.outerRadius=f-_*this.index,this.innerRadius=this.outerRadius-_}updateElements(o,s,h,c){const f=c==="reset",d=this.chart,_=this.getDataset(),x=d.options.animation,T=this._cachedMeta.rScale,R=T.xCenter,C=T.yCenter,P=T.getIndexAngle(0)-.5*Nt;let D=P,F;const N=360/this.countVisibleElements();for(F=0;F<s;++F)D+=this._computeAngle(F,c,N);for(F=s;F<s+h;F++){const z=o[F];let W=D,q=D+this._computeAngle(F,c,N),Z=d.getDataVisibility(F)?T.getDistanceFromCenterForValue(_.data[F]):0;D=q,f&&(x.animateScale&&(Z=0),x.animateRotate&&(W=q=P));const $={x:R,y:C,innerRadius:0,outerRadius:Z,startAngle:W,endAngle:q,options:this.resolveDataElementOptions(F,z.active?"active":c)};this.updateElement(z,F,$,c)}}countVisibleElements(){const o=this.getDataset(),s=this._cachedMeta;let h=0;return s.data.forEach((c,f)=>{!isNaN(o.data[f])&&this.chart.getDataVisibility(f)&&h++}),h}_computeAngle(o,s,h){return this.chart.getDataVisibility(o)?$e(this.resolveDataElementOptions(o,s).angle||h):0}}cs.id="polarArea",cs.defaults={dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0},cs.overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(l){const o=l.data;if(o.labels.length&&o.datasets.length){const{labels:{pointStyle:s}}=l.legend.options;return o.labels.map((h,c)=>{const d=l.getDatasetMeta(0).controller.getStyle(c);return{text:h,fillStyle:d.backgroundColor,strokeStyle:d.borderColor,lineWidth:d.borderWidth,pointStyle:s,hidden:!l.getDataVisibility(c),index:c}})}return[]}},onClick(l,o,s){s.chart.toggleDataVisibility(o.index),s.chart.update()}},tooltip:{callbacks:{title(){return""},label(l){return l.chart.data.labels[l.dataIndex]+": "+l.formattedValue}}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}};class pl extends lr{}pl.id="pie",pl.defaults={cutout:0,rotation:0,circumference:360,radius:"100%"};class us extends nn{getLabelAndValue(o){const s=this._cachedMeta.vScale,h=this.getParsed(o);return{label:s.getLabels()[o],value:""+s.getLabelForValue(h[s.axis])}}update(o){const s=this._cachedMeta,h=s.dataset,c=s.data||[],f=s.iScale.getLabels();if(h.points=c,o!=="resize"){const d=this.resolveDatasetElementOptions(o);this.options.showLine||(d.borderWidth=0);const _={_loop:!0,_fullLoop:f.length===c.length,options:d};this.updateElement(h,void 0,_,o)}this.updateElements(c,0,c.length,o)}updateElements(o,s,h,c){const f=this.getDataset(),d=this._cachedMeta.rScale,_=c==="reset";for(let y=s;y<s+h;y++){const x=o[y],T=this.resolveDataElementOptions(y,x.active?"active":c),R=d.getPointPositionForValue(y,f.data[y]),C=_?d.xCenter:R.x,P=_?d.yCenter:R.y,D={x:C,y:P,angle:R.angle,skip:isNaN(C)||isNaN(P),options:T};this.updateElement(x,y,D,c)}}}us.id="radar",us.defaults={datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}},us.overrides={aspectRatio:1,scales:{r:{type:"radialLinear"}}};class fs extends ro{}fs.id="scatter",fs.defaults={showLine:!1,fill:!1},fs.overrides={interaction:{mode:"point"},plugins:{tooltip:{callbacks:{title(){return""},label(l){return"("+l.label+", "+l.formattedValue+")"}}}},scales:{x:{type:"linear"},y:{type:"linear"}}};var Du=Object.freeze({__proto__:null,BarController:ls,BubbleController:hs,DoughnutController:lr,LineController:ro,PolarAreaController:cs,PieController:pl,RadarController:us,ScatterController:fs});function ku(l,o,s){const{startAngle:h,pixelMargin:c,x:f,y:d,outerRadius:_,innerRadius:y}=o;let x=c/_;l.beginPath(),l.arc(f,d,_,h-x,s+x),y>c?(x=c/y,l.arc(f,d,y,s+x,h-x,!0)):l.arc(f,d,c,s+bt,h-bt),l.closePath(),l.clip()}function Dv(l){return qo(l,["outerStart","outerEnd","innerStart","innerEnd"])}function kv(l,o,s,h){const c=Dv(l.options.borderRadius),f=(s-o)/2,d=Math.min(f,h*o/2),_=y=>{const x=(s-Math.min(f,y))*h/2;return de(y,0,Math.min(f,x))};return{outerStart:_(c.outerStart),outerEnd:_(c.outerEnd),innerStart:de(c.innerStart,0,d),innerEnd:de(c.innerEnd,0,d)}}function hr(l,o,s,h){return{x:s+l*Math.cos(o),y:h+l*Math.sin(o)}}function gl(l,o,s,h,c){const{x:f,y:d,startAngle:_,pixelMargin:y,innerRadius:x}=o,T=Math.max(o.outerRadius+h+s-y,0),R=x>0?x+h+s+y:0;let C=0;const P=c-_;if(h){const Vt=x>0?x-h:0,lo=T>0?T-h:0,Ai=(Vt+lo)/2,ho=Ai!==0?P*Ai/(Ai+h):P;C=(P-ho)/2}const D=Math.max(.001,P*T-s/Nt)/T,F=(P-D)/2,N=_+F+C,z=c-F-C,{outerStart:W,outerEnd:q,innerStart:Z,innerEnd:$}=kv(o,R,T,z-N),ot=T-W,nt=T-q,ct=N+W/ot,lt=z-q/nt,Gt=R+Z,Ft=R+$,Pt=N+Z/Gt,he=z-$/Ft;if(l.beginPath(),l.arc(f,d,T,ct,lt),q>0){const Vt=hr(nt,lt,f,d);l.arc(Vt.x,Vt.y,q,lt,z+bt)}const Ce=hr(Ft,z,f,d);if(l.lineTo(Ce.x,Ce.y),$>0){const Vt=hr(Ft,he,f,d);l.arc(Vt.x,Vt.y,$,z+bt,he+Math.PI)}if(l.arc(f,d,R,z-$/R,N+Z/R,!0),Z>0){const Vt=hr(Gt,Pt,f,d);l.arc(Vt.x,Vt.y,Z,Pt+Math.PI,N-bt)}const Tt=hr(ot,N,f,d);if(l.lineTo(Tt.x,Tt.y),W>0){const Vt=hr(ot,ct,f,d);l.arc(Vt.x,Vt.y,W,N-bt,ct)}l.closePath()}function Fv(l,o,s,h){const{fullCircles:c,startAngle:f,circumference:d}=o;let _=o.endAngle;if(c){gl(l,o,s,h,f+At);for(let y=0;y<c;++y)l.fill();isNaN(d)||(_=f+d%At,d%At===0&&(_+=At))}return gl(l,o,s,h,_),l.fill(),_}function Nv(l,o,s){const{x:h,y:c,startAngle:f,pixelMargin:d,fullCircles:_}=o,y=Math.max(o.outerRadius-d,0),x=o.innerRadius+d;let T;for(s&&ku(l,o,f+At),l.beginPath(),l.arc(h,c,x,f+At,f,!0),T=0;T<_;++T)l.stroke();for(l.beginPath(),l.arc(h,c,y,f,f+At),T=0;T<_;++T)l.stroke()}function Bv(l,o,s,h,c){const{options:f}=o,{borderWidth:d,borderJoinStyle:_}=f,y=f.borderAlign==="inner";!d||(y?(l.lineWidth=d*2,l.lineJoin=_||"round"):(l.lineWidth=d,l.lineJoin=_||"bevel"),o.fullCircles&&Nv(l,o,y),y&&ku(l,o,c),gl(l,o,s,h,c),l.stroke())}class ds extends Ke{constructor(o){super();this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,o&&Object.assign(this,o)}inRange(o,s,h){const c=this.getProps(["x","y"],h),{angle:f,distance:d}=Ga(c,{x:o,y:s}),{startAngle:_,endAngle:y,innerRadius:x,outerRadius:T,circumference:R}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],h),C=this.options.spacing/2,D=gt(R,y-_)>=At||ir(f,_,y),F=hn(d,x+C,T+C);return D&&F}getCenterPoint(o){const{x:s,y:h,startAngle:c,endAngle:f,innerRadius:d,outerRadius:_}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius","circumference"],o),{offset:y,spacing:x}=this.options,T=(c+f)/2,R=(d+_+x+y)/2;return{x:s+Math.cos(T)*R,y:h+Math.sin(T)*R}}tooltipPosition(o){return this.getCenterPoint(o)}draw(o){const{options:s,circumference:h}=this,c=(s.offset||0)/2,f=(s.spacing||0)/2;if(this.pixelMargin=s.borderAlign==="inner"?.33:0,this.fullCircles=h>At?Math.floor(h/At):0,h===0||this.innerRadius<0||this.outerRadius<0)return;o.save();let d=0;if(c){d=c/2;const y=(this.startAngle+this.endAngle)/2;o.translate(Math.cos(y)*d,Math.sin(y)*d),this.circumference>=Nt&&(d=c)}o.fillStyle=s.backgroundColor,o.strokeStyle=s.borderColor;const _=Fv(o,this,d,f);Bv(o,this,d,f,_),o.restore()}}ds.id="arc",ds.defaults={borderAlign:"center",borderColor:"#fff",borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0},ds.defaultRoutes={backgroundColor:"backgroundColor"};function Fu(l,o,s=o){l.lineCap=gt(s.borderCapStyle,o.borderCapStyle),l.setLineDash(gt(s.borderDash,o.borderDash)),l.lineDashOffset=gt(s.borderDashOffset,o.borderDashOffset),l.lineJoin=gt(s.borderJoinStyle,o.borderJoinStyle),l.lineWidth=gt(s.borderWidth,o.borderWidth),l.strokeStyle=gt(s.borderColor,o.borderColor)}function Gv(l,o,s){l.lineTo(s.x,s.y)}function zv(l){return l.stepped?pc:l.tension||l.cubicInterpolationMode==="monotone"?gc:Gv}function Nu(l,o,s={}){const h=l.length,{start:c=0,end:f=h-1}=s,{start:d,end:_}=o,y=Math.max(c,d),x=Math.min(f,_),T=c<d&&f<d||c>_&&f>_;return{count:h,start:y,loop:o.loop,ilen:x<y&&!T?h+x-y:x-y}}function Uv(l,o,s,h){const{points:c,options:f}=o,{count:d,start:_,loop:y,ilen:x}=Nu(c,s,h),T=zv(f);let{move:R=!0,reverse:C}=h||{},P,D,F;for(P=0;P<=x;++P)D=c[(_+(C?x-P:P))%d],!D.skip&&(R?(l.moveTo(D.x,D.y),R=!1):T(l,F,D,C,f.stepped),F=D);return y&&(D=c[(_+(C?x:0))%d],T(l,F,D,C,f.stepped)),!!y}function Vv(l,o,s,h){const c=o.points,{count:f,start:d,ilen:_}=Nu(c,s,h),{move:y=!0,reverse:x}=h||{};let T=0,R=0,C,P,D,F,N,z;const W=Z=>(d+(x?_-Z:Z))%f,q=()=>{F!==N&&(l.lineTo(T,N),l.lineTo(T,F),l.lineTo(T,z))};for(y&&(P=c[W(0)],l.moveTo(P.x,P.y)),C=0;C<=_;++C){if(P=c[W(C)],P.skip)continue;const Z=P.x,$=P.y,ot=Z|0;ot===D?($<F?F=$:$>N&&(N=$),T=(R*T+Z)/++R):(q(),l.lineTo(Z,$),D=ot,R=0,F=N=$),z=$}q()}function _l(l){const o=l.options,s=o.borderDash&&o.borderDash.length;return!l._decimated&&!l._loop&&!o.tension&&o.cubicInterpolationMode!=="monotone"&&!o.stepped&&!s?Vv:Uv}function Xv(l){return l.stepped?Xc:l.tension||l.cubicInterpolationMode==="monotone"?jc:Wn}function jv(l,o,s,h){let c=o._path;c||(c=o._path=new Path2D,o.path(c,s,h)&&c.closePath()),Fu(l,o.options),l.stroke(c)}function Wv(l,o,s,h){const{segments:c,options:f}=o,d=_l(o);for(const _ of c)Fu(l,f,_.style),l.beginPath(),d(l,o,_,{start:s,end:s+h-1})&&l.closePath(),l.stroke()}const Hv=typeof Path2D=="function";function Yv(l,o,s,h){Hv&&!o.options.segment?jv(l,o,s,h):Wv(l,o,s,h)}class $n extends Ke{constructor(o){super();this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,o&&Object.assign(this,o)}updateControlPoints(o,s){const h=this.options;if((h.tension||h.cubicInterpolationMode==="monotone")&&!h.stepped&&!this._pointsUpdated){const c=h.spanGaps?this._loop:this._fullLoop;zc(this._points,h,o,c,s),this._pointsUpdated=!0}}set points(o){this._points=o,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=$c(this,this.options.segment))}first(){const o=this.segments,s=this.points;return o.length&&s[o[0].start]}last(){const o=this.segments,s=this.points,h=o.length;return h&&s[o[h-1].end]}interpolate(o,s){const h=this.options,c=o[s],f=this.points,d=rl(this,{property:s,start:c,end:c});if(!d.length)return;const _=[],y=Xv(h);let x,T;for(x=0,T=d.length;x<T;++x){const{start:R,end:C}=d[x],P=f[R],D=f[C];if(P===D){_.push(P);continue}const F=Math.abs((c-P[s])/(D[s]-P[s])),N=y(P,D,F,h.stepped);N[s]=o[s],_.push(N)}return _.length===1?_[0]:_}pathSegment(o,s,h){return _l(this)(o,this,s,h)}path(o,s,h){const c=this.segments,f=_l(this);let d=this._loop;s=s||0,h=h||this.points.length-s;for(const _ of c)d&=f(o,this,_,{start:s,end:s+h-1});return!!d}draw(o,s,h,c){const f=this.options||{};(this.points||[]).length&&f.borderWidth&&(o.save(),Yv(o,this,h,c),o.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}$n.id="line",$n.defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0},$n.defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"},$n.descriptors={_scriptable:!0,_indexable:l=>l!=="borderDash"&&l!=="fill"};function Bu(l,o,s,h){const c=l.options,{[s]:f}=l.getProps([s],h);return Math.abs(o-f)<c.radius+c.hitRadius}class ps extends Ke{constructor(o){super();this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,o&&Object.assign(this,o)}inRange(o,s,h){const c=this.options,{x:f,y:d}=this.getProps(["x","y"],h);return Math.pow(o-f,2)+Math.pow(s-d,2)<Math.pow(c.hitRadius+c.radius,2)}inXRange(o,s){return Bu(this,o,"x",s)}inYRange(o,s){return Bu(this,o,"y",s)}getCenterPoint(o){const{x:s,y:h}=this.getProps(["x","y"],o);return{x:s,y:h}}size(o){o=o||this.options||{};let s=o.radius||0;s=Math.max(s,s&&o.hoverRadius||0);const h=s&&o.borderWidth||0;return(s+h)*2}draw(o,s){const h=this.options;this.skip||h.radius<.1||!Xn(this,s,this.size(h)/2)||(o.strokeStyle=h.borderColor,o.lineWidth=h.borderWidth,o.fillStyle=h.backgroundColor,Wr(o,h,this.x,this.y))}getRange(){const o=this.options||{};return o.radius+o.hitRadius}}ps.id="point",ps.defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0},ps.defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};function Gu(l,o){const{x:s,y:h,base:c,width:f,height:d}=l.getProps(["x","y","base","width","height"],o);let _,y,x,T,R;return l.horizontal?(R=d/2,_=Math.min(s,c),y=Math.max(s,c),x=h-R,T=h+R):(R=f/2,_=s-R,y=s+R,x=Math.min(h,c),T=Math.max(h,c)),{left:_,top:x,right:y,bottom:T}}function Kn(l,o,s,h){return l?0:de(o,s,h)}function $v(l,o,s){const h=l.options.borderWidth,c=l.borderSkipped,f=qa(h);return{t:Kn(c.top,f.top,0,s),r:Kn(c.right,f.right,0,o),b:Kn(c.bottom,f.bottom,0,s),l:Kn(c.left,f.left,0,o)}}function Kv(l,o,s){const{enableBorderRadius:h}=l.getProps(["enableBorderRadius"]),c=l.options.borderRadius,f=Ri(c),d=Math.min(o,s),_=l.borderSkipped,y=h||vt(c);return{topLeft:Kn(!y||_.top||_.left,f.topLeft,0,d),topRight:Kn(!y||_.top||_.right,f.topRight,0,d),bottomLeft:Kn(!y||_.bottom||_.left,f.bottomLeft,0,d),bottomRight:Kn(!y||_.bottom||_.right,f.bottomRight,0,d)}}function Zv(l){const o=Gu(l),s=o.right-o.left,h=o.bottom-o.top,c=$v(l,s/2,h/2),f=Kv(l,s/2,h/2);return{outer:{x:o.left,y:o.top,w:s,h,radius:f},inner:{x:o.left+c.l,y:o.top+c.t,w:s-c.l-c.r,h:h-c.t-c.b,radius:{topLeft:Math.max(0,f.topLeft-Math.max(c.t,c.l)),topRight:Math.max(0,f.topRight-Math.max(c.t,c.r)),bottomLeft:Math.max(0,f.bottomLeft-Math.max(c.b,c.l)),bottomRight:Math.max(0,f.bottomRight-Math.max(c.b,c.r))}}}}function vl(l,o,s,h){const c=o===null,f=s===null,_=l&&!(c&&f)&&Gu(l,h);return _&&(c||hn(o,_.left,_.right))&&(f||hn(s,_.top,_.bottom))}function qv(l){return l.topLeft||l.topRight||l.bottomLeft||l.bottomRight}function Jv(l,o){l.rect(o.x,o.y,o.w,o.h)}function yl(l,o,s={}){const h=l.x!==s.x?-o:0,c=l.y!==s.y?-o:0,f=(l.x+l.w!==s.x+s.w?o:0)-h,d=(l.y+l.h!==s.y+s.h?o:0)-c;return{x:l.x+h,y:l.y+c,w:l.w+f,h:l.h+d,radius:l.radius}}class gs extends Ke{constructor(o){super();this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,o&&Object.assign(this,o)}draw(o){const{inflateAmount:s,options:{borderColor:h,backgroundColor:c}}=this,{inner:f,outer:d}=Zv(this),_=qv(d.radius)?$r:Jv;o.save(),(d.w!==f.w||d.h!==f.h)&&(o.beginPath(),_(o,yl(d,s,f)),o.clip(),_(o,yl(f,-s,d)),o.fillStyle=h,o.fill("evenodd")),o.beginPath(),_(o,yl(f,s)),o.fillStyle=c,o.fill(),o.restore()}inRange(o,s,h){return vl(this,o,s,h)}inXRange(o,s){return vl(this,o,null,s)}inYRange(o,s){return vl(this,null,o,s)}getCenterPoint(o){const{x:s,y:h,base:c,horizontal:f}=this.getProps(["x","y","base","horizontal"],o);return{x:f?(s+c)/2:s,y:f?h:(h+c)/2}}getRange(o){return o==="x"?this.width/2:this.height/2}}gs.id="bar",gs.defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0},gs.defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};var ml=Object.freeze({__proto__:null,ArcElement:ds,LineElement:$n,PointElement:ps,BarElement:gs});function Qv(l,o,s,h,c){const f=c.samples||h;if(f>=s)return l.slice(o,o+s);const d=[],_=(s-2)/(f-2);let y=0;const x=o+s-1;let T=o,R,C,P,D,F;for(d[y++]=l[T],R=0;R<f-2;R++){let N=0,z=0,W;const q=Math.floor((R+1)*_)+1+o,Z=Math.min(Math.floor((R+2)*_)+1,s)+o,$=Z-q;for(W=q;W<Z;W++)N+=l[W].x,z+=l[W].y;N/=$,z/=$;const ot=Math.floor(R*_)+1+o,nt=Math.min(Math.floor((R+1)*_)+1,s)+o,{x:ct,y:lt}=l[T];for(P=D=-1,W=ot;W<nt;W++)D=.5*Math.abs((ct-N)*(l[W].y-lt)-(ct-l[W].x)*(z-lt)),D>P&&(P=D,C=l[W],F=W);d[y++]=C,T=F}return d[y++]=l[x],d}function ty(l,o,s,h){let c=0,f=0,d,_,y,x,T,R,C,P,D,F;const N=[],z=o+s-1,W=l[o].x,Z=l[z].x-W;for(d=o;d<o+s;++d){_=l[d],y=(_.x-W)/Z*h,x=_.y;const $=y|0;if($===T)x<D?(D=x,R=d):x>F&&(F=x,C=d),c=(f*c+_.x)/++f;else{const ot=d-1;if(!Ot(R)&&!Ot(C)){const nt=Math.min(R,C),ct=Math.max(R,C);nt!==P&&nt!==ot&&N.push(Zn(On({},l[nt]),{x:c})),ct!==P&&ct!==ot&&N.push(Zn(On({},l[ct]),{x:c}))}d>0&&ot!==P&&N.push(l[ot]),N.push(_),T=$,f=0,D=F=x,R=C=P=d}}return N}function zu(l){if(l._decimated){const o=l._data;delete l._decimated,delete l._data,Object.defineProperty(l,"data",{value:o})}}function Uu(l){l.data.datasets.forEach(o=>{zu(o)})}function ey(l,o){const s=o.length;let h=0,c;const{iScale:f}=l,{min:d,max:_,minDefined:y,maxDefined:x}=f.getUserBounds();return y&&(h=de(cn(o,f.axis,d).lo,0,s-1)),x?c=de(cn(o,f.axis,_).hi+1,h,s)-h:c=s-h,{start:h,count:c}}var ny={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(l,o,s)=>{if(!s.enabled){Uu(l);return}const h=l.width;l.data.datasets.forEach((c,f)=>{const{_data:d,indexAxis:_}=c,y=l.getDatasetMeta(f),x=d||c.data;if(rr([_,l.options.indexAxis])==="y"||y.type!=="line")return;const T=l.scales[y.xAxisID];if(T.type!=="linear"&&T.type!=="time"||l.options.parsing)return;let{start:R,count:C}=ey(y,x);const P=s.threshold||4*h;if(C<=P){zu(c);return}Ot(d)&&(c._data=x,delete c.data,Object.defineProperty(c,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(F){this._data=F}}));let D;switch(s.algorithm){case"lttb":D=Qv(x,R,C,h,s);break;case"min-max":D=ty(x,R,C,h);break;default:throw new Error(`Unsupported decimation algorithm '${s.algorithm}'`)}c._decimated=D})},destroy(l){Uu(l)}};function iy(l,o){const s=l.getDatasetMeta(o);return s&&l.isDatasetVisible(o)?s.dataset:null}function ry(l){const o=l.options,s=o.fill;let h=gt(s&&s.target,s);return h===void 0&&(h=!!o.backgroundColor),h===!1||h===null?!1:h===!0?"origin":h}function oy(l,o,s){const h=ry(l);if(vt(h))return isNaN(h.value)?!1:h;let c=parseFloat(h);return jt(c)&&Math.floor(c)===c?((h[0]==="-"||h[0]==="+")&&(c=o+c),c===o||c<0||c>=s?!1:c):["origin","start","end","stack","shape"].indexOf(h)>=0&&h}function sy(l){const{scale:o={},fill:s}=l;let h=null,c;return s==="start"?h=o.bottom:s==="end"?h=o.top:vt(s)?h=o.getPixelForValue(s.value):o.getBasePixel&&(h=o.getBasePixel()),jt(h)?(c=o.isHorizontal(),{x:c?h:null,y:c?null:h}):null}class Vu{constructor(o){this.x=o.x,this.y=o.y,this.radius=o.radius}pathSegment(o,s,h){const{x:c,y:f,radius:d}=this;return s=s||{start:0,end:At},o.arc(c,f,d,s.end,s.start,!0),!h.bounds}interpolate(o){const{x:s,y:h,radius:c}=this,f=o.angle;return{x:s+Math.cos(f)*c,y:h+Math.sin(f)*c,angle:f}}}function ay(l){const{scale:o,fill:s}=l,h=o.options,c=o.getLabels().length,f=[],d=h.reverse?o.max:o.min,_=h.reverse?o.min:o.max;let y,x,T;if(s==="start"?T=d:s==="end"?T=_:vt(s)?T=s.value:T=o.getBaseValue(),h.grid.circular)return x=o.getPointPositionForValue(0,d),new Vu({x:x.x,y:x.y,radius:o.getDistanceFromCenterForValue(T)});for(y=0;y<c;++y)f.push(o.getPointPositionForValue(y,T));return f}function ly(l){return(l.scale||{}).getPointPositionForValue?ay(l):sy(l)}function xl(l,o,s){for(;o>l;o--){const h=s[o];if(!isNaN(h.x)&&!isNaN(h.y))break}return o}function hy(l,o){const{x:s=null,y:h=null}=l||{},c=o.points,f=[];return o.segments.forEach(({start:d,end:_})=>{_=xl(d,_,c);const y=c[d],x=c[_];h!==null?(f.push({x:y.x,y:h}),f.push({x:x.x,y:h})):s!==null&&(f.push({x:s,y:y.y}),f.push({x:s,y:x.y}))}),f}function cy(l){const{scale:o,index:s,line:h}=l,c=[],f=h.segments,d=h.points,_=uy(o,s);_.push(Xu({x:null,y:o.bottom},h));for(let y=0;y<f.length;y++){const x=f[y];for(let T=x.start;T<=x.end;T++)fy(c,d[T],_)}return new $n({points:c,options:{}})}function uy(l,o){const s=[],h=l.getMatchingVisibleMetas("line");for(let c=0;c<h.length;c++){const f=h[c];if(f.index===o)break;f.hidden||s.unshift(f.dataset)}return s}function fy(l,o,s){const h=[];for(let c=0;c<s.length;c++){const f=s[c],{first:d,last:_,point:y}=dy(f,o,"x");if(!(!y||d&&_)){if(d)h.unshift(y);else if(l.push(y),!_)break}}l.push(...h)}function dy(l,o,s){const h=l.interpolate(o,s);if(!h)return{};const c=h[s],f=l.segments,d=l.points;let _=!1,y=!1;for(let x=0;x<f.length;x++){const T=f[x],R=d[T.start][s],C=d[T.end][s];if(hn(c,R,C)){_=c===R,y=c===C;break}}return{first:_,last:y,point:h}}function py(l){const{chart:o,fill:s,line:h}=l;if(jt(s))return iy(o,s);if(s==="stack")return cy(l);if(s==="shape")return!0;const c=ly(l);return c instanceof Vu?c:Xu(c,h)}function Xu(l,o){let s=[],h=!1;return Dt(l)?(h=!0,s=l):s=hy(l,o),s.length?new $n({points:s,options:{tension:0},_loop:h,_fullLoop:h}):null}function gy(l,o,s){let c=l[o].fill;const f=[o];let d;if(!s)return c;for(;c!==!1&&f.indexOf(c)===-1;){if(!jt(c))return c;if(d=l[c],!d)return!1;if(d.visible)return c;f.push(c),c=d.fill}return!1}function ju(l,o,s){const{segments:h,points:c}=o;let f=!0,d=!1;l.beginPath();for(const _ of h){const{start:y,end:x}=_,T=c[y],R=c[xl(y,x,c)];f?(l.moveTo(T.x,T.y),f=!1):(l.lineTo(T.x,s),l.lineTo(T.x,T.y)),d=!!o.pathSegment(l,_,{move:d}),d?l.closePath():l.lineTo(R.x,s)}l.lineTo(o.first().x,s),l.closePath(),l.clip()}function bl(l,o,s,h){if(h)return;let c=o[l],f=s[l];return l==="angle"&&(c=Pe(c),f=Pe(f)),{property:l,start:c,end:f}}function Wu(l,o,s,h){return l&&o?h(l[s],o[s]):l?l[s]:o?o[s]:0}function _y(l,o,s){const h=l.segments,c=l.points,f=o.points,d=[];for(const _ of h){let{start:y,end:x}=_;x=xl(y,x,c);const T=bl(s,c[y],c[x],_.loop);if(!o.segments){d.push({source:_,target:T,start:c[y],end:c[x]});continue}const R=rl(o,T);for(const C of R){const P=bl(s,f[C.start],f[C.end],C.loop),D=il(_,c,P);for(const F of D)d.push({source:F,target:C,start:{[s]:Wu(T,P,"start",Math.max)},end:{[s]:Wu(T,P,"end",Math.min)}})}}return d}function vy(l,o,s){const{top:h,bottom:c}=o.chart.chartArea,{property:f,start:d,end:_}=s||{};f==="x"&&(l.beginPath(),l.rect(d,h,_-d,c-h),l.clip())}function Hu(l,o,s,h){const c=o.interpolate(s,h);c&&l.lineTo(c.x,c.y)}function Yu(l,o){const{line:s,target:h,property:c,color:f,scale:d}=o,_=_y(s,h,c);for(const{source:y,target:x,start:T,end:R}of _){const{style:{backgroundColor:C=f}={}}=y,P=h!==!0;l.save(),l.fillStyle=C,vy(l,d,P&&bl(c,T,R)),l.beginPath();const D=!!s.pathSegment(l,y);let F;if(P){D?l.closePath():Hu(l,h,R,c);const N=!!h.pathSegment(l,x,{move:D,reverse:!0});F=D&&N,F||Hu(l,h,T,c)}l.closePath(),l.fill(F?"evenodd":"nonzero"),l.restore()}}function yy(l,o){const{line:s,target:h,above:c,below:f,area:d,scale:_}=o,y=s._loop?"angle":o.axis;l.save(),y==="x"&&f!==c&&(ju(l,h,d.top),Yu(l,{line:s,target:h,color:c,scale:_,property:y}),l.restore(),l.save(),ju(l,h,d.bottom)),Yu(l,{line:s,target:h,color:f,scale:_,property:y}),l.restore()}function El(l,o,s){const h=py(o),{line:c,scale:f,axis:d}=o,_=c.options,y=_.fill,x=_.backgroundColor,{above:T=x,below:R=x}=y||{};h&&c.points.length&&(Hr(l,s),yy(l,{line:c,target:h,above:T,below:R,area:s,scale:f,axis:d}),Yr(l))}var my={id:"filler",afterDatasetsUpdate(l,o,s){const h=(l.data.datasets||[]).length,c=[];let f,d,_,y;for(d=0;d<h;++d)f=l.getDatasetMeta(d),_=f.dataset,y=null,_&&_.options&&_ instanceof $n&&(y={visible:l.isDatasetVisible(d),index:d,fill:oy(_,d,h),chart:l,axis:f.controller.options.indexAxis,scale:f.vScale,line:_}),f.$filler=y,c.push(y);for(d=0;d<h;++d)y=c[d],!(!y||y.fill===!1)&&(y.fill=gy(c,d,s.propagate))},beforeDraw(l,o,s){const h=s.drawTime==="beforeDraw",c=l.getSortedVisibleDatasetMetas(),f=l.chartArea;for(let d=c.length-1;d>=0;--d){const _=c[d].$filler;!_||(_.line.updateControlPoints(f,_.axis),h&&El(l.ctx,_,f))}},beforeDatasetsDraw(l,o,s){if(s.drawTime!=="beforeDatasetsDraw")return;const h=l.getSortedVisibleDatasetMetas();for(let c=h.length-1;c>=0;--c){const f=h[c].$filler;f&&El(l.ctx,f,l.chartArea)}},beforeDatasetDraw(l,o,s){const h=o.meta.$filler;!h||h.fill===!1||s.drawTime!=="beforeDatasetDraw"||El(l.ctx,h,l.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const $u=(l,o)=>{let{boxHeight:s=o,boxWidth:h=o}=l;return l.usePointStyle&&(s=Math.min(s,o),h=Math.min(h,o)),{boxWidth:h,boxHeight:s,itemHeight:Math.max(o,s)}},xy=(l,o)=>l!==null&&o!==null&&l.datasetIndex===o.datasetIndex&&l.index===o.index;class Ku extends Ke{constructor(o){super();this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=o.chart,this.options=o.options,this.ctx=o.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(o,s,h){this.maxWidth=o,this.maxHeight=s,this._margins=h,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const o=this.options.labels||{};let s=kt(o.generateLabels,[this.chart],this)||[];o.filter&&(s=s.filter(h=>o.filter(h,this.chart.data))),o.sort&&(s=s.sort((h,c)=>o.sort(h,c,this.chart.data))),this.options.reverse&&s.reverse(),this.legendItems=s}fit(){const{options:o,ctx:s}=this;if(!o.display){this.width=this.height=0;return}const h=o.labels,c=le(h.font),f=c.size,d=this._computeTitleHeight(),{boxWidth:_,itemHeight:y}=$u(h,f);let x,T;s.font=c.string,this.isHorizontal()?(x=this.maxWidth,T=this._fitRows(d,f,_,y)+10):(T=this.maxHeight,x=this._fitCols(d,f,_,y)+10),this.width=Math.min(x,o.maxWidth||this.maxWidth),this.height=Math.min(T,o.maxHeight||this.maxHeight)}_fitRows(o,s,h,c){const{ctx:f,maxWidth:d,options:{labels:{padding:_}}}=this,y=this.legendHitBoxes=[],x=this.lineWidths=[0],T=c+_;let R=o;f.textAlign="left",f.textBaseline="middle";let C=-1,P=-T;return this.legendItems.forEach((D,F)=>{const N=h+s/2+f.measureText(D.text).width;(F===0||x[x.length-1]+N+2*_>d)&&(R+=T,x[x.length-(F>0?0:1)]=0,P+=T,C++),y[F]={left:0,top:P,row:C,width:N,height:c},x[x.length-1]+=N+_}),R}_fitCols(o,s,h,c){const{ctx:f,maxHeight:d,options:{labels:{padding:_}}}=this,y=this.legendHitBoxes=[],x=this.columnSizes=[],T=d-o;let R=_,C=0,P=0,D=0,F=0;return this.legendItems.forEach((N,z)=>{const W=h+s/2+f.measureText(N.text).width;z>0&&P+c+2*_>T&&(R+=C+_,x.push({width:C,height:P}),D+=C+_,F++,C=P=0),y[z]={left:D,top:P,col:F,width:W,height:c},C=Math.max(C,W),P+=c+_}),R+=C,x.push({width:C,height:P}),R}adjustHitBoxes(){if(!this.options.display)return;const o=this._computeTitleHeight(),{legendHitBoxes:s,options:{align:h,labels:{padding:c},rtl:f}}=this,d=Oi(f,this.left,this.width);if(this.isHorizontal()){let _=0,y=p(h,this.left+c,this.right-this.lineWidths[_]);for(const x of s)_!==x.row&&(_=x.row,y=p(h,this.left+c,this.right-this.lineWidths[_])),x.top+=this.top+o+c,x.left=d.leftForLtr(d.x(y),x.width),y+=x.width+c}else{let _=0,y=p(h,this.top+o+c,this.bottom-this.columnSizes[_].height);for(const x of s)x.col!==_&&(_=x.col,y=p(h,this.top+o+c,this.bottom-this.columnSizes[_].height)),x.top=y,x.left+=this.left+c,x.left=d.leftForLtr(d.x(x.left),x.width),y+=x.height+c}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const o=this.ctx;Hr(o,this),this._draw(),Yr(o)}}_draw(){const{options:o,columnSizes:s,lineWidths:h,ctx:c}=this,{align:f,labels:d}=o,_=Et.color,y=Oi(o.rtl,this.left,this.width),x=le(d.font),{color:T,padding:R}=d,C=x.size,P=C/2;let D;this.drawTitle(),c.textAlign=y.textAlign("left"),c.textBaseline="middle",c.lineWidth=.5,c.font=x.string;const{boxWidth:F,boxHeight:N,itemHeight:z}=$u(d,C),W=function(nt,ct,lt){if(isNaN(F)||F<=0||isNaN(N)||N<0)return;c.save();const Gt=gt(lt.lineWidth,1);if(c.fillStyle=gt(lt.fillStyle,_),c.lineCap=gt(lt.lineCap,"butt"),c.lineDashOffset=gt(lt.lineDashOffset,0),c.lineJoin=gt(lt.lineJoin,"miter"),c.lineWidth=Gt,c.strokeStyle=gt(lt.strokeStyle,_),c.setLineDash(gt(lt.lineDash,[])),d.usePointStyle){const Ft={radius:F*Math.SQRT2/2,pointStyle:lt.pointStyle,rotation:lt.rotation,borderWidth:Gt},Pt=y.xPlus(nt,F/2),he=ct+P;Wr(c,Ft,Pt,he)}else{const Ft=ct+Math.max((C-N)/2,0),Pt=y.leftForLtr(nt,F),he=Ri(lt.borderRadius);c.beginPath(),Object.values(he).some(Ce=>Ce!==0)?$r(c,{x:Pt,y:Ft,w:F,h:N,radius:he}):c.rect(Pt,Ft,F,N),c.fill(),Gt!==0&&c.stroke()}c.restore()},q=function(nt,ct,lt){jn(c,lt.text,nt,ct+z/2,x,{strikethrough:lt.hidden,textAlign:y.textAlign(lt.textAlign)})},Z=this.isHorizontal(),$=this._computeTitleHeight();Z?D={x:p(f,this.left+R,this.right-h[0]),y:this.top+R+$,line:0}:D={x:this.left+R,y:p(f,this.top+$+R,this.bottom-s[0].height),line:0},el(this.ctx,o.textDirection);const ot=z+R;this.legendItems.forEach((nt,ct)=>{c.strokeStyle=nt.fontColor||T,c.fillStyle=nt.fontColor||T;const lt=c.measureText(nt.text).width,Gt=y.textAlign(nt.textAlign||(nt.textAlign=d.textAlign)),Ft=F+P+lt;let Pt=D.x,he=D.y;y.setWidth(this.width),Z?ct>0&&Pt+Ft+R>this.right&&(he=D.y+=ot,D.line++,Pt=D.x=p(f,this.left+R,this.right-h[D.line])):ct>0&&he+ot>this.bottom&&(Pt=D.x=Pt+s[D.line].width+R,D.line++,he=D.y=p(f,this.top+$+R,this.bottom-s[D.line].height));const Ce=y.x(Pt);W(Ce,he,nt),Pt=g(Gt,Pt+F+P,Z?Pt+Ft:this.right,o.rtl),q(y.x(Pt),he,nt),Z?D.x+=Ft+R:D.y+=ot}),nl(this.ctx,o.textDirection)}drawTitle(){const o=this.options,s=o.title,h=le(s.font),c=ye(s.padding);if(!s.display)return;const f=Oi(o.rtl,this.left,this.width),d=this.ctx,_=s.position,y=h.size/2,x=c.top+y;let T,R=this.left,C=this.width;if(this.isHorizontal())C=Math.max(...this.lineWidths),T=this.top+x,R=p(o.align,R,this.right-C);else{const D=this.columnSizes.reduce((F,N)=>Math.max(F,N.height),0);T=x+p(o.align,this.top,this.bottom-D-o.labels.padding-this._computeTitleHeight())}const P=p(_,R,R+C);d.textAlign=f.textAlign(u(_)),d.textBaseline="middle",d.strokeStyle=s.color,d.fillStyle=s.color,d.font=h.string,jn(d,s.text,P,T,h)}_computeTitleHeight(){const o=this.options.title,s=le(o.font),h=ye(o.padding);return o.display?s.lineHeight+h.height:0}_getLegendItemAt(o,s){let h,c,f;if(hn(o,this.left,this.right)&&hn(s,this.top,this.bottom)){for(f=this.legendHitBoxes,h=0;h<f.length;++h)if(c=f[h],hn(o,c.left,c.left+c.width)&&hn(s,c.top,c.top+c.height))return this.legendItems[h]}return null}handleEvent(o){const s=this.options;if(!by(o.type,s))return;const h=this._getLegendItemAt(o.x,o.y);if(o.type==="mousemove"){const c=this._hoveredItem,f=xy(c,h);c&&!f&&kt(s.onLeave,[o,c,this],this),this._hoveredItem=h,h&&!f&&kt(s.onHover,[o,h,this],this)}else h&&kt(s.onClick,[o,h,this],this)}}function by(l,o){return!!(l==="mousemove"&&(o.onHover||o.onLeave)||o.onClick&&(l==="click"||l==="mouseup"))}var Ey={id:"legend",_element:Ku,start(l,o,s){const h=l.legend=new Ku({ctx:l.ctx,options:s,chart:l});me.configure(l,h,s),me.addBox(l,h)},stop(l){me.removeBox(l,l.legend),delete l.legend},beforeUpdate(l,o,s){const h=l.legend;me.configure(l,h,s),h.options=s},afterUpdate(l){const o=l.legend;o.buildLabels(),o.adjustHitBoxes()},afterEvent(l,o){o.replay||l.legend.handleEvent(o.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(l,o,s){const h=o.datasetIndex,c=s.chart;c.isDatasetVisible(h)?(c.hide(h),o.hidden=!0):(c.show(h),o.hidden=!1)},onHover:null,onLeave:null,labels:{color:l=>l.chart.options.color,boxWidth:40,padding:10,generateLabels(l){const o=l.data.datasets,{labels:{usePointStyle:s,pointStyle:h,textAlign:c,color:f}}=l.legend.options;return l._getSortedDatasetMetas().map(d=>{const _=d.controller.getStyle(s?0:void 0),y=ye(_.borderWidth);return{text:o[d.index].label,fillStyle:_.backgroundColor,fontColor:f,hidden:!d.visible,lineCap:_.borderCapStyle,lineDash:_.borderDash,lineDashOffset:_.borderDashOffset,lineJoin:_.borderJoinStyle,lineWidth:(y.width+y.height)/4,strokeStyle:_.borderColor,pointStyle:h||_.pointStyle,rotation:_.rotation,textAlign:c||_.textAlign,borderRadius:0,datasetIndex:d.index}},this)}},title:{color:l=>l.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:l=>!l.startsWith("on"),labels:{_scriptable:l=>!["generateLabels","filter","sort"].includes(l)}}};class Tl extends Ke{constructor(o){super();this.chart=o.chart,this.options=o.options,this.ctx=o.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(o,s){const h=this.options;if(this.left=0,this.top=0,!h.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=o,this.height=this.bottom=s;const c=Dt(h.text)?h.text.length:1;this._padding=ye(h.padding);const f=c*le(h.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=f:this.width=f}isHorizontal(){const o=this.options.position;return o==="top"||o==="bottom"}_drawArgs(o){const{top:s,left:h,bottom:c,right:f,options:d}=this,_=d.align;let y=0,x,T,R;return this.isHorizontal()?(T=p(_,h,f),R=s+o,x=f-h):(d.position==="left"?(T=h+o,R=p(_,c,s),y=Nt*-.5):(T=f-o,R=p(_,s,c),y=Nt*.5),x=c-s),{titleX:T,titleY:R,maxWidth:x,rotation:y}}draw(){const o=this.ctx,s=this.options;if(!s.display)return;const h=le(s.font),f=h.lineHeight/2+this._padding.top,{titleX:d,titleY:_,maxWidth:y,rotation:x}=this._drawArgs(f);jn(o,s.text,0,0,h,{color:s.color,maxWidth:y,rotation:x,textAlign:u(s.align),textBaseline:"middle",translation:[d,_]})}}function Ty(l,o){const s=new Tl({ctx:l.ctx,options:o,chart:l});me.configure(l,s,o),me.addBox(l,s),l.titleBlock=s}var wy={id:"title",_element:Tl,start(l,o,s){Ty(l,s)},stop(l){const o=l.titleBlock;me.removeBox(l,o),delete l.titleBlock},beforeUpdate(l,o,s){const h=l.titleBlock;me.configure(l,h,s),h.options=s},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const _s=new WeakMap;var Sy={id:"subtitle",start(l,o,s){const h=new Tl({ctx:l.ctx,options:s,chart:l});me.configure(l,h,s),me.addBox(l,h),_s.set(l,h)},stop(l){me.removeBox(l,_s.get(l)),_s.delete(l)},beforeUpdate(l,o,s){const h=_s.get(l);me.configure(l,h,s),h.options=s},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const oo={average(l){if(!l.length)return!1;let o,s,h=0,c=0,f=0;for(o=0,s=l.length;o<s;++o){const d=l[o].element;if(d&&d.hasValue()){const _=d.tooltipPosition();h+=_.x,c+=_.y,++f}}return{x:h/f,y:c/f}},nearest(l,o){if(!l.length)return!1;let s=o.x,h=o.y,c=Number.POSITIVE_INFINITY,f,d,_;for(f=0,d=l.length;f<d;++f){const y=l[f].element;if(y&&y.hasValue()){const x=y.getCenterPoint(),T=Ho(o,x);T<c&&(c=T,_=y)}}if(_){const y=_.tooltipPosition();s=y.x,h=y.y}return{x:s,y:h}}};function fn(l,o){return o&&(Dt(o)?Array.prototype.push.apply(l,o):l.push(o)),l}function Cn(l){return(typeof l=="string"||l instanceof String)&&l.indexOf(`
`)>-1?l.split(`
`):l}function Ry(l,o){const{element:s,datasetIndex:h,index:c}=o,f=l.getDatasetMeta(h).controller,{label:d,value:_}=f.getLabelAndValue(c);return{chart:l,label:d,parsed:f.getParsed(c),raw:l.data.datasets[h].data[c],formattedValue:_,dataset:f.getDataset(),dataIndex:c,datasetIndex:h,element:s}}function Zu(l,o){const s=l.chart.ctx,{body:h,footer:c,title:f}=l,{boxWidth:d,boxHeight:_}=o,y=le(o.bodyFont),x=le(o.titleFont),T=le(o.footerFont),R=f.length,C=c.length,P=h.length,D=ye(o.padding);let F=D.height,N=0,z=h.reduce((Z,$)=>Z+$.before.length+$.lines.length+$.after.length,0);if(z+=l.beforeBody.length+l.afterBody.length,R&&(F+=R*x.lineHeight+(R-1)*o.titleSpacing+o.titleMarginBottom),z){const Z=o.displayColors?Math.max(_,y.lineHeight):y.lineHeight;F+=P*Z+(z-P)*y.lineHeight+(z-1)*o.bodySpacing}C&&(F+=o.footerMarginTop+C*T.lineHeight+(C-1)*o.footerSpacing);let W=0;const q=function(Z){N=Math.max(N,s.measureText(Z).width+W)};return s.save(),s.font=x.string,It(l.title,q),s.font=y.string,It(l.beforeBody.concat(l.afterBody),q),W=o.displayColors?d+2+o.boxPadding:0,It(h,Z=>{It(Z.before,q),It(Z.lines,q),It(Z.after,q)}),W=0,s.font=T.string,It(l.footer,q),s.restore(),N+=D.width,{width:N,height:F}}function Cy(l,o){const{y:s,height:h}=o;return s<h/2?"top":s>l.height-h/2?"bottom":"center"}function Oy(l,o,s,h){const{x:c,width:f}=h,d=s.caretSize+s.caretPadding;if(l==="left"&&c+f+d>o.width||l==="right"&&c-f-d<0)return!0}function Iy(l,o,s,h){const{x:c,width:f}=s,{width:d,chartArea:{left:_,right:y}}=l;let x="center";return h==="center"?x=c<=(_+y)/2?"left":"right":c<=f/2?x="left":c>=d-f/2&&(x="right"),Oy(x,l,o,s)&&(x="center"),x}function qu(l,o,s){const h=s.yAlign||o.yAlign||Cy(l,s);return{xAlign:s.xAlign||o.xAlign||Iy(l,o,s,h),yAlign:h}}function Ay(l,o){let{x:s,width:h}=l;return o==="right"?s-=h:o==="center"&&(s-=h/2),s}function Py(l,o,s){let{y:h,height:c}=l;return o==="top"?h+=s:o==="bottom"?h-=c+s:h-=c/2,h}function Ju(l,o,s,h){const{caretSize:c,caretPadding:f,cornerRadius:d}=l,{xAlign:_,yAlign:y}=s,x=c+f,{topLeft:T,topRight:R,bottomLeft:C,bottomRight:P}=Ri(d);let D=Ay(o,_);const F=Py(o,y,x);return y==="center"?_==="left"?D+=x:_==="right"&&(D-=x):_==="left"?D-=Math.max(T,C)+c:_==="right"&&(D+=Math.max(R,P)+c),{x:de(D,0,h.width-o.width),y:de(F,0,h.height-o.height)}}function vs(l,o,s){const h=ye(s.padding);return o==="center"?l.x+l.width/2:o==="right"?l.x+l.width-h.right:l.x+h.left}function Qu(l){return fn([],Cn(l))}function My(l,o,s){return Rn(l,{tooltip:o,tooltipItems:s,type:"tooltip"})}function tf(l,o){const s=o&&o.dataset&&o.dataset.tooltip&&o.dataset.tooltip.callbacks;return s?l.override(s):l}class wl extends Ke{constructor(o){super();this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=o.chart||o._chart,this._chart=this.chart,this.options=o.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(o){this.options=o,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const o=this._cachedAnimations;if(o)return o;const s=this.chart,h=this.options.setContext(this.getContext()),c=h.enabled&&s.options.animation&&h.animations,f=new al(this.chart,c);return c._cacheable&&(this._cachedAnimations=Object.freeze(f)),f}getContext(){return this.$context||(this.$context=My(this.chart.getContext(),this,this._tooltipItems))}getTitle(o,s){const{callbacks:h}=s,c=h.beforeTitle.apply(this,[o]),f=h.title.apply(this,[o]),d=h.afterTitle.apply(this,[o]);let _=[];return _=fn(_,Cn(c)),_=fn(_,Cn(f)),_=fn(_,Cn(d)),_}getBeforeBody(o,s){return Qu(s.callbacks.beforeBody.apply(this,[o]))}getBody(o,s){const{callbacks:h}=s,c=[];return It(o,f=>{const d={before:[],lines:[],after:[]},_=tf(h,f);fn(d.before,Cn(_.beforeLabel.call(this,f))),fn(d.lines,_.label.call(this,f)),fn(d.after,Cn(_.afterLabel.call(this,f))),c.push(d)}),c}getAfterBody(o,s){return Qu(s.callbacks.afterBody.apply(this,[o]))}getFooter(o,s){const{callbacks:h}=s,c=h.beforeFooter.apply(this,[o]),f=h.footer.apply(this,[o]),d=h.afterFooter.apply(this,[o]);let _=[];return _=fn(_,Cn(c)),_=fn(_,Cn(f)),_=fn(_,Cn(d)),_}_createItems(o){const s=this._active,h=this.chart.data,c=[],f=[],d=[];let _=[],y,x;for(y=0,x=s.length;y<x;++y)_.push(Ry(this.chart,s[y]));return o.filter&&(_=_.filter((T,R,C)=>o.filter(T,R,C,h))),o.itemSort&&(_=_.sort((T,R)=>o.itemSort(T,R,h))),It(_,T=>{const R=tf(o.callbacks,T);c.push(R.labelColor.call(this,T)),f.push(R.labelPointStyle.call(this,T)),d.push(R.labelTextColor.call(this,T))}),this.labelColors=c,this.labelPointStyles=f,this.labelTextColors=d,this.dataPoints=_,_}update(o,s){const h=this.options.setContext(this.getContext()),c=this._active;let f,d=[];if(!c.length)this.opacity!==0&&(f={opacity:0});else{const _=oo[h.position].call(this,c,this._eventPosition);d=this._createItems(h),this.title=this.getTitle(d,h),this.beforeBody=this.getBeforeBody(d,h),this.body=this.getBody(d,h),this.afterBody=this.getAfterBody(d,h),this.footer=this.getFooter(d,h);const y=this._size=Zu(this,h),x=Object.assign({},_,y),T=qu(this.chart,h,x),R=Ju(h,x,T,this.chart);this.xAlign=T.xAlign,this.yAlign=T.yAlign,f={opacity:1,x:R.x,y:R.y,width:y.width,height:y.height,caretX:_.x,caretY:_.y}}this._tooltipItems=d,this.$context=void 0,f&&this._resolveAnimations().update(this,f),o&&h.external&&h.external.call(this,{chart:this.chart,tooltip:this,replay:s})}drawCaret(o,s,h,c){const f=this.getCaretPosition(o,h,c);s.lineTo(f.x1,f.y1),s.lineTo(f.x2,f.y2),s.lineTo(f.x3,f.y3)}getCaretPosition(o,s,h){const{xAlign:c,yAlign:f}=this,{caretSize:d,cornerRadius:_}=h,{topLeft:y,topRight:x,bottomLeft:T,bottomRight:R}=Ri(_),{x:C,y:P}=o,{width:D,height:F}=s;let N,z,W,q,Z,$;return f==="center"?(Z=P+F/2,c==="left"?(N=C,z=N-d,q=Z+d,$=Z-d):(N=C+D,z=N+d,q=Z-d,$=Z+d),W=N):(c==="left"?z=C+Math.max(y,T)+d:c==="right"?z=C+D-Math.max(x,R)-d:z=this.caretX,f==="top"?(q=P,Z=q-d,N=z-d,W=z+d):(q=P+F,Z=q+d,N=z+d,W=z-d),$=q),{x1:N,x2:z,x3:W,y1:q,y2:Z,y3:$}}drawTitle(o,s,h){const c=this.title,f=c.length;let d,_,y;if(f){const x=Oi(h.rtl,this.x,this.width);for(o.x=vs(this,h.titleAlign,h),s.textAlign=x.textAlign(h.titleAlign),s.textBaseline="middle",d=le(h.titleFont),_=h.titleSpacing,s.fillStyle=h.titleColor,s.font=d.string,y=0;y<f;++y)s.fillText(c[y],x.x(o.x),o.y+d.lineHeight/2),o.y+=d.lineHeight+_,y+1===f&&(o.y+=h.titleMarginBottom-_)}}_drawColorBox(o,s,h,c,f){const d=this.labelColors[h],_=this.labelPointStyles[h],{boxHeight:y,boxWidth:x,boxPadding:T}=f,R=le(f.bodyFont),C=vs(this,"left",f),P=c.x(C),D=y<R.lineHeight?(R.lineHeight-y)/2:0,F=s.y+D;if(f.usePointStyle){const N={radius:Math.min(x,y)/2,pointStyle:_.pointStyle,rotation:_.rotation,borderWidth:1},z=c.leftForLtr(P,x)+x/2,W=F+y/2;o.strokeStyle=f.multiKeyBackground,o.fillStyle=f.multiKeyBackground,Wr(o,N,z,W),o.strokeStyle=d.borderColor,o.fillStyle=d.backgroundColor,Wr(o,N,z,W)}else{o.lineWidth=d.borderWidth||1,o.strokeStyle=d.borderColor,o.setLineDash(d.borderDash||[]),o.lineDashOffset=d.borderDashOffset||0;const N=c.leftForLtr(P,x-T),z=c.leftForLtr(c.xPlus(P,1),x-T-2),W=Ri(d.borderRadius);Object.values(W).some(q=>q!==0)?(o.beginPath(),o.fillStyle=f.multiKeyBackground,$r(o,{x:N,y:F,w:x,h:y,radius:W}),o.fill(),o.stroke(),o.fillStyle=d.backgroundColor,o.beginPath(),$r(o,{x:z,y:F+1,w:x-2,h:y-2,radius:W}),o.fill()):(o.fillStyle=f.multiKeyBackground,o.fillRect(N,F,x,y),o.strokeRect(N,F,x,y),o.fillStyle=d.backgroundColor,o.fillRect(z,F+1,x-2,y-2))}o.fillStyle=this.labelTextColors[h]}drawBody(o,s,h){const{body:c}=this,{bodySpacing:f,bodyAlign:d,displayColors:_,boxHeight:y,boxWidth:x,boxPadding:T}=h,R=le(h.bodyFont);let C=R.lineHeight,P=0;const D=Oi(h.rtl,this.x,this.width),F=function(ct){s.fillText(ct,D.x(o.x+P),o.y+C/2),o.y+=C+f},N=D.textAlign(d);let z,W,q,Z,$,ot,nt;for(s.textAlign=d,s.textBaseline="middle",s.font=R.string,o.x=vs(this,N,h),s.fillStyle=h.bodyColor,It(this.beforeBody,F),P=_&&N!=="right"?d==="center"?x/2+T:x+2+T:0,Z=0,ot=c.length;Z<ot;++Z){for(z=c[Z],W=this.labelTextColors[Z],s.fillStyle=W,It(z.before,F),q=z.lines,_&&q.length&&(this._drawColorBox(s,o,Z,D,h),C=Math.max(R.lineHeight,y)),$=0,nt=q.length;$<nt;++$)F(q[$]),C=R.lineHeight;It(z.after,F)}P=0,C=R.lineHeight,It(this.afterBody,F),o.y-=f}drawFooter(o,s,h){const c=this.footer,f=c.length;let d,_;if(f){const y=Oi(h.rtl,this.x,this.width);for(o.x=vs(this,h.footerAlign,h),o.y+=h.footerMarginTop,s.textAlign=y.textAlign(h.footerAlign),s.textBaseline="middle",d=le(h.footerFont),s.fillStyle=h.footerColor,s.font=d.string,_=0;_<f;++_)s.fillText(c[_],y.x(o.x),o.y+d.lineHeight/2),o.y+=d.lineHeight+h.footerSpacing}}drawBackground(o,s,h,c){const{xAlign:f,yAlign:d}=this,{x:_,y}=o,{width:x,height:T}=h,{topLeft:R,topRight:C,bottomLeft:P,bottomRight:D}=Ri(c.cornerRadius);s.fillStyle=c.backgroundColor,s.strokeStyle=c.borderColor,s.lineWidth=c.borderWidth,s.beginPath(),s.moveTo(_+R,y),d==="top"&&this.drawCaret(o,s,h,c),s.lineTo(_+x-C,y),s.quadraticCurveTo(_+x,y,_+x,y+C),d==="center"&&f==="right"&&this.drawCaret(o,s,h,c),s.lineTo(_+x,y+T-D),s.quadraticCurveTo(_+x,y+T,_+x-D,y+T),d==="bottom"&&this.drawCaret(o,s,h,c),s.lineTo(_+P,y+T),s.quadraticCurveTo(_,y+T,_,y+T-P),d==="center"&&f==="left"&&this.drawCaret(o,s,h,c),s.lineTo(_,y+R),s.quadraticCurveTo(_,y,_+R,y),s.closePath(),s.fill(),c.borderWidth>0&&s.stroke()}_updateAnimationTarget(o){const s=this.chart,h=this.$animations,c=h&&h.x,f=h&&h.y;if(c||f){const d=oo[o.position].call(this,this._active,this._eventPosition);if(!d)return;const _=this._size=Zu(this,o),y=Object.assign({},d,this._size),x=qu(s,o,y),T=Ju(o,y,x,s);(c._to!==T.x||f._to!==T.y)&&(this.xAlign=x.xAlign,this.yAlign=x.yAlign,this.width=_.width,this.height=_.height,this.caretX=d.x,this.caretY=d.y,this._resolveAnimations().update(this,T))}}draw(o){const s=this.options.setContext(this.getContext());let h=this.opacity;if(!h)return;this._updateAnimationTarget(s);const c={width:this.width,height:this.height},f={x:this.x,y:this.y};h=Math.abs(h)<.001?0:h;const d=ye(s.padding),_=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;s.enabled&&_&&(o.save(),o.globalAlpha=h,this.drawBackground(f,o,c,s),el(o,s.textDirection),f.y+=d.top,this.drawTitle(f,o,s),this.drawBody(f,o,s),this.drawFooter(f,o,s),nl(o,s.textDirection),o.restore())}getActiveElements(){return this._active||[]}setActiveElements(o,s){const h=this._active,c=o.map(({datasetIndex:_,index:y})=>{const x=this.chart.getDatasetMeta(_);if(!x)throw new Error("Cannot find a dataset at index "+_);return{datasetIndex:_,element:x.data[y],index:y}}),f=!mi(h,c),d=this._positionChanged(c,s);(f||d)&&(this._active=c,this._eventPosition=s,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(o,s,h=!0){if(s&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const c=this.options,f=this._active||[],d=this._getActiveElements(o,f,s,h),_=this._positionChanged(d,o),y=s||!mi(d,f)||_;return y&&(this._active=d,(c.enabled||c.external)&&(this._eventPosition={x:o.x,y:o.y},this.update(!0,s))),y}_getActiveElements(o,s,h,c){const f=this.options;if(o.type==="mouseout")return[];if(!c)return s;const d=this.chart.getElementsAtEventForMode(o,f.mode,f,h);return f.reverse&&d.reverse(),d}_positionChanged(o,s){const{caretX:h,caretY:c,options:f}=this,d=oo[f.position].call(this,o,s);return d!==!1&&(h!==d.x||c!==d.y)}}wl.positioners=oo;var Ly={id:"tooltip",_element:wl,positioners:oo,afterInit(l,o,s){s&&(l.tooltip=new wl({chart:l,options:s}))},beforeUpdate(l,o,s){l.tooltip&&l.tooltip.initialize(s)},reset(l,o,s){l.tooltip&&l.tooltip.initialize(s)},afterDraw(l){const o=l.tooltip,s={tooltip:o};l.notifyPlugins("beforeTooltipDraw",s)!==!1&&(o&&o.draw(l.ctx),l.notifyPlugins("afterTooltipDraw",s))},afterEvent(l,o){if(l.tooltip){const s=o.replay;l.tooltip.handleEvent(o.event,s,o.inChartArea)&&(o.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(l,o)=>o.bodyFont.size,boxWidth:(l,o)=>o.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:{beforeTitle:Te,title(l){if(l.length>0){const o=l[0],s=o.chart.data.labels,h=s?s.length:0;if(this&&this.options&&this.options.mode==="dataset")return o.dataset.label||"";if(o.label)return o.label;if(h>0&&o.dataIndex<h)return s[o.dataIndex]}return""},afterTitle:Te,beforeBody:Te,beforeLabel:Te,label(l){if(this&&this.options&&this.options.mode==="dataset")return l.label+": "+l.formattedValue||l.formattedValue;let o=l.dataset.label||"";o&&(o+=": ");const s=l.formattedValue;return Ot(s)||(o+=s),o},labelColor(l){const s=l.chart.getDatasetMeta(l.datasetIndex).controller.getStyle(l.dataIndex);return{borderColor:s.borderColor,backgroundColor:s.backgroundColor,borderWidth:s.borderWidth,borderDash:s.borderDash,borderDashOffset:s.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(l){const s=l.chart.getDatasetMeta(l.datasetIndex).controller.getStyle(l.dataIndex);return{pointStyle:s.pointStyle,rotation:s.rotation}},afterLabel:Te,afterBody:Te,beforeFooter:Te,footer:Te,afterFooter:Te}},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:l=>l!=="filter"&&l!=="itemSort"&&l!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},ef=Object.freeze({__proto__:null,Decimation:ny,Filler:my,Legend:Ey,SubTitle:Sy,Title:wy,Tooltip:Ly});const Dy=(l,o,s,h)=>(typeof o=="string"?(s=l.push(o)-1,h.unshift({index:s,label:o})):isNaN(o)&&(s=null),s);function ky(l,o,s,h){const c=l.indexOf(o);if(c===-1)return Dy(l,o,s,h);const f=l.lastIndexOf(o);return c!==f?s:c}const Fy=(l,o)=>l===null?null:de(Math.round(l),0,o);class ys extends Hn{constructor(o){super(o);this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(o){const s=this._addedLabels;if(s.length){const h=this.getLabels();for(const{index:c,label:f}of s)h[c]===f&&h.splice(c,1);this._addedLabels=[]}super.init(o)}parse(o,s){if(Ot(o))return null;const h=this.getLabels();return s=isFinite(s)&&h[s]===o?s:ky(h,o,gt(s,o),this._addedLabels),Fy(s,h.length-1)}determineDataLimits(){const{minDefined:o,maxDefined:s}=this.getUserBounds();let{min:h,max:c}=this.getMinMax(!0);this.options.bounds==="ticks"&&(o||(h=0),s||(c=this.getLabels().length-1)),this.min=h,this.max=c}buildTicks(){const o=this.min,s=this.max,h=this.options.offset,c=[];let f=this.getLabels();f=o===0&&s===f.length-1?f:f.slice(o,s+1),this._valueRange=Math.max(f.length-(h?0:1),1),this._startValue=this.min-(h?.5:0);for(let d=o;d<=s;d++)c.push({value:d});return c}getLabelForValue(o){const s=this.getLabels();return o>=0&&o<s.length?s[o]:o}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(o){return typeof o!="number"&&(o=this.parse(o)),o===null?NaN:this.getPixelForDecimal((o-this._startValue)/this._valueRange)}getPixelForTick(o){const s=this.ticks;return o<0||o>s.length-1?null:this.getPixelForValue(s[o].value)}getValueForPixel(o){return Math.round(this._startValue+this.getDecimalForPixel(o)*this._valueRange)}getBasePixel(){return this.bottom}}ys.id="category",ys.defaults={ticks:{callback:ys.prototype.getLabelForValue}};function Ny(l,o){const s=[],{bounds:c,step:f,min:d,max:_,precision:y,count:x,maxTicks:T,maxDigits:R,includeBounds:C}=l,P=f||1,D=T-1,{min:F,max:N}=o,z=!Ot(d),W=!Ot(_),q=!Ot(x),Z=(N-F)/(R+1);let $=Fa((N-F)/D/P)*P,ot,nt,ct,lt;if($<1e-14&&!z&&!W)return[{value:F},{value:N}];lt=Math.ceil(N/$)-Math.floor(F/$),lt>D&&($=Fa(lt*$/D/P)*P),Ot(y)||(ot=Math.pow(10,y),$=Math.ceil($*ot)/ot),c==="ticks"?(nt=Math.floor(F/$)*$,ct=Math.ceil(N/$)*$):(nt=F,ct=N),z&&W&&f&&hc((_-d)/f,$/1e3)?(lt=Math.round(Math.min((_-d)/$,T)),$=(_-d)/lt,nt=d,ct=_):q?(nt=z?d:nt,ct=W?_:ct,lt=x-1,$=(ct-nt)/lt):(lt=(ct-nt)/$,nr(lt,Math.round(lt),$/1e3)?lt=Math.round(lt):lt=Math.ceil(lt));const Gt=Math.max(Ba($),Ba(nt));ot=Math.pow(10,Ot(y)?Gt:y),nt=Math.round(nt*ot)/ot,ct=Math.round(ct*ot)/ot;let Ft=0;for(z&&(C&&nt!==d?(s.push({value:d}),nt<d&&Ft++,nr(Math.round((nt+Ft*$)*ot)/ot,d,nf(d,Z,l))&&Ft++):nt<d&&Ft++);Ft<lt;++Ft)s.push({value:Math.round((nt+Ft*$)*ot)/ot});return W&&C&&ct!==_?s.length&&nr(s[s.length-1].value,_,nf(_,Z,l))?s[s.length-1].value=_:s.push({value:_}):(!W||ct===_)&&s.push({value:ct}),s}function nf(l,o,{horizontal:s,minRotation:h}){const c=$e(h),f=(s?Math.sin(c):Math.cos(c))||.001,d=.75*o*(""+l).length;return Math.min(o/f,d)}class ms extends Hn{constructor(o){super(o);this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(o,s){return Ot(o)||(typeof o=="number"||o instanceof Number)&&!isFinite(+o)?null:+o}handleTickRangeOptions(){const{beginAtZero:o}=this.options,{minDefined:s,maxDefined:h}=this.getUserBounds();let{min:c,max:f}=this;const d=y=>c=s?c:y,_=y=>f=h?f:y;if(o){const y=Ae(c),x=Ae(f);y<0&&x<0?_(0):y>0&&x>0&&d(0)}if(c===f){let y=1;(f>=Number.MAX_SAFE_INTEGER||c<=Number.MIN_SAFE_INTEGER)&&(y=Math.abs(f*.05)),_(f+y),o||d(c-y)}this.min=c,this.max=f}getTickLimit(){const o=this.options.ticks;let{maxTicksLimit:s,stepSize:h}=o,c;return h?(c=Math.ceil(this.max/h)-Math.floor(this.min/h)+1,c>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${h} would result generating up to ${c} ticks. Limiting to 1000.`),c=1e3)):(c=this.computeTickLimit(),s=s||11),s&&(c=Math.min(s,c)),c}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const o=this.options,s=o.ticks;let h=this.getTickLimit();h=Math.max(2,h);const c={maxTicks:h,bounds:o.bounds,min:o.min,max:o.max,precision:s.precision,step:s.stepSize,count:s.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:s.minRotation||0,includeBounds:s.includeBounds!==!1},f=this._range||this,d=Ny(c,f);return o.bounds==="ticks"&&Na(d,this,"value"),o.reverse?(d.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),d}configure(){const o=this.ticks;let s=this.min,h=this.max;if(super.configure(),this.options.offset&&o.length){const c=(h-s)/Math.max(o.length-1,1)/2;s-=c,h+=c}this._startValue=s,this._endValue=h,this._valueRange=h-s}getLabelForValue(o){return ar(o,this.chart.options.locale,this.options.ticks.format)}}class Sl extends ms{determineDataLimits(){const{min:o,max:s}=this.getMinMax(!0);this.min=jt(o)?o:0,this.max=jt(s)?s:1,this.handleTickRangeOptions()}computeTickLimit(){const o=this.isHorizontal(),s=o?this.width:this.height,h=$e(this.options.ticks.minRotation),c=(o?Math.sin(h):Math.cos(h))||.001,f=this._resolveTickFontOptions(0);return Math.ceil(s/Math.min(40,f.lineHeight/c))}getPixelForValue(o){return o===null?NaN:this.getPixelForDecimal((o-this._startValue)/this._valueRange)}getValueForPixel(o){return this._startValue+this.getDecimalForPixel(o)*this._valueRange}}Sl.id="linear",Sl.defaults={ticks:{callback:eo.formatters.numeric}};function rf(l){return l/Math.pow(10,Math.floor(Re(l)))===1}function By(l,o){const s=Math.floor(Re(o.max)),h=Math.ceil(o.max/Math.pow(10,s)),c=[];let f=we(l.min,Math.pow(10,Math.floor(Re(o.min)))),d=Math.floor(Re(f)),_=Math.floor(f/Math.pow(10,d)),y=d<0?Math.pow(10,Math.abs(d)):1;do c.push({value:f,major:rf(f)}),++_,_===10&&(_=1,++d,y=d>=0?1:y),f=Math.round(_*Math.pow(10,d)*y)/y;while(d<s||d===s&&_<h);const x=we(l.max,f);return c.push({value:x,major:rf(f)}),c}class Rl extends Hn{constructor(o){super(o);this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(o,s){const h=ms.prototype.parse.apply(this,[o,s]);if(h===0){this._zero=!0;return}return jt(h)&&h>0?h:null}determineDataLimits(){const{min:o,max:s}=this.getMinMax(!0);this.min=jt(o)?Math.max(0,o):null,this.max=jt(s)?Math.max(0,s):null,this.options.beginAtZero&&(this._zero=!0),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:o,maxDefined:s}=this.getUserBounds();let h=this.min,c=this.max;const f=y=>h=o?h:y,d=y=>c=s?c:y,_=(y,x)=>Math.pow(10,Math.floor(Re(y))+x);h===c&&(h<=0?(f(1),d(10)):(f(_(h,-1)),d(_(c,1)))),h<=0&&f(_(c,-1)),c<=0&&d(_(h,1)),this._zero&&this.min!==this._suggestedMin&&h===_(this.min,0)&&f(_(h,-1)),this.min=h,this.max=c}buildTicks(){const o=this.options,s={min:this._userMin,max:this._userMax},h=By(s,this);return o.bounds==="ticks"&&Na(h,this,"value"),o.reverse?(h.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),h}getLabelForValue(o){return o===void 0?"0":ar(o,this.chart.options.locale,this.options.ticks.format)}configure(){const o=this.min;super.configure(),this._startValue=Re(o),this._valueRange=Re(this.max)-Re(o)}getPixelForValue(o){return(o===void 0||o===0)&&(o=this.min),o===null||isNaN(o)?NaN:this.getPixelForDecimal(o===this.min?0:(Re(o)-this._startValue)/this._valueRange)}getValueForPixel(o){const s=this.getDecimalForPixel(o);return Math.pow(10,this._startValue+s*this._valueRange)}}Rl.id="logarithmic",Rl.defaults={ticks:{callback:eo.formatters.logarithmic,major:{enabled:!0}}};function Cl(l){const o=l.ticks;if(o.display&&l.display){const s=ye(o.backdropPadding);return gt(o.font&&o.font.size,Et.font.size)+s.height}return 0}function Gy(l,o,s){return s=Dt(s)?s:[s],{w:dc(l,o.string,s),h:s.length*o.lineHeight}}function of(l,o,s,h,c){return l===h||l===c?{start:o-s/2,end:o+s/2}:l<h||l>c?{start:o-s,end:o}:{start:o,end:o+s}}function zy(l){const o={l:l.left+l._padding.left,r:l.right-l._padding.right,t:l.top+l._padding.top,b:l.bottom-l._padding.bottom},s=Object.assign({},o),h=[],c=[],f=l._pointLabels.length,d=l.options.pointLabels,_=d.centerPointLabels?Nt/f:0;for(let y=0;y<f;y++){const x=d.setContext(l.getPointLabelContext(y));c[y]=x.padding;const T=l.getPointPosition(y,l.drawingArea+c[y],_),R=le(x.font),C=Gy(l.ctx,R,l._pointLabels[y]);h[y]=C;const P=Pe(l.getIndexAngle(y)+_),D=Math.round(Wo(P)),F=of(D,T.x,C.w,0,180),N=of(D,T.y,C.h,90,270);Uy(s,o,P,F,N)}l.setCenterPoint(o.l-s.l,s.r-o.r,o.t-s.t,s.b-o.b),l._pointLabelItems=Vy(l,h,c)}function Uy(l,o,s,h,c){const f=Math.abs(Math.sin(s)),d=Math.abs(Math.cos(s));let _=0,y=0;h.start<o.l?(_=(o.l-h.start)/f,l.l=Math.min(l.l,o.l-_)):h.end>o.r&&(_=(h.end-o.r)/f,l.r=Math.max(l.r,o.r+_)),c.start<o.t?(y=(o.t-c.start)/d,l.t=Math.min(l.t,o.t-y)):c.end>o.b&&(y=(c.end-o.b)/d,l.b=Math.max(l.b,o.b+y))}function Vy(l,o,s){const h=[],c=l._pointLabels.length,f=l.options,d=Cl(f)/2,_=l.drawingArea,y=f.pointLabels.centerPointLabels?Nt/c:0;for(let x=0;x<c;x++){const T=l.getPointPosition(x,_+d+s[x],y),R=Math.round(Wo(Pe(T.angle+bt))),C=o[x],P=Wy(T.y,C.h,R),D=Xy(R),F=jy(T.x,C.w,D);h.push({x:T.x,y:P,textAlign:D,left:F,top:P,right:F+C.w,bottom:P+C.h})}return h}function Xy(l){return l===0||l===180?"center":l<180?"left":"right"}function jy(l,o,s){return s==="right"?l-=o:s==="center"&&(l-=o/2),l}function Wy(l,o,s){return s===90||s===270?l-=o/2:(s>270||s<90)&&(l-=o),l}function Hy(l,o){const{ctx:s,options:{pointLabels:h}}=l;for(let c=o-1;c>=0;c--){const f=h.setContext(l.getPointLabelContext(c)),d=le(f.font),{x:_,y,textAlign:x,left:T,top:R,right:C,bottom:P}=l._pointLabelItems[c],{backdropColor:D}=f;if(!Ot(D)){const F=ye(f.backdropPadding);s.fillStyle=D,s.fillRect(T-F.left,R-F.top,C-T+F.width,P-R+F.height)}jn(s,l._pointLabels[c],_,y+d.lineHeight/2,d,{color:f.color,textAlign:x,textBaseline:"middle"})}}function sf(l,o,s,h){const{ctx:c}=l;if(s)c.arc(l.xCenter,l.yCenter,o,0,At);else{let f=l.getPointPosition(0,o);c.moveTo(f.x,f.y);for(let d=1;d<h;d++)f=l.getPointPosition(d,o),c.lineTo(f.x,f.y)}}function Yy(l,o,s,h){const c=l.ctx,f=o.circular,{color:d,lineWidth:_}=o;!f&&!h||!d||!_||s<0||(c.save(),c.strokeStyle=d,c.lineWidth=_,c.setLineDash(o.borderDash),c.lineDashOffset=o.borderDashOffset,c.beginPath(),sf(l,s,f,h),c.closePath(),c.stroke(),c.restore())}function $y(l,o,s){return Rn(l,{label:s,index:o,type:"pointLabel"})}class so extends ms{constructor(o){super(o);this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const o=this._padding=ye(Cl(this.options)/2),s=this.width=this.maxWidth-o.width,h=this.height=this.maxHeight-o.height;this.xCenter=Math.floor(this.left+s/2+o.left),this.yCenter=Math.floor(this.top+h/2+o.top),this.drawingArea=Math.floor(Math.min(s,h)/2)}determineDataLimits(){const{min:o,max:s}=this.getMinMax(!1);this.min=jt(o)&&!isNaN(o)?o:0,this.max=jt(s)&&!isNaN(s)?s:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/Cl(this.options))}generateTickLabels(o){ms.prototype.generateTickLabels.call(this,o),this._pointLabels=this.getLabels().map((s,h)=>{const c=kt(this.options.pointLabels.callback,[s,h],this);return c||c===0?c:""}).filter((s,h)=>this.chart.getDataVisibility(h))}fit(){const o=this.options;o.display&&o.pointLabels.display?zy(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(o,s,h,c){this.xCenter+=Math.floor((o-s)/2),this.yCenter+=Math.floor((h-c)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(o,s,h,c))}getIndexAngle(o){const s=At/(this._pointLabels.length||1),h=this.options.startAngle||0;return Pe(o*s+$e(h))}getDistanceFromCenterForValue(o){if(Ot(o))return NaN;const s=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-o)*s:(o-this.min)*s}getValueForDistanceFromCenter(o){if(Ot(o))return NaN;const s=o/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-s:this.min+s}getPointLabelContext(o){const s=this._pointLabels||[];if(o>=0&&o<s.length){const h=s[o];return $y(this.getContext(),o,h)}}getPointPosition(o,s,h=0){const c=this.getIndexAngle(o)-bt+h;return{x:Math.cos(c)*s+this.xCenter,y:Math.sin(c)*s+this.yCenter,angle:c}}getPointPositionForValue(o,s){return this.getPointPosition(o,this.getDistanceFromCenterForValue(s))}getBasePosition(o){return this.getPointPositionForValue(o||0,this.getBaseValue())}getPointLabelPosition(o){const{left:s,top:h,right:c,bottom:f}=this._pointLabelItems[o];return{left:s,top:h,right:c,bottom:f}}drawBackground(){const{backgroundColor:o,grid:{circular:s}}=this.options;if(o){const h=this.ctx;h.save(),h.beginPath(),sf(this,this.getDistanceFromCenterForValue(this._endValue),s,this._pointLabels.length),h.closePath(),h.fillStyle=o,h.fill(),h.restore()}}drawGrid(){const o=this.ctx,s=this.options,{angleLines:h,grid:c}=s,f=this._pointLabels.length;let d,_,y;if(s.pointLabels.display&&Hy(this,f),c.display&&this.ticks.forEach((x,T)=>{if(T!==0){_=this.getDistanceFromCenterForValue(x.value);const R=c.setContext(this.getContext(T-1));Yy(this,R,_,f)}}),h.display){for(o.save(),d=f-1;d>=0;d--){const x=h.setContext(this.getPointLabelContext(d)),{color:T,lineWidth:R}=x;!R||!T||(o.lineWidth=R,o.strokeStyle=T,o.setLineDash(x.borderDash),o.lineDashOffset=x.borderDashOffset,_=this.getDistanceFromCenterForValue(s.ticks.reverse?this.min:this.max),y=this.getPointPosition(d,_),o.beginPath(),o.moveTo(this.xCenter,this.yCenter),o.lineTo(y.x,y.y),o.stroke())}o.restore()}}drawBorder(){}drawLabels(){const o=this.ctx,s=this.options,h=s.ticks;if(!h.display)return;const c=this.getIndexAngle(0);let f,d;o.save(),o.translate(this.xCenter,this.yCenter),o.rotate(c),o.textAlign="center",o.textBaseline="middle",this.ticks.forEach((_,y)=>{if(y===0&&!s.reverse)return;const x=h.setContext(this.getContext(y)),T=le(x.font);if(f=this.getDistanceFromCenterForValue(this.ticks[y].value),x.showLabelBackdrop){o.font=T.string,d=o.measureText(_.label).width,o.fillStyle=x.backdropColor;const R=ye(x.backdropPadding);o.fillRect(-d/2-R.left,-f-T.size/2-R.top,d+R.width,T.size+R.height)}jn(o,_.label,0,-f,T,{color:x.color})}),o.restore()}drawTitle(){}}so.id="radialLinear",so.defaults={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:eo.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(l){return l},padding:5,centerPointLabels:!1}},so.defaultRoutes={"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"},so.descriptors={angleLines:{_fallback:"grid"}};const xs={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Me=Object.keys(xs);function Ky(l,o){return l-o}function af(l,o){if(Ot(o))return null;const s=l._adapter,{parser:h,round:c,isoWeekday:f}=l._parseOpts;let d=o;return typeof h=="function"&&(d=h(d)),jt(d)||(d=typeof h=="string"?s.parse(d,h):s.parse(d)),d===null?null:(c&&(d=c==="week"&&(er(f)||f===!0)?s.startOf(d,"isoWeek",f):s.startOf(d,c)),+d)}function lf(l,o,s,h){const c=Me.length;for(let f=Me.indexOf(l);f<c-1;++f){const d=xs[Me[f]],_=d.steps?d.steps:Number.MAX_SAFE_INTEGER;if(d.common&&Math.ceil((s-o)/(_*d.size))<=h)return Me[f]}return Me[c-1]}function Zy(l,o,s,h,c){for(let f=Me.length-1;f>=Me.indexOf(s);f--){const d=Me[f];if(xs[d].common&&l._adapter.diff(c,h,d)>=o-1)return d}return Me[s?Me.indexOf(s):0]}function qy(l){for(let o=Me.indexOf(l)+1,s=Me.length;o<s;++o)if(xs[Me[o]].common)return Me[o]}function hf(l,o,s){if(!s)l[o]=!0;else if(s.length){const{lo:h,hi:c}=Yo(s,o),f=s[h]>=o?s[h]:s[c];l[f]=!0}}function Jy(l,o,s,h){const c=l._adapter,f=+c.startOf(o[0].value,h),d=o[o.length-1].value;let _,y;for(_=f;_<=d;_=+c.add(_,1,h))y=s[_],y>=0&&(o[y].major=!0);return o}function cf(l,o,s){const h=[],c={},f=o.length;let d,_;for(d=0;d<f;++d)_=o[d],c[_]=d,h.push({value:_,major:!1});return f===0||!s?h:Jy(l,h,c,s)}class ao extends Hn{constructor(o){super(o);this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(o,s){const h=o.time||(o.time={}),c=this._adapter=new Iu._date(o.adapters.date);Qe(h.displayFormats,c.formats()),this._parseOpts={parser:h.parser,round:h.round,isoWeekday:h.isoWeekday},super.init(o),this._normalized=s.normalized}parse(o,s){return o===void 0?null:af(this,o)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const o=this.options,s=this._adapter,h=o.time.unit||"day";let{min:c,max:f,minDefined:d,maxDefined:_}=this.getUserBounds();function y(x){!d&&!isNaN(x.min)&&(c=Math.min(c,x.min)),!_&&!isNaN(x.max)&&(f=Math.max(f,x.max))}(!d||!_)&&(y(this._getLabelBounds()),(o.bounds!=="ticks"||o.ticks.source!=="labels")&&y(this.getMinMax(!1))),c=jt(c)&&!isNaN(c)?c:+s.startOf(Date.now(),h),f=jt(f)&&!isNaN(f)?f:+s.endOf(Date.now(),h)+1,this.min=Math.min(c,f-1),this.max=Math.max(c+1,f)}_getLabelBounds(){const o=this.getLabelTimestamps();let s=Number.POSITIVE_INFINITY,h=Number.NEGATIVE_INFINITY;return o.length&&(s=o[0],h=o[o.length-1]),{min:s,max:h}}buildTicks(){const o=this.options,s=o.time,h=o.ticks,c=h.source==="labels"?this.getLabelTimestamps():this._generate();o.bounds==="ticks"&&c.length&&(this.min=this._userMin||c[0],this.max=this._userMax||c[c.length-1]);const f=this.min,d=this.max,_=vc(c,f,d);return this._unit=s.unit||(h.autoSkip?lf(s.minUnit,this.min,this.max,this._getLabelCapacity(f)):Zy(this,_.length,s.minUnit,this.min,this.max)),this._majorUnit=!h.major.enabled||this._unit==="year"?void 0:qy(this._unit),this.initOffsets(c),o.reverse&&_.reverse(),cf(this,_,this._majorUnit)}initOffsets(o){let s=0,h=0,c,f;this.options.offset&&o.length&&(c=this.getDecimalForValue(o[0]),o.length===1?s=1-c:s=(this.getDecimalForValue(o[1])-c)/2,f=this.getDecimalForValue(o[o.length-1]),o.length===1?h=f:h=(f-this.getDecimalForValue(o[o.length-2]))/2);const d=o.length<3?.5:.25;s=de(s,0,d),h=de(h,0,d),this._offsets={start:s,end:h,factor:1/(s+1+h)}}_generate(){const o=this._adapter,s=this.min,h=this.max,c=this.options,f=c.time,d=f.unit||lf(f.minUnit,s,h,this._getLabelCapacity(s)),_=gt(f.stepSize,1),y=d==="week"?f.isoWeekday:!1,x=er(y)||y===!0,T={};let R=s,C,P;if(x&&(R=+o.startOf(R,"isoWeek",y)),R=+o.startOf(R,x?"day":d),o.diff(h,s,d)>1e5*_)throw new Error(s+" and "+h+" are too far apart with stepSize of "+_+" "+d);const D=c.ticks.source==="data"&&this.getDataTimestamps();for(C=R,P=0;C<h;C=+o.add(C,_,d),P++)hf(T,C,D);return(C===h||c.bounds==="ticks"||P===1)&&hf(T,C,D),Object.keys(T).sort((F,N)=>F-N).map(F=>+F)}getLabelForValue(o){const s=this._adapter,h=this.options.time;return h.tooltipFormat?s.format(o,h.tooltipFormat):s.format(o,h.displayFormats.datetime)}_tickFormatFunction(o,s,h,c){const f=this.options,d=f.time.displayFormats,_=this._unit,y=this._majorUnit,x=_&&d[_],T=y&&d[y],R=h[s],C=y&&T&&R&&R.major,P=this._adapter.format(o,c||(C?T:x)),D=f.ticks.callback;return D?kt(D,[P,s,h],this):P}generateTickLabels(o){let s,h,c;for(s=0,h=o.length;s<h;++s)c=o[s],c.label=this._tickFormatFunction(c.value,s,o)}getDecimalForValue(o){return o===null?NaN:(o-this.min)/(this.max-this.min)}getPixelForValue(o){const s=this._offsets,h=this.getDecimalForValue(o);return this.getPixelForDecimal((s.start+h)*s.factor)}getValueForPixel(o){const s=this._offsets,h=this.getDecimalForPixel(o)/s.factor-s.end;return this.min+h*(this.max-this.min)}_getLabelSize(o){const s=this.options.ticks,h=this.ctx.measureText(o).width,c=$e(this.isHorizontal()?s.maxRotation:s.minRotation),f=Math.cos(c),d=Math.sin(c),_=this._resolveTickFontOptions(0).size;return{w:h*f+_*d,h:h*d+_*f}}_getLabelCapacity(o){const s=this.options.time,h=s.displayFormats,c=h[s.unit]||h.millisecond,f=this._tickFormatFunction(o,0,cf(this,[o],this._majorUnit),c),d=this._getLabelSize(f),_=Math.floor(this.isHorizontal()?this.width/d.w:this.height/d.h)-1;return _>0?_:1}getDataTimestamps(){let o=this._cache.data||[],s,h;if(o.length)return o;const c=this.getMatchingVisibleMetas();if(this._normalized&&c.length)return this._cache.data=c[0].controller.getAllParsedValues(this);for(s=0,h=c.length;s<h;++s)o=o.concat(c[s].controller.getAllParsedValues(this));return this._cache.data=this.normalize(o)}getLabelTimestamps(){const o=this._cache.labels||[];let s,h;if(o.length)return o;const c=this.getLabels();for(s=0,h=c.length;s<h;++s)o.push(af(this,c[s]));return this._cache.labels=this._normalized?o:this.normalize(o)}normalize(o){return Va(o.sort(Ky))}}ao.id="time",ao.defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",major:{enabled:!1}}};function bs(l,o,s){let h=0,c=l.length-1,f,d,_,y;s?(o>=l[h].pos&&o<=l[c].pos&&({lo:h,hi:c}=cn(l,"pos",o)),{pos:f,time:_}=l[h],{pos:d,time:y}=l[c]):(o>=l[h].time&&o<=l[c].time&&({lo:h,hi:c}=cn(l,"time",o)),{time:f,pos:_}=l[h],{time:d,pos:y}=l[c]);const x=d-f;return x?_+(y-_)*(o-f)/x:_}class Ol extends ao{constructor(o){super(o);this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const o=this._getTimestampsForTable(),s=this._table=this.buildLookupTable(o);this._minPos=bs(s,this.min),this._tableRange=bs(s,this.max)-this._minPos,super.initOffsets(o)}buildLookupTable(o){const{min:s,max:h}=this,c=[],f=[];let d,_,y,x,T;for(d=0,_=o.length;d<_;++d)x=o[d],x>=s&&x<=h&&c.push(x);if(c.length<2)return[{time:s,pos:0},{time:h,pos:1}];for(d=0,_=c.length;d<_;++d)T=c[d+1],y=c[d-1],x=c[d],Math.round((T+y)/2)!==x&&f.push({time:x,pos:d/(_-1)});return f}_getTimestampsForTable(){let o=this._cache.all||[];if(o.length)return o;const s=this.getDataTimestamps(),h=this.getLabelTimestamps();return s.length&&h.length?o=this.normalize(s.concat(h)):o=s.length?s:h,o=this._cache.all=o,o}getDecimalForValue(o){return(bs(this._table,o)-this._minPos)/this._tableRange}getValueForPixel(o){const s=this._offsets,h=this.getDecimalForPixel(o)/s.factor-s.end;return bs(this._table,h*this._tableRange+this._minPos,!0)}}Ol.id="timeseries",Ol.defaults=ao.defaults;var uf=Object.freeze({__proto__:null,CategoryScale:ys,LinearScale:Sl,LogarithmicScale:Rl,RadialLinearScale:so,TimeScale:ao,TimeSeriesScale:Ol});return Jt.register(Du,uf,ml,ef),Jt.helpers=On({},f_),Jt._adapters=Iu,Jt.Animation=su,Jt.Animations=al,Jt.animator=m,Jt.controllers=un.controllers.items,Jt.DatasetController=nn,Jt.Element=Ke,Jt.elements=ml,Jt.Interaction=wc,Jt.layouts=me,Jt.platforms=ru,Jt.Scale=Hn,Jt.Ticks=eo,Object.assign(Jt,Du,uf,ml,ef,ru),Jt.Chart=Jt,typeof window!="undefined"&&(window.Chart=Jt),Jt})})(xg);var bg=xg.exports,oR={jet:[{index:0,rgb:[0,0,131]},{index:.125,rgb:[0,60,170]},{index:.375,rgb:[5,255,255]},{index:.625,rgb:[255,255,0]},{index:.875,rgb:[250,0,0]},{index:1,rgb:[128,0,0]}],hsv:[{index:0,rgb:[255,0,0]},{index:.169,rgb:[253,255,2]},{index:.173,rgb:[247,255,2]},{index:.337,rgb:[0,252,4]},{index:.341,rgb:[0,252,10]},{index:.506,rgb:[1,249,255]},{index:.671,rgb:[2,0,253]},{index:.675,rgb:[8,0,253]},{index:.839,rgb:[255,0,251]},{index:.843,rgb:[255,0,245]},{index:1,rgb:[255,0,6]}],hot:[{index:0,rgb:[0,0,0]},{index:.3,rgb:[230,0,0]},{index:.6,rgb:[255,210,0]},{index:1,rgb:[255,255,255]}],spring:[{index:0,rgb:[255,0,255]},{index:1,rgb:[255,255,0]}],summer:[{index:0,rgb:[0,128,102]},{index:1,rgb:[255,255,102]}],autumn:[{index:0,rgb:[255,0,0]},{index:1,rgb:[255,255,0]}],winter:[{index:0,rgb:[0,0,255]},{index:1,rgb:[0,255,128]}],bone:[{index:0,rgb:[0,0,0]},{index:.376,rgb:[84,84,116]},{index:.753,rgb:[169,200,200]},{index:1,rgb:[255,255,255]}],copper:[{index:0,rgb:[0,0,0]},{index:.804,rgb:[255,160,102]},{index:1,rgb:[255,199,127]}],greys:[{index:0,rgb:[0,0,0]},{index:1,rgb:[255,255,255]}],yignbu:[{index:0,rgb:[8,29,88]},{index:.125,rgb:[37,52,148]},{index:.25,rgb:[34,94,168]},{index:.375,rgb:[29,145,192]},{index:.5,rgb:[65,182,196]},{index:.625,rgb:[127,205,187]},{index:.75,rgb:[199,233,180]},{index:.875,rgb:[237,248,217]},{index:1,rgb:[255,255,217]}],greens:[{index:0,rgb:[0,68,27]},{index:.125,rgb:[0,109,44]},{index:.25,rgb:[35,139,69]},{index:.375,rgb:[65,171,93]},{index:.5,rgb:[116,196,118]},{index:.625,rgb:[161,217,155]},{index:.75,rgb:[199,233,192]},{index:.875,rgb:[229,245,224]},{index:1,rgb:[247,252,245]}],yiorrd:[{index:0,rgb:[128,0,38]},{index:.125,rgb:[189,0,38]},{index:.25,rgb:[227,26,28]},{index:.375,rgb:[252,78,42]},{index:.5,rgb:[253,141,60]},{index:.625,rgb:[254,178,76]},{index:.75,rgb:[254,217,118]},{index:.875,rgb:[255,237,160]},{index:1,rgb:[255,255,204]}],bluered:[{index:0,rgb:[0,0,255]},{index:1,rgb:[255,0,0]}],rdbu:[{index:0,rgb:[5,10,172]},{index:.35,rgb:[106,137,247]},{index:.5,rgb:[190,190,190]},{index:.6,rgb:[220,170,132]},{index:.7,rgb:[230,145,90]},{index:1,rgb:[178,10,28]}],picnic:[{index:0,rgb:[0,0,255]},{index:.1,rgb:[51,153,255]},{index:.2,rgb:[102,204,255]},{index:.3,rgb:[153,204,255]},{index:.4,rgb:[204,204,255]},{index:.5,rgb:[255,255,255]},{index:.6,rgb:[255,204,255]},{index:.7,rgb:[255,153,255]},{index:.8,rgb:[255,102,204]},{index:.9,rgb:[255,102,102]},{index:1,rgb:[255,0,0]}],rainbow:[{index:0,rgb:[150,0,90]},{index:.125,rgb:[0,0,200]},{index:.25,rgb:[0,25,255]},{index:.375,rgb:[0,152,255]},{index:.5,rgb:[44,255,150]},{index:.625,rgb:[151,255,0]},{index:.75,rgb:[255,234,0]},{index:.875,rgb:[255,111,0]},{index:1,rgb:[255,0,0]}],portland:[{index:0,rgb:[12,51,131]},{index:.25,rgb:[10,136,186]},{index:.5,rgb:[242,211,56]},{index:.75,rgb:[242,143,56]},{index:1,rgb:[217,30,30]}],blackbody:[{index:0,rgb:[0,0,0]},{index:.2,rgb:[230,0,0]},{index:.4,rgb:[230,210,0]},{index:.7,rgb:[255,255,255]},{index:1,rgb:[160,200,255]}],earth:[{index:0,rgb:[0,0,130]},{index:.1,rgb:[0,180,180]},{index:.2,rgb:[40,210,40]},{index:.4,rgb:[230,230,50]},{index:.6,rgb:[120,70,20]},{index:1,rgb:[255,255,255]}],electric:[{index:0,rgb:[0,0,0]},{index:.15,rgb:[30,0,100]},{index:.4,rgb:[120,0,100]},{index:.6,rgb:[160,90,0]},{index:.8,rgb:[230,200,0]},{index:1,rgb:[255,250,220]}],alpha:[{index:0,rgb:[255,255,255,0]},{index:1,rgb:[255,255,255,1]}],viridis:[{index:0,rgb:[68,1,84]},{index:.13,rgb:[71,44,122]},{index:.25,rgb:[59,81,139]},{index:.38,rgb:[44,113,142]},{index:.5,rgb:[33,144,141]},{index:.63,rgb:[39,173,129]},{index:.75,rgb:[92,200,99]},{index:.88,rgb:[170,220,50]},{index:1,rgb:[253,231,37]}],inferno:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[31,12,72]},{index:.25,rgb:[85,15,109]},{index:.38,rgb:[136,34,106]},{index:.5,rgb:[186,54,85]},{index:.63,rgb:[227,89,51]},{index:.75,rgb:[249,140,10]},{index:.88,rgb:[249,201,50]},{index:1,rgb:[252,255,164]}],magma:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[28,16,68]},{index:.25,rgb:[79,18,123]},{index:.38,rgb:[129,37,129]},{index:.5,rgb:[181,54,122]},{index:.63,rgb:[229,80,100]},{index:.75,rgb:[251,135,97]},{index:.88,rgb:[254,194,135]},{index:1,rgb:[252,253,191]}],plasma:[{index:0,rgb:[13,8,135]},{index:.13,rgb:[75,3,161]},{index:.25,rgb:[125,3,168]},{index:.38,rgb:[168,34,150]},{index:.5,rgb:[203,70,121]},{index:.63,rgb:[229,107,93]},{index:.75,rgb:[248,148,65]},{index:.88,rgb:[253,195,40]},{index:1,rgb:[240,249,33]}],warm:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[172,0,187]},{index:.25,rgb:[219,0,170]},{index:.38,rgb:[255,0,130]},{index:.5,rgb:[255,63,74]},{index:.63,rgb:[255,123,0]},{index:.75,rgb:[234,176,0]},{index:.88,rgb:[190,228,0]},{index:1,rgb:[147,255,0]}],cool:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[116,0,218]},{index:.25,rgb:[98,74,237]},{index:.38,rgb:[68,146,231]},{index:.5,rgb:[0,204,197]},{index:.63,rgb:[0,247,146]},{index:.75,rgb:[0,255,88]},{index:.88,rgb:[40,255,8]},{index:1,rgb:[147,255,0]}],"rainbow-soft":[{index:0,rgb:[125,0,179]},{index:.1,rgb:[199,0,180]},{index:.2,rgb:[255,0,121]},{index:.3,rgb:[255,108,0]},{index:.4,rgb:[222,194,0]},{index:.5,rgb:[150,255,0]},{index:.6,rgb:[0,255,55]},{index:.7,rgb:[0,246,150]},{index:.8,rgb:[50,167,222]},{index:.9,rgb:[103,51,235]},{index:1,rgb:[124,0,186]}],bathymetry:[{index:0,rgb:[40,26,44]},{index:.13,rgb:[59,49,90]},{index:.25,rgb:[64,76,139]},{index:.38,rgb:[63,110,151]},{index:.5,rgb:[72,142,158]},{index:.63,rgb:[85,174,163]},{index:.75,rgb:[120,206,163]},{index:.88,rgb:[187,230,172]},{index:1,rgb:[253,254,204]}],cdom:[{index:0,rgb:[47,15,62]},{index:.13,rgb:[87,23,86]},{index:.25,rgb:[130,28,99]},{index:.38,rgb:[171,41,96]},{index:.5,rgb:[206,67,86]},{index:.63,rgb:[230,106,84]},{index:.75,rgb:[242,149,103]},{index:.88,rgb:[249,193,135]},{index:1,rgb:[254,237,176]}],chlorophyll:[{index:0,rgb:[18,36,20]},{index:.13,rgb:[25,63,41]},{index:.25,rgb:[24,91,59]},{index:.38,rgb:[13,119,72]},{index:.5,rgb:[18,148,80]},{index:.63,rgb:[80,173,89]},{index:.75,rgb:[132,196,122]},{index:.88,rgb:[175,221,162]},{index:1,rgb:[215,249,208]}],density:[{index:0,rgb:[54,14,36]},{index:.13,rgb:[89,23,80]},{index:.25,rgb:[110,45,132]},{index:.38,rgb:[120,77,178]},{index:.5,rgb:[120,113,213]},{index:.63,rgb:[115,151,228]},{index:.75,rgb:[134,185,227]},{index:.88,rgb:[177,214,227]},{index:1,rgb:[230,241,241]}],"freesurface-blue":[{index:0,rgb:[30,4,110]},{index:.13,rgb:[47,14,176]},{index:.25,rgb:[41,45,236]},{index:.38,rgb:[25,99,212]},{index:.5,rgb:[68,131,200]},{index:.63,rgb:[114,156,197]},{index:.75,rgb:[157,181,203]},{index:.88,rgb:[200,208,216]},{index:1,rgb:[241,237,236]}],"freesurface-red":[{index:0,rgb:[60,9,18]},{index:.13,rgb:[100,17,27]},{index:.25,rgb:[142,20,29]},{index:.38,rgb:[177,43,27]},{index:.5,rgb:[192,87,63]},{index:.63,rgb:[205,125,105]},{index:.75,rgb:[216,162,148]},{index:.88,rgb:[227,199,193]},{index:1,rgb:[241,237,236]}],oxygen:[{index:0,rgb:[64,5,5]},{index:.13,rgb:[106,6,15]},{index:.25,rgb:[144,26,7]},{index:.38,rgb:[168,64,3]},{index:.5,rgb:[188,100,4]},{index:.63,rgb:[206,136,11]},{index:.75,rgb:[220,174,25]},{index:.88,rgb:[231,215,44]},{index:1,rgb:[248,254,105]}],par:[{index:0,rgb:[51,20,24]},{index:.13,rgb:[90,32,35]},{index:.25,rgb:[129,44,34]},{index:.38,rgb:[159,68,25]},{index:.5,rgb:[182,99,19]},{index:.63,rgb:[199,134,22]},{index:.75,rgb:[212,171,35]},{index:.88,rgb:[221,210,54]},{index:1,rgb:[225,253,75]}],phase:[{index:0,rgb:[145,105,18]},{index:.13,rgb:[184,71,38]},{index:.25,rgb:[186,58,115]},{index:.38,rgb:[160,71,185]},{index:.5,rgb:[110,97,218]},{index:.63,rgb:[50,123,164]},{index:.75,rgb:[31,131,110]},{index:.88,rgb:[77,129,34]},{index:1,rgb:[145,105,18]}],salinity:[{index:0,rgb:[42,24,108]},{index:.13,rgb:[33,50,162]},{index:.25,rgb:[15,90,145]},{index:.38,rgb:[40,118,137]},{index:.5,rgb:[59,146,135]},{index:.63,rgb:[79,175,126]},{index:.75,rgb:[120,203,104]},{index:.88,rgb:[193,221,100]},{index:1,rgb:[253,239,154]}],temperature:[{index:0,rgb:[4,35,51]},{index:.13,rgb:[23,51,122]},{index:.25,rgb:[85,59,157]},{index:.38,rgb:[129,79,143]},{index:.5,rgb:[175,95,130]},{index:.63,rgb:[222,112,101]},{index:.75,rgb:[249,146,66]},{index:.88,rgb:[249,196,65]},{index:1,rgb:[232,250,91]}],turbidity:[{index:0,rgb:[34,31,27]},{index:.13,rgb:[65,50,41]},{index:.25,rgb:[98,69,52]},{index:.38,rgb:[131,89,57]},{index:.5,rgb:[161,112,59]},{index:.63,rgb:[185,140,66]},{index:.75,rgb:[202,174,88]},{index:.88,rgb:[216,209,126]},{index:1,rgb:[233,246,171]}],"velocity-blue":[{index:0,rgb:[17,32,64]},{index:.13,rgb:[35,52,116]},{index:.25,rgb:[29,81,156]},{index:.38,rgb:[31,113,162]},{index:.5,rgb:[50,144,169]},{index:.63,rgb:[87,173,176]},{index:.75,rgb:[149,196,189]},{index:.88,rgb:[203,221,211]},{index:1,rgb:[254,251,230]}],"velocity-green":[{index:0,rgb:[23,35,19]},{index:.13,rgb:[24,64,38]},{index:.25,rgb:[11,95,45]},{index:.38,rgb:[39,123,35]},{index:.5,rgb:[95,146,12]},{index:.63,rgb:[152,165,18]},{index:.75,rgb:[201,186,69]},{index:.88,rgb:[233,216,137]},{index:1,rgb:[255,253,205]}],cubehelix:[{index:0,rgb:[0,0,0]},{index:.07,rgb:[22,5,59]},{index:.13,rgb:[60,4,105]},{index:.2,rgb:[109,1,135]},{index:.27,rgb:[161,0,147]},{index:.33,rgb:[210,2,142]},{index:.4,rgb:[251,11,123]},{index:.47,rgb:[255,29,97]},{index:.53,rgb:[255,54,69]},{index:.6,rgb:[255,85,46]},{index:.67,rgb:[255,120,34]},{index:.73,rgb:[255,157,37]},{index:.8,rgb:[241,191,57]},{index:.87,rgb:[224,220,93]},{index:.93,rgb:[218,241,142]},{index:1,rgb:[227,253,198]}]};function sR(r,e,t){return r*(1-t)+e*t}var aR=sR,Rd=oR,Ns=aR,lR=hR;function hR(r){var e,t,n,i,a,u,p,g,E,v,m;if(r||(r={}),g=(r.nshades||72)-1,p=r.format||"hex",u=r.colormap,u||(u="jet"),typeof u=="string"){if(u=u.toLowerCase(),!Rd[u])throw Error(u+" not a supported colorscale");a=Rd[u]}else if(Array.isArray(u))a=u.slice();else throw Error("unsupported colormap option",u);if(a.length>g+1)throw new Error(u+" map requires nshades to be at least size "+a.length);Array.isArray(r.alpha)?r.alpha.length!==2?v=[1,1]:v=r.alpha.slice():typeof r.alpha=="number"?v=[r.alpha,r.alpha]:v=[1,1],e=a.map(function(O){return Math.round(O.index*g)}),v[0]=Math.min(Math.max(v[0],0),1),v[1]=Math.min(Math.max(v[1],0),1);var b=a.map(function(O,I){var M=a[I].index,A=a[I].rgb.slice();return A.length===4&&A[3]>=0&&A[3]<=1||(A[3]=v[0]+(v[1]-v[0])*M),A}),E=[];for(m=0;m<e.length-1;++m){i=e[m+1]-e[m],t=b[m],n=b[m+1];for(var w=0;w<i;w++){var S=w/i;E.push([Math.round(Ns(t[0],n[0],S)),Math.round(Ns(t[1],n[1],S)),Math.round(Ns(t[2],n[2],S)),Ns(t[3],n[3],S)])}}return E.push(a[a.length-1].rgb.concat(v[1])),p==="hex"?E=E.map(uR):p==="rgbaString"?E=E.map(fR):p==="float"&&(E=E.map(cR)),E}function cR(r){return[r[0]/255,r[1]/255,r[2]/255,r[3]]}function uR(r){for(var e,t="#",n=0;n<3;++n)e=r[n],e=e.toString(16),t+=("00"+e).substr(e.length);return t}function fR(r){return"rgba("+r.join(",")+")"}const ih=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,dR=typeof AbortController!="undefined",Eg=dR?AbortController:Object.assign(class{constructor(){this.signal=new Eg.AbortSignal}abort(){this.signal.aborted=!0}},{AbortSignal:class{constructor(){this.aborted=!1}}}),sc=new Set,rh=(r,e)=>{const t=`LRU_CACHE_OPTION_${r}`;La(t)&&ac(t,`${r} option`,`options.${e}`,ci)},oh=(r,e)=>{const t=`LRU_CACHE_METHOD_${r}`;if(La(t)){const{prototype:n}=ci,{get:i}=Object.getOwnPropertyDescriptor(n,r);ac(t,`${r} method`,`cache.${e}()`,i)}},pR=(r,e)=>{const t=`LRU_CACHE_PROPERTY_${r}`;if(La(t)){const{prototype:n}=ci,{get:i}=Object.getOwnPropertyDescriptor(n,r);ac(t,`${r} property`,`cache.${e}`,i)}},La=r=>typeof process=="object"&&process&&!sc.has(r),ac=(r,e,t,n)=>{sc.add(r);const i=`The ${e} is deprecated. Please use ${t} instead.`;process.emitWarning(i,"DeprecationWarning",r,n)},ki=r=>r&&r===Math.floor(r)&&r>0&&isFinite(r),Tg=r=>ki(r)?r<=Math.pow(2,8)?Uint8Array:r<=Math.pow(2,16)?Uint16Array:r<=Math.pow(2,32)?Uint32Array:r<=Number.MAX_SAFE_INTEGER?Ks:null:null;class Ks extends Array{constructor(e){super(e);this.fill(0)}}class gR{constructor(e){const t=e?Tg(e):Array;this.heap=new t(e),this.length=0}push(e){this.heap[this.length++]=e}pop(){return this.heap[--this.length]}}class ci{constructor(e={}){const{max:t=0,ttl:n,ttlResolution:i=1,ttlAutopurge:a,updateAgeOnGet:u,allowStale:p,dispose:g,disposeAfter:v,noDisposeOnSet:m,noUpdateTTL:b,maxSize:E=0,sizeCalculation:w,fetchMethod:S}=e,{length:O,maxAge:I,stale:M}=e instanceof ci?{}:e;if(t!==0&&!ki(t))throw new TypeError("max option must be a nonnegative integer");const A=t?Tg(t):Array;if(!A)throw new Error("invalid max value: "+t);if(this.max=t,this.maxSize=E,this.sizeCalculation=w||O,this.sizeCalculation){if(!this.maxSize)throw new TypeError("cannot set sizeCalculation without setting maxSize");if(typeof this.sizeCalculation!="function")throw new TypeError("sizeCalculation set to non-function")}if(this.fetchMethod=S||null,this.fetchMethod&&typeof this.fetchMethod!="function")throw new TypeError("fetchMethod must be a function if specified");if(this.keyMap=new Map,this.keyList=new Array(t).fill(null),this.valList=new Array(t).fill(null),this.next=new A(t),this.prev=new A(t),this.head=0,this.tail=0,this.free=new gR(t),this.initialFill=1,this.size=0,typeof g=="function"&&(this.dispose=g),typeof v=="function"?(this.disposeAfter=v,this.disposed=[]):(this.disposeAfter=null,this.disposed=null),this.noDisposeOnSet=!!m,this.noUpdateTTL=!!b,this.maxSize!==0){if(!ki(this.maxSize))throw new TypeError("maxSize must be a positive integer if specified");this.initializeSizeTracking()}if(this.allowStale=!!p||!!M,this.updateAgeOnGet=!!u,this.ttlResolution=ki(i)||i===0?i:1,this.ttlAutopurge=!!a,this.ttl=n||I||0,this.ttl){if(!ki(this.ttl))throw new TypeError("ttl must be a positive integer if specified");this.initializeTTLTracking()}if(this.max===0&&this.ttl===0&&this.maxSize===0)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!this.max&&!this.maxSize){const k="LRU_CACHE_UNBOUNDED";if(La(k)){sc.add(k);const L="TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.";process.emitWarning(L,"UnboundedCacheWarning",k,ci)}}M&&rh("stale","allowStale"),I&&rh("maxAge","ttl"),O&&rh("length","sizeCalculation")}getRemainingTTL(e){return this.has(e)?1/0:0}initializeTTLTracking(){this.ttls=new Ks(this.max),this.starts=new Ks(this.max),this.setItemTTL=(n,i)=>{if(this.starts[n]=i!==0?ih.now():0,this.ttls[n]=i,i!==0&&this.ttlAutopurge){const a=setTimeout(()=>{this.isStale(n)&&this.delete(this.keyList[n])},i+1);a.unref&&a.unref()}},this.updateItemAge=n=>{this.starts[n]=this.ttls[n]!==0?ih.now():0};let e=0;const t=()=>{const n=ih.now();if(this.ttlResolution>0){e=n;const i=setTimeout(()=>e=0,this.ttlResolution);i.unref&&i.unref()}return n};this.getRemainingTTL=n=>{const i=this.keyMap.get(n);return i===void 0?0:this.ttls[i]===0||this.starts[i]===0?1/0:this.starts[i]+this.ttls[i]-(e||t())},this.isStale=n=>this.ttls[n]!==0&&this.starts[n]!==0&&(e||t())-this.starts[n]>this.ttls[n]}updateItemAge(e){}setItemTTL(e,t){}isStale(e){return!1}initializeSizeTracking(){this.calculatedSize=0,this.sizes=new Ks(this.max),this.removeItemSize=e=>this.calculatedSize-=this.sizes[e],this.requireSize=(e,t,n,i)=>{if(!ki(n))if(i){if(typeof i!="function")throw new TypeError("sizeCalculation must be a function");if(n=i(t,e),!ki(n))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}else throw new TypeError("invalid size value (must be positive integer)");return n},this.addItemSize=(e,t,n,i)=>{this.sizes[e]=i;const a=this.maxSize-this.sizes[e];for(;this.calculatedSize>a;)this.evict();this.calculatedSize+=this.sizes[e]},this.delete=e=>{if(this.size!==0){const t=this.keyMap.get(e);t!==void 0&&(this.calculatedSize-=this.sizes[t])}return ci.prototype.delete.call(this,e)}}removeItemSize(e){}addItemSize(e,t,n,i){}requireSize(e,t,n,i){if(n||i)throw new TypeError("cannot set size without setting maxSize on cache")}*indexes({allowStale:e=this.allowStale}={}){if(this.size)for(let t=this.tail;!(!this.isValidIndex(t)||((e||!this.isStale(t))&&(yield t),t===this.head));)t=this.prev[t]}*rindexes({allowStale:e=this.allowStale}={}){if(this.size)for(let t=this.head;!(!this.isValidIndex(t)||((e||!this.isStale(t))&&(yield t),t===this.tail));)t=this.next[t]}isValidIndex(e){return this.keyMap.get(this.keyList[e])===e}*entries(){for(const e of this.indexes())yield[this.keyList[e],this.valList[e]]}*rentries(){for(const e of this.rindexes())yield[this.keyList[e],this.valList[e]]}*keys(){for(const e of this.indexes())yield this.keyList[e]}*rkeys(){for(const e of this.rindexes())yield this.keyList[e]}*values(){for(const e of this.indexes())yield this.valList[e]}*rvalues(){for(const e of this.rindexes())yield this.valList[e]}[Symbol.iterator](){return this.entries()}find(e,t={}){for(const n of this.indexes())if(e(this.valList[n],this.keyList[n],this))return this.get(this.keyList[n],t)}forEach(e,t=this){for(const n of this.indexes())e.call(t,this.valList[n],this.keyList[n],this)}rforEach(e,t=this){for(const n of this.rindexes())e.call(t,this.valList[n],this.keyList[n],this)}get prune(){return oh("prune","purgeStale"),this.purgeStale}purgeStale(){let e=!1;for(const t of this.rindexes({allowStale:!0}))this.isStale(t)&&(this.delete(this.keyList[t]),e=!0);return e}dump(){const e=[];for(const t of this.indexes()){const n=this.keyList[t],a={value:this.valList[t]};this.ttls&&(a.ttl=this.ttls[t]),this.sizes&&(a.size=this.sizes[t]),e.unshift([n,a])}return e}load(e){this.clear();for(const[t,n]of e)this.set(t,n.value,n)}dispose(e,t,n){}set(e,t,{ttl:n=this.ttl,noDisposeOnSet:i=this.noDisposeOnSet,size:a=0,sizeCalculation:u=this.sizeCalculation,noUpdateTTL:p=this.noUpdateTTL}={}){a=this.requireSize(e,t,a,u);let g=this.size===0?void 0:this.keyMap.get(e);if(g===void 0)g=this.newIndex(),this.keyList[g]=e,this.valList[g]=t,this.keyMap.set(e,g),this.next[this.tail]=g,this.prev[g]=this.tail,this.tail=g,this.size++,this.addItemSize(g,t,e,a),p=!1;else{const v=this.valList[g];t!==v&&(this.isBackgroundFetch(v)?v.__abortController.abort():i||(this.dispose(v,e,"set"),this.disposeAfter&&this.disposed.push([v,e,"set"])),this.removeItemSize(g),this.valList[g]=t,this.addItemSize(g,t,e,a)),this.moveToTail(g)}if(n!==0&&this.ttl===0&&!this.ttls&&this.initializeTTLTracking(),p||this.setItemTTL(g,n),this.disposeAfter)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift());return this}newIndex(){return this.size===0?this.tail:this.size===this.max?this.evict():this.free.length!==0?this.free.pop():this.initialFill++}pop(){if(this.size){const e=this.valList[this.head];return this.evict(),e}}evict(){const e=this.head,t=this.keyList[e],n=this.valList[e];return this.isBackgroundFetch(n)?n.__abortController.abort():(this.dispose(n,t,"evict"),this.disposeAfter&&this.disposed.push([n,t,"evict"])),this.removeItemSize(e),this.head=this.next[e],this.keyMap.delete(t),this.size--,e}has(e){return this.keyMap.has(e)&&!this.isStale(this.keyMap.get(e))}peek(e,{allowStale:t=this.allowStale}={}){const n=this.keyMap.get(e);if(n!==void 0&&(t||!this.isStale(n)))return this.valList[n]}backgroundFetch(e,t,n){const i=t===void 0?void 0:this.valList[t];if(this.isBackgroundFetch(i))return i;const a=new Eg,u={signal:a.signal,options:n},p=Promise.resolve(this.fetchMethod(e,i,u)).then(g=>(a.signal.aborted||this.set(e,g,u.options),g));return p.__abortController=a,p.__staleWhileFetching=i,t===void 0?(this.set(e,p,u.options),t=this.keyMap.get(e)):this.valList[t]=p,p}isBackgroundFetch(e){return e&&typeof e=="object"&&typeof e.then=="function"&&Object.prototype.hasOwnProperty.call(e,"__staleWhileFetching")}async fetch(e,{allowStale:t=this.allowStale,updateAgeOnGet:n=this.updateAgeOnGet,ttl:i=this.ttl,noDisposeOnSet:a=this.noDisposeOnSet,size:u=0,sizeCalculation:p=this.sizeCalculation,noUpdateTTL:g=this.noUpdateTTL}={}){if(!this.fetchMethod)return this.get(e,{allowStale:t,updateAgeOnGet:n});const v={allowStale:t,updateAgeOnGet:n,ttl:i,noDisposeOnSet:a,size:u,sizeCalculation:p,noUpdateTTL:g};let m=this.keyMap.get(e);if(m===void 0)return this.backgroundFetch(e,m,v);{const b=this.valList[m];if(this.isBackgroundFetch(b))return t&&b.__staleWhileFetching!==void 0?b.__staleWhileFetching:b;if(!this.isStale(m))return this.moveToTail(m),n&&this.updateItemAge(m),b;const E=this.backgroundFetch(e,m,v);return t&&E.__staleWhileFetching!==void 0?E.__staleWhileFetching:E}}get(e,{allowStale:t=this.allowStale,updateAgeOnGet:n=this.updateAgeOnGet}={}){const i=this.keyMap.get(e);if(i!==void 0){const a=this.valList[i],u=this.isBackgroundFetch(a);return this.isStale(i)?u?t?a.__staleWhileFetching:void 0:(this.delete(e),t?a:void 0):u?void 0:(this.moveToTail(i),n&&this.updateItemAge(i),a)}}connect(e,t){this.prev[t]=e,this.next[e]=t}moveToTail(e){e!==this.tail&&(e===this.head?this.head=this.next[e]:this.connect(this.prev[e],this.next[e]),this.connect(this.tail,e),this.tail=e)}get del(){return oh("del","delete"),this.delete}delete(e){let t=!1;if(this.size!==0){const n=this.keyMap.get(e);if(n!==void 0)if(t=!0,this.size===1)this.clear();else{this.removeItemSize(n);const i=this.valList[n];this.isBackgroundFetch(i)?i.__abortController.abort():(this.dispose(i,e,"delete"),this.disposeAfter&&this.disposed.push([i,e,"delete"])),this.keyMap.delete(e),this.keyList[n]=null,this.valList[n]=null,n===this.tail?this.tail=this.prev[n]:n===this.head?this.head=this.next[n]:(this.next[this.prev[n]]=this.next[n],this.prev[this.next[n]]=this.prev[n]),this.size--,this.free.push(n)}}if(this.disposed)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift());return t}clear(){for(const e of this.rindexes({allowStale:!0})){const t=this.valList[e];if(this.isBackgroundFetch(t))t.__abortController.abort();else{const n=this.keyList[e];this.dispose(t,n,"delete"),this.disposeAfter&&this.disposed.push([t,n,"delete"])}}if(this.keyMap.clear(),this.valList.fill(null),this.keyList.fill(null),this.ttls&&(this.ttls.fill(0),this.starts.fill(0)),this.sizes&&this.sizes.fill(0),this.head=0,this.tail=0,this.initialFill=1,this.free.length=0,this.calculatedSize=0,this.size=0,this.disposed)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift())}get reset(){return oh("reset","clear"),this.clear}get length(){return pR("length","size"),this.size}}var _R=ci;function vR(r){const e=new _R({max:100});return(...t)=>{if(e.has(t))return e.get(t);const n=r(...t);return e.set(t,n),n}}const yR="https://chaichontat-host.s3.amazonaws.com/libd-rotation",Cd=["Astro","Endo","Excit","Inhib","MSN.D1","MSN.D2","Macrophage","Micro","Mural","Neu","OPC","Oligo","Tcell","by_row","coords"];function mR(r){const e=r.coords,t=r.by_row;return delete r.coords,delete r.by_row,{data:r,coords:e,byRow:t}}async function xR(r){const e=await Promise.all(Cd.map(t=>fetch(`${yR}/${r}/${t}.json`).then(n=>n.json())));return mR(e.reduce((t,n,i)=>Zn(On({},t),{[Cd[i]]:n}),{}))}function bR(r){const e={},t=[],n=[];for(const[i,a]of Object.keys(r).entries())e[a]=i,n.push(a),t.push(Math.max(...r[a]));return{idxs:e,maxs:t,cellTypes:n}}function ER(r){let e,t,n,i,a,u;function p(v){r[4](v)}let g={names:r[1],color:"slate"};return r[0]!==void 0&&(g.curr=r[0]),e=new $s({props:g}),Bs.push(()=>Gs(e,"curr",p)),{c(){si(e.$$.fragment),n=De(),i=ie("div"),a=ie("canvas"),this.h()},l(v){ai(e.$$.fragment,v),n=ke(v),i=re(v,"DIV",{class:!0});var m=_e(i);a=re(m,"CANVAS",{class:!0,id:!0}),_e(a).forEach(Mt),m.forEach(Mt),this.h()},h(){St(a,"class",""),St(a,"id","myChart"),St(i,"class","relative")},m(v,m){li(e,v,m),Le(v,n,m),Le(v,i,m),Ut(i,a),u=!0},p(v,[m]){const b={};!t&&m&1&&(t=!0,b.curr=v[0],zs(()=>t=!1)),e.$set(b)},i(v){u||(Dn(e.$$.fragment,v),u=!0)},o(v){kn(e.$$.fragment,v),u=!1},d(v){hi(e,v),v&&Mt(n),v&&Mt(i)}}}function TR(r,e,t){let n;Th(r,Xi,A=>t(5,n=A));let{d:i}=e;const{data:a,coords:u}=i,{idxs:p,maxs:g,cellTypes:v}=bR(a),m=lR({colormap:"viridis",nshades:255,format:"hex"});let b=v[0],E;const w=u.reduce((A,{x:k,y:L})=>[Math.min(A[0],k),Math.min(A[1],L)],[1/0,1/0]),S=u.reduce((A,{x:k,y:L})=>[Math.max(A[0],k),Math.max(A[1],L)],[0,0]),O=vR(A=>a[A].map(k=>m[Math.round(k/g[p[A]]*255)]));function I(A,k){!A||(A.data.datasets[0].backgroundColor=O(k),A.update())}console.log(w),wh(()=>{const A=document.getElementById("myChart").getContext("2d");t(3,E=new bg(A,{data:{datasets:[{type:"scatter",data:[{x:1e4,y:1e4}],backgroundColor:"white",normalized:!0,pointRadius:25,borderColor:"#eeeeee"},{type:"scatter",data:u,backgroundColor:O(b),normalized:!0,pointRadius:2.5,pointHoverRadius:20,pointHoverBorderWidth:1,pointHoverBorderColor:"#eeeeee"}]},options:{animation:!1,aspectRatio:1,scales:{x:{min:w[0],max:S[0],grid:{display:!1},ticks:{display:!1}},y:{min:w[1],max:S[1],grid:{display:!1},ticks:{display:!1}}},plugins:{legend:{display:!1},tooltip:{enabled:!1}},onHover:(k,L)=>{var B;L.length===0||((B=L[0])==null?void 0:B.index)===0||Us(Xi,n.currIdx=L[0].index,n)},onClick:(k,L)=>{var G;if(L.length===0||((G=L[0])==null?void 0:G.index)===0)return;const B=L[0].index;if(B===n.lockedIdx){Us(Xi,n.lockedIdx=-1,n);return}Us(Xi,n.lockedIdx=B,n)}}}))});function M(A){b=A,t(0,b)}return r.$$set=A=>{"d"in A&&t(2,i=A.d)},r.$$.update=()=>{r.$$.dirty&8&&E&&console.log(E.data.datasets),r.$$.dirty&9&&I(E,b)},[b,v,i,E,M]}class wR extends Mr{constructor(e){super();Lr(this,e,TR,ER,Dr,{d:2})}}function SR(r){let e,t;return{c(){e=ie("div"),t=ie("canvas"),this.h()},l(n){e=re(n,"DIV",{class:!0});var i=_e(e);t=re(i,"CANVAS",{id:!0}),_e(t).forEach(Mt),i.forEach(Mt),this.h()},h(){St(t,"id","bar"),St(e,"class","relative w-full")},m(n,i){Le(n,e,i),Ut(e,t)},p:ce,i:ce,o:ce,d(n){n&&Mt(e)}}}function RR(r,e,t){let n;Th(r,Xi,p=>t(2,n=p));let{d:i}=e;const{byRow:a}=i;let u;return wh(()=>{const p=document.getElementById("bar").getContext("2d");t(1,u=new bg(p,{type:"bar",data:{datasets:[{data:a[0],backgroundColor:"white",normalized:!0}]},options:{scales:{x:{grid:{borderColor:"white"},ticks:{color:"white"},position:"top"},y:{min:0,max:10,grid:{borderColor:"white"},ticks:{color:"white"},reverse:!0}},animation:{duration:200},plugins:{tooltip:{enabled:!1},legend:{display:!1}}}}))}),r.$$set=p=>{"d"in p&&t(0,i=p.d)},r.$$.update=()=>{r.$$.dirty&6&&u&&(n.lockedIdx!==-1?t(1,u.data.datasets[0].data=a[n.lockedIdx],u):t(1,u.data.datasets[0].data=a[n.currIdx],u),u.update())},[i,u,n]}class CR extends Mr{constructor(e){super();Lr(this,e,RR,SR,Dr,{d:0})}}function OR(r){return{c:ce,l:ce,m:ce,p:ce,i:ce,o:ce,d:ce}}function IR(r){let e,t,n,i;return e=new wR({props:{d:r[1]}}),n=new CR({props:{d:r[1]}}),{c(){si(e.$$.fragment),t=De(),si(n.$$.fragment)},l(a){ai(e.$$.fragment,a),t=ke(a),ai(n.$$.fragment,a)},m(a,u){li(e,a,u),Le(a,t,u),li(n,a,u),i=!0},p(a,u){const p={};u&1&&(p.d=a[1]),e.$set(p);const g={};u&1&&(g.d=a[1]),n.$set(g)},i(a){i||(Dn(e.$$.fragment,a),Dn(n.$$.fragment,a),i=!0)},o(a){kn(e.$$.fragment,a),kn(n.$$.fragment,a),i=!1},d(a){hi(e,a),a&&Mt(t),hi(n,a)}}}function AR(r){return{c:ce,l:ce,m:ce,p:ce,i:ce,o:ce,d:ce}}function PR(r){let e,t,n,i,a={ctx:r,current:null,token:null,hasCatch:!1,pending:AR,then:IR,catch:OR,value:1,blocks:[,,,]};return gf(n=r[0],a),{c(){e=ie("section"),t=ie("div"),a.block.c(),this.h()},l(u){e=re(u,"SECTION",{class:!0});var p=_e(e);t=re(p,"DIV",{class:!0});var g=_e(t);a.block.l(g),g.forEach(Mt),p.forEach(Mt),this.h()},h(){St(t,"class","mt-2 flex w-[50vw] max-w-[600px] flex-col"),St(e,"class","flex flex-grow flex-col gap-y-2")},m(u,p){Le(u,e,p),Ut(e,t),a.block.m(t,a.anchor=null),a.mount=()=>t,a.anchor=null,i=!0},p(u,[p]){r=u,a.ctx=r,p&1&&n!==(n=r[0])&&gf(n,a)||im(a,r,p)},i(u){i||(Dn(a.block),i=!0)},o(u){for(let p=0;p<3;p+=1){const g=a.blocks[p];kn(g)}i=!1},d(u){u&&Mt(e),a.block.d(),a.token=null,a=null}}}function MR(r,e,t){let{dataPromise:n}=e;return r.$$set=i=>{"dataPromise"in i&&t(0,n=i.dataPromise)},[n]}class LR extends Mr{constructor(e){super();Lr(this,e,MR,PR,Dr,{dataPromise:0})}}function DR(r){let e,t,n,i,a,u,p,g,v,m,b,E,w,S,O;return E=new LR({props:{dataPromise:r[0]}}),S=new rR({props:{sample:Zs,dataPromise:r[0]}}),{c(){e=De(),t=ie("h1"),n=Ni("Visium "),i=ie("span"),a=Ni("IF"),u=De(),p=ie("h3"),g=Ni("Sample: "),v=Ni(Zs),m=De(),b=ie("main"),si(E.$$.fragment),w=De(),si(S.$$.fragment),this.h()},l(I){rm('[data-svelte="svelte-1i58lyp"]',document.head).forEach(Mt),e=ke(I),t=re(I,"H1",{class:!0});var A=_e(t);n=Bi(A,"Visium "),i=re(A,"SPAN",{class:!0});var k=_e(i);a=Bi(k,"IF"),k.forEach(Mt),A.forEach(Mt),u=ke(I),p=re(I,"H3",{class:!0});var L=_e(p);g=Bi(L,"Sample: "),v=Bi(L,Zs),L.forEach(Mt),m=ke(I),b=re(I,"MAIN",{class:!0});var B=_e(b);ai(E.$$.fragment,B),w=ke(B),ai(S.$$.fragment,B),B.forEach(Mt),this.h()},h(){document.title="Visium IF",St(i,"class","fancy svelte-d0hokl"),St(t,"class","order-1 mb-2 text-3xl font-bold text-white sm:text-5xl sm:leading-none"),St(p,"class","mb-6 text-lg text-slate-100"),St(b,"class","flex flex-wrap gap-x-6 md:flex-nowrap")},m(I,M){Le(I,e,M),Le(I,t,M),Ut(t,n),Ut(t,i),Ut(i,a),Le(I,u,M),Le(I,p,M),Ut(p,g),Ut(p,v),Le(I,m,M),Le(I,b,M),li(E,b,null),Ut(b,w),li(S,b,null),O=!0},p:ce,i(I){O||(Dn(E.$$.fragment,I),Dn(S.$$.fragment,I),O=!0)},o(I){kn(E.$$.fragment,I),kn(S.$$.fragment,I),O=!1},d(I){I&&Mt(e),I&&Mt(t),I&&Mt(u),I&&Mt(p),I&&Mt(m),I&&Mt(b),hi(E),hi(S)}}}const Zs="Br6522_Ant_IF";function kR(r){return[xR(Zs)]}class QR extends Mr{constructor(e){super();Lr(this,e,kR,DR,Dr,{})}}export{KR as L,QR as R,ZR as a};
