var Hy=Object.defineProperty,Yy=Object.defineProperties;var $y=Object.getOwnPropertyDescriptors;var bs=Object.getOwnPropertySymbols;var hf=Object.prototype.hasOwnProperty,cf=Object.prototype.propertyIsEnumerable;var lf=(o,e,t)=>e in o?Hy(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t,On=(o,e)=>{for(var t in e||(e={}))hf.call(e,t)&&lf(o,t,e[t]);if(bs)for(var t of bs(e))cf.call(e,t)&&lf(o,t,e[t]);return o},qn=(o,e)=>Yy(o,$y(e));var co=(o,e)=>{var t={};for(var n in o)hf.call(o,n)&&e.indexOf(n)<0&&(t[n]=o[n]);if(o!=null&&bs)for(var n of bs(o))e.indexOf(n)<0&&cf.call(o,n)&&(t[n]=o[n]);return t};import{S as da,i as pa,s as ga,e as Kt,t as kn,c as Zt,a as oe,h as Fn,d as Gt,b as wt,g as gn,J as St,K as Dn,j as Hs,k as Le,m as De,E as me,L as Ky,M as xd,N as Fs,O as Ns,w as br,x as Er,y as Tr,P as ar,Q as Bs,q as Bi,o as Gi,B as wr,R as bd,v as Ed,T as Pl,U as lr,V as Zy,W as qy}from"./index-459a7ae4.js";import{w as Jy}from"./index-6487d96d.js";var Qy=function(){function o(e){this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null}return o.prototype.preventDefault=function(){this.defaultPrevented=!0},o.prototype.stopPropagation=function(){this.propagationStopped=!0},o}(),Bn=Qy,Ir={PROPERTYCHANGE:"propertychange"},tm=function(){function o(){this.disposed=!1}return o.prototype.dispose=function(){this.disposed||(this.disposed=!0,this.disposeInternal())},o.prototype.disposeInternal=function(){},o}(),_a=tm;function Ar(o,e){return o>e?1:o<e?-1:0}function bh(o,e,t){var n=o.length;if(o[0]<=e)return 0;if(e<=o[n-1])return n-1;var i=void 0;if(t>0){for(i=1;i<n;++i)if(o[i]<e)return i-1}else if(t<0){for(i=1;i<n;++i)if(o[i]<=e)return i}else for(i=1;i<n;++i){if(o[i]==e)return i;if(o[i]<e)return typeof t=="function"?t(e,o[i-1],o[i])>0?i-1:i:o[i-1]-e<e-o[i]?i-1:i}return n-1}function em(o,e,t){for(;e<t;){var n=o[e];o[e]=o[t],o[t]=n,++e,--t}}function Td(o,e){for(var t=Array.isArray(e)?e:[e],n=t.length,i=0;i<n;i++)o[o.length]=t[i]}function Wi(o,e){var t=o.length;if(t!==e.length)return!1;for(var n=0;n<t;n++)if(o[n]!==e[n])return!1;return!0}function nm(o,e,t){var n=e||Ar;return o.every(function(i,a){if(a===0)return!0;var u=n(o[a-1],i);return!(u>0||t&&u===0)})}function Sr(){return!0}function va(){return!1}function Vi(){}function im(o){var e=!1,t,n,i;return function(){var a=Array.prototype.slice.call(arguments);return(!e||this!==i||!Wi(a,n))&&(e=!0,i=this,n=a,t=o.apply(this,arguments)),t}}function rm(o){function e(){var t;try{t=o()}catch(n){return Promise.reject(n)}return t instanceof Promise?t:Promise.resolve(t)}return e()}var se=typeof Object.assign=="function"?Object.assign:function(o,e){if(o==null)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(o),n=1,i=arguments.length;n<i;++n){var a=arguments[n];if(a!=null)for(var u in a)a.hasOwnProperty(u)&&(t[u]=a[u])}return t};function Lr(o){for(var e in o)delete o[e]}var wd=typeof Object.values=="function"?Object.values:function(o){var e=[];for(var t in o)e.push(o[t]);return e};function Ro(o){var e;for(e in o)return!1;return!e}var om=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),sm=function(o){om(e,o);function e(t){var n=o.call(this)||this;return n.eventTarget_=t,n.pendingRemovals_=null,n.dispatching_=null,n.listeners_=null,n}return e.prototype.addEventListener=function(t,n){if(!(!t||!n)){var i=this.listeners_||(this.listeners_={}),a=i[t]||(i[t]=[]);a.indexOf(n)===-1&&a.push(n)}},e.prototype.dispatchEvent=function(t){var n=typeof t=="string",i=n?t:t.type,a=this.listeners_&&this.listeners_[i];if(!!a){var u=n?new Bn(t):t;u.target||(u.target=this.eventTarget_||this);var p=this.dispatching_||(this.dispatching_={}),g=this.pendingRemovals_||(this.pendingRemovals_={});i in p||(p[i]=0,g[i]=0),++p[i];for(var v,m=0,E=a.length;m<E;++m)if("handleEvent"in a[m]?v=a[m].handleEvent(u):v=a[m].call(this,u),v===!1||u.propagationStopped){v=!1;break}if(--p[i]===0){var b=g[i];for(delete g[i];b--;)this.removeEventListener(i,Vi);delete p[i]}return v}},e.prototype.disposeInternal=function(){this.listeners_&&Lr(this.listeners_)},e.prototype.getListeners=function(t){return this.listeners_&&this.listeners_[t]||void 0},e.prototype.hasListener=function(t){return this.listeners_?t?t in this.listeners_:Object.keys(this.listeners_).length>0:!1},e.prototype.removeEventListener=function(t,n){var i=this.listeners_&&this.listeners_[t];if(i){var a=i.indexOf(n);a!==-1&&(this.pendingRemovals_&&t in this.pendingRemovals_?(i[a]=Vi,++this.pendingRemovals_[t]):(i.splice(a,1),i.length===0&&delete this.listeners_[t]))}},e}(_a),Hi=sm,pt={CHANGE:"change",ERROR:"error",BLUR:"blur",CLEAR:"clear",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",DRAGENTER:"dragenter",DRAGOVER:"dragover",DROP:"drop",FOCUS:"focus",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",RESIZE:"resize",TOUCHMOVE:"touchmove",WHEEL:"wheel"};function Lt(o,e,t,n,i){if(n&&n!==o&&(t=t.bind(n)),i){var a=t;t=function(){o.removeEventListener(e,t),a.apply(this,arguments)}}var u={target:o,type:e,listener:t};return o.addEventListener(e,t),u}function Ys(o,e,t,n){return Lt(o,e,t,n,!0)}function qt(o){o&&o.target&&(o.target.removeEventListener(o.type,o.listener),Lr(o))}var am=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),ya=function(o){am(e,o);function e(){var t=o.call(this)||this;return t.on=t.onInternal,t.once=t.onceInternal,t.un=t.unInternal,t.revision_=0,t}return e.prototype.changed=function(){++this.revision_,this.dispatchEvent(pt.CHANGE)},e.prototype.getRevision=function(){return this.revision_},e.prototype.onInternal=function(t,n){if(Array.isArray(t)){for(var i=t.length,a=new Array(i),u=0;u<i;++u)a[u]=Lt(this,t[u],n);return a}else return Lt(this,t,n)},e.prototype.onceInternal=function(t,n){var i;if(Array.isArray(t)){var a=t.length;i=new Array(a);for(var u=0;u<a;++u)i[u]=Ys(this,t[u],n)}else i=Ys(this,t,n);return n.ol_key=i,i},e.prototype.unInternal=function(t,n){var i=n.ol_key;if(i)lm(i);else if(Array.isArray(t))for(var a=0,u=t.length;a<u;++a)this.removeEventListener(t[a],n);else this.removeEventListener(t,n)},e}(Hi);ya.prototype.on;ya.prototype.once;ya.prototype.un;function lm(o){if(Array.isArray(o))for(var e=0,t=o.length;e<t;++e)qt(o[e]);else qt(o)}var Sd=ya;function Ct(){return function(){throw new Error("Unimplemented abstract method.")}()}var hm=0;function Xt(o){return o.ol_uid||(o.ol_uid=String(++hm))}var cm="6.14.1",Rd=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),uf=function(o){Rd(e,o);function e(t,n,i){var a=o.call(this,t)||this;return a.key=n,a.oldValue=i,a}return e}(Bn),um=function(o){Rd(e,o);function e(t){var n=o.call(this)||this;return n.on,n.once,n.un,Xt(n),n.values_=null,t!==void 0&&n.setProperties(t),n}return e.prototype.get=function(t){var n;return this.values_&&this.values_.hasOwnProperty(t)&&(n=this.values_[t]),n},e.prototype.getKeys=function(){return this.values_&&Object.keys(this.values_)||[]},e.prototype.getProperties=function(){return this.values_&&se({},this.values_)||{}},e.prototype.hasProperties=function(){return!!this.values_},e.prototype.notify=function(t,n){var i;i="change:".concat(t),this.hasListener(i)&&this.dispatchEvent(new uf(i,t,n)),i=Ir.PROPERTYCHANGE,this.hasListener(i)&&this.dispatchEvent(new uf(i,t,n))},e.prototype.addChangeListener=function(t,n){this.addEventListener("change:".concat(t),n)},e.prototype.removeChangeListener=function(t,n){this.removeEventListener("change:".concat(t),n)},e.prototype.set=function(t,n,i){var a=this.values_||(this.values_={});if(i)a[t]=n;else{var u=a[t];a[t]=n,u!==n&&this.notify(t,u)}},e.prototype.setProperties=function(t,n){for(var i in t)this.set(i,t[i],n)},e.prototype.applyProperties=function(t){!t.values_||se(this.values_||(this.values_={}),t.values_)},e.prototype.unset=function(t,n){if(this.values_&&t in this.values_){var i=this.values_[t];delete this.values_[t],Ro(this.values_)&&(this.values_=null),n||this.notify(t,i)}},e}(Sd),Tn=um,fm=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),dm=function(o){fm(e,o);function e(t){var n=this,i="v"+cm.split("-")[0],a="Assertion failed. See https://openlayers.org/en/"+i+"/doc/errors/#"+t+" for details.";return n=o.call(this,a)||this,n.code=t,n.name="AssertionError",n.message=a,n}return e}(Error),Cd=dm;function Ot(o,e){if(!o)throw new Cd(e)}var pm=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),gm=function(o){pm(e,o);function e(t){var n=o.call(this)||this;if(n.on,n.once,n.un,n.id_=void 0,n.geometryName_="geometry",n.style_=null,n.styleFunction_=void 0,n.geometryChangeKey_=null,n.addChangeListener(n.geometryName_,n.handleGeometryChanged_),t)if(typeof t.getSimplifiedGeometry=="function"){var i=t;n.setGeometry(i)}else{var a=t;n.setProperties(a)}return n}return e.prototype.clone=function(){var t=new e(this.hasProperties()?this.getProperties():null);t.setGeometryName(this.getGeometryName());var n=this.getGeometry();n&&t.setGeometry(n.clone());var i=this.getStyle();return i&&t.setStyle(i),t},e.prototype.getGeometry=function(){return this.get(this.geometryName_)},e.prototype.getId=function(){return this.id_},e.prototype.getGeometryName=function(){return this.geometryName_},e.prototype.getStyle=function(){return this.style_},e.prototype.getStyleFunction=function(){return this.styleFunction_},e.prototype.handleGeometryChange_=function(){this.changed()},e.prototype.handleGeometryChanged_=function(){this.geometryChangeKey_&&(qt(this.geometryChangeKey_),this.geometryChangeKey_=null);var t=this.getGeometry();t&&(this.geometryChangeKey_=Lt(t,pt.CHANGE,this.handleGeometryChange_,this)),this.changed()},e.prototype.setGeometry=function(t){this.set(this.geometryName_,t)},e.prototype.setStyle=function(t){this.style_=t,this.styleFunction_=t?_m(t):void 0,this.changed()},e.prototype.setId=function(t){this.id_=t,this.changed()},e.prototype.setGeometryName=function(t){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=t,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()},e}(Tn);function _m(o){if(typeof o=="function")return o;var e;if(Array.isArray(o))e=o;else{Ot(typeof o.getZIndex=="function",41);var t=o;e=[t]}return function(){return e}}var vm=gm,mt={POINT:"Point",LINE_STRING:"LineString",LINEAR_RING:"LinearRing",POLYGON:"Polygon",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon",GEOMETRY_COLLECTION:"GeometryCollection",CIRCLE:"Circle"},ge={RADIANS:"radians",DEGREES:"degrees",FEET:"ft",METERS:"m",PIXELS:"pixels",TILE_PIXELS:"tile-pixels",USFEET:"us-ft"},ym={"9001":ge.METERS,"9002":ge.FEET,"9003":ge.USFEET,"9101":ge.RADIANS,"9102":ge.DEGREES};function ff(o){return ym[o]}var yn={};yn[ge.RADIANS]=6370997/(2*Math.PI);yn[ge.DEGREES]=2*Math.PI*6370997/360;yn[ge.FEET]=.3048;yn[ge.METERS]=1;yn[ge.USFEET]=1200/3937;var li=typeof navigator!="undefined"&&typeof navigator.userAgent!="undefined"?navigator.userAgent.toLowerCase():"",mm=li.indexOf("firefox")!==-1,xm=li.indexOf("safari")!==-1&&li.indexOf("chrom")==-1,bm=xm&&!!(li.indexOf("version/15.4")>=0||li.match(/cpu (os|iphone os) 15_4 like mac os x/)),Em=li.indexOf("webkit")!==-1&&li.indexOf("edge")==-1,Tm=li.indexOf("macintosh")!==-1,Od=typeof devicePixelRatio!="undefined"?devicePixelRatio:1,ma=typeof WorkerGlobalScope!="undefined"&&typeof OffscreenCanvas!="undefined"&&self instanceof WorkerGlobalScope,wm=typeof Image!="undefined"&&Image.prototype.decode,Id=function(){var o=!1;try{var e=Object.defineProperty({},"passive",{get:function(){o=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch{}return o}(),Ad=new Array(6);function Ge(){return[1,0,0,1,0,0]}function Ml(o){return xa(o,1,0,0,1,0,0)}function Pd(o,e){var t=o[0],n=o[1],i=o[2],a=o[3],u=o[4],p=o[5],g=e[0],v=e[1],m=e[2],E=e[3],b=e[4],w=e[5];return o[0]=t*g+i*v,o[1]=n*g+a*v,o[2]=t*m+i*E,o[3]=n*m+a*E,o[4]=t*b+i*w+u,o[5]=n*b+a*w+p,o}function xa(o,e,t,n,i,a,u){return o[0]=e,o[1]=t,o[2]=n,o[3]=i,o[4]=a,o[5]=u,o}function Sm(o,e){return o[0]=e[0],o[1]=e[1],o[2]=e[2],o[3]=e[3],o[4]=e[4],o[5]=e[5],o}function re(o,e){var t=e[0],n=e[1];return e[0]=o[0]*t+o[2]*n+o[4],e[1]=o[1]*t+o[3]*n+o[5],e}function Rm(o,e){var t=Math.cos(e),n=Math.sin(e);return Pd(o,xa(Ad,t,n,-n,t,0,0))}function Cm(o,e,t){return Pd(o,xa(Ad,e,0,0,t,0,0))}function Om(o,e,t){return xa(o,e,0,0,t,0,0)}function mn(o,e,t,n,i,a,u,p){var g=Math.sin(a),v=Math.cos(a);return o[0]=n*v,o[1]=i*g,o[2]=-n*g,o[3]=i*v,o[4]=u*n*v-p*n*g+e,o[5]=u*i*g+p*i*v+t,o}function Md(o,e){var t=Im(e);Ot(t!==0,32);var n=e[0],i=e[1],a=e[2],u=e[3],p=e[4],g=e[5];return o[0]=u/t,o[1]=-i/t,o[2]=-a/t,o[3]=n/t,o[4]=(a*g-u*p)/t,o[5]=-(n*g-i*p)/t,o}function Im(o){return o[0]*o[3]-o[1]*o[2]}var df;function Am(o){var e="matrix("+o.join(", ")+")";if(ma)return e;var t=df||(df=document.createElement("div"));return t.style.transform=e,t.style.transform}var _o={BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",TOP_LEFT:"top-left",TOP_RIGHT:"top-right"},pe={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function pf(o){for(var e=xn(),t=0,n=o.length;t<n;++t)Eo(e,o[t]);return e}function Eh(o,e,t){return t?(t[0]=o[0]-e,t[1]=o[1]-e,t[2]=o[2]+e,t[3]=o[3]+e,t):[o[0]-e,o[1]-e,o[2]+e,o[3]+e]}function Ld(o,e){return e?(e[0]=o[0],e[1]=o[1],e[2]=o[2],e[3]=o[3],e):o.slice()}function Dd(o,e,t){var n,i;return e<o[0]?n=o[0]-e:o[2]<e?n=e-o[2]:n=0,t<o[1]?i=o[1]-t:o[3]<t?i=t-o[3]:i=0,n*n+i*i}function Xi(o,e){return kd(o,e[0],e[1])}function vr(o,e){return o[0]<=e[0]&&e[2]<=o[2]&&o[1]<=e[1]&&e[3]<=o[3]}function kd(o,e,t){return o[0]<=e&&e<=o[2]&&o[1]<=t&&t<=o[3]}function oh(o,e){var t=o[0],n=o[1],i=o[2],a=o[3],u=e[0],p=e[1],g=pe.UNKNOWN;return u<t?g=g|pe.LEFT:u>i&&(g=g|pe.RIGHT),p<n?g=g|pe.BELOW:p>a&&(g=g|pe.ABOVE),g===pe.UNKNOWN&&(g=pe.INTERSECTING),g}function xn(){return[1/0,1/0,-1/0,-1/0]}function bn(o,e,t,n,i){return i?(i[0]=o,i[1]=e,i[2]=t,i[3]=n,i):[o,e,t,n]}function ba(o){return bn(1/0,1/0,-1/0,-1/0,o)}function Pm(o,e){var t=o[0],n=o[1];return bn(t,n,t,n,e)}function Mm(o,e,t,n,i){var a=ba(i);return Fd(a,o,e,t,n)}function $s(o,e){return o[0]==e[0]&&o[2]==e[2]&&o[1]==e[1]&&o[3]==e[3]}function Lm(o,e){return e[0]<o[0]&&(o[0]=e[0]),e[2]>o[2]&&(o[2]=e[2]),e[1]<o[1]&&(o[1]=e[1]),e[3]>o[3]&&(o[3]=e[3]),o}function Eo(o,e){e[0]<o[0]&&(o[0]=e[0]),e[0]>o[2]&&(o[2]=e[0]),e[1]<o[1]&&(o[1]=e[1]),e[1]>o[3]&&(o[3]=e[1])}function Fd(o,e,t,n,i){for(;t<n;t+=i)Dm(o,e[t],e[t+1]);return o}function Dm(o,e,t){o[0]=Math.min(o[0],e),o[1]=Math.min(o[1],t),o[2]=Math.max(o[2],e),o[3]=Math.max(o[3],t)}function Th(o,e){var t;return t=e(Ea(o)),t||(t=e(Ta(o)),t)||(t=e(wa(o)),t)||(t=e(Dr(o)),t)?t:!1}function sh(o){var e=0;return Sa(o)||(e=ee(o)*on(o)),e}function Ea(o){return[o[0],o[1]]}function Ta(o){return[o[2],o[1]]}function ji(o){return[(o[0]+o[2])/2,(o[1]+o[3])/2]}function km(o,e){var t;return e===_o.BOTTOM_LEFT?t=Ea(o):e===_o.BOTTOM_RIGHT?t=Ta(o):e===_o.TOP_LEFT?t=Dr(o):e===_o.TOP_RIGHT?t=wa(o):Ot(!1,13),t}function ah(o,e,t,n,i){var a=e*n[0]/2,u=e*n[1]/2,p=Math.cos(t),g=Math.sin(t),v=a*p,m=a*g,E=u*p,b=u*g,w=o[0],S=o[1],C=w-v+b,A=w-v-b,M=w+v-b,I=w+v+b,L=S-m-E,k=S-m+E,N=S+m+E,G=S+m-E;return bn(Math.min(C,A,M,I),Math.min(L,k,N,G),Math.max(C,A,M,I),Math.max(L,k,N,G),i)}function on(o){return o[3]-o[1]}function zi(o,e,t){var n=t||xn();return ke(o,e)?(o[0]>e[0]?n[0]=o[0]:n[0]=e[0],o[1]>e[1]?n[1]=o[1]:n[1]=e[1],o[2]<e[2]?n[2]=o[2]:n[2]=e[2],o[3]<e[3]?n[3]=o[3]:n[3]=e[3]):ba(n),n}function Dr(o){return[o[0],o[3]]}function wa(o){return[o[2],o[3]]}function ee(o){return o[2]-o[0]}function ke(o,e){return o[0]<=e[2]&&o[2]>=e[0]&&o[1]<=e[3]&&o[3]>=e[1]}function Sa(o){return o[2]<o[0]||o[3]<o[1]}function Fm(o,e){return e?(e[0]=o[0],e[1]=o[1],e[2]=o[2],e[3]=o[3],e):o}function Nm(o,e,t){var n=!1,i=oh(o,e),a=oh(o,t);if(i===pe.INTERSECTING||a===pe.INTERSECTING)n=!0;else{var u=o[0],p=o[1],g=o[2],v=o[3],m=e[0],E=e[1],b=t[0],w=t[1],S=(w-E)/(b-m),C=void 0,A=void 0;!!(a&pe.ABOVE)&&!(i&pe.ABOVE)&&(C=b-(w-v)/S,n=C>=u&&C<=g),!n&&!!(a&pe.RIGHT)&&!(i&pe.RIGHT)&&(A=w-(b-g)*S,n=A>=p&&A<=v),!n&&!!(a&pe.BELOW)&&!(i&pe.BELOW)&&(C=b-(w-p)/S,n=C>=u&&C<=g),!n&&!!(a&pe.LEFT)&&!(i&pe.LEFT)&&(A=w-(b-u)*S,n=A>=p&&A<=v)}return n}function Bm(o,e){var t=e.getExtent(),n=ji(o);if(e.canWrapX()&&(n[0]<t[0]||n[0]>=t[2])){var i=ee(t),a=Math.floor((n[0]-t[0])/i),u=a*i;o[0]-=u,o[2]-=u}return o}var Gm=function(){function o(e){this.code_=e.code,this.units_=e.units,this.extent_=e.extent!==void 0?e.extent:null,this.worldExtent_=e.worldExtent!==void 0?e.worldExtent:null,this.axisOrientation_=e.axisOrientation!==void 0?e.axisOrientation:"enu",this.global_=e.global!==void 0?e.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}return o.prototype.canWrapX=function(){return this.canWrapX_},o.prototype.getCode=function(){return this.code_},o.prototype.getExtent=function(){return this.extent_},o.prototype.getUnits=function(){return this.units_},o.prototype.getMetersPerUnit=function(){return this.metersPerUnit_||yn[this.units_]},o.prototype.getWorldExtent=function(){return this.worldExtent_},o.prototype.getAxisOrientation=function(){return this.axisOrientation_},o.prototype.isGlobal=function(){return this.global_},o.prototype.setGlobal=function(e){this.global_=e,this.canWrapX_=!!(e&&this.extent_)},o.prototype.getDefaultTileGrid=function(){return this.defaultTileGrid_},o.prototype.setDefaultTileGrid=function(e){this.defaultTileGrid_=e},o.prototype.setExtent=function(e){this.extent_=e,this.canWrapX_=!!(this.global_&&e)},o.prototype.setWorldExtent=function(e){this.worldExtent_=e},o.prototype.setGetPointResolution=function(e){this.getPointResolutionFunc_=e},o.prototype.getPointResolutionFunc=function(){return this.getPointResolutionFunc_},o}(),Ks=Gm;function ae(o,e,t){return Math.min(Math.max(o,e),t)}var zm=function(){var o;return"cosh"in Math?o=Math.cosh:o=function(e){var t=Math.exp(e);return(t+1/t)/2},o}(),Nd=function(){var o;return"log2"in Math?o=Math.log2:o=function(e){return Math.log(e)*Math.LOG2E},o}();function Um(o,e,t,n,i,a){var u=i-t,p=a-n;if(u!==0||p!==0){var g=((o-t)*u+(e-n)*p)/(u*u+p*p);g>1?(t=i,n=a):g>0&&(t+=u*g,n+=p*g)}return Rr(o,e,t,n)}function Rr(o,e,t,n){var i=t-o,a=n-e;return i*i+a*a}function Vm(o){for(var e=o.length,t=0;t<e;t++){for(var n=t,i=Math.abs(o[t][t]),a=t+1;a<e;a++){var u=Math.abs(o[a][t]);u>i&&(i=u,n=a)}if(i===0)return null;var p=o[n];o[n]=o[t],o[t]=p;for(var g=t+1;g<e;g++)for(var v=-o[g][t]/o[t][t],m=t;m<e+1;m++)t==m?o[g][m]=0:o[g][m]+=v*o[t][m]}for(var E=new Array(e),b=e-1;b>=0;b--){E[b]=o[b][e]/o[b][b];for(var w=b-1;w>=0;w--)o[w][e]-=o[w][b]*E[b]}return E}function Gs(o){return o*Math.PI/180}function To(o,e){var t=o%e;return t*e<0?t+e:t}function Ai(o,e,t){return o+t*(e-o)}function Bd(o,e){var t=Math.pow(10,e);return Math.round(o*t)/t}function Es(o,e){return Math.floor(Bd(o,e))}function Ts(o,e){return Math.ceil(Bd(o,e))}var Xm=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),ko=6378137,yr=Math.PI*ko,jm=[-yr,-yr,yr,yr],Wm=[-180,-85,180,85],ws=ko*Math.log(Math.tan(Math.PI/2)),hr=function(o){Xm(e,o);function e(t){return o.call(this,{code:t,units:ge.METERS,extent:jm,global:!0,worldExtent:Wm,getPointResolution:function(n,i){return n/zm(i[1]/ko)}})||this}return e}(Ks),gf=[new hr("EPSG:3857"),new hr("EPSG:102100"),new hr("EPSG:102113"),new hr("EPSG:900913"),new hr("http://www.opengis.net/def/crs/EPSG/0/3857"),new hr("http://www.opengis.net/gml/srs/epsg.xml#3857")];function Hm(o,e,t){var n=o.length,i=t>1?t:2,a=e;a===void 0&&(i>2?a=o.slice():a=new Array(n));for(var u=0;u<n;u+=i){a[u]=yr*o[u]/180;var p=ko*Math.log(Math.tan(Math.PI*(+o[u+1]+90)/360));p>ws?p=ws:p<-ws&&(p=-ws),a[u+1]=p}return a}function Ym(o,e,t){var n=o.length,i=t>1?t:2,a=e;a===void 0&&(i>2?a=o.slice():a=new Array(n));for(var u=0;u<n;u+=i)a[u]=180*o[u]/yr,a[u+1]=360*Math.atan(Math.exp(o[u+1]/ko))/Math.PI-90;return a}var $m=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Km=6378137,_f=[-180,-90,180,90],Zm=Math.PI*Km/180,Oi=function(o){$m(e,o);function e(t,n){return o.call(this,{code:t,units:ge.DEGREES,extent:_f,axisOrientation:n,global:!0,metersPerUnit:Zm,worldExtent:_f})||this}return e}(Ks),vf=[new Oi("CRS:84"),new Oi("EPSG:4326","neu"),new Oi("urn:ogc:def:crs:OGC:1.3:CRS84"),new Oi("urn:ogc:def:crs:OGC:2:84"),new Oi("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new Oi("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new Oi("http://www.opengis.net/def/crs/EPSG/0/4326","neu")],lh={};function qm(o){return lh[o]||lh[o.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function Jm(o,e){lh[o]=e}var Cr={};function Zs(o,e,t){var n=o.getCode(),i=e.getCode();n in Cr||(Cr[n]={}),Cr[n][i]=t}function Qm(o,e){var t;return o in Cr&&e in Cr[o]&&(t=Cr[o][e]),t}function t0(o,e){return o[0]+=+e[0],o[1]+=+e[1],o}function qs(o,e){for(var t=!0,n=o.length-1;n>=0;--n)if(o[n]!=e[n]){t=!1;break}return t}function wh(o,e){var t=Math.cos(e),n=Math.sin(e),i=o[0]*t-o[1]*n,a=o[1]*t+o[0]*n;return o[0]=i,o[1]=a,o}function e0(o,e){return o[0]*=e,o[1]*=e,o}function Gd(o,e){if(e.canWrapX()){var t=ee(e.getExtent()),n=n0(o,e,t);n&&(o[0]-=n*t)}return o}function n0(o,e,t){var n=e.getExtent(),i=0;if(e.canWrapX()&&(o[0]<n[0]||o[0]>n[2])){var a=t||ee(n);i=Math.floor((o[0]-n[0])/a)}return i}var i0=63710088e-1;function yf(o,e,t){var n=t||i0,i=Gs(o[1]),a=Gs(e[1]),u=(a-i)/2,p=Gs(e[0]-o[0])/2,g=Math.sin(u)*Math.sin(u)+Math.sin(p)*Math.sin(p)*Math.cos(i)*Math.cos(a);return 2*n*Math.atan2(Math.sqrt(g),Math.sqrt(1-g))}var hh=!0;function r0(o){var e=o===void 0?!0:o;hh=!e}function Sh(o,e,t){var n;if(e!==void 0){for(var i=0,a=o.length;i<a;++i)e[i]=o[i];n=e}else n=o.slice();return n}function zd(o,e,t){if(e!==void 0&&o!==e){for(var n=0,i=o.length;n<i;++n)e[n]=o[n];o=e}return o}function o0(o){Jm(o.getCode(),o),Zs(o,o,Sh)}function s0(o){o.forEach(o0)}function qe(o){return typeof o=="string"?qm(o):o||null}function mf(o,e,t,n){o=qe(o);var i,a=o.getPointResolutionFunc();if(a){if(i=a(e,t),n&&n!==o.getUnits()){var u=o.getMetersPerUnit();u&&(i=i*u/yn[n])}}else{var p=o.getUnits();if(p==ge.DEGREES&&!n||n==ge.DEGREES)i=e;else{var g=Ch(o,qe("EPSG:4326"));if(g===zd&&p!==ge.DEGREES)i=e*o.getMetersPerUnit();else{var v=[t[0]-e/2,t[1],t[0]+e/2,t[1],t[0],t[1]-e/2,t[0],t[1]+e/2];v=g(v,v,2);var m=yf(v.slice(0,2),v.slice(2,4)),E=yf(v.slice(4,6),v.slice(6,8));i=(m+E)/2}var u=n?yn[n]:o.getMetersPerUnit();u!==void 0&&(i/=u)}}return i}function xf(o){s0(o),o.forEach(function(e){o.forEach(function(t){e!==t&&Zs(e,t,Sh)})})}function a0(o,e,t,n){o.forEach(function(i){e.forEach(function(a){Zs(i,a,t),Zs(a,i,n)})})}function Rh(o,e){return o?typeof o=="string"?qe(o):o:qe(e)}function l0(o,e){if(o===e)return!0;var t=o.getUnits()===e.getUnits();if(o.getCode()===e.getCode())return t;var n=Ch(o,e);return n===Sh&&t}function Ch(o,e){var t=o.getCode(),n=e.getCode(),i=Qm(t,n);return i||(i=zd),i}function Js(o,e){var t=qe(o),n=qe(e);return Ch(t,n)}function h0(o,e,t){var n=Js(e,t);return n(o,void 0,o.length)}var c0=null;function u0(){return c0}function Qs(o,e){return o}function Pn(o,e){return hh&&!qs(o,[0,0])&&o[0]>=-180&&o[0]<=180&&o[1]>=-90&&o[1]<=90&&(hh=!1,console.warn("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),o}function Oh(o,e){return o}function Di(o,e){return o}function f0(){xf(gf),xf(vf),a0(vf,gf,Hm,Ym)}f0();function Ui(o,e,t,n,i,a){for(var u=a||[],p=0,g=e;g<t;g+=n){var v=o[g],m=o[g+1];u[p++]=i[0]*v+i[2]*m+i[4],u[p++]=i[1]*v+i[3]*m+i[5]}return a&&u.length!=p&&(u.length=p),u}function Ih(o,e,t,n,i,a,u){for(var p=u||[],g=Math.cos(i),v=Math.sin(i),m=a[0],E=a[1],b=0,w=e;w<t;w+=n){var S=o[w]-m,C=o[w+1]-E;p[b++]=m+S*g-C*v,p[b++]=E+S*v+C*g;for(var A=w+2;A<w+n;++A)p[b++]=o[A]}return u&&p.length!=b&&(p.length=b),p}function d0(o,e,t,n,i,a,u,p){for(var g=p||[],v=u[0],m=u[1],E=0,b=e;b<t;b+=n){var w=o[b]-v,S=o[b+1]-m;g[E++]=v+i*w,g[E++]=m+a*S;for(var C=b+2;C<b+n;++C)g[E++]=o[C]}return p&&g.length!=E&&(g.length=E),g}function Ud(o,e,t,n,i,a,u){for(var p=u||[],g=0,v=e;v<t;v+=n){p[g++]=o[v]+i,p[g++]=o[v+1]+a;for(var m=v+2;m<v+n;++m)p[g++]=o[m]}return u&&p.length!=g&&(p.length=g),p}var p0=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),bf=Ge(),g0=function(o){p0(e,o);function e(){var t=o.call(this)||this;return t.extent_=xn(),t.extentRevision_=-1,t.simplifiedGeometryMaxMinSquaredTolerance=0,t.simplifiedGeometryRevision=0,t.simplifyTransformedInternal=im(function(n,i,a){if(!a)return this.getSimplifiedGeometry(i);var u=this.clone();return u.applyTransform(a),u.getSimplifiedGeometry(i)}),t}return e.prototype.simplifyTransformed=function(t,n){return this.simplifyTransformedInternal(this.getRevision(),t,n)},e.prototype.clone=function(){return Ct()},e.prototype.closestPointXY=function(t,n,i,a){return Ct()},e.prototype.containsXY=function(t,n){var i=this.getClosestPoint([t,n]);return i[0]===t&&i[1]===n},e.prototype.getClosestPoint=function(t,n){var i=n||[NaN,NaN];return this.closestPointXY(t[0],t[1],i,1/0),i},e.prototype.intersectsCoordinate=function(t){return this.containsXY(t[0],t[1])},e.prototype.computeExtent=function(t){return Ct()},e.prototype.getExtent=function(t){if(this.extentRevision_!=this.getRevision()){var n=this.computeExtent(this.extent_);(isNaN(n[0])||isNaN(n[1]))&&ba(n),this.extentRevision_=this.getRevision()}return Fm(this.extent_,t)},e.prototype.rotate=function(t,n){Ct()},e.prototype.scale=function(t,n,i){Ct()},e.prototype.simplify=function(t){return this.getSimplifiedGeometry(t*t)},e.prototype.getSimplifiedGeometry=function(t){return Ct()},e.prototype.getType=function(){return Ct()},e.prototype.applyTransform=function(t){Ct()},e.prototype.intersectsExtent=function(t){return Ct()},e.prototype.translate=function(t,n){Ct()},e.prototype.transform=function(t,n){var i=qe(t),a=i.getUnits()==ge.TILE_PIXELS?function(u,p,g){var v=i.getExtent(),m=i.getWorldExtent(),E=on(m)/on(v);return mn(bf,m[0],m[3],E,-E,0,0,0),Ui(u,0,u.length,g,bf,p),Js(i,n)(u,p,g)}:Js(i,n);return this.applyTransform(a),this},e}(Tn),_0=g0,Xe={XY:"XY",XYZ:"XYZ",XYM:"XYM",XYZM:"XYZM"},v0=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),y0=function(o){v0(e,o);function e(){var t=o.call(this)||this;return t.layout=Xe.XY,t.stride=2,t.flatCoordinates=null,t}return e.prototype.computeExtent=function(t){return Mm(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.getCoordinates=function(){return Ct()},e.prototype.getFirstCoordinate=function(){return this.flatCoordinates.slice(0,this.stride)},e.prototype.getFlatCoordinates=function(){return this.flatCoordinates},e.prototype.getLastCoordinate=function(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)},e.prototype.getLayout=function(){return this.layout},e.prototype.getSimplifiedGeometry=function(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;var n=this.getSimplifiedGeometryInternal(t),i=n.getFlatCoordinates();return i.length<this.flatCoordinates.length?n:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)},e.prototype.getSimplifiedGeometryInternal=function(t){return this},e.prototype.getStride=function(){return this.stride},e.prototype.setFlatCoordinates=function(t,n){this.stride=Ef(t),this.layout=t,this.flatCoordinates=n},e.prototype.setCoordinates=function(t,n){Ct()},e.prototype.setLayout=function(t,n,i){var a;if(t)a=Ef(t);else{for(var u=0;u<i;++u)if(n.length===0){this.layout=Xe.XY,this.stride=2;return}else n=n[0];a=n.length,t=m0(a)}this.layout=t,this.stride=a},e.prototype.applyTransform=function(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())},e.prototype.rotate=function(t,n){var i=this.getFlatCoordinates();if(i){var a=this.getStride();Ih(i,0,i.length,a,t,n,i),this.changed()}},e.prototype.scale=function(t,n,i){var a=n;a===void 0&&(a=t);var u=i;u||(u=ji(this.getExtent()));var p=this.getFlatCoordinates();if(p){var g=this.getStride();d0(p,0,p.length,g,t,a,u,p),this.changed()}},e.prototype.translate=function(t,n){var i=this.getFlatCoordinates();if(i){var a=this.getStride();Ud(i,0,i.length,a,t,n,i),this.changed()}},e}(_0);function m0(o){var e;return o==2?e=Xe.XY:o==3?e=Xe.XYZ:o==4&&(e=Xe.XYZM),e}function Ef(o){var e;return o==Xe.XY?e=2:o==Xe.XYZ||o==Xe.XYM?e=3:o==Xe.XYZM&&(e=4),e}function x0(o,e,t){var n=o.getFlatCoordinates();if(n){var i=o.getStride();return Ui(n,0,n.length,i,e,t)}else return null}var Ra=y0;function Vd(o,e,t,n){for(var i=0,a=t.length;i<a;++i)o[e++]=t[i];return e}function Xd(o,e,t,n){for(var i=0,a=t.length;i<a;++i)for(var u=t[i],p=0;p<n;++p)o[e++]=u[p];return e}function b0(o,e,t,n,i){for(var a=i||[],u=0,p=0,g=t.length;p<g;++p){var v=Xd(o,e,t[p],n);a[u++]=v,e=v}return a.length=u,a}var E0=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),jd=function(o){E0(e,o);function e(t,n,i){var a=o.call(this)||this;if(i!==void 0&&n===void 0)a.setFlatCoordinates(i,t);else{var u=n||0;a.setCenterAndRadius(t,u,i)}return a}return e.prototype.clone=function(){var t=new e(this.flatCoordinates.slice(),void 0,this.layout);return t.applyProperties(this),t},e.prototype.closestPointXY=function(t,n,i,a){var u=this.flatCoordinates,p=t-u[0],g=n-u[1],v=p*p+g*g;if(v<a){if(v===0)for(var m=0;m<this.stride;++m)i[m]=u[m];else{var E=this.getRadius()/Math.sqrt(v);i[0]=u[0]+E*p,i[1]=u[1]+E*g;for(var m=2;m<this.stride;++m)i[m]=u[m]}return i.length=this.stride,v}else return a},e.prototype.containsXY=function(t,n){var i=this.flatCoordinates,a=t-i[0],u=n-i[1];return a*a+u*u<=this.getRadiusSquared_()},e.prototype.getCenter=function(){return this.flatCoordinates.slice(0,this.stride)},e.prototype.computeExtent=function(t){var n=this.flatCoordinates,i=n[this.stride]-n[0];return bn(n[0]-i,n[1]-i,n[0]+i,n[1]+i,t)},e.prototype.getRadius=function(){return Math.sqrt(this.getRadiusSquared_())},e.prototype.getRadiusSquared_=function(){var t=this.flatCoordinates[this.stride]-this.flatCoordinates[0],n=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return t*t+n*n},e.prototype.getType=function(){return mt.CIRCLE},e.prototype.intersectsExtent=function(t){var n=this.getExtent();if(ke(t,n)){var i=this.getCenter();return t[0]<=i[0]&&t[2]>=i[0]||t[1]<=i[1]&&t[3]>=i[1]?!0:Th(t,this.intersectsCoordinate.bind(this))}return!1},e.prototype.setCenter=function(t){var n=this.stride,i=this.flatCoordinates[n]-this.flatCoordinates[0],a=t.slice();a[n]=a[0]+i;for(var u=1;u<n;++u)a[n+u]=t[u];this.setFlatCoordinates(this.layout,a),this.changed()},e.prototype.setCenterAndRadius=function(t,n,i){this.setLayout(i,t,0),this.flatCoordinates||(this.flatCoordinates=[]);var a=this.flatCoordinates,u=Vd(a,0,t,this.stride);a[u++]=a[0]+n;for(var p=1,g=this.stride;p<g;++p)a[u++]=a[p];a.length=u,this.changed()},e.prototype.getCoordinates=function(){return null},e.prototype.setCoordinates=function(t,n){},e.prototype.setRadius=function(t){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+t,this.changed()},e.prototype.rotate=function(t,n){var i=this.getCenter(),a=this.getStride();this.setCenter(Ih(i,0,i.length,a,t,n,i)),this.changed()},e.prototype.translate=function(t,n){var i=this.getCenter(),a=this.getStride();this.setCenter(Ud(i,0,i.length,a,t,n,i)),this.changed()},e}(Ra);jd.prototype.transform;var T0=jd;function Tf(o,e,t,n,i,a,u){var p=o[e],g=o[e+1],v=o[t]-p,m=o[t+1]-g,E;if(v===0&&m===0)E=e;else{var b=((i-p)*v+(a-g)*m)/(v*v+m*m);if(b>1)E=t;else if(b>0){for(var w=0;w<n;++w)u[w]=Ai(o[e+w],o[t+w],b);u.length=n;return}else E=e}for(var w=0;w<n;++w)u[w]=o[E+w];u.length=n}function Wd(o,e,t,n,i){var a=o[e],u=o[e+1];for(e+=n;e<t;e+=n){var p=o[e],g=o[e+1],v=Rr(a,u,p,g);v>i&&(i=v),a=p,u=g}return i}function w0(o,e,t,n,i){for(var a=0,u=t.length;a<u;++a){var p=t[a];i=Wd(o,e,p,n,i),e=p}return i}function Hd(o,e,t,n,i,a,u,p,g,v,m){if(e==t)return v;var E,b;if(i===0)if(b=Rr(u,p,o[e],o[e+1]),b<v){for(E=0;E<n;++E)g[E]=o[e+E];return g.length=n,b}else return v;for(var w=m||[NaN,NaN],S=e+n;S<t;)if(Tf(o,S-n,S,n,u,p,w),b=Rr(u,p,w[0],w[1]),b<v){for(v=b,E=0;E<n;++E)g[E]=w[E];g.length=n,S+=n}else S+=n*Math.max((Math.sqrt(b)-Math.sqrt(v))/i|0,1);if(a&&(Tf(o,t-n,e,n,u,p,w),b=Rr(u,p,w[0],w[1]),b<v)){for(v=b,E=0;E<n;++E)g[E]=w[E];g.length=n}return v}function S0(o,e,t,n,i,a,u,p,g,v,m){for(var E=m||[NaN,NaN],b=0,w=t.length;b<w;++b){var S=t[b];v=Hd(o,e,S,n,i,a,u,p,g,v,E),e=S}return v}function R0(o,e,t,n,i,a,u){var p=(t-e)/n;if(p<3){for(;e<t;e+=n)a[u++]=o[e],a[u++]=o[e+1];return u}var g=new Array(p);g[0]=1,g[p-1]=1;for(var v=[e,t-n],m=0;v.length>0;){for(var E=v.pop(),b=v.pop(),w=0,S=o[b],C=o[b+1],A=o[E],M=o[E+1],I=b+n;I<E;I+=n){var L=o[I],k=o[I+1],N=Um(L,k,S,C,A,M);N>w&&(m=I,w=N)}w>i&&(g[(m-e)/n]=1,b+n<m&&v.push(b,m),m+n<E&&v.push(m,E))}for(var I=0;I<p;++I)g[I]&&(a[u++]=o[e+I*n],a[u++]=o[e+I*n+1]);return u}function Pi(o,e){return e*Math.round(o/e)}function C0(o,e,t,n,i,a,u){if(e==t)return u;var p=Pi(o[e],i),g=Pi(o[e+1],i);e+=n,a[u++]=p,a[u++]=g;var v,m;do if(v=Pi(o[e],i),m=Pi(o[e+1],i),e+=n,e==t)return a[u++]=v,a[u++]=m,u;while(v==p&&m==g);for(;e<t;){var E=Pi(o[e],i),b=Pi(o[e+1],i);if(e+=n,!(E==v&&b==m)){var w=v-p,S=m-g,C=E-p,A=b-g;if(w*A==S*C&&(w<0&&C<w||w==C||w>0&&C>w)&&(S<0&&A<S||S==A||S>0&&A>S)){v=E,m=b;continue}a[u++]=v,a[u++]=m,p=v,g=m,v=E,m=b}}return a[u++]=v,a[u++]=m,u}function O0(o,e,t,n,i,a,u,p){for(var g=0,v=t.length;g<v;++g){var m=t[g];u=C0(o,e,m,n,i,a,u),p.push(u),e=m}return u}function mr(o,e,t,n,i){for(var a=i!==void 0?i:[],u=0,p=e;p<t;p+=n)a[u++]=o.slice(p,p+n);return a.length=u,a}function ta(o,e,t,n,i){for(var a=i!==void 0?i:[],u=0,p=0,g=t.length;p<g;++p){var v=t[p];a[u++]=mr(o,e,v,n,a[u]),e=v}return a.length=u,a}function wf(o,e,t,n,i){for(var a=i!==void 0?i:[],u=0,p=0,g=t.length;p<g;++p){var v=t[p];a[u++]=ta(o,e,v,n,a[u]),e=v[v.length-1]}return a.length=u,a}function Yd(o,e,t,n){for(var i=0,a=o[t-n],u=o[t-n+1];e<t;e+=n){var p=o[e],g=o[e+1];i+=u*p-a*g,a=p,u=g}return i/2}function I0(o,e,t,n){for(var i=0,a=0,u=t.length;a<u;++a){var p=t[a];i+=Yd(o,e,p,n),e=p}return i}var A0=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),P0=function(o){A0(e,o);function e(t,n){var i=o.call(this)||this;return i.maxDelta_=-1,i.maxDeltaRevision_=-1,n!==void 0&&!Array.isArray(t[0])?i.setFlatCoordinates(n,t):i.setCoordinates(t,n),i}return e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,n,i,a){return a<Dd(this.getExtent(),t,n)?a:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Wd(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Hd(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,n,i,a))},e.prototype.getArea=function(){return Yd(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getCoordinates=function(){return mr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getSimplifiedGeometryInternal=function(t){var n=[];return n.length=R0(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,n,0),new e(n,Xe.XY)},e.prototype.getType=function(){return mt.LINEAR_RING},e.prototype.intersectsExtent=function(t){return!1},e.prototype.setCoordinates=function(t,n){this.setLayout(n,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Xd(this.flatCoordinates,0,t,this.stride),this.changed()},e}(Ra),Sf=P0;function M0(o,e,t,n,i){var a;for(e+=n;e<t;e+=n)if(a=i(o.slice(e-n,e),o.slice(e,e+n)),a)return a;return!1}function L0(o,e,t,n,i){var a=Th(i,function(u){return!ki(o,e,t,n,u[0],u[1])});return!a}function ki(o,e,t,n,i,a){for(var u=0,p=o[t-n],g=o[t-n+1];e<t;e+=n){var v=o[e],m=o[e+1];g<=a?m>a&&(v-p)*(a-g)-(i-p)*(m-g)>0&&u++:m<=a&&(v-p)*(a-g)-(i-p)*(m-g)<0&&u--,p=v,g=m}return u!==0}function $d(o,e,t,n,i,a){if(t.length===0||!ki(o,e,t[0],n,i,a))return!1;for(var u=1,p=t.length;u<p;++u)if(ki(o,t[u-1],t[u],n,i,a))return!1;return!0}function Kd(o,e,t,n,i){var a=Fd(xn(),o,e,t,n);return ke(i,a)?vr(i,a)||a[0]>=i[0]&&a[2]<=i[2]||a[1]>=i[1]&&a[3]<=i[3]?!0:M0(o,e,t,n,function(u,p){return Nm(i,u,p)}):!1}function D0(o,e,t,n,i){return!!(Kd(o,e,t,n,i)||ki(o,e,t,n,i[0],i[1])||ki(o,e,t,n,i[0],i[3])||ki(o,e,t,n,i[2],i[1])||ki(o,e,t,n,i[2],i[3]))}function k0(o,e,t,n,i){if(!D0(o,e,t[0],n,i))return!1;if(t.length===1)return!0;for(var a=1,u=t.length;a<u;++a)if(L0(o,t[a-1],t[a],n,i)&&!Kd(o,t[a-1],t[a],n,i))return!1;return!0}function F0(o,e,t,n){for(var i=o[e],a=o[e+1],u=0,p=e+n;p<t;p+=n){var g=o[p],v=o[p+1];u+=Math.sqrt((g-i)*(g-i)+(v-a)*(v-a)),i=g,a=v}return u}var N0=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),B0=function(o){N0(e,o);function e(t,n){var i=o.call(this)||this;return i.setCoordinates(t,n),i}return e.prototype.clone=function(){var t=new e(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t},e.prototype.closestPointXY=function(t,n,i,a){var u=this.flatCoordinates,p=Rr(t,n,u[0],u[1]);if(p<a){for(var g=this.stride,v=0;v<g;++v)i[v]=u[v];return i.length=g,p}else return a},e.prototype.getCoordinates=function(){return this.flatCoordinates?this.flatCoordinates.slice():[]},e.prototype.computeExtent=function(t){return Pm(this.flatCoordinates,t)},e.prototype.getType=function(){return mt.POINT},e.prototype.intersectsExtent=function(t){return kd(t,this.flatCoordinates[0],this.flatCoordinates[1])},e.prototype.setCoordinates=function(t,n){this.setLayout(n,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Vd(this.flatCoordinates,0,t,this.stride),this.changed()},e}(Ra),G0=B0;function z0(o,e,t,n,i,a,u){for(var p,g,v,m,E,b,w,S=i[a+1],C=[],A=0,M=t.length;A<M;++A){var I=t[A];for(m=o[I-n],b=o[I-n+1],p=e;p<I;p+=n)E=o[p],w=o[p+1],(S<=b&&w<=S||b<=S&&S<=w)&&(v=(S-b)/(w-b)*(E-m)+m,C.push(v)),m=E,b=w}var L=NaN,k=-1/0;for(C.sort(Ar),m=C[0],p=1,g=C.length;p<g;++p){E=C[p];var N=Math.abs(E-m);N>k&&(v=(m+E)/2,$d(o,e,t,n,v,S)&&(L=v,k=N)),m=E}return isNaN(L)&&(L=i[a]),u?(u.push(L,S,k),u):[L,S,k]}function U0(o,e,t,n){for(;e<t-n;){for(var i=0;i<n;++i){var a=o[e+i];o[e+i]=o[t-n+i],o[t-n+i]=a}e+=n,t-=n}}function Zd(o,e,t,n){for(var i=0,a=o[t-n],u=o[t-n+1];e<t;e+=n){var p=o[e],g=o[e+1];i+=(p-a)*(g+u),a=p,u=g}return i===0?void 0:i>0}function V0(o,e,t,n,i){for(var a=i!==void 0?i:!1,u=0,p=t.length;u<p;++u){var g=t[u],v=Zd(o,e,g,n);if(u===0){if(a&&v||!a&&!v)return!1}else if(a&&!v||!a&&v)return!1;e=g}return!0}function Rf(o,e,t,n,i){for(var a=i!==void 0?i:!1,u=0,p=t.length;u<p;++u){var g=t[u],v=Zd(o,e,g,n),m=u===0?a&&v||!a&&!v:a&&!v||!a&&v;m&&U0(o,e,g,n),e=g}return e}var X0=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),qd=function(o){X0(e,o);function e(t,n,i){var a=o.call(this)||this;return a.ends_=[],a.flatInteriorPointRevision_=-1,a.flatInteriorPoint_=null,a.maxDelta_=-1,a.maxDeltaRevision_=-1,a.orientedRevision_=-1,a.orientedFlatCoordinates_=null,n!==void 0&&i?(a.setFlatCoordinates(n,t),a.ends_=i):a.setCoordinates(t,n),a}return e.prototype.appendLinearRing=function(t){this.flatCoordinates?Td(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},e.prototype.clone=function(){var t=new e(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t},e.prototype.closestPointXY=function(t,n,i,a){return a<Dd(this.getExtent(),t,n)?a:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(w0(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),S0(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,n,i,a))},e.prototype.containsXY=function(t,n){return $d(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,n)},e.prototype.getArea=function(){return I0(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)},e.prototype.getCoordinates=function(t){var n;return t!==void 0?(n=this.getOrientedFlatCoordinates().slice(),Rf(n,0,this.ends_,this.stride,t)):n=this.flatCoordinates,ta(n,0,this.ends_,this.stride)},e.prototype.getEnds=function(){return this.ends_},e.prototype.getFlatInteriorPoint=function(){if(this.flatInteriorPointRevision_!=this.getRevision()){var t=ji(this.getExtent());this.flatInteriorPoint_=z0(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_},e.prototype.getInteriorPoint=function(){return new G0(this.getFlatInteriorPoint(),Xe.XYM)},e.prototype.getLinearRingCount=function(){return this.ends_.length},e.prototype.getLinearRing=function(t){return t<0||this.ends_.length<=t?null:new Sf(this.flatCoordinates.slice(t===0?0:this.ends_[t-1],this.ends_[t]),this.layout)},e.prototype.getLinearRings=function(){for(var t=this.layout,n=this.flatCoordinates,i=this.ends_,a=[],u=0,p=0,g=i.length;p<g;++p){var v=i[p],m=new Sf(n.slice(u,v),t);a.push(m),u=v}return a},e.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;V0(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=Rf(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},e.prototype.getSimplifiedGeometryInternal=function(t){var n=[],i=[];return n.length=O0(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),n,0,i),new e(n,Xe.XY,i)},e.prototype.getType=function(){return mt.POLYGON},e.prototype.intersectsExtent=function(t){return k0(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)},e.prototype.setCoordinates=function(t,n){this.setLayout(n,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var i=b0(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=i.length===0?0:i[i.length-1],this.changed()},e}(Ra);function Cf(o){var e=o[0],t=o[1],n=o[2],i=o[3],a=[e,t,e,i,n,i,n,t,e,t];return new qd(a,Xe.XY,[a.length])}var Fe={ADD:"add",REMOVE:"remove"},Jd=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Of={LENGTH:"length"},Ss=function(o){Jd(e,o);function e(t,n,i){var a=o.call(this,t)||this;return a.element=n,a.index=i,a}return e}(Bn),j0=function(o){Jd(e,o);function e(t,n){var i=o.call(this)||this;i.on,i.once,i.un;var a=n||{};if(i.unique_=!!a.unique,i.array_=t||[],i.unique_)for(var u=0,p=i.array_.length;u<p;++u)i.assertUnique_(i.array_[u],u);return i.updateLength_(),i}return e.prototype.clear=function(){for(;this.getLength()>0;)this.pop()},e.prototype.extend=function(t){for(var n=0,i=t.length;n<i;++n)this.push(t[n]);return this},e.prototype.forEach=function(t){for(var n=this.array_,i=0,a=n.length;i<a;++i)t(n[i],i,n)},e.prototype.getArray=function(){return this.array_},e.prototype.item=function(t){return this.array_[t]},e.prototype.getLength=function(){return this.get(Of.LENGTH)},e.prototype.insertAt=function(t,n){this.unique_&&this.assertUnique_(n),this.array_.splice(t,0,n),this.updateLength_(),this.dispatchEvent(new Ss(Fe.ADD,n,t))},e.prototype.pop=function(){return this.removeAt(this.getLength()-1)},e.prototype.push=function(t){this.unique_&&this.assertUnique_(t);var n=this.getLength();return this.insertAt(n,t),this.getLength()},e.prototype.remove=function(t){for(var n=this.array_,i=0,a=n.length;i<a;++i)if(n[i]===t)return this.removeAt(i)},e.prototype.removeAt=function(t){var n=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new Ss(Fe.REMOVE,n,t)),n},e.prototype.setAt=function(t,n){var i=this.getLength();if(t<i){this.unique_&&this.assertUnique_(n,t);var a=this.array_[t];this.array_[t]=n,this.dispatchEvent(new Ss(Fe.REMOVE,a,t)),this.dispatchEvent(new Ss(Fe.ADD,n,t))}else{for(var u=i;u<t;++u)this.insertAt(u,void 0);this.insertAt(t,n)}},e.prototype.updateLength_=function(){this.set(Of.LENGTH,this.array_.length)},e.prototype.assertUnique_=function(t,n){for(var i=0,a=this.array_.length;i<a;++i)if(this.array_[i]===t&&i!==n)throw new Cd(58)},e}(Tn),Ze=j0,Ne={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"},W0=function(){function o(e){var t=e||{};this.color_=t.color!==void 0?t.color:null}return o.prototype.clone=function(){var e=this.getColor();return new o({color:Array.isArray(e)?e.slice():e||void 0})},o.prototype.getColor=function(){return this.color_},o.prototype.setColor=function(e){this.color_=e},o}(),H0=W0,Y0=function(){function o(e){var t=e||{};this.color_=t.color!==void 0?t.color:null,this.lineCap_=t.lineCap,this.lineDash_=t.lineDash!==void 0?t.lineDash:null,this.lineDashOffset_=t.lineDashOffset,this.lineJoin_=t.lineJoin,this.miterLimit_=t.miterLimit,this.width_=t.width}return o.prototype.clone=function(){var e=this.getColor();return new o({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})},o.prototype.getColor=function(){return this.color_},o.prototype.getLineCap=function(){return this.lineCap_},o.prototype.getLineDash=function(){return this.lineDash_},o.prototype.getLineDashOffset=function(){return this.lineDashOffset_},o.prototype.getLineJoin=function(){return this.lineJoin_},o.prototype.getMiterLimit=function(){return this.miterLimit_},o.prototype.getWidth=function(){return this.width_},o.prototype.setColor=function(e){this.color_=e},o.prototype.setLineCap=function(e){this.lineCap_=e},o.prototype.setLineDash=function(e){this.lineDash_=e},o.prototype.setLineDashOffset=function(e){this.lineDashOffset_=e},o.prototype.setLineJoin=function(e){this.lineJoin_=e},o.prototype.setMiterLimit=function(e){this.miterLimit_=e},o.prototype.setWidth=function(e){this.width_=e},o}(),Qd=Y0,Wt={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function If(o){return o[0]>0&&o[1]>0}function $0(o,e,t){return t===void 0&&(t=[0,0]),t[0]=o[0]*e+.5|0,t[1]=o[1]*e+.5|0,t}function Be(o,e){return Array.isArray(o)?o:(e===void 0?e=[o,o]:(e[0]=o,e[1]=o),e)}var K0=function(){function o(e){this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=Be(e.scale),this.displacement_=e.displacement}return o.prototype.clone=function(){var e=this.getScale();return new o({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice()})},o.prototype.getOpacity=function(){return this.opacity_},o.prototype.getRotateWithView=function(){return this.rotateWithView_},o.prototype.getRotation=function(){return this.rotation_},o.prototype.getScale=function(){return this.scale_},o.prototype.getScaleArray=function(){return this.scaleArray_},o.prototype.getDisplacement=function(){return this.displacement_},o.prototype.getAnchor=function(){return Ct()},o.prototype.getImage=function(e){return Ct()},o.prototype.getHitDetectionImage=function(){return Ct()},o.prototype.getPixelRatio=function(e){return 1},o.prototype.getImageState=function(){return Ct()},o.prototype.getImageSize=function(){return Ct()},o.prototype.getOrigin=function(){return Ct()},o.prototype.getSize=function(){return Ct()},o.prototype.setDisplacement=function(e){this.displacement_=e},o.prototype.setOpacity=function(e){this.opacity_=e},o.prototype.setRotateWithView=function(e){this.rotateWithView_=e},o.prototype.setRotation=function(e){this.rotation_=e},o.prototype.setScale=function(e){this.scale_=e,this.scaleArray_=Be(e)},o.prototype.listenImageChange=function(e){Ct()},o.prototype.load=function(){Ct()},o.prototype.unlistenImageChange=function(e){Ct()},o}(),tp=K0,ep=/^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i,np=/^([a-z]*)$|^hsla?\(.*\)$/i;function ip(o){return typeof o=="string"?o:sp(o)}function rp(o){var e=document.createElement("div");if(e.style.color=o,e.style.color!==""){document.body.appendChild(e);var t=getComputedStyle(e).color;return document.body.removeChild(e),t}else return""}var op=function(){var o=1024,e={},t=0;return function(n){var i;if(e.hasOwnProperty(n))i=e[n];else{if(t>=o){var a=0;for(var u in e)(a++&3)===0&&(delete e[u],--t)}i=Z0(n),e[n]=i,++t}return i}}();function Co(o){return Array.isArray(o)?o:op(o)}function Z0(o){var e,t,n,i,a;if(np.exec(o)&&(o=rp(o)),ep.exec(o)){var u=o.length-1,p=void 0;u<=4?p=1:p=2;var g=u===4||u===8;e=parseInt(o.substr(1+0*p,p),16),t=parseInt(o.substr(1+1*p,p),16),n=parseInt(o.substr(1+2*p,p),16),g?i=parseInt(o.substr(1+3*p,p),16):i=255,p==1&&(e=(e<<4)+e,t=(t<<4)+t,n=(n<<4)+n,g&&(i=(i<<4)+i)),a=[e,t,n,i/255]}else o.indexOf("rgba(")==0?(a=o.slice(5,-1).split(",").map(Number),Af(a)):o.indexOf("rgb(")==0?(a=o.slice(4,-1).split(",").map(Number),a.push(1),Af(a)):Ot(!1,14);return a}function Af(o){return o[0]=ae(o[0]+.5|0,0,255),o[1]=ae(o[1]+.5|0,0,255),o[2]=ae(o[2]+.5|0,0,255),o[3]=ae(o[3],0,1),o}function sp(o){var e=o[0];e!=(e|0)&&(e=e+.5|0);var t=o[1];t!=(t|0)&&(t=t+.5|0);var n=o[2];n!=(n|0)&&(n=n+.5|0);var i=o[3]===void 0?1:Math.round(o[3]*100)/100;return"rgba("+e+","+t+","+n+","+i+")"}function q0(o){return np.test(o)&&(o=rp(o)),ep.test(o)||o.indexOf("rgba(")===0||o.indexOf("rgb(")===0}function vn(o){return Array.isArray(o)?sp(o):o}function je(o,e,t,n){var i;return t&&t.length?i=t.shift():ma?i=new OffscreenCanvas(o||300,e||300):i=document.createElement("canvas"),o&&(i.width=o),e&&(i.height=e),i.getContext("2d",n)}function Pf(o,e){var t=e.parentNode;t&&t.replaceChild(o,e)}function ch(o){return o&&o.parentNode?o.parentNode.removeChild(o):null}function J0(o){for(;o.lastChild;)o.removeChild(o.lastChild)}function Q0(o,e){for(var t=o.childNodes,n=0;;++n){var i=t[n],a=e[n];if(!i&&!a)break;if(i!==a){if(!i){o.appendChild(a);continue}if(!a){o.removeChild(i),--n;continue}o.insertBefore(a,i)}}}var Rs="ol-hidden",Ca="ol-unselectable",Ah="ol-control",Mf="ol-collapsed",tx=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z]+?)\\s*$`].join(""),"i"),Lf=["style","variant","weight","size","lineHeight","family"],ap=function(o){var e=o.match(tx);if(!e)return null;for(var t={lineHeight:"normal",size:"1.2em",style:"normal",weight:"normal",variant:"normal"},n=0,i=Lf.length;n<i;++n){var a=e[n+1];a!==void 0&&(t[Lf[n]]=a)}return t.families=t.family.split(/,\s?/),t};function ex(o){return o===1?"":String(Math.round(o*100)/100)}var lp="10px sans-serif",Nn="#000",ea="round",Oo=[],Io=0,Pr="round",Ao=10,Po="#000",Mo="center",na="middle",Fi=[0,0,0,0],Lo=1,Mn=new Tn,nx=new Hi;nx.setSize=function(){console.warn("labelCache is deprecated.")};var pr=null,uh,fh={},ix=function(){var o=100,e="32px ",t=["monospace","serif"],n=t.length,i="wmytzilWMYTZIL@#/&?$%10\uF013",a,u;function p(v,m,E){for(var b=!0,w=0;w<n;++w){var S=t[w];if(u=ia(v+" "+m+" "+e+S,i),E!=S){var C=ia(v+" "+m+" "+e+E+","+S,i);b=b&&C!=u}}return!!b}function g(){for(var v=!0,m=Mn.getKeys(),E=0,b=m.length;E<b;++E){var w=m[E];Mn.get(w)<o&&(p.apply(this,w.split(`
`))?(Lr(fh),pr=null,uh=void 0,Mn.set(w,o)):(Mn.set(w,Mn.get(w)+1,!0),v=!1))}v&&(clearInterval(a),a=void 0)}return function(v){var m=ap(v);if(!!m)for(var E=m.families,b=0,w=E.length;b<w;++b){var S=E[b],C=m.style+`
`+m.weight+`
`+S;Mn.get(C)===void 0&&(Mn.set(C,o,!0),p(m.style,m.weight,S)||(Mn.set(C,0,!0),a===void 0&&(a=setInterval(g,32))))}}}(),rx=function(){var o;return function(e){var t=fh[e];if(t==null){if(ma){var n=ap(e),i=hp(e,"\u017Dg"),a=isNaN(Number(n.lineHeight))?1.2:Number(n.lineHeight);t=a*(i.actualBoundingBoxAscent+i.actualBoundingBoxDescent)}else o||(o=document.createElement("div"),o.innerHTML="M",o.style.minHeight="0",o.style.maxHeight="none",o.style.height="auto",o.style.padding="0",o.style.border="none",o.style.position="absolute",o.style.display="block",o.style.left="-99999px"),o.style.font=e,document.body.appendChild(o),t=o.offsetHeight,document.body.removeChild(o);fh[e]=t}return t}}();function hp(o,e){return pr||(pr=je(1,1)),o!=uh&&(pr.font=o,uh=pr.font),pr.measureText(e)}function ia(o,e){return hp(o,e).width}function Df(o,e,t){if(e in t)return t[e];var n=ia(o,e);return t[e]=n,n}function ox(o,e){for(var t=[],n=[],i=[],a=0,u=0,p=0,g=0,v=0,m=e.length;v<=m;v+=2){var E=e[v];if(E===`
`||v===m){a=Math.max(a,u),i.push(u),u=0,p+=g;continue}var b=e[v+1]||o.font,w=ia(b,E);t.push(w),u+=w;var S=rx(b);n.push(S),g=Math.max(g,S)}return{width:a,height:p,widths:t,heights:n,lineWidths:i}}function sx(o,e,t,n,i,a,u,p,g,v,m){o.save(),t!==1&&(o.globalAlpha*=t),e&&o.setTransform.apply(o,e),n.contextInstructions?(o.translate(g,v),o.scale(m[0],m[1]),ax(n,o)):m[0]<0||m[1]<0?(o.translate(g,v),o.scale(m[0],m[1]),o.drawImage(n,i,a,u,p,0,0,u,p)):o.drawImage(n,i,a,u,p,g,v,u*m[0],p*m[1]),o.restore()}function ax(o,e){for(var t=o.contextInstructions,n=0,i=t.length;n<i;n+=2)Array.isArray(t[n+1])?e[t[n]].apply(e,t[n+1]):e[t[n]]=t[n+1]}var lx=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),hx=function(o){lx(e,o);function e(t){var n=this,i=t.rotateWithView!==void 0?t.rotateWithView:!1;return n=o.call(this,{opacity:1,rotateWithView:i,rotation:t.rotation!==void 0?t.rotation:0,scale:t.scale!==void 0?t.scale:1,displacement:t.displacement!==void 0?t.displacement:[0,0]})||this,n.canvas_=void 0,n.hitDetectionCanvas_=null,n.fill_=t.fill!==void 0?t.fill:null,n.origin_=[0,0],n.points_=t.points,n.radius_=t.radius!==void 0?t.radius:t.radius1,n.radius2_=t.radius2,n.angle_=t.angle!==void 0?t.angle:0,n.stroke_=t.stroke!==void 0?t.stroke:null,n.size_=null,n.renderOptions_=null,n.render(),n}return e.prototype.clone=function(){var t=this.getScale(),n=new e({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,displacement:this.getDisplacement().slice()});return n.setOpacity(this.getOpacity()),n},e.prototype.getAnchor=function(){var t=this.size_;if(!t)return null;var n=this.getDisplacement();return[t[0]/2-n[0],t[1]/2+n[1]]},e.prototype.getAngle=function(){return this.angle_},e.prototype.getFill=function(){return this.fill_},e.prototype.getHitDetectionImage=function(){return this.hitDetectionCanvas_||this.createHitDetectionCanvas_(this.renderOptions_),this.hitDetectionCanvas_},e.prototype.getImage=function(t){var n=this.canvas_[t];if(!n){var i=this.renderOptions_,a=je(i.size*t,i.size*t);this.draw_(i,a,t),n=a.canvas,this.canvas_[t]=n}return n},e.prototype.getPixelRatio=function(t){return t},e.prototype.getImageSize=function(){return this.size_},e.prototype.getImageState=function(){return Wt.LOADED},e.prototype.getOrigin=function(){return this.origin_},e.prototype.getPoints=function(){return this.points_},e.prototype.getRadius=function(){return this.radius_},e.prototype.getRadius2=function(){return this.radius2_},e.prototype.getSize=function(){return this.size_},e.prototype.getStroke=function(){return this.stroke_},e.prototype.listenImageChange=function(t){},e.prototype.load=function(){},e.prototype.unlistenImageChange=function(t){},e.prototype.calculateLineJoinSize_=function(t,n,i){if(n===0||this.points_===1/0||t!=="bevel"&&t!=="miter")return n;var a=this.radius_,u=this.radius2_===void 0?a:this.radius2_;if(a<u){var p=a;a=u,u=p}var g=this.radius2_===void 0?this.points_:this.points_*2,v=2*Math.PI/g,m=u*Math.sin(v),E=Math.sqrt(u*u-m*m),b=a-E,w=Math.sqrt(m*m+b*b),S=w/m;if(t==="miter"&&S<=i)return S*n;var C=n/2/S,A=n/2*(b/w),M=Math.sqrt((a+C)*(a+C)+A*A),I=M-a;if(this.radius2_===void 0||t==="bevel")return I*2;var L=a*Math.sin(v),k=Math.sqrt(a*a-L*L),N=u-k,G=Math.sqrt(L*L+N*N),z=G/L;if(z<=i){var V=z*n/2-u-a;return 2*Math.max(I,V)}return I*2},e.prototype.createRenderOptions=function(){var t=Pr,n=0,i=null,a=0,u,p=0;this.stroke_&&(u=this.stroke_.getColor(),u===null&&(u=Po),u=vn(u),p=this.stroke_.getWidth(),p===void 0&&(p=Lo),i=this.stroke_.getLineDash(),a=this.stroke_.getLineDashOffset(),t=this.stroke_.getLineJoin(),t===void 0&&(t=Pr),n=this.stroke_.getMiterLimit(),n===void 0&&(n=Ao));var g=this.calculateLineJoinSize_(t,p,n),v=Math.max(this.radius_,this.radius2_||0),m=Math.ceil(2*v+g);return{strokeStyle:u,strokeWidth:p,size:m,lineDash:i,lineDashOffset:a,lineJoin:t,miterLimit:n}},e.prototype.render=function(){this.renderOptions_=this.createRenderOptions();var t=this.renderOptions_.size;this.canvas_={},this.size_=[t,t]},e.prototype.draw_=function(t,n,i){if(n.scale(i,i),n.translate(t.size/2,t.size/2),this.createPath_(n),this.fill_){var a=this.fill_.getColor();a===null&&(a=Nn),n.fillStyle=vn(a),n.fill()}this.stroke_&&(n.strokeStyle=t.strokeStyle,n.lineWidth=t.strokeWidth,n.setLineDash&&t.lineDash&&(n.setLineDash(t.lineDash),n.lineDashOffset=t.lineDashOffset),n.lineJoin=t.lineJoin,n.miterLimit=t.miterLimit,n.stroke())},e.prototype.createHitDetectionCanvas_=function(t){if(this.fill_){var n=this.fill_.getColor(),i=0;if(typeof n=="string"&&(n=Co(n)),n===null?i=1:Array.isArray(n)&&(i=n.length===4?n[3]:1),i===0){var a=je(t.size,t.size);this.hitDetectionCanvas_=a.canvas,this.drawHitDetectionCanvas_(t,a)}}this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.getImage(1))},e.prototype.createPath_=function(t){var n=this.points_,i=this.radius_;if(n===1/0)t.arc(0,0,i,0,2*Math.PI);else{var a=this.radius2_===void 0?i:this.radius2_;this.radius2_!==void 0&&(n*=2);for(var u=this.angle_-Math.PI/2,p=2*Math.PI/n,g=0;g<n;g++){var v=u+g*p,m=g%2===0?i:a;t.lineTo(m*Math.cos(v),m*Math.sin(v))}t.closePath()}},e.prototype.drawHitDetectionCanvas_=function(t,n){n.translate(t.size/2,t.size/2),this.createPath_(n),n.fillStyle=Nn,n.fill(),this.stroke_&&(n.strokeStyle=t.strokeStyle,n.lineWidth=t.strokeWidth,t.lineDash&&(n.setLineDash(t.lineDash),n.lineDashOffset=t.lineDashOffset),n.lineJoin=t.lineJoin,n.miterLimit=t.miterLimit,n.stroke())},e}(tp),cx=hx,ux=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),fx=function(o){ux(e,o);function e(t){var n=t||{};return o.call(this,{points:1/0,fill:n.fill,radius:n.radius,stroke:n.stroke,scale:n.scale!==void 0?n.scale:1,rotation:n.rotation!==void 0?n.rotation:0,rotateWithView:n.rotateWithView!==void 0?n.rotateWithView:!1,displacement:n.displacement!==void 0?n.displacement:[0,0]})||this}return e.prototype.clone=function(){var t=this.getScale(),n=new e({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice()});return n.setOpacity(this.getOpacity()),n},e.prototype.setRadius=function(t){this.radius_=t,this.render()},e}(cx),dx=fx,cp=function(){function o(e){var t=e||{};this.geometry_=null,this.geometryFunction_=kf,t.geometry!==void 0&&this.setGeometry(t.geometry),this.fill_=t.fill!==void 0?t.fill:null,this.image_=t.image!==void 0?t.image:null,this.renderer_=t.renderer!==void 0?t.renderer:null,this.hitDetectionRenderer_=t.hitDetectionRenderer!==void 0?t.hitDetectionRenderer:null,this.stroke_=t.stroke!==void 0?t.stroke:null,this.text_=t.text!==void 0?t.text:null,this.zIndex_=t.zIndex}return o.prototype.clone=function(){var e=this.getGeometry();return e&&typeof e=="object"&&(e=e.clone()),new o({geometry:e,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer(),stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})},o.prototype.getRenderer=function(){return this.renderer_},o.prototype.setRenderer=function(e){this.renderer_=e},o.prototype.setHitDetectionRenderer=function(e){this.hitDetectionRenderer_=e},o.prototype.getHitDetectionRenderer=function(){return this.hitDetectionRenderer_},o.prototype.getGeometry=function(){return this.geometry_},o.prototype.getGeometryFunction=function(){return this.geometryFunction_},o.prototype.getFill=function(){return this.fill_},o.prototype.setFill=function(e){this.fill_=e},o.prototype.getImage=function(){return this.image_},o.prototype.setImage=function(e){this.image_=e},o.prototype.getStroke=function(){return this.stroke_},o.prototype.setStroke=function(e){this.stroke_=e},o.prototype.getText=function(){return this.text_},o.prototype.setText=function(e){this.text_=e},o.prototype.getZIndex=function(){return this.zIndex_},o.prototype.setGeometry=function(e){typeof e=="function"?this.geometryFunction_=e:typeof e=="string"?this.geometryFunction_=function(t){return t.get(e)}:e?e!==void 0&&(this.geometryFunction_=function(){return e}):this.geometryFunction_=kf,this.geometry_=e},o.prototype.setZIndex=function(e){this.zIndex_=e},o}();function px(o){var e;if(typeof o=="function")e=o;else{var t;if(Array.isArray(o))t=o;else{Ot(typeof o.getZIndex=="function",41);var n=o;t=[n]}e=function(){return t}}return e}var Ll=null;function gx(o,e){if(!Ll){var t=new H0({color:"rgba(255,255,255,0.4)"}),n=new Qd({color:"#3399CC",width:1.25});Ll=[new cp({image:new dx({fill:t,stroke:n,radius:5}),fill:t,stroke:n})]}return Ll}function kf(o){return o.getGeometry()}var _x=cp,vx={POINT:"point",LINE:"line"},Bt={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"},yx=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),mx=function(o){yx(e,o);function e(t){var n=o.call(this)||this;n.on,n.once,n.un,n.background_=t.background;var i=se({},t);return typeof t.properties=="object"&&(delete i.properties,se(i,t.properties)),i[Bt.OPACITY]=t.opacity!==void 0?t.opacity:1,Ot(typeof i[Bt.OPACITY]=="number",64),i[Bt.VISIBLE]=t.visible!==void 0?t.visible:!0,i[Bt.Z_INDEX]=t.zIndex,i[Bt.MAX_RESOLUTION]=t.maxResolution!==void 0?t.maxResolution:1/0,i[Bt.MIN_RESOLUTION]=t.minResolution!==void 0?t.minResolution:0,i[Bt.MIN_ZOOM]=t.minZoom!==void 0?t.minZoom:-1/0,i[Bt.MAX_ZOOM]=t.maxZoom!==void 0?t.maxZoom:1/0,n.className_=i.className!==void 0?i.className:"ol-layer",delete i.className,n.setProperties(i),n.state_=null,n}return e.prototype.getBackground=function(){return this.background_},e.prototype.getClassName=function(){return this.className_},e.prototype.getLayerState=function(t){var n=this.state_||{layer:this,managed:t===void 0?!0:t},i=this.getZIndex();return n.opacity=ae(Math.round(this.getOpacity()*100)/100,0,1),n.visible=this.getVisible(),n.extent=this.getExtent(),n.zIndex=i===void 0&&!n.managed?1/0:i,n.maxResolution=this.getMaxResolution(),n.minResolution=Math.max(this.getMinResolution(),0),n.minZoom=this.getMinZoom(),n.maxZoom=this.getMaxZoom(),this.state_=n,n},e.prototype.getLayersArray=function(t){return Ct()},e.prototype.getLayerStatesArray=function(t){return Ct()},e.prototype.getExtent=function(){return this.get(Bt.EXTENT)},e.prototype.getMaxResolution=function(){return this.get(Bt.MAX_RESOLUTION)},e.prototype.getMinResolution=function(){return this.get(Bt.MIN_RESOLUTION)},e.prototype.getMinZoom=function(){return this.get(Bt.MIN_ZOOM)},e.prototype.getMaxZoom=function(){return this.get(Bt.MAX_ZOOM)},e.prototype.getOpacity=function(){return this.get(Bt.OPACITY)},e.prototype.getSourceState=function(){return Ct()},e.prototype.getVisible=function(){return this.get(Bt.VISIBLE)},e.prototype.getZIndex=function(){return this.get(Bt.Z_INDEX)},e.prototype.setBackground=function(t){this.background_=t,this.changed()},e.prototype.setExtent=function(t){this.set(Bt.EXTENT,t)},e.prototype.setMaxResolution=function(t){this.set(Bt.MAX_RESOLUTION,t)},e.prototype.setMinResolution=function(t){this.set(Bt.MIN_RESOLUTION,t)},e.prototype.setMaxZoom=function(t){this.set(Bt.MAX_ZOOM,t)},e.prototype.setMinZoom=function(t){this.set(Bt.MIN_ZOOM,t)},e.prototype.setOpacity=function(t){Ot(typeof t=="number",64),this.set(Bt.OPACITY,t)},e.prototype.setVisible=function(t){this.set(Bt.VISIBLE,t)},e.prototype.setZIndex=function(t){this.set(Bt.Z_INDEX,t)},e.prototype.disposeInternal=function(){this.state_&&(this.state_.layer=null,this.state_=null),o.prototype.disposeInternal.call(this)},e}(Tn),up=mx,Oe={UNDEFINED:"undefined",LOADING:"loading",READY:"ready",ERROR:"error"},xx=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),bx=function(o){xx(e,o);function e(t){var n=this,i=se({},t);delete i.source,n=o.call(this,i)||this,n.on,n.once,n.un,n.mapPrecomposeKey_=null,n.mapRenderKey_=null,n.sourceChangeKey_=null,n.renderer_=null,n.rendered=!1,t.render&&(n.render=t.render),t.map&&n.setMap(t.map),n.addChangeListener(Bt.SOURCE,n.handleSourcePropertyChange_);var a=t.source?t.source:null;return n.setSource(a),n}return e.prototype.getLayersArray=function(t){var n=t||[];return n.push(this),n},e.prototype.getLayerStatesArray=function(t){var n=t||[];return n.push(this.getLayerState()),n},e.prototype.getSource=function(){return this.get(Bt.SOURCE)||null},e.prototype.getRenderSource=function(){return this.getSource()},e.prototype.getSourceState=function(){var t=this.getSource();return t?t.getState():Oe.UNDEFINED},e.prototype.handleSourceChange_=function(){this.changed()},e.prototype.handleSourcePropertyChange_=function(){this.sourceChangeKey_&&(qt(this.sourceChangeKey_),this.sourceChangeKey_=null);var t=this.getSource();t&&(this.sourceChangeKey_=Lt(t,pt.CHANGE,this.handleSourceChange_,this)),this.changed()},e.prototype.getFeatures=function(t){return this.renderer_?this.renderer_.getFeatures(t):new Promise(function(n){return n([])})},e.prototype.getData=function(t){return!this.renderer_||!this.rendered?null:this.renderer_.getData(t)},e.prototype.render=function(t,n){var i=this.getRenderer();if(i.prepareFrame(t))return this.rendered=!0,i.renderFrame(t,n)},e.prototype.unrender=function(){this.rendered=!1},e.prototype.setMapInternal=function(t){t||this.unrender(),this.set(Bt.MAP,t)},e.prototype.getMapInternal=function(){return this.get(Bt.MAP)},e.prototype.setMap=function(t){this.mapPrecomposeKey_&&(qt(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(qt(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=Lt(t,Ne.PRECOMPOSE,function(n){var i=n,a=i.frameState.layerStatesArray,u=this.getLayerState(!1);Ot(!a.some(function(p){return p.layer===u.layer}),67),a.push(u)},this),this.mapRenderKey_=Lt(this,pt.CHANGE,t.render,t),this.changed())},e.prototype.setSource=function(t){this.set(Bt.SOURCE,t)},e.prototype.getRenderer=function(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_},e.prototype.hasRenderer=function(){return!!this.renderer_},e.prototype.createRenderer=function(){return null},e.prototype.disposeInternal=function(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_),this.setSource(null),o.prototype.disposeInternal.call(this)},e}(up);function ra(o,e){if(!o.visible)return!1;var t=e.resolution;if(t<o.minResolution||t>=o.maxResolution)return!1;var n=e.zoom;return n>o.minZoom&&n<=o.maxZoom}var Oa=bx;function Ex(o,e,t,n,i){fp(o,e,t||0,n||o.length-1,i||Tx)}function fp(o,e,t,n,i){for(;n>t;){if(n-t>600){var a=n-t+1,u=e-t+1,p=Math.log(a),g=.5*Math.exp(2*p/3),v=.5*Math.sqrt(p*g*(a-g)/a)*(u-a/2<0?-1:1),m=Math.max(t,Math.floor(e-u*g/a+v)),E=Math.min(n,Math.floor(e+(a-u)*g/a+v));fp(o,e,m,E,i)}var b=o[e],w=t,S=n;for(uo(o,t,e),i(o[n],b)>0&&uo(o,t,n);w<S;){for(uo(o,w,S),w++,S--;i(o[w],b)<0;)w++;for(;i(o[S],b)>0;)S--}i(o[t],b)===0?uo(o,t,S):(S++,uo(o,S,n)),S<=e&&(t=S+1),e<=S&&(n=S-1)}}function uo(o,e,t){var n=o[e];o[e]=o[t],o[t]=n}function Tx(o,e){return o<e?-1:o>e?1:0}class dp{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(e){let t=this.data;const n=[];if(!Os(e,t))return n;const i=this.toBBox,a=[];for(;t;){for(let u=0;u<t.children.length;u++){const p=t.children[u],g=t.leaf?i(p):p;Os(e,g)&&(t.leaf?n.push(p):kl(e,g)?this._all(p,n):a.push(p))}t=a.pop()}return n}collides(e){let t=this.data;if(!Os(e,t))return!1;const n=[];for(;t;){for(let i=0;i<t.children.length;i++){const a=t.children[i],u=t.leaf?this.toBBox(a):a;if(Os(e,u)){if(t.leaf||kl(e,u))return!0;n.push(a)}}t=n.pop()}return!1}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let n=0;n<e.length;n++)this.insert(e[n]);return this}let t=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=t;else if(this.data.height===t.height)this._splitRoot(this.data,t);else{if(this.data.height<t.height){const n=this.data;this.data=t,t=n}this._insert(t,this.data.height-t.height-1,!0)}return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=gr([]),this}remove(e,t){if(!e)return this;let n=this.data;const i=this.toBBox(e),a=[],u=[];let p,g,v;for(;n||a.length;){if(n||(n=a.pop(),g=a[a.length-1],p=u.pop(),v=!0),n.leaf){const m=wx(e,n.children,t);if(m!==-1)return n.children.splice(m,1),a.push(n),this._condense(a),this}!v&&!n.leaf&&kl(n,i)?(a.push(n),u.push(p),p=0,g=n,n=n.children[0]):g?(p++,n=g.children[p],v=!1):n=null}return this}toBBox(e){return e}compareMinX(e,t){return e.minX-t.minX}compareMinY(e,t){return e.minY-t.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,t){const n=[];for(;e;)e.leaf?t.push(...e.children):n.push(...e.children),e=n.pop();return t}_build(e,t,n,i){const a=n-t+1;let u=this._maxEntries,p;if(a<=u)return p=gr(e.slice(t,n+1)),cr(p,this.toBBox),p;i||(i=Math.ceil(Math.log(a)/Math.log(u)),u=Math.ceil(a/Math.pow(u,i-1))),p=gr([]),p.leaf=!1,p.height=i;const g=Math.ceil(a/u),v=g*Math.ceil(Math.sqrt(u));Ff(e,t,n,v,this.compareMinX);for(let m=t;m<=n;m+=v){const E=Math.min(m+v-1,n);Ff(e,m,E,g,this.compareMinY);for(let b=m;b<=E;b+=g){const w=Math.min(b+g-1,E);p.children.push(this._build(e,b,w,i-1))}}return cr(p,this.toBBox),p}_chooseSubtree(e,t,n,i){for(;i.push(t),!(t.leaf||i.length-1===n);){let a=1/0,u=1/0,p;for(let g=0;g<t.children.length;g++){const v=t.children[g],m=Dl(v),E=Cx(e,v)-m;E<u?(u=E,a=m<a?m:a,p=v):E===u&&m<a&&(a=m,p=v)}t=p||t.children[0]}return t}_insert(e,t,n){const i=n?e:this.toBBox(e),a=[],u=this._chooseSubtree(i,this.data,t,a);for(u.children.push(e),yo(u,i);t>=0&&a[t].children.length>this._maxEntries;)this._split(a,t),t--;this._adjustParentBBoxes(i,a,t)}_split(e,t){const n=e[t],i=n.children.length,a=this._minEntries;this._chooseSplitAxis(n,a,i);const u=this._chooseSplitIndex(n,a,i),p=gr(n.children.splice(u,n.children.length-u));p.height=n.height,p.leaf=n.leaf,cr(n,this.toBBox),cr(p,this.toBBox),t?e[t-1].children.push(p):this._splitRoot(n,p)}_splitRoot(e,t){this.data=gr([e,t]),this.data.height=e.height+1,this.data.leaf=!1,cr(this.data,this.toBBox)}_chooseSplitIndex(e,t,n){let i,a=1/0,u=1/0;for(let p=t;p<=n-t;p++){const g=vo(e,0,p,this.toBBox),v=vo(e,p,n,this.toBBox),m=Ox(g,v),E=Dl(g)+Dl(v);m<a?(a=m,i=p,u=E<u?E:u):m===a&&E<u&&(u=E,i=p)}return i||n-t}_chooseSplitAxis(e,t,n){const i=e.leaf?this.compareMinX:Sx,a=e.leaf?this.compareMinY:Rx,u=this._allDistMargin(e,t,n,i),p=this._allDistMargin(e,t,n,a);u<p&&e.children.sort(i)}_allDistMargin(e,t,n,i){e.children.sort(i);const a=this.toBBox,u=vo(e,0,t,a),p=vo(e,n-t,n,a);let g=Cs(u)+Cs(p);for(let v=t;v<n-t;v++){const m=e.children[v];yo(u,e.leaf?a(m):m),g+=Cs(u)}for(let v=n-t-1;v>=t;v--){const m=e.children[v];yo(p,e.leaf?a(m):m),g+=Cs(p)}return g}_adjustParentBBoxes(e,t,n){for(let i=n;i>=0;i--)yo(t[i],e)}_condense(e){for(let t=e.length-1,n;t>=0;t--)e[t].children.length===0?t>0?(n=e[t-1].children,n.splice(n.indexOf(e[t]),1)):this.clear():cr(e[t],this.toBBox)}}function wx(o,e,t){if(!t)return e.indexOf(o);for(let n=0;n<e.length;n++)if(t(o,e[n]))return n;return-1}function cr(o,e){vo(o,0,o.children.length,e,o)}function vo(o,e,t,n,i){i||(i=gr(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(let a=e;a<t;a++){const u=o.children[a];yo(i,o.leaf?n(u):u)}return i}function yo(o,e){return o.minX=Math.min(o.minX,e.minX),o.minY=Math.min(o.minY,e.minY),o.maxX=Math.max(o.maxX,e.maxX),o.maxY=Math.max(o.maxY,e.maxY),o}function Sx(o,e){return o.minX-e.minX}function Rx(o,e){return o.minY-e.minY}function Dl(o){return(o.maxX-o.minX)*(o.maxY-o.minY)}function Cs(o){return o.maxX-o.minX+(o.maxY-o.minY)}function Cx(o,e){return(Math.max(e.maxX,o.maxX)-Math.min(e.minX,o.minX))*(Math.max(e.maxY,o.maxY)-Math.min(e.minY,o.minY))}function Ox(o,e){const t=Math.max(o.minX,e.minX),n=Math.max(o.minY,e.minY),i=Math.min(o.maxX,e.maxX),a=Math.min(o.maxY,e.maxY);return Math.max(0,i-t)*Math.max(0,a-n)}function kl(o,e){return o.minX<=e.minX&&o.minY<=e.minY&&e.maxX<=o.maxX&&e.maxY<=o.maxY}function Os(o,e){return e.minX<=o.maxX&&e.minY<=o.maxY&&e.maxX>=o.minX&&e.maxY>=o.minY}function gr(o){return{children:o,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Ff(o,e,t,n,i){const a=[e,t];for(;a.length;){if(t=a.pop(),e=a.pop(),t-e<=n)continue;const u=e+Math.ceil((t-e)/n/2)*n;Ex(o,u,e,t,i),a.push(e,u,u,t)}}var Ix=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Nf={RENDER_ORDER:"renderOrder"},Ax=function(o){Ix(e,o);function e(t){var n=this,i=t||{},a=se({},i);return delete a.style,delete a.renderBuffer,delete a.updateWhileAnimating,delete a.updateWhileInteracting,n=o.call(this,a)||this,n.declutter_=i.declutter!==void 0?i.declutter:!1,n.renderBuffer_=i.renderBuffer!==void 0?i.renderBuffer:100,n.style_=null,n.styleFunction_=void 0,n.setStyle(i.style),n.updateWhileAnimating_=i.updateWhileAnimating!==void 0?i.updateWhileAnimating:!1,n.updateWhileInteracting_=i.updateWhileInteracting!==void 0?i.updateWhileInteracting:!1,n}return e.prototype.getDeclutter=function(){return this.declutter_},e.prototype.getFeatures=function(t){return o.prototype.getFeatures.call(this,t)},e.prototype.getRenderBuffer=function(){return this.renderBuffer_},e.prototype.getRenderOrder=function(){return this.get(Nf.RENDER_ORDER)},e.prototype.getStyle=function(){return this.style_},e.prototype.getStyleFunction=function(){return this.styleFunction_},e.prototype.getUpdateWhileAnimating=function(){return this.updateWhileAnimating_},e.prototype.getUpdateWhileInteracting=function(){return this.updateWhileInteracting_},e.prototype.renderDeclutter=function(t){t.declutterTree||(t.declutterTree=new dp(9)),this.getRenderer().renderDeclutter(t)},e.prototype.setRenderOrder=function(t){this.set(Nf.RENDER_ORDER,t)},e.prototype.setStyle=function(t){this.style_=t!==void 0?t:gx,this.styleFunction_=t===null?void 0:px(this.style_),this.changed()},e}(Oa),Px=Ax,Fo={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},Is=[Fo.FILL],si=[Fo.STROKE],Ni=[Fo.BEGIN_PATH],Bf=[Fo.CLOSE_PATH],ft=Fo,Mx=function(){function o(){}return o.prototype.drawCustom=function(e,t,n,i){},o.prototype.drawGeometry=function(e){},o.prototype.setStyle=function(e){},o.prototype.drawCircle=function(e,t){},o.prototype.drawFeature=function(e,t){},o.prototype.drawGeometryCollection=function(e,t){},o.prototype.drawLineString=function(e,t){},o.prototype.drawMultiLineString=function(e,t){},o.prototype.drawMultiPoint=function(e,t){},o.prototype.drawMultiPolygon=function(e,t){},o.prototype.drawPoint=function(e,t){},o.prototype.drawPolygon=function(e,t){},o.prototype.drawText=function(e,t){},o.prototype.setFillStrokeStyle=function(e,t){},o.prototype.setImageStyle=function(e,t){},o.prototype.setTextStyle=function(e,t){},o}(),pp=Mx,Lx=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Dx=function(o){Lx(e,o);function e(t,n,i,a){var u=o.call(this)||this;return u.tolerance=t,u.maxExtent=n,u.pixelRatio=a,u.maxLineWidth=0,u.resolution=i,u.beginGeometryInstruction1_=null,u.beginGeometryInstruction2_=null,u.bufferedMaxExtent_=null,u.instructions=[],u.coordinates=[],u.tmpCoordinate_=[],u.hitDetectionInstructions=[],u.state={},u}return e.prototype.applyPixelRatio=function(t){var n=this.pixelRatio;return n==1?t:t.map(function(i){return i*n})},e.prototype.appendFlatPointCoordinates=function(t,n){for(var i=this.getBufferedMaxExtent(),a=this.tmpCoordinate_,u=this.coordinates,p=u.length,g=0,v=t.length;g<v;g+=n)a[0]=t[g],a[1]=t[g+1],Xi(i,a)&&(u[p++]=a[0],u[p++]=a[1]);return p},e.prototype.appendFlatLineCoordinates=function(t,n,i,a,u,p){var g=this.coordinates,v=g.length,m=this.getBufferedMaxExtent();p&&(n+=a);var E=t[n],b=t[n+1],w=this.tmpCoordinate_,S=!0,C,A,M;for(C=n+a;C<i;C+=a)w[0]=t[C],w[1]=t[C+1],M=oh(m,w),M!==A?(S&&(g[v++]=E,g[v++]=b,S=!1),g[v++]=w[0],g[v++]=w[1]):M===pe.INTERSECTING?(g[v++]=w[0],g[v++]=w[1],S=!1):S=!0,E=w[0],b=w[1],A=M;return(u&&S||C===n+a)&&(g[v++]=E,g[v++]=b),v},e.prototype.drawCustomCoordinates_=function(t,n,i,a,u){for(var p=0,g=i.length;p<g;++p){var v=i[p],m=this.appendFlatLineCoordinates(t,n,v,a,!1,!1);u.push(m),n=v}return n},e.prototype.drawCustom=function(t,n,i,a){this.beginGeometry(t,n);var u=t.getType(),p=t.getStride(),g=this.coordinates.length,v,m,E,b,w;switch(u){case mt.MULTI_POLYGON:v=t.getOrientedFlatCoordinates(),b=[];var S=t.getEndss();w=0;for(var C=0,A=S.length;C<A;++C){var M=[];w=this.drawCustomCoordinates_(v,w,S[C],p,M),b.push(M)}this.instructions.push([ft.CUSTOM,g,b,t,i,wf]),this.hitDetectionInstructions.push([ft.CUSTOM,g,b,t,a||i,wf]);break;case mt.POLYGON:case mt.MULTI_LINE_STRING:E=[],v=u==mt.POLYGON?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),w=this.drawCustomCoordinates_(v,0,t.getEnds(),p,E),this.instructions.push([ft.CUSTOM,g,E,t,i,ta]),this.hitDetectionInstructions.push([ft.CUSTOM,g,E,t,a||i,ta]);break;case mt.LINE_STRING:case mt.CIRCLE:v=t.getFlatCoordinates(),m=this.appendFlatLineCoordinates(v,0,v.length,p,!1,!1),this.instructions.push([ft.CUSTOM,g,m,t,i,mr]),this.hitDetectionInstructions.push([ft.CUSTOM,g,m,t,a||i,mr]);break;case mt.MULTI_POINT:v=t.getFlatCoordinates(),m=this.appendFlatPointCoordinates(v,p),m>g&&(this.instructions.push([ft.CUSTOM,g,m,t,i,mr]),this.hitDetectionInstructions.push([ft.CUSTOM,g,m,t,a||i,mr]));break;case mt.POINT:v=t.getFlatCoordinates(),this.coordinates.push(v[0],v[1]),m=this.coordinates.length,this.instructions.push([ft.CUSTOM,g,m,t,i]),this.hitDetectionInstructions.push([ft.CUSTOM,g,m,t,a||i]);break}this.endGeometry(n)},e.prototype.beginGeometry=function(t,n){this.beginGeometryInstruction1_=[ft.BEGIN_GEOMETRY,n,0,t],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[ft.BEGIN_GEOMETRY,n,0,t],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)},e.prototype.finish=function(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}},e.prototype.reverseHitDetectionInstructions=function(){var t=this.hitDetectionInstructions;t.reverse();var n,i=t.length,a,u,p=-1;for(n=0;n<i;++n)a=t[n],u=a[0],u==ft.END_GEOMETRY?p=n:u==ft.BEGIN_GEOMETRY&&(a[2]=n,em(this.hitDetectionInstructions,p,n),p=-1)},e.prototype.setFillStrokeStyle=function(t,n){var i=this.state;if(t){var a=t.getColor();i.fillStyle=vn(a||Nn)}else i.fillStyle=void 0;if(n){var u=n.getColor();i.strokeStyle=vn(u||Po);var p=n.getLineCap();i.lineCap=p!==void 0?p:ea;var g=n.getLineDash();i.lineDash=g?g.slice():Oo;var v=n.getLineDashOffset();i.lineDashOffset=v||Io;var m=n.getLineJoin();i.lineJoin=m!==void 0?m:Pr;var E=n.getWidth();i.lineWidth=E!==void 0?E:Lo;var b=n.getMiterLimit();i.miterLimit=b!==void 0?b:Ao,i.lineWidth>this.maxLineWidth&&(this.maxLineWidth=i.lineWidth,this.bufferedMaxExtent_=null)}else i.strokeStyle=void 0,i.lineCap=void 0,i.lineDash=null,i.lineDashOffset=void 0,i.lineJoin=void 0,i.lineWidth=void 0,i.miterLimit=void 0},e.prototype.createFill=function(t){var n=t.fillStyle,i=[ft.SET_FILL_STYLE,n];return typeof n!="string"&&i.push(!0),i},e.prototype.applyStroke=function(t){this.instructions.push(this.createStroke(t))},e.prototype.createStroke=function(t){return[ft.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]},e.prototype.updateFillStyle=function(t,n){var i=t.fillStyle;(typeof i!="string"||t.currentFillStyle!=i)&&(i!==void 0&&this.instructions.push(n.call(this,t)),t.currentFillStyle=i)},e.prototype.updateStrokeStyle=function(t,n){var i=t.strokeStyle,a=t.lineCap,u=t.lineDash,p=t.lineDashOffset,g=t.lineJoin,v=t.lineWidth,m=t.miterLimit;(t.currentStrokeStyle!=i||t.currentLineCap!=a||u!=t.currentLineDash&&!Wi(t.currentLineDash,u)||t.currentLineDashOffset!=p||t.currentLineJoin!=g||t.currentLineWidth!=v||t.currentMiterLimit!=m)&&(i!==void 0&&n.call(this,t),t.currentStrokeStyle=i,t.currentLineCap=a,t.currentLineDash=u,t.currentLineDashOffset=p,t.currentLineJoin=g,t.currentLineWidth=v,t.currentMiterLimit=m)},e.prototype.endGeometry=function(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;var n=[ft.END_GEOMETRY,t];this.instructions.push(n),this.hitDetectionInstructions.push(n)},e.prototype.getBufferedMaxExtent=function(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=Ld(this.maxExtent),this.maxLineWidth>0)){var t=this.resolution*(this.maxLineWidth+1)/2;Eh(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_},e}(pp),No=Dx,kx=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Fx=function(o){kx(e,o);function e(t,n,i,a){var u=o.call(this,t,n,i,a)||this;return u.hitDetectionImage_=null,u.image_=null,u.imagePixelRatio_=void 0,u.anchorX_=void 0,u.anchorY_=void 0,u.height_=void 0,u.opacity_=void 0,u.originX_=void 0,u.originY_=void 0,u.rotateWithView_=void 0,u.rotation_=void 0,u.scale_=void 0,u.width_=void 0,u.declutterImageWithText_=void 0,u}return e.prototype.drawPoint=function(t,n){if(!!this.image_){this.beginGeometry(t,n);var i=t.getFlatCoordinates(),a=t.getStride(),u=this.coordinates.length,p=this.appendFlatPointCoordinates(i,a);this.instructions.push([ft.DRAW_IMAGE,u,p,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterImageWithText_]),this.hitDetectionInstructions.push([ft.DRAW_IMAGE,u,p,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterImageWithText_]),this.endGeometry(n)}},e.prototype.drawMultiPoint=function(t,n){if(!!this.image_){this.beginGeometry(t,n);var i=t.getFlatCoordinates(),a=t.getStride(),u=this.coordinates.length,p=this.appendFlatPointCoordinates(i,a);this.instructions.push([ft.DRAW_IMAGE,u,p,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterImageWithText_]),this.hitDetectionInstructions.push([ft.DRAW_IMAGE,u,p,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterImageWithText_]),this.endGeometry(n)}},e.prototype.finish=function(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,o.prototype.finish.call(this)},e.prototype.setImageStyle=function(t,n){var i=t.getAnchor(),a=t.getSize(),u=t.getHitDetectionImage(),p=t.getImage(this.pixelRatio),g=t.getOrigin();this.imagePixelRatio_=t.getPixelRatio(this.pixelRatio),this.anchorX_=i[0],this.anchorY_=i[1],this.hitDetectionImage_=u,this.image_=p,this.height_=a[1],this.opacity_=t.getOpacity(),this.originX_=g[0]*this.imagePixelRatio_,this.originY_=g[1]*this.imagePixelRatio_,this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScaleArray(),this.width_=a[0],this.declutterImageWithText_=n},e}(No),Nx=Fx,Bx=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Gx=function(o){Bx(e,o);function e(t,n,i,a){return o.call(this,t,n,i,a)||this}return e.prototype.drawFlatCoordinates_=function(t,n,i,a){var u=this.coordinates.length,p=this.appendFlatLineCoordinates(t,n,i,a,!1,!1),g=[ft.MOVE_TO_LINE_TO,u,p];return this.instructions.push(g),this.hitDetectionInstructions.push(g),i},e.prototype.drawLineString=function(t,n){var i=this.state,a=i.strokeStyle,u=i.lineWidth;if(!(a===void 0||u===void 0)){this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(t,n),this.hitDetectionInstructions.push([ft.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Oo,Io],Ni);var p=t.getFlatCoordinates(),g=t.getStride();this.drawFlatCoordinates_(p,0,p.length,g),this.hitDetectionInstructions.push(si),this.endGeometry(n)}},e.prototype.drawMultiLineString=function(t,n){var i=this.state,a=i.strokeStyle,u=i.lineWidth;if(!(a===void 0||u===void 0)){this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(t,n),this.hitDetectionInstructions.push([ft.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset],Ni);for(var p=t.getEnds(),g=t.getFlatCoordinates(),v=t.getStride(),m=0,E=0,b=p.length;E<b;++E)m=this.drawFlatCoordinates_(g,m,p[E],v);this.hitDetectionInstructions.push(si),this.endGeometry(n)}},e.prototype.finish=function(){var t=this.state;return t.lastStroke!=null&&t.lastStroke!=this.coordinates.length&&this.instructions.push(si),this.reverseHitDetectionInstructions(),this.state=null,o.prototype.finish.call(this)},e.prototype.applyStroke=function(t){t.lastStroke!=null&&t.lastStroke!=this.coordinates.length&&(this.instructions.push(si),t.lastStroke=this.coordinates.length),t.lastStroke=0,o.prototype.applyStroke.call(this,t),this.instructions.push(Ni)},e}(No),zx=Gx,Ux=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Vx=function(o){Ux(e,o);function e(t,n,i,a){return o.call(this,t,n,i,a)||this}return e.prototype.drawFlatCoordinatess_=function(t,n,i,a){var u=this.state,p=u.fillStyle!==void 0,g=u.strokeStyle!==void 0,v=i.length;this.instructions.push(Ni),this.hitDetectionInstructions.push(Ni);for(var m=0;m<v;++m){var E=i[m],b=this.coordinates.length,w=this.appendFlatLineCoordinates(t,n,E,a,!0,!g),S=[ft.MOVE_TO_LINE_TO,b,w];this.instructions.push(S),this.hitDetectionInstructions.push(S),g&&(this.instructions.push(Bf),this.hitDetectionInstructions.push(Bf)),n=E}return p&&(this.instructions.push(Is),this.hitDetectionInstructions.push(Is)),g&&(this.instructions.push(si),this.hitDetectionInstructions.push(si)),n},e.prototype.drawCircle=function(t,n){var i=this.state,a=i.fillStyle,u=i.strokeStyle;if(!(a===void 0&&u===void 0)){this.setFillStrokeStyles_(),this.beginGeometry(t,n),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([ft.SET_FILL_STYLE,Nn]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([ft.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset]);var p=t.getFlatCoordinates(),g=t.getStride(),v=this.coordinates.length;this.appendFlatLineCoordinates(p,0,p.length,g,!1,!1);var m=[ft.CIRCLE,v];this.instructions.push(Ni,m),this.hitDetectionInstructions.push(Ni,m),i.fillStyle!==void 0&&(this.instructions.push(Is),this.hitDetectionInstructions.push(Is)),i.strokeStyle!==void 0&&(this.instructions.push(si),this.hitDetectionInstructions.push(si)),this.endGeometry(n)}},e.prototype.drawPolygon=function(t,n){var i=this.state,a=i.fillStyle,u=i.strokeStyle;if(!(a===void 0&&u===void 0)){this.setFillStrokeStyles_(),this.beginGeometry(t,n),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([ft.SET_FILL_STYLE,Nn]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([ft.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset]);var p=t.getEnds(),g=t.getOrientedFlatCoordinates(),v=t.getStride();this.drawFlatCoordinatess_(g,0,p,v),this.endGeometry(n)}},e.prototype.drawMultiPolygon=function(t,n){var i=this.state,a=i.fillStyle,u=i.strokeStyle;if(!(a===void 0&&u===void 0)){this.setFillStrokeStyles_(),this.beginGeometry(t,n),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([ft.SET_FILL_STYLE,Nn]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([ft.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset]);for(var p=t.getEndss(),g=t.getOrientedFlatCoordinates(),v=t.getStride(),m=0,E=0,b=p.length;E<b;++E)m=this.drawFlatCoordinatess_(g,m,p[E],v);this.endGeometry(n)}},e.prototype.finish=function(){this.reverseHitDetectionInstructions(),this.state=null;var t=this.tolerance;if(t!==0)for(var n=this.coordinates,i=0,a=n.length;i<a;++i)n[i]=Pi(n[i],t);return o.prototype.finish.call(this)},e.prototype.setFillStrokeStyles_=function(){var t=this.state,n=t.fillStyle;n!==void 0&&this.updateFillStyle(t,this.createFill),t.strokeStyle!==void 0&&this.updateStrokeStyle(t,this.applyStroke)},e}(No),Gf=Vx;function Xx(o,e,t,n,i){var a=t,u=t,p=0,g=0,v=t,m,E,b,w,S,C,A,M,I,L;for(E=t;E<n;E+=i){var k=e[E],N=e[E+1];S!==void 0&&(I=k-S,L=N-C,w=Math.sqrt(I*I+L*L),A!==void 0&&(g+=b,m=Math.acos((A*I+M*L)/(b*w)),m>o&&(g>p&&(p=g,a=v,u=E),g=0,v=E-i)),b=w,A=I,M=L),S=k,C=N}return g+=w,g>p?[v,E]:[a,u]}var jx=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),oa={left:0,end:0,center:.5,right:1,start:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1},Wx=function(o){jx(e,o);function e(t,n,i,a){var u=o.call(this,t,n,i,a)||this;return u.labels_=null,u.text_="",u.textOffsetX_=0,u.textOffsetY_=0,u.textRotateWithView_=void 0,u.textRotation_=0,u.textFillState_=null,u.fillStates={},u.textStrokeState_=null,u.strokeStates={},u.textState_={},u.textStates={},u.textKey_="",u.fillKey_="",u.strokeKey_="",u.declutterImageWithText_=void 0,u}return e.prototype.finish=function(){var t=o.prototype.finish.call(this);return t.textStates=this.textStates,t.fillStates=this.fillStates,t.strokeStates=this.strokeStates,t},e.prototype.drawText=function(t,n){var i=this.textFillState_,a=this.textStrokeState_,u=this.textState_;if(!(this.text_===""||!u||!i&&!a)){var p=this.coordinates,g=p.length,v=t.getType(),m=null,E=t.getStride();if(u.placement===vx.LINE&&(v==mt.LINE_STRING||v==mt.MULTI_LINE_STRING||v==mt.POLYGON||v==mt.MULTI_POLYGON)){if(!ke(this.getBufferedMaxExtent(),t.getExtent()))return;var b=void 0;if(m=t.getFlatCoordinates(),v==mt.LINE_STRING)b=[m.length];else if(v==mt.MULTI_LINE_STRING)b=t.getEnds();else if(v==mt.POLYGON)b=t.getEnds().slice(0,1);else if(v==mt.MULTI_POLYGON){var w=t.getEndss();b=[];for(var S=0,C=w.length;S<C;++S)b.push(w[S][0])}this.beginGeometry(t,n);for(var A=u.textAlign,M=0,I=void 0,L=0,k=b.length;L<k;++L){if(A==null){var N=Xx(u.maxAngle,m,M,b[L],E);M=N[0],I=N[1]}else I=b[L];for(var S=M;S<I;S+=E)p.push(m[S],m[S+1]);var G=p.length;M=b[L],this.drawChars_(g,G),g=G}this.endGeometry(n)}else{var z=u.overflow?null:[];switch(v){case mt.POINT:case mt.MULTI_POINT:m=t.getFlatCoordinates();break;case mt.LINE_STRING:m=t.getFlatMidpoint();break;case mt.CIRCLE:m=t.getCenter();break;case mt.MULTI_LINE_STRING:m=t.getFlatMidpoints(),E=2;break;case mt.POLYGON:m=t.getFlatInteriorPoint(),u.overflow||z.push(m[2]/this.resolution),E=3;break;case mt.MULTI_POLYGON:var V=t.getFlatInteriorPoints();m=[];for(var S=0,C=V.length;S<C;S+=3)u.overflow||z.push(V[S+2]/this.resolution),m.push(V[S],V[S+1]);if(m.length===0)return;E=2;break}var G=this.appendFlatPointCoordinates(m,E);if(G===g)return;if(z&&(G-g)/2!==m.length/E){var Y=g/2;z=z.filter(function(at,ht){var ut=p[(Y+ht)*2]===m[ht*E]&&p[(Y+ht)*2+1]===m[ht*E+1];return ut||--Y,ut})}this.saveTextStates_(),(u.backgroundFill||u.backgroundStroke)&&(this.setFillStrokeStyle(u.backgroundFill,u.backgroundStroke),u.backgroundFill&&(this.updateFillStyle(this.state,this.createFill),this.hitDetectionInstructions.push(this.createFill(this.state))),u.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(t,n);var X=u.padding;if(X!=Fi&&(u.scale[0]<0||u.scale[1]<0)){var J=u.padding[0],q=u.padding[1],K=u.padding[2],Q=u.padding[3];u.scale[0]<0&&(q=-q,Q=-Q),u.scale[1]<0&&(J=-J,K=-K),X=[J,q,K,Q]}var tt=this.pixelRatio;this.instructions.push([ft.DRAW_IMAGE,g,G,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterImageWithText_,X==Fi?Fi:X.map(function(at){return at*tt}),!!u.backgroundFill,!!u.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,z]);var nt=1/tt;this.hitDetectionInstructions.push([ft.DRAW_IMAGE,g,G,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[nt,nt],NaN,this.declutterImageWithText_,X,!!u.backgroundFill,!!u.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,z]),this.endGeometry(n)}}},e.prototype.saveTextStates_=function(){var t=this.textStrokeState_,n=this.textState_,i=this.textFillState_,a=this.strokeKey_;t&&(a in this.strokeStates||(this.strokeStates[a]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));var u=this.textKey_;u in this.textStates||(this.textStates[u]={font:n.font,textAlign:n.textAlign||Mo,textBaseline:n.textBaseline||na,scale:n.scale});var p=this.fillKey_;i&&(p in this.fillStates||(this.fillStates[p]={fillStyle:i.fillStyle}))},e.prototype.drawChars_=function(t,n){var i=this.textStrokeState_,a=this.textState_,u=this.strokeKey_,p=this.textKey_,g=this.fillKey_;this.saveTextStates_();var v=this.pixelRatio,m=oa[a.textBaseline],E=this.textOffsetY_*v,b=this.text_,w=i?i.lineWidth*Math.abs(a.scale[0])/2:0;this.instructions.push([ft.DRAW_CHARS,t,n,m,a.overflow,g,a.maxAngle,v,E,u,w*v,b,p,1]),this.hitDetectionInstructions.push([ft.DRAW_CHARS,t,n,m,a.overflow,g,a.maxAngle,1,E,u,w,b,p,1/v])},e.prototype.setTextStyle=function(t,n){var i,a,u;if(!t)this.text_="";else{var p=t.getFill();p?(a=this.textFillState_,a||(a={},this.textFillState_=a),a.fillStyle=vn(p.getColor()||Nn)):(a=null,this.textFillState_=a);var g=t.getStroke();if(!g)u=null,this.textStrokeState_=u;else{u=this.textStrokeState_,u||(u={},this.textStrokeState_=u);var v=g.getLineDash(),m=g.getLineDashOffset(),E=g.getWidth(),b=g.getMiterLimit();u.lineCap=g.getLineCap()||ea,u.lineDash=v?v.slice():Oo,u.lineDashOffset=m===void 0?Io:m,u.lineJoin=g.getLineJoin()||Pr,u.lineWidth=E===void 0?Lo:E,u.miterLimit=b===void 0?Ao:b,u.strokeStyle=vn(g.getColor()||Po)}i=this.textState_;var w=t.getFont()||lp;ix(w);var S=t.getScaleArray();i.overflow=t.getOverflow(),i.font=w,i.maxAngle=t.getMaxAngle(),i.placement=t.getPlacement(),i.textAlign=t.getTextAlign(),i.textBaseline=t.getTextBaseline()||na,i.backgroundFill=t.getBackgroundFill(),i.backgroundStroke=t.getBackgroundStroke(),i.padding=t.getPadding()||Fi,i.scale=S===void 0?[1,1]:S;var C=t.getOffsetX(),A=t.getOffsetY(),M=t.getRotateWithView(),I=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=C===void 0?0:C,this.textOffsetY_=A===void 0?0:A,this.textRotateWithView_=M===void 0?!1:M,this.textRotation_=I===void 0?0:I,this.strokeKey_=u?(typeof u.strokeStyle=="string"?u.strokeStyle:Xt(u.strokeStyle))+u.lineCap+u.lineDashOffset+"|"+u.lineWidth+u.lineJoin+u.miterLimit+"["+u.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.textBaseline||"?"),this.fillKey_=a?typeof a.fillStyle=="string"?a.fillStyle:"|"+Xt(a.fillStyle):""}this.declutterImageWithText_=n},e}(No),Hx=Wx,Yx={Circle:Gf,Default:No,Image:Nx,LineString:zx,Polygon:Gf,Text:Hx},$x=function(){function o(e,t,n,i){this.tolerance_=e,this.maxExtent_=t,this.pixelRatio_=i,this.resolution_=n,this.buildersByZIndex_={}}return o.prototype.finish=function(){var e={};for(var t in this.buildersByZIndex_){e[t]=e[t]||{};var n=this.buildersByZIndex_[t];for(var i in n){var a=n[i].finish();e[t][i]=a}}return e},o.prototype.getBuilder=function(e,t){var n=e!==void 0?e.toString():"0",i=this.buildersByZIndex_[n];i===void 0&&(i={},this.buildersByZIndex_[n]=i);var a=i[t];if(a===void 0){var u=Yx[t];a=new u(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),i[t]=a}return a},o}(),zf=$x,Kx=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Zx=function(o){Kx(e,o);function e(t){var n=o.call(this)||this;return n.ready=!0,n.boundHandleImageChange_=n.handleImageChange_.bind(n),n.layer_=t,n.declutterExecutorGroup=null,n}return e.prototype.getFeatures=function(t){return Ct()},e.prototype.getData=function(t){return null},e.prototype.prepareFrame=function(t){return Ct()},e.prototype.renderFrame=function(t,n){return Ct()},e.prototype.loadedTileCallback=function(t,n,i){t[n]||(t[n]={}),t[n][i.tileCoord.toString()]=i},e.prototype.createLoadedTileFinder=function(t,n,i){return function(a,u){var p=this.loadedTileCallback.bind(this,i,a);return t.forEachLoadedTile(n,a,u,p)}.bind(this)},e.prototype.forEachFeatureAtCoordinate=function(t,n,i,a,u){},e.prototype.getDataAtPixel=function(t,n,i){return null},e.prototype.getLayer=function(){return this.layer_},e.prototype.handleFontsChanged=function(){},e.prototype.handleImageChange_=function(t){var n=t.target;n.getState()===Wt.LOADED&&this.renderIfReadyAndVisible()},e.prototype.loadImage=function(t){var n=t.getState();return n!=Wt.LOADED&&n!=Wt.ERROR&&t.addEventListener(pt.CHANGE,this.boundHandleImageChange_),n==Wt.IDLE&&(t.load(),n=t.getState()),n==Wt.LOADED},e.prototype.renderIfReadyAndVisible=function(){var t=this.getLayer();t.getVisible()&&t.getSourceState()==Oe.READY&&t.changed()},e.prototype.disposeInternal=function(){delete this.layer_,o.prototype.disposeInternal.call(this)},e}(Sd),gp=Zx,qx=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Jx=function(o){qx(e,o);function e(t,n,i,a){var u=o.call(this,t)||this;return u.inversePixelTransform=n,u.frameState=i,u.context=a,u}return e}(Bn),wo=Jx,Qx=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),mo=null;function tb(){var o=document.createElement("canvas");o.width=1,o.height=1,mo=o.getContext("2d")}var eb=function(o){Qx(e,o);function e(t){var n=o.call(this,t)||this;return n.container=null,n.renderedResolution,n.tempTransform=Ge(),n.pixelTransform=Ge(),n.inversePixelTransform=Ge(),n.context=null,n.containerReused=!1,n.pixelContext_=null,n.frameState=null,n}return e.prototype.getImageData=function(t,n,i){mo||tb(),mo.clearRect(0,0,1,1);var a;try{mo.drawImage(t,n,i,1,1,0,0,1,1),a=mo.getImageData(0,0,1,1).data}catch{return null}return a},e.prototype.getBackground=function(t){var n=this.getLayer(),i=n.getBackground();return typeof i=="function"&&(i=i(t.viewState.resolution)),i||void 0},e.prototype.useContainer=function(t,n,i,a){var u=this.getLayer().getClassName(),p,g;if(t&&t.className===u&&t.style.opacity===""&&i===1&&(!a||t.style.backgroundColor&&Wi(Co(t.style.backgroundColor),Co(a)))){var v=t.firstElementChild;v instanceof HTMLCanvasElement&&(g=v.getContext("2d"))}if(g&&g.canvas.style.transform===n?(this.container=t,this.context=g,this.containerReused=!0):this.containerReused&&(this.container=null,this.context=null,this.containerReused=!1),!this.container){p=document.createElement("div"),p.className=u;var m=p.style;m.position="absolute",m.width="100%",m.height="100%",a&&(m.backgroundColor=a),g=je();var v=g.canvas;p.appendChild(v),m=v.style,m.position="absolute",m.left="0",m.transformOrigin="top left",this.container=p,this.context=g}},e.prototype.clipUnrotated=function(t,n,i){var a=Dr(i),u=wa(i),p=Ta(i),g=Ea(i);re(n.coordinateToPixelTransform,a),re(n.coordinateToPixelTransform,u),re(n.coordinateToPixelTransform,p),re(n.coordinateToPixelTransform,g);var v=this.inversePixelTransform;re(v,a),re(v,u),re(v,p),re(v,g),t.save(),t.beginPath(),t.moveTo(Math.round(a[0]),Math.round(a[1])),t.lineTo(Math.round(u[0]),Math.round(u[1])),t.lineTo(Math.round(p[0]),Math.round(p[1])),t.lineTo(Math.round(g[0]),Math.round(g[1])),t.clip()},e.prototype.dispatchRenderEvent_=function(t,n,i){var a=this.getLayer();if(a.hasListener(t)){var u=new wo(t,this.inversePixelTransform,i,n);a.dispatchEvent(u)}},e.prototype.preRender=function(t,n){this.frameState=n,this.dispatchRenderEvent_(Ne.PRERENDER,t,n)},e.prototype.postRender=function(t,n){this.dispatchRenderEvent_(Ne.POSTRENDER,t,n)},e.prototype.getRenderTransform=function(t,n,i,a,u,p,g){var v=u/2,m=p/2,E=a/n,b=-E,w=-t[0]+g,S=-t[1];return mn(this.tempTransform,v,m,E,b,-i,w,S)},e.prototype.getDataAtPixel=function(t,n,i){var a=re(this.inversePixelTransform,t.slice()),u=this.context,p=this.getLayer(),g=p.getExtent();if(g){var v=re(n.pixelToCoordinateTransform,t.slice());if(!Xi(g,v))return null}var m=Math.round(a[0]),E=Math.round(a[1]),b=this.pixelContext_;if(!b){var w=document.createElement("canvas");w.width=1,w.height=1,b=w.getContext("2d"),this.pixelContext_=b}b.clearRect(0,0,1,1);var S;try{b.drawImage(u.canvas,m,E,1,1,0,0,1,1),S=b.getImageData(0,0,1,1).data}catch(C){return C.name==="SecurityError"?(this.pixelContext_=null,new Uint8Array):S}return S[3]===0?null:S},e.prototype.disposeInternal=function(){delete this.frameState,o.prototype.disposeInternal.call(this)},e}(gp),nb=eb,Qt={CIRCLE:"Circle",DEFAULT:"Default",IMAGE:"Image",LINE_STRING:"LineString",POLYGON:"Polygon",TEXT:"Text"};function ib(o,e,t,n,i,a,u,p,g,v,m,E){var b=o[e],w=o[e+1],S=0,C=0,A=0,M=0;function I(){S=b,C=w,e+=n,b=o[e],w=o[e+1],M+=A,A=Math.sqrt((b-S)*(b-S)+(w-C)*(w-C))}do I();while(e<t-n&&M+A<a);for(var L=A===0?0:(a-M)/A,k=Ai(S,b,L),N=Ai(C,w,L),G=e-n,z=M,V=a+p*g(v,i,m);e<t-n&&M+A<V;)I();L=A===0?0:(V-M)/A;var Y=Ai(S,b,L),X=Ai(C,w,L),J;if(E){var q=[k,N,Y,X];Ih(q,0,4,2,E,q,q),J=q[0]>q[2]}else J=k>Y;var K=Math.PI,Q=[],tt=G+n===e;e=G,A=0,M=z,b=o[e],w=o[e+1];var nt;if(tt){I(),nt=Math.atan2(w-C,b-S),J&&(nt+=nt>0?-K:K);var ot=(Y+k)/2,at=(X+N)/2;return Q[0]=[ot,at,(V-a)/2,nt,i],Q}for(var ht=0,ut=i.length;ht<ut;){I();var Rt=Math.atan2(w-C,b-S);if(J&&(Rt+=Rt>0?-K:K),nt!==void 0){var W=Rt-nt;if(W+=W>K?-2*K:W<-K?2*K:0,Math.abs(W)>u)return null}nt=Rt;for(var Yt=ht,Ut=0;ht<ut;++ht){var Jt=J?ut-ht-1:ht,ne=p*g(v,i[Jt],m);if(e+n<t&&M+A<a+Ut+ne/2)break;Ut+=ne}if(ht!==Yt){var ze=J?i.substring(ut-Yt,ut-ht):i.substring(Yt,ht);L=A===0?0:(a+Ut/2-M)/A;var ot=Ai(S,b,L),at=Ai(C,w,L);Q.push([ot,at,Ut/2,Rt,ze]),a+=Ut}}return Q}var ur=xn(),Jn=[],In=[],An=[],Qn=[];function Uf(o){return o[3].declutterBox}var rb=new RegExp("["+String.fromCharCode(1425)+"-"+String.fromCharCode(2303)+String.fromCharCode(64285)+"-"+String.fromCharCode(65023)+String.fromCharCode(65136)+"-"+String.fromCharCode(65276)+String.fromCharCode(67584)+"-"+String.fromCharCode(69631)+String.fromCharCode(124928)+"-"+String.fromCharCode(126975)+"]");function Vf(o,e){return(e==="start"||e==="end")&&!rb.test(o)&&(e=e==="start"?"left":"right"),oa[e]}function ob(o,e,t){return t>0&&o.push(`
`,""),o.push(e,""),o}var sb=function(){function o(e,t,n,i){this.overlaps=n,this.pixelRatio=t,this.resolution=e,this.alignFill_,this.instructions=i.instructions,this.coordinates=i.coordinates,this.coordinateCache_={},this.renderedTransform_=Ge(),this.hitDetectionInstructions=i.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=i.fillStates||{},this.strokeStates=i.strokeStates||{},this.textStates=i.textStates||{},this.widths_={},this.labels_={}}return o.prototype.createLabel=function(e,t,n,i){var a=e+t+n+i;if(this.labels_[a])return this.labels_[a];var u=i?this.strokeStates[i]:null,p=n?this.fillStates[n]:null,g=this.textStates[t],v=this.pixelRatio,m=[g.scale[0]*v,g.scale[1]*v],E=Array.isArray(e),b=Vf(E?e[0]:e,g.textAlign||Mo),w=i&&u.lineWidth?u.lineWidth:0,S=E?e:e.split(`
`).reduce(ob,[]),C=ox(g,S),A=C.width,M=C.height,I=C.widths,L=C.heights,k=C.lineWidths,N=A+w,G=[],z=(N+2)*m[0],V=(M+w)*m[1],Y={width:z<0?Math.floor(z):Math.ceil(z),height:V<0?Math.floor(V):Math.ceil(V),contextInstructions:G};if((m[0]!=1||m[1]!=1)&&G.push("scale",m),i){G.push("strokeStyle",u.strokeStyle),G.push("lineWidth",w),G.push("lineCap",u.lineCap),G.push("lineJoin",u.lineJoin),G.push("miterLimit",u.miterLimit);var X=ma?OffscreenCanvasRenderingContext2D:CanvasRenderingContext2D;X.prototype.setLineDash&&(G.push("setLineDash",[u.lineDash]),G.push("lineDashOffset",u.lineDashOffset))}n&&G.push("fillStyle",p.fillStyle),G.push("textBaseline","middle"),G.push("textAlign","center");for(var J=.5-b,q=b*N+J*w,K=[],Q=[],tt=0,nt=0,ot=0,at=0,ht,ut=0,Rt=S.length;ut<Rt;ut+=2){var W=S[ut];if(W===`
`){nt+=tt,tt=0,q=b*N+J*w,++at;continue}var Yt=S[ut+1]||g.font;Yt!==ht&&(i&&K.push("font",Yt),n&&Q.push("font",Yt),ht=Yt),tt=Math.max(tt,L[ot]);var Ut=[W,q+J*I[ot]+b*(I[ot]-k[at]),.5*(w+tt)+nt];q+=I[ot],i&&K.push("strokeText",Ut),n&&Q.push("fillText",Ut),++ot}return Array.prototype.push.apply(G,K),Array.prototype.push.apply(G,Q),this.labels_[a]=Y,Y},o.prototype.replayTextBackground_=function(e,t,n,i,a,u,p){e.beginPath(),e.moveTo.apply(e,t),e.lineTo.apply(e,n),e.lineTo.apply(e,i),e.lineTo.apply(e,a),e.lineTo.apply(e,t),u&&(this.alignFill_=u[2],this.fill_(e)),p&&(this.setStrokeStyle_(e,p),e.stroke())},o.prototype.calculateImageOrLabelDimensions_=function(e,t,n,i,a,u,p,g,v,m,E,b,w,S,C,A){p*=b[0],g*=b[1];var M=n-p,I=i-g,L=a+v>e?e-v:a,k=u+m>t?t-m:u,N=S[3]+L*b[0]+S[1],G=S[0]+k*b[1]+S[2],z=M-S[3],V=I-S[0];(C||E!==0)&&(Jn[0]=z,Qn[0]=z,Jn[1]=V,In[1]=V,In[0]=z+N,An[0]=In[0],An[1]=V+G,Qn[1]=An[1]);var Y;return E!==0?(Y=mn(Ge(),n,i,1,1,E,-n,-i),re(Y,Jn),re(Y,In),re(Y,An),re(Y,Qn),bn(Math.min(Jn[0],In[0],An[0],Qn[0]),Math.min(Jn[1],In[1],An[1],Qn[1]),Math.max(Jn[0],In[0],An[0],Qn[0]),Math.max(Jn[1],In[1],An[1],Qn[1]),ur)):bn(Math.min(z,z+N),Math.min(V,V+G),Math.max(z,z+N),Math.max(V,V+G),ur),w&&(M=Math.round(M),I=Math.round(I)),{drawImageX:M,drawImageY:I,drawImageW:L,drawImageH:k,originX:v,originY:m,declutterBox:{minX:ur[0],minY:ur[1],maxX:ur[2],maxY:ur[3],value:A},canvasTransform:Y,scale:b}},o.prototype.replayImageOrLabel_=function(e,t,n,i,a,u,p){var g=!!(u||p),v=i.declutterBox,m=e.canvas,E=p?p[2]*i.scale[0]/2:0,b=v.minX-E<=m.width/t&&v.maxX+E>=0&&v.minY-E<=m.height/t&&v.maxY+E>=0;return b&&(g&&this.replayTextBackground_(e,Jn,In,An,Qn,u,p),sx(e,i.canvasTransform,a,n,i.originX,i.originY,i.drawImageW,i.drawImageH,i.drawImageX,i.drawImageY,i.scale)),!0},o.prototype.fill_=function(e){if(this.alignFill_){var t=re(this.renderedTransform_,[0,0]),n=512*this.pixelRatio;e.save(),e.translate(t[0]%n,t[1]%n),e.rotate(this.viewRotation_)}e.fill(),this.alignFill_&&e.restore()},o.prototype.setStrokeStyle_=function(e,t){e.strokeStyle=t[1],e.lineWidth=t[2],e.lineCap=t[3],e.lineJoin=t[4],e.miterLimit=t[5],e.setLineDash&&(e.lineDashOffset=t[7],e.setLineDash(t[6]))},o.prototype.drawLabelWithPointPlacement_=function(e,t,n,i){var a=this.textStates[t],u=this.createLabel(e,t,i,n),p=this.strokeStates[n],g=this.pixelRatio,v=Vf(Array.isArray(e)?e[0]:e,a.textAlign||Mo),m=oa[a.textBaseline||na],E=p&&p.lineWidth?p.lineWidth:0,b=u.width/g-2*a.scale[0],w=v*b+2*(.5-v)*E,S=m*u.height/g+2*(.5-m)*E;return{label:u,anchorX:w,anchorY:S}},o.prototype.execute_=function(e,t,n,i,a,u,p,g){var v;this.pixelCoordinates_&&Wi(n,this.renderedTransform_)?v=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),v=Ui(this.coordinates,0,this.coordinates.length,2,n,this.pixelCoordinates_),Sm(this.renderedTransform_,n));for(var m=0,E=i.length,b=0,w,S,C,A,M,I,L,k,N,G,z,V,Y=0,X=0,J=null,q=null,K=this.coordinateCache_,Q=this.viewRotation_,tt=Math.round(Math.atan2(-n[1],n[0])*1e12)/1e12,nt={context:e,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:Q},ot=this.instructions!=i||this.overlaps?0:200,at,ht,ut,Rt;m<E;){var W=i[m],Yt=W[0];switch(Yt){case ft.BEGIN_GEOMETRY:at=W[1],Rt=W[3],at.getGeometry()?p!==void 0&&!ke(p,Rt.getExtent())?m=W[2]+1:++m:m=W[2];break;case ft.BEGIN_PATH:Y>ot&&(this.fill_(e),Y=0),X>ot&&(e.stroke(),X=0),!Y&&!X&&(e.beginPath(),A=NaN,M=NaN),++m;break;case ft.CIRCLE:b=W[1];var Ut=v[b],Jt=v[b+1],ne=v[b+2],ze=v[b+3],ie=ne-Ut,ue=ze-Jt,wn=Math.sqrt(ie*ie+ue*ue);e.moveTo(Ut+wn,Jt),e.arc(Ut,Jt,wn,0,2*Math.PI,!0),++m;break;case ft.CLOSE_PATH:e.closePath(),++m;break;case ft.CUSTOM:b=W[1],w=W[2];var Yi=W[3],Gn=W[4],ui=W.length==6?W[5]:void 0;nt.geometry=Yi,nt.feature=at,m in K||(K[m]=[]);var We=K[m];ui?ui(v,b,w,2,We):(We[0]=v[b],We[1]=v[b+1],We.length=2),Gn(We,nt),++m;break;case ft.DRAW_IMAGE:b=W[1],w=W[2],k=W[3],S=W[4],C=W[5];var zn=W[6],fi=W[7],di=W[8],pi=W[9],Te=W[10],$i=W[11],It=W[12],Dt=W[13],vt=W[14];if(!k&&W.length>=19){N=W[18],G=W[19],z=W[20],V=W[21];var jt=this.drawLabelWithPointPlacement_(N,G,z,V);k=jt.label,W[3]=k;var we=W[22];S=(jt.anchorX-we)*this.pixelRatio,W[4]=S;var gt=W[23];C=(jt.anchorY-gt)*this.pixelRatio,W[5]=C,zn=k.height,W[6]=zn,Dt=k.width,W[13]=Dt}var Ki=void 0;W.length>24&&(Ki=W[24]);var gi=void 0,kt=void 0,At=void 0;W.length>16?(gi=W[15],kt=W[16],At=W[17]):(gi=Fi,kt=!1,At=!1),Te&&tt?$i+=Q:!Te&&!tt&&($i-=Q);for(var _i=0;b<w;b+=2)if(!(Ki&&Ki[_i++]<Dt/this.pixelRatio)){var Se=this.calculateImageOrLabelDimensions_(k.width,k.height,v[b],v[b+1],Dt,zn,S,C,di,pi,$i,It,a,gi,kt||At,at),Gr=[e,t,k,Se,fi,kt?J:null,At?q:null],vi=void 0,sn=void 0;if(g&&vt){var Je=w-b;if(!vt[Je]){vt[Je]=Gr;continue}if(vi=vt[Je],delete vt[Je],sn=Uf(vi),g.collides(sn))continue}g&&g.collides(Se.declutterBox)||(vi&&(g&&g.insert(sn),this.replayImageOrLabel_.apply(this,vi)),g&&g.insert(Se.declutterBox),this.replayImageOrLabel_.apply(this,Gr))}++m;break;case ft.DRAW_CHARS:var zr=W[1],Uo=W[2],Ur=W[3],Da=W[4];V=W[5];var Vo=W[6],Qe=W[7],yi=W[8];z=W[9];var _e=W[10];N=W[11],G=W[12];var He=[W[13],W[13]],mi=this.textStates[G],Un=mi.font,Ue=[mi.scale[0]*Qe,mi.scale[1]*Qe],Sn=void 0;Un in this.widths_?Sn=this.widths_[Un]:(Sn={},this.widths_[Un]=Sn);var Vn=F0(v,zr,Uo,2),Zi=Math.abs(Ue[0])*Df(Un,N,Sn);if(Da||Zi<=Vn){var ka=this.textStates[G].textAlign,Et=(Vn-Zi)*oa[ka],Nt=ib(v,zr,Uo,2,N,Et,Vo,Math.abs(Ue[0]),Df,Un,Sn,tt?0:this.viewRotation_);t:if(Nt){var Pt=[],tn=void 0,an=void 0,xi=void 0,bt=void 0,fe=void 0;if(z)for(tn=0,an=Nt.length;tn<an;++tn){fe=Nt[tn],xi=fe[4],bt=this.createLabel(xi,G,"",z),S=fe[2]+(Ue[0]<0?-_e:_e),C=Ur*bt.height+(.5-Ur)*2*_e*Ue[1]/Ue[0]-yi;var Se=this.calculateImageOrLabelDimensions_(bt.width,bt.height,fe[0],fe[1],bt.width,bt.height,S,C,0,0,fe[3],He,!1,Fi,!1,at);if(g&&g.collides(Se.declutterBox))break t;Pt.push([e,t,bt,Se,1,null,null])}if(V)for(tn=0,an=Nt.length;tn<an;++tn){fe=Nt[tn],xi=fe[4],bt=this.createLabel(xi,G,V,""),S=fe[2],C=Ur*bt.height-yi;var Se=this.calculateImageOrLabelDimensions_(bt.width,bt.height,fe[0],fe[1],bt.width,bt.height,S,C,0,0,fe[3],He,!1,Fi,!1,at);if(g&&g.collides(Se.declutterBox))break t;Pt.push([e,t,bt,Se,1,null,null])}g&&g.load(Pt.map(Uf));for(var bi=0,Re=Pt.length;bi<Re;++bi)this.replayImageOrLabel_.apply(this,Pt[bi])}}++m;break;case ft.END_GEOMETRY:if(u!==void 0){at=W[1];var Ae=u(at,Rt);if(Ae)return Ae}++m;break;case ft.FILL:ot?Y++:this.fill_(e),++m;break;case ft.MOVE_TO_LINE_TO:for(b=W[1],w=W[2],ht=v[b],ut=v[b+1],I=ht+.5|0,L=ut+.5|0,(I!==A||L!==M)&&(e.moveTo(ht,ut),A=I,M=L),b+=2;b<w;b+=2)ht=v[b],ut=v[b+1],I=ht+.5|0,L=ut+.5|0,(b==w-2||I!==A||L!==M)&&(e.lineTo(ht,ut),A=I,M=L);++m;break;case ft.SET_FILL_STYLE:J=W,this.alignFill_=W[2],Y&&(this.fill_(e),Y=0,X&&(e.stroke(),X=0)),e.fillStyle=W[1],++m;break;case ft.SET_STROKE_STYLE:q=W,X&&(e.stroke(),X=0),this.setStrokeStyle_(e,W),++m;break;case ft.STROKE:ot?X++:e.stroke(),++m;break;default:++m;break}}Y&&this.fill_(e),X&&e.stroke()},o.prototype.execute=function(e,t,n,i,a,u){this.viewRotation_=i,this.execute_(e,t,n,this.instructions,a,void 0,void 0,u)},o.prototype.executeHitDetection=function(e,t,n,i,a){return this.viewRotation_=n,this.execute_(e,1,t,this.hitDetectionInstructions,!0,i,a)},o}(),ab=sb,Fl=[Qt.POLYGON,Qt.CIRCLE,Qt.LINE_STRING,Qt.IMAGE,Qt.TEXT,Qt.DEFAULT],lb=function(){function o(e,t,n,i,a,u){this.maxExtent_=e,this.overlaps_=i,this.pixelRatio_=n,this.resolution_=t,this.renderBuffer_=u,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=Ge(),this.createExecutors_(a)}return o.prototype.clip=function(e,t){var n=this.getClipCoords(t);e.beginPath(),e.moveTo(n[0],n[1]),e.lineTo(n[2],n[3]),e.lineTo(n[4],n[5]),e.lineTo(n[6],n[7]),e.clip()},o.prototype.createExecutors_=function(e){for(var t in e){var n=this.executorsByZIndex_[t];n===void 0&&(n={},this.executorsByZIndex_[t]=n);var i=e[t];for(var a in i){var u=i[a];n[a]=new ab(this.resolution_,this.pixelRatio_,this.overlaps_,u)}}},o.prototype.hasExecutors=function(e){for(var t in this.executorsByZIndex_)for(var n=this.executorsByZIndex_[t],i=0,a=e.length;i<a;++i)if(e[i]in n)return!0;return!1},o.prototype.forEachFeatureAtCoordinate=function(e,t,n,i,a,u){i=Math.round(i);var p=i*2+1,g=mn(this.hitDetectionTransform_,i+.5,i+.5,1/t,-1/t,-n,-e[0],-e[1]),v=!this.hitDetectionContext_;v&&(this.hitDetectionContext_=je(p,p));var m=this.hitDetectionContext_;m.canvas.width!==p||m.canvas.height!==p?(m.canvas.width=p,m.canvas.height=p):v||m.clearRect(0,0,p,p);var E;this.renderBuffer_!==void 0&&(E=xn(),Eo(E,e),Eh(E,t*(this.renderBuffer_+i),E));var b=hb(i),w;function S(G,z){for(var V=m.getImageData(0,0,p,p).data,Y=0,X=b.length;Y<X;Y++)if(V[b[Y]]>0){if(!u||w!==Qt.IMAGE&&w!==Qt.TEXT||u.indexOf(G)!==-1){var J=(b[Y]-3)/4,q=i-J%p,K=i-(J/p|0),Q=a(G,z,q*q+K*K);if(Q)return Q}m.clearRect(0,0,p,p);break}}var C=Object.keys(this.executorsByZIndex_).map(Number);C.sort(Ar);var A,M,I,L,k;for(A=C.length-1;A>=0;--A){var N=C[A].toString();for(I=this.executorsByZIndex_[N],M=Fl.length-1;M>=0;--M)if(w=Fl[M],L=I[w],L!==void 0&&(k=L.executeHitDetection(m,g,n,S,E),k))return k}},o.prototype.getClipCoords=function(e){var t=this.maxExtent_;if(!t)return null;var n=t[0],i=t[1],a=t[2],u=t[3],p=[n,i,n,u,a,u,a,i];return Ui(p,0,8,2,e,p),p},o.prototype.isEmpty=function(){return Ro(this.executorsByZIndex_)},o.prototype.execute=function(e,t,n,i,a,u,p){var g=Object.keys(this.executorsByZIndex_).map(Number);g.sort(Ar),this.maxExtent_&&(e.save(),this.clip(e,n));var v=u||Fl,m,E,b,w,S,C;for(p&&g.reverse(),m=0,E=g.length;m<E;++m){var A=g[m].toString();for(S=this.executorsByZIndex_[A],b=0,w=v.length;b<w;++b){var M=v[b];C=S[M],C!==void 0&&C.execute(e,t,n,i,a,p)}}this.maxExtent_&&e.restore()},o}(),Nl={};function hb(o){if(Nl[o]!==void 0)return Nl[o];for(var e=o*2+1,t=o*o,n=new Array(t+1),i=0;i<=o;++i)for(var a=0;a<=o;++a){var u=i*i+a*a;if(u>t)break;var p=n[u];p||(p=[],n[u]=p),p.push(((o+i)*e+(o+a))*4+3),i>0&&p.push(((o-i)*e+(o+a))*4+3),a>0&&(p.push(((o+i)*e+(o-a))*4+3),i>0&&p.push(((o-i)*e+(o-a))*4+3))}for(var g=[],i=0,v=n.length;i<v;++i)n[i]&&g.push.apply(g,n[i]);return Nl[o]=g,g}var Xf=lb,Ee={ANIMATING:0,INTERACTING:1},cb=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),ub=function(o){cb(e,o);function e(t,n,i,a,u,p,g){var v=o.call(this)||this;return v.context_=t,v.pixelRatio_=n,v.extent_=i,v.transform_=a,v.viewRotation_=u,v.squaredTolerance_=p,v.userTransform_=g,v.contextFillState_=null,v.contextStrokeState_=null,v.contextTextState_=null,v.fillState_=null,v.strokeState_=null,v.image_=null,v.imageAnchorX_=0,v.imageAnchorY_=0,v.imageHeight_=0,v.imageOpacity_=0,v.imageOriginX_=0,v.imageOriginY_=0,v.imageRotateWithView_=!1,v.imageRotation_=0,v.imageScale_=[0,0],v.imageWidth_=0,v.text_="",v.textOffsetX_=0,v.textOffsetY_=0,v.textRotateWithView_=!1,v.textRotation_=0,v.textScale_=[0,0],v.textFillState_=null,v.textStrokeState_=null,v.textState_=null,v.pixelCoordinates_=[],v.tmpLocalTransform_=Ge(),v}return e.prototype.drawImages_=function(t,n,i,a){if(!!this.image_){var u=Ui(t,n,i,a,this.transform_,this.pixelCoordinates_),p=this.context_,g=this.tmpLocalTransform_,v=p.globalAlpha;this.imageOpacity_!=1&&(p.globalAlpha=v*this.imageOpacity_);var m=this.imageRotation_;this.imageRotateWithView_&&(m+=this.viewRotation_);for(var E=0,b=u.length;E<b;E+=2){var w=u[E]-this.imageAnchorX_,S=u[E+1]-this.imageAnchorY_;if(m!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){var C=w+this.imageAnchorX_,A=S+this.imageAnchorY_;mn(g,C,A,1,1,m,-C,-A),p.setTransform.apply(p,g),p.translate(C,A),p.scale(this.imageScale_[0],this.imageScale_[1]),p.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),p.setTransform(1,0,0,1,0,0)}else p.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,w,S,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(p.globalAlpha=v)}},e.prototype.drawText_=function(t,n,i,a){if(!(!this.textState_||this.text_==="")){this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);var u=Ui(t,n,i,a,this.transform_,this.pixelCoordinates_),p=this.context_,g=this.textRotation_;for(this.textRotateWithView_&&(g+=this.viewRotation_);n<i;n+=a){var v=u[n]+this.textOffsetX_,m=u[n+1]+this.textOffsetY_;if(g!==0||this.textScale_[0]!=1||this.textScale_[1]!=1){var E=mn(this.tmpLocalTransform_,v,m,1,1,g,-v,-m);p.setTransform.apply(p,E),p.translate(v,m),p.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&p.strokeText(this.text_,0,0),this.textFillState_&&p.fillText(this.text_,0,0),p.setTransform(1,0,0,1,0,0)}else this.textStrokeState_&&p.strokeText(this.text_,v,m),this.textFillState_&&p.fillText(this.text_,v,m)}}},e.prototype.moveToLineTo_=function(t,n,i,a,u){var p=this.context_,g=Ui(t,n,i,a,this.transform_,this.pixelCoordinates_);p.moveTo(g[0],g[1]);var v=g.length;u&&(v-=2);for(var m=2;m<v;m+=2)p.lineTo(g[m],g[m+1]);return u&&p.closePath(),i},e.prototype.drawRings_=function(t,n,i,a){for(var u=0,p=i.length;u<p;++u)n=this.moveToLineTo_(t,n,i[u],a,!0);return n},e.prototype.drawCircle=function(t){if(!!ke(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var n=x0(t,this.transform_,this.pixelCoordinates_),i=n[2]-n[0],a=n[3]-n[1],u=Math.sqrt(i*i+a*a),p=this.context_;p.beginPath(),p.arc(n[0],n[1],u,0,2*Math.PI),this.fillState_&&p.fill(),this.strokeState_&&p.stroke()}this.text_!==""&&this.drawText_(t.getCenter(),0,2,2)}},e.prototype.setStyle=function(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())},e.prototype.setTransform=function(t){this.transform_=t},e.prototype.drawGeometry=function(t){var n=t.getType();switch(n){case mt.POINT:this.drawPoint(t);break;case mt.LINE_STRING:this.drawLineString(t);break;case mt.POLYGON:this.drawPolygon(t);break;case mt.MULTI_POINT:this.drawMultiPoint(t);break;case mt.MULTI_LINE_STRING:this.drawMultiLineString(t);break;case mt.MULTI_POLYGON:this.drawMultiPolygon(t);break;case mt.GEOMETRY_COLLECTION:this.drawGeometryCollection(t);break;case mt.CIRCLE:this.drawCircle(t);break}},e.prototype.drawFeature=function(t,n){var i=n.getGeometryFunction()(t);!i||!ke(this.extent_,i.getExtent())||(this.setStyle(n),this.drawGeometry(i))},e.prototype.drawGeometryCollection=function(t){for(var n=t.getGeometriesArray(),i=0,a=n.length;i<a;++i)this.drawGeometry(n[i])},e.prototype.drawPoint=function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var n=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(n,0,n.length,i),this.text_!==""&&this.drawText_(n,0,n.length,i)},e.prototype.drawMultiPoint=function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var n=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(n,0,n.length,i),this.text_!==""&&this.drawText_(n,0,n.length,i)},e.prototype.drawLineString=function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!ke(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var n=this.context_,i=t.getFlatCoordinates();n.beginPath(),this.moveToLineTo_(i,0,i.length,t.getStride(),!1),n.stroke()}if(this.text_!==""){var a=t.getFlatMidpoint();this.drawText_(a,0,2,2)}}},e.prototype.drawMultiLineString=function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var n=t.getExtent();if(!!ke(this.extent_,n)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var i=this.context_,a=t.getFlatCoordinates(),u=0,p=t.getEnds(),g=t.getStride();i.beginPath();for(var v=0,m=p.length;v<m;++v)u=this.moveToLineTo_(a,u,p[v],g,!1);i.stroke()}if(this.text_!==""){var E=t.getFlatMidpoints();this.drawText_(E,0,E.length,2)}}},e.prototype.drawPolygon=function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!ke(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var n=this.context_;n.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&n.fill(),this.strokeState_&&n.stroke()}if(this.text_!==""){var i=t.getFlatInteriorPoint();this.drawText_(i,0,2,2)}}},e.prototype.drawMultiPolygon=function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!ke(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var n=this.context_,i=t.getOrientedFlatCoordinates(),a=0,u=t.getEndss(),p=t.getStride();n.beginPath();for(var g=0,v=u.length;g<v;++g){var m=u[g];a=this.drawRings_(i,a,m,p)}this.fillState_&&n.fill(),this.strokeState_&&n.stroke()}if(this.text_!==""){var E=t.getFlatInteriorPoints();this.drawText_(E,0,E.length,2)}}},e.prototype.setContextFillState_=function(t){var n=this.context_,i=this.contextFillState_;i?i.fillStyle!=t.fillStyle&&(i.fillStyle=t.fillStyle,n.fillStyle=t.fillStyle):(n.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})},e.prototype.setContextStrokeState_=function(t){var n=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=t.lineCap&&(i.lineCap=t.lineCap,n.lineCap=t.lineCap),n.setLineDash&&(Wi(i.lineDash,t.lineDash)||n.setLineDash(i.lineDash=t.lineDash),i.lineDashOffset!=t.lineDashOffset&&(i.lineDashOffset=t.lineDashOffset,n.lineDashOffset=t.lineDashOffset)),i.lineJoin!=t.lineJoin&&(i.lineJoin=t.lineJoin,n.lineJoin=t.lineJoin),i.lineWidth!=t.lineWidth&&(i.lineWidth=t.lineWidth,n.lineWidth=t.lineWidth),i.miterLimit!=t.miterLimit&&(i.miterLimit=t.miterLimit,n.miterLimit=t.miterLimit),i.strokeStyle!=t.strokeStyle&&(i.strokeStyle=t.strokeStyle,n.strokeStyle=t.strokeStyle)):(n.lineCap=t.lineCap,n.setLineDash&&(n.setLineDash(t.lineDash),n.lineDashOffset=t.lineDashOffset),n.lineJoin=t.lineJoin,n.lineWidth=t.lineWidth,n.miterLimit=t.miterLimit,n.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})},e.prototype.setContextTextState_=function(t){var n=this.context_,i=this.contextTextState_,a=t.textAlign?t.textAlign:Mo;i?(i.font!=t.font&&(i.font=t.font,n.font=t.font),i.textAlign!=a&&(i.textAlign=a,n.textAlign=a),i.textBaseline!=t.textBaseline&&(i.textBaseline=t.textBaseline,n.textBaseline=t.textBaseline)):(n.font=t.font,n.textAlign=a,n.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:a,textBaseline:t.textBaseline})},e.prototype.setFillStrokeStyle=function(t,n){var i=this;if(!t)this.fillState_=null;else{var a=t.getColor();this.fillState_={fillStyle:vn(a||Nn)}}if(!n)this.strokeState_=null;else{var u=n.getColor(),p=n.getLineCap(),g=n.getLineDash(),v=n.getLineDashOffset(),m=n.getLineJoin(),E=n.getWidth(),b=n.getMiterLimit(),w=g||Oo;this.strokeState_={lineCap:p!==void 0?p:ea,lineDash:this.pixelRatio_===1?w:w.map(function(S){return S*i.pixelRatio_}),lineDashOffset:(v||Io)*this.pixelRatio_,lineJoin:m!==void 0?m:Pr,lineWidth:(E!==void 0?E:Lo)*this.pixelRatio_,miterLimit:b!==void 0?b:Ao,strokeStyle:vn(u||Po)}}},e.prototype.setImageStyle=function(t){var n;if(!t||!(n=t.getSize())){this.image_=null;return}var i=t.getAnchor(),a=t.getOrigin();this.image_=t.getImage(this.pixelRatio_),this.imageAnchorX_=i[0]*this.pixelRatio_,this.imageAnchorY_=i[1]*this.pixelRatio_,this.imageHeight_=n[1]*this.pixelRatio_,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=a[0],this.imageOriginY_=a[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation(),this.imageScale_=t.getScaleArray(),this.imageWidth_=n[0]*this.pixelRatio_},e.prototype.setTextStyle=function(t){if(!t)this.text_="";else{var n=t.getFill();if(!n)this.textFillState_=null;else{var i=n.getColor();this.textFillState_={fillStyle:vn(i||Nn)}}var a=t.getStroke();if(!a)this.textStrokeState_=null;else{var u=a.getColor(),p=a.getLineCap(),g=a.getLineDash(),v=a.getLineDashOffset(),m=a.getLineJoin(),E=a.getWidth(),b=a.getMiterLimit();this.textStrokeState_={lineCap:p!==void 0?p:ea,lineDash:g||Oo,lineDashOffset:v||Io,lineJoin:m!==void 0?m:Pr,lineWidth:E!==void 0?E:Lo,miterLimit:b!==void 0?b:Ao,strokeStyle:vn(u||Po)}}var w=t.getFont(),S=t.getOffsetX(),C=t.getOffsetY(),A=t.getRotateWithView(),M=t.getRotation(),I=t.getScaleArray(),L=t.getText(),k=t.getTextAlign(),N=t.getTextBaseline();this.textState_={font:w!==void 0?w:lp,textAlign:k!==void 0?k:Mo,textBaseline:N!==void 0?N:na},this.text_=L!==void 0?Array.isArray(L)?L.reduce(function(G,z,V){return G+=V%2?" ":z},""):L:"",this.textOffsetX_=S!==void 0?this.pixelRatio_*S:0,this.textOffsetY_=C!==void 0?this.pixelRatio_*C:0,this.textRotateWithView_=A!==void 0?A:!1,this.textRotation_=M!==void 0?M:0,this.textScale_=[this.pixelRatio_*I[0],this.pixelRatio_*I[1]]}},e}(pp),fb=ub,ri={FRACTION:"fraction",PIXELS:"pixels"},Ke={BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",TOP_LEFT:"top-left",TOP_RIGHT:"top-right"},db=function(){function o(){this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32}return o.prototype.clear=function(){this.cache_={},this.cacheSize_=0},o.prototype.canExpireCache=function(){return this.cacheSize_>this.maxCacheSize_},o.prototype.expire=function(){if(this.canExpireCache()){var e=0;for(var t in this.cache_){var n=this.cache_[t];(e++&3)===0&&!n.hasListener()&&(delete this.cache_[t],--this.cacheSize_)}}},o.prototype.get=function(e,t,n){var i=jf(e,t,n);return i in this.cache_?this.cache_[i]:null},o.prototype.set=function(e,t,n,i){var a=jf(e,t,n);this.cache_[a]=i,++this.cacheSize_},o.prototype.setSize=function(e){this.maxCacheSize_=e,this.expire()},o}();function jf(o,e,t){var n=t?ip(t):"null";return e+":"+o+":"+n}var sa=new db,pb=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),gb=function(o){pb(e,o);function e(t,n,i,a){var u=o.call(this)||this;return u.extent=t,u.pixelRatio_=i,u.resolution=n,u.state=a,u}return e.prototype.changed=function(){this.dispatchEvent(pt.CHANGE)},e.prototype.getExtent=function(){return this.extent},e.prototype.getImage=function(){return Ct()},e.prototype.getPixelRatio=function(){return this.pixelRatio_},e.prototype.getResolution=function(){return this.resolution},e.prototype.getState=function(){return this.state},e.prototype.load=function(){Ct()},e}(Hi),_b=gb,vb=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();(function(o){vb(e,o);function e(t,n,i,a,u,p){var g=o.call(this,t,n,i,Wt.IDLE)||this;return g.src_=a,g.image_=new Image,u!==null&&(g.image_.crossOrigin=u),g.unlisten_=null,g.state=Wt.IDLE,g.imageLoadFunction_=p,g}return e.prototype.getImage=function(){return this.image_},e.prototype.handleImageError_=function(){this.state=Wt.ERROR,this.unlistenImage_(),this.changed()},e.prototype.handleImageLoad_=function(){this.resolution===void 0&&(this.resolution=on(this.extent)/this.image_.height),this.state=Wt.LOADED,this.unlistenImage_(),this.changed()},e.prototype.load=function(){(this.state==Wt.IDLE||this.state==Wt.ERROR)&&(this.state=Wt.LOADING,this.changed(),this.imageLoadFunction_(this,this.src_),this.unlisten_=Ph(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))},e.prototype.setImage=function(t){this.image_=t,this.resolution=on(this.extent)/this.image_.height},e.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)},e})(_b);function Ph(o,e,t){var n=o,i=!0,a=!1,u=!1,p=[Ys(n,pt.LOAD,function(){u=!0,a||e()})];return n.src&&wm?(a=!0,n.decode().then(function(){i&&e()}).catch(function(g){i&&(u?e():t())})):p.push(Ys(n,pt.ERROR,t)),function(){i=!1,p.forEach(qt)}}var yb=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),fo=null,mb=function(o){yb(e,o);function e(t,n,i,a,u,p){var g=o.call(this)||this;return g.hitDetectionImage_=null,g.image_=t||new Image,a!==null&&(g.image_.crossOrigin=a),g.canvas_={},g.color_=p,g.unlisten_=null,g.imageState_=u,g.size_=i,g.src_=n,g.tainted_,g}return e.prototype.isTainted_=function(){if(this.tainted_===void 0&&this.imageState_===Wt.LOADED){fo||(fo=je(1,1)),fo.drawImage(this.image_,0,0);try{fo.getImageData(0,0,1,1),this.tainted_=!1}catch{fo=null,this.tainted_=!0}}return this.tainted_===!0},e.prototype.dispatchChangeEvent_=function(){this.dispatchEvent(pt.CHANGE)},e.prototype.handleImageError_=function(){this.imageState_=Wt.ERROR,this.unlistenImage_(),this.dispatchChangeEvent_()},e.prototype.handleImageLoad_=function(){this.imageState_=Wt.LOADED,this.size_?(this.image_.width=this.size_[0],this.image_.height=this.size_[1]):this.size_=[this.image_.width,this.image_.height],this.unlistenImage_(),this.dispatchChangeEvent_()},e.prototype.getImage=function(t){return this.replaceColor_(t),this.canvas_[t]?this.canvas_[t]:this.image_},e.prototype.getPixelRatio=function(t){return this.replaceColor_(t),this.canvas_[t]?t:1},e.prototype.getImageState=function(){return this.imageState_},e.prototype.getHitDetectionImage=function(){if(!this.hitDetectionImage_)if(this.isTainted_()){var t=this.size_[0],n=this.size_[1],i=je(t,n);i.fillRect(0,0,t,n),this.hitDetectionImage_=i.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_},e.prototype.getSize=function(){return this.size_},e.prototype.getSrc=function(){return this.src_},e.prototype.load=function(){if(this.imageState_==Wt.IDLE){this.imageState_=Wt.LOADING;try{this.image_.src=this.src_}catch{this.handleImageError_()}this.unlisten_=Ph(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this))}},e.prototype.replaceColor_=function(t){if(!(!this.color_||this.canvas_[t]||this.imageState_!==Wt.LOADED)){var n=document.createElement("canvas");this.canvas_[t]=n,n.width=Math.ceil(this.image_.width*t),n.height=Math.ceil(this.image_.height*t);var i=n.getContext("2d");if(i.scale(t,t),i.drawImage(this.image_,0,0),i.globalCompositeOperation="multiply",i.globalCompositeOperation==="multiply"||this.isTainted_())i.fillStyle=ip(this.color_),i.fillRect(0,0,n.width/t,n.height/t),i.globalCompositeOperation="destination-in",i.drawImage(this.image_,0,0);else{for(var a=i.getImageData(0,0,n.width,n.height),u=a.data,p=this.color_[0]/255,g=this.color_[1]/255,v=this.color_[2]/255,m=this.color_[3],E=0,b=u.length;E<b;E+=4)u[E]*=p,u[E+1]*=g,u[E+2]*=v,u[E+3]*=m;i.putImageData(a,0,0)}}},e.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)},e}(Hi);function xb(o,e,t,n,i,a){var u=sa.get(e,n,a);return u||(u=new mb(o,e,t,n,i,a),sa.set(e,n,a,u)),u}var bb=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Eb=function(o){bb(e,o);function e(t){var n=this,i=t||{},a=i.opacity!==void 0?i.opacity:1,u=i.rotation!==void 0?i.rotation:0,p=i.scale!==void 0?i.scale:1,g=i.rotateWithView!==void 0?i.rotateWithView:!1;n=o.call(this,{opacity:a,rotation:u,scale:p,displacement:i.displacement!==void 0?i.displacement:[0,0],rotateWithView:g})||this,n.anchor_=i.anchor!==void 0?i.anchor:[.5,.5],n.normalizedAnchor_=null,n.anchorOrigin_=i.anchorOrigin!==void 0?i.anchorOrigin:Ke.TOP_LEFT,n.anchorXUnits_=i.anchorXUnits!==void 0?i.anchorXUnits:ri.FRACTION,n.anchorYUnits_=i.anchorYUnits!==void 0?i.anchorYUnits:ri.FRACTION,n.crossOrigin_=i.crossOrigin!==void 0?i.crossOrigin:null;var v=i.img!==void 0?i.img:null;n.imgSize_=i.imgSize;var m=i.src;Ot(!(m!==void 0&&v),4),Ot(!v||v&&n.imgSize_,5),(m===void 0||m.length===0)&&v&&(m=v.src||Xt(v)),Ot(m!==void 0&&m.length>0,6);var E=i.src!==void 0?Wt.IDLE:Wt.LOADED;return n.color_=i.color!==void 0?Co(i.color):null,n.iconImage_=xb(v,m,n.imgSize_!==void 0?n.imgSize_:null,n.crossOrigin_,E,n.color_),n.offset_=i.offset!==void 0?i.offset:[0,0],n.offsetOrigin_=i.offsetOrigin!==void 0?i.offsetOrigin:Ke.TOP_LEFT,n.origin_=null,n.size_=i.size!==void 0?i.size:null,n}return e.prototype.clone=function(){var t=this.getScale();return new e({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,imgSize:this.imgSize_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:Array.isArray(t)?t.slice():t,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc()})},e.prototype.getAnchor=function(){var t=this.normalizedAnchor_;if(!t){t=this.anchor_;var n=this.getSize();if(this.anchorXUnits_==ri.FRACTION||this.anchorYUnits_==ri.FRACTION){if(!n)return null;t=this.anchor_.slice(),this.anchorXUnits_==ri.FRACTION&&(t[0]*=n[0]),this.anchorYUnits_==ri.FRACTION&&(t[1]*=n[1])}if(this.anchorOrigin_!=Ke.TOP_LEFT){if(!n)return null;t===this.anchor_&&(t=this.anchor_.slice()),(this.anchorOrigin_==Ke.TOP_RIGHT||this.anchorOrigin_==Ke.BOTTOM_RIGHT)&&(t[0]=-t[0]+n[0]),(this.anchorOrigin_==Ke.BOTTOM_LEFT||this.anchorOrigin_==Ke.BOTTOM_RIGHT)&&(t[1]=-t[1]+n[1])}this.normalizedAnchor_=t}var i=this.getDisplacement();return[t[0]-i[0],t[1]+i[1]]},e.prototype.setAnchor=function(t){this.anchor_=t,this.normalizedAnchor_=null},e.prototype.getColor=function(){return this.color_},e.prototype.getImage=function(t){return this.iconImage_.getImage(t)},e.prototype.getPixelRatio=function(t){return this.iconImage_.getPixelRatio(t)},e.prototype.getImageSize=function(){return this.iconImage_.getSize()},e.prototype.getImageState=function(){return this.iconImage_.getImageState()},e.prototype.getHitDetectionImage=function(){return this.iconImage_.getHitDetectionImage()},e.prototype.getOrigin=function(){if(this.origin_)return this.origin_;var t=this.offset_;if(this.offsetOrigin_!=Ke.TOP_LEFT){var n=this.getSize(),i=this.iconImage_.getSize();if(!n||!i)return null;t=t.slice(),(this.offsetOrigin_==Ke.TOP_RIGHT||this.offsetOrigin_==Ke.BOTTOM_RIGHT)&&(t[0]=i[0]-n[0]-t[0]),(this.offsetOrigin_==Ke.BOTTOM_LEFT||this.offsetOrigin_==Ke.BOTTOM_RIGHT)&&(t[1]=i[1]-n[1]-t[1])}return this.origin_=t,this.origin_},e.prototype.getSrc=function(){return this.iconImage_.getSrc()},e.prototype.getSize=function(){return this.size_?this.size_:this.iconImage_.getSize()},e.prototype.listenImageChange=function(t){this.iconImage_.addEventListener(pt.CHANGE,t)},e.prototype.load=function(){this.iconImage_.load()},e.prototype.unlistenImageChange=function(t){this.iconImage_.removeEventListener(pt.CHANGE,t)},e}(tp),Tb=Eb,_n=.5;function wb(o,e,t,n,i,a,u){var p=o[0]*_n,g=o[1]*_n,v=je(p,g);v.imageSmoothingEnabled=!1;for(var m=v.canvas,E=new fb(v,_n,i,null,u),b=t.length,w=Math.floor((256*256*256-1)/b),S={},C=1;C<=b;++C){var A=t[C-1],M=A.getStyleFunction()||n;if(!!n){var I=M(A,a);if(!!I){Array.isArray(I)||(I=[I]);for(var L=C*w,k="#"+("000000"+L.toString(16)).slice(-6),N=0,G=I.length;N<G;++N){var z=I[N],V=z.getGeometryFunction()(A);if(!(!V||!ke(i,V.getExtent()))){var Y=z.clone(),X=Y.getFill();X&&X.setColor(k);var J=Y.getStroke();J&&(J.setColor(k),J.setLineDash(null)),Y.setText(void 0);var q=z.getImage();if(q&&q.getOpacity()!==0){var K=q.getImageSize();if(!K)continue;var Q=je(K[0],K[1],void 0,{alpha:!1}),tt=Q.canvas;Q.fillStyle=k,Q.fillRect(0,0,tt.width,tt.height),Y.setImage(new Tb({img:tt,imgSize:K,anchor:q.getAnchor(),anchorXUnits:ri.PIXELS,anchorYUnits:ri.PIXELS,offset:q.getOrigin(),opacity:1,size:q.getSize(),scale:q.getScale(),rotation:q.getRotation(),rotateWithView:q.getRotateWithView()}))}var nt=Y.getZIndex()||0,ot=S[nt];ot||(ot={},S[nt]=ot,ot[mt.POLYGON]=[],ot[mt.CIRCLE]=[],ot[mt.LINE_STRING]=[],ot[mt.POINT]=[]),ot[V.getType().replace("Multi","")].push(V,Y)}}}}}for(var at=Object.keys(S).map(Number).sort(Ar),C=0,ht=at.length;C<ht;++C){var ot=S[at[C]];for(var ut in ot)for(var Rt=ot[ut],N=0,G=Rt.length;N<G;N+=2){E.setStyle(Rt[N+1]);for(var W=0,Yt=e.length;W<Yt;++W)E.setTransform(e[W]),E.drawGeometry(Rt[N])}}return v.getImageData(0,0,m.width,m.height)}function Sb(o,e,t){var n=[];if(t){var i=Math.floor(Math.round(o[0])*_n),a=Math.floor(Math.round(o[1])*_n),u=(ae(i,0,t.width-1)+ae(a,0,t.height-1)*t.width)*4,p=t.data[u],g=t.data[u+1],v=t.data[u+2],m=v+256*(g+256*p),E=Math.floor((256*256*256-1)/e.length);m&&m%E===0&&n.push(e[m/E-1])}return n}var Rb=.5,_p={Point:kb,LineString:Mb,Polygon:Nb,MultiPoint:Fb,MultiLineString:Lb,MultiPolygon:Db,GeometryCollection:Pb,Circle:Ib};function Cb(o,e){return parseInt(Xt(o),10)-parseInt(Xt(e),10)}function Ob(o,e){var t=dh(o,e);return t*t}function dh(o,e){return Rb*o/e}function Ib(o,e,t,n,i){var a=t.getFill(),u=t.getStroke();if(a||u){var p=o.getBuilder(t.getZIndex(),Qt.CIRCLE);p.setFillStrokeStyle(a,u),p.drawCircle(e,n)}var g=t.getText();if(g&&g.getText()){var v=(i||o).getBuilder(t.getZIndex(),Qt.TEXT);v.setTextStyle(g),v.drawText(e,n)}}function Wf(o,e,t,n,i,a,u){var p=!1,g=t.getImage();if(g){var v=g.getImageState();v==Wt.LOADED||v==Wt.ERROR?g.unlistenImageChange(i):(v==Wt.IDLE&&g.load(),v=g.getImageState(),g.listenImageChange(i),p=!0)}return Ab(o,e,t,n,a,u),p}function Ab(o,e,t,n,i,a){var u=t.getGeometryFunction()(e);if(!!u){var p=u.simplifyTransformed(n,i),g=t.getRenderer();if(g)vp(o,p,t,e);else{var v=_p[p.getType()];v(o,p,t,e,a)}}}function vp(o,e,t,n){if(e.getType()==mt.GEOMETRY_COLLECTION){for(var i=e.getGeometries(),a=0,u=i.length;a<u;++a)vp(o,i[a],t,n);return}var p=o.getBuilder(t.getZIndex(),Qt.DEFAULT);p.drawCustom(e,n,t.getRenderer(),t.getHitDetectionRenderer())}function Pb(o,e,t,n,i){var a=e.getGeometriesArray(),u,p;for(u=0,p=a.length;u<p;++u){var g=_p[a[u].getType()];g(o,a[u],t,n,i)}}function Mb(o,e,t,n,i){var a=t.getStroke();if(a){var u=o.getBuilder(t.getZIndex(),Qt.LINE_STRING);u.setFillStrokeStyle(null,a),u.drawLineString(e,n)}var p=t.getText();if(p&&p.getText()){var g=(i||o).getBuilder(t.getZIndex(),Qt.TEXT);g.setTextStyle(p),g.drawText(e,n)}}function Lb(o,e,t,n,i){var a=t.getStroke();if(a){var u=o.getBuilder(t.getZIndex(),Qt.LINE_STRING);u.setFillStrokeStyle(null,a),u.drawMultiLineString(e,n)}var p=t.getText();if(p&&p.getText()){var g=(i||o).getBuilder(t.getZIndex(),Qt.TEXT);g.setTextStyle(p),g.drawText(e,n)}}function Db(o,e,t,n,i){var a=t.getFill(),u=t.getStroke();if(u||a){var p=o.getBuilder(t.getZIndex(),Qt.POLYGON);p.setFillStrokeStyle(a,u),p.drawMultiPolygon(e,n)}var g=t.getText();if(g&&g.getText()){var v=(i||o).getBuilder(t.getZIndex(),Qt.TEXT);v.setTextStyle(g),v.drawText(e,n)}}function kb(o,e,t,n,i){var a=t.getImage(),u=t.getText(),p;if(i&&(o=i,p=a&&u&&u.getText()?{}:void 0),a){if(a.getImageState()!=Wt.LOADED)return;var g=o.getBuilder(t.getZIndex(),Qt.IMAGE);g.setImageStyle(a,p),g.drawPoint(e,n)}if(u&&u.getText()){var v=o.getBuilder(t.getZIndex(),Qt.TEXT);v.setTextStyle(u,p),v.drawText(e,n)}}function Fb(o,e,t,n,i){var a=t.getImage(),u=t.getText(),p;if(i&&(o=i,p=a&&u&&u.getText()?{}:void 0),a){if(a.getImageState()!=Wt.LOADED)return;var g=o.getBuilder(t.getZIndex(),Qt.IMAGE);g.setImageStyle(a,p),g.drawMultiPoint(e,n)}if(u&&u.getText()){var v=(i||o).getBuilder(t.getZIndex(),Qt.TEXT);v.setTextStyle(u,p),v.drawText(e,n)}}function Nb(o,e,t,n,i){var a=t.getFill(),u=t.getStroke();if(a||u){var p=o.getBuilder(t.getZIndex(),Qt.POLYGON);p.setFillStrokeStyle(a,u),p.drawPolygon(e,n)}var g=t.getText();if(g&&g.getText()){var v=(i||o).getBuilder(t.getZIndex(),Qt.TEXT);v.setTextStyle(g),v.drawText(e,n)}}var Bb=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Gb=function(o){Bb(e,o);function e(t){var n=o.call(this,t)||this;return n.boundHandleStyleImageChange_=n.handleStyleImageChange_.bind(n),n.animatingOrInteracting_,n.dirty_=!1,n.hitDetectionImageData_=null,n.renderedFeatures_=null,n.renderedRevision_=-1,n.renderedResolution_=NaN,n.renderedExtent_=xn(),n.wrappedRenderedExtent_=xn(),n.renderedRotation_,n.renderedCenter_=null,n.renderedProjection_=null,n.renderedRenderOrder_=null,n.replayGroup_=null,n.replayGroupChanged=!0,n.declutterExecutorGroup=null,n.clipping=!0,n}return e.prototype.renderWorlds=function(t,n,i){var a=n.extent,u=n.viewState,p=u.center,g=u.resolution,v=u.projection,m=u.rotation,E=v.getExtent(),b=this.getLayer().getSource(),w=n.pixelRatio,S=n.viewHints,C=!(S[Ee.ANIMATING]||S[Ee.INTERACTING]),A=this.context,M=Math.round(n.size[0]*w),I=Math.round(n.size[1]*w),L=b.getWrapX()&&v.canWrapX(),k=L?ee(E):null,N=L?Math.ceil((a[2]-E[2])/k)+1:1,G=L?Math.floor((a[0]-E[0])/k):0;do{var z=this.getRenderTransform(p,g,m,w,M,I,G*k);t.execute(A,1,z,m,C,void 0,i)}while(++G<N)},e.prototype.renderDeclutter=function(t){this.declutterExecutorGroup&&this.renderWorlds(this.declutterExecutorGroup,t,t.declutterTree)},e.prototype.renderFrame=function(t,n){var i=t.pixelRatio,a=t.layerStatesArray[t.layerIndex];Om(this.pixelTransform,1/i,1/i),Md(this.inversePixelTransform,this.pixelTransform);var u=Am(this.pixelTransform);this.useContainer(n,u,a.opacity,this.getBackground(t));var p=this.context,g=p.canvas,v=this.replayGroup_,m=this.declutterExecutorGroup;if((!v||v.isEmpty())&&(!m||m.isEmpty()))return null;var E=Math.round(t.size[0]*i),b=Math.round(t.size[1]*i);g.width!=E||g.height!=b?(g.width=E,g.height=b,g.style.transform!==u&&(g.style.transform=u)):this.containerReused||p.clearRect(0,0,E,b),this.preRender(p,t);var w=t.viewState;w.projection;var S=!1,C=!0;if(a.extent&&this.clipping){var A=Di(a.extent);C=ke(A,t.extent),S=C&&!vr(A,t.extent),S&&this.clipUnrotated(p,t,A)}C&&this.renderWorlds(v,t),S&&p.restore(),this.postRender(p,t);var M=ex(a.opacity),I=this.container;return M!==I.style.opacity&&(I.style.opacity=M),this.renderedRotation_!==w.rotation&&(this.renderedRotation_=w.rotation,this.hitDetectionImageData_=null),this.container},e.prototype.getFeatures=function(t){return new Promise(function(n){if(!this.hitDetectionImageData_&&!this.animatingOrInteracting_){var i=[this.context.canvas.width,this.context.canvas.height];re(this.pixelTransform,i);var a=this.renderedCenter_,u=this.renderedResolution_,p=this.renderedRotation_,g=this.renderedProjection_,v=this.wrappedRenderedExtent_,m=this.getLayer(),E=[],b=i[0]*_n,w=i[1]*_n;E.push(this.getRenderTransform(a,u,p,_n,b,w,0).slice());var S=m.getSource(),C=g.getExtent();if(S.getWrapX()&&g.canWrapX()&&!vr(C,v)){for(var A=v[0],M=ee(C),I=0,L=void 0;A<C[0];)--I,L=M*I,E.push(this.getRenderTransform(a,u,p,_n,b,w,L).slice()),A+=M;for(I=0,A=v[2];A>C[2];)++I,L=M*I,E.push(this.getRenderTransform(a,u,p,_n,b,w,L).slice()),A-=M}this.hitDetectionImageData_=wb(i,E,this.renderedFeatures_,m.getStyleFunction(),v,u,p)}n(Sb(t,this.renderedFeatures_,this.hitDetectionImageData_))}.bind(this))},e.prototype.forEachFeatureAtCoordinate=function(t,n,i,a,u){var p=this;if(!!this.replayGroup_){var g=n.viewState.resolution,v=n.viewState.rotation,m=this.getLayer(),E={},b=function(C,A,M){var I=Xt(C),L=E[I];if(L){if(L!==!0&&M<L.distanceSq){if(M===0)return E[I]=!0,u.splice(u.lastIndexOf(L),1),a(C,m,A);L.geometry=A,L.distanceSq=M}}else{if(M===0)return E[I]=!0,a(C,m,A);u.push(E[I]={feature:C,layer:m,geometry:A,distanceSq:M,callback:a})}},w,S=[this.replayGroup_];return this.declutterExecutorGroup&&S.push(this.declutterExecutorGroup),S.some(function(C){return w=C.forEachFeatureAtCoordinate(t,g,v,i,b,C===p.declutterExecutorGroup&&n.declutterTree?n.declutterTree.all().map(function(A){return A.value}):null)}),w}},e.prototype.handleFontsChanged=function(){var t=this.getLayer();t.getVisible()&&this.replayGroup_&&t.changed()},e.prototype.handleStyleImageChange_=function(t){this.renderIfReadyAndVisible()},e.prototype.prepareFrame=function(t){var n=this.getLayer(),i=n.getSource();if(!i)return!1;var a=t.viewHints[Ee.ANIMATING],u=t.viewHints[Ee.INTERACTING],p=n.getUpdateWhileAnimating(),g=n.getUpdateWhileInteracting();if(!this.dirty_&&!p&&a||!g&&u)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;var v=t.extent,m=t.viewState,E=m.projection,b=m.resolution,w=t.pixelRatio,S=n.getRevision(),C=n.getRenderBuffer(),A=n.getRenderOrder();A===void 0&&(A=Cb);var M=m.center.slice(),I=Eh(v,C*b),L=I.slice(),k=[I.slice()],N=E.getExtent();if(i.getWrapX()&&E.canWrapX()&&!vr(N,t.extent)){var G=ee(N),z=Math.max(ee(I)/2,G);I[0]=N[0]-z,I[2]=N[2]+z,Gd(M,E);var V=Bm(k[0],E);V[0]<N[0]&&V[2]<N[2]?k.push([V[0]+G,V[1],V[2]+G,V[3]]):V[0]>N[0]&&V[2]>N[2]&&k.push([V[0]-G,V[1],V[2]-G,V[3]])}if(!this.dirty_&&this.renderedResolution_==b&&this.renderedRevision_==S&&this.renderedRenderOrder_==A&&vr(this.wrappedRenderedExtent_,I))return Wi(this.renderedExtent_,L)||(this.hitDetectionImageData_=null,this.renderedExtent_=L),this.renderedCenter_=M,this.replayGroupChanged=!1,!0;this.replayGroup_=null,this.dirty_=!1;var Y=new zf(dh(b,w),I,b,w),X;this.getLayer().getDeclutter()&&(X=new zf(dh(b,w),I,b,w));for(var J,q,K,q=0,K=k.length;q<K;++q)i.loadFeatures(k[q],b,E);var Q=Ob(b,w),tt=function(ut){var Rt,W=ut.getStyleFunction()||n.getStyleFunction();if(W&&(Rt=W(ut,b)),Rt){var Yt=this.renderFeature(ut,Q,Rt,Y,J,X);this.dirty_=this.dirty_||Yt}}.bind(this),nt=Oh(I),ot=i.getFeaturesInExtent(nt);A&&ot.sort(A);for(var q=0,K=ot.length;q<K;++q)tt(ot[q]);this.renderedFeatures_=ot;var at=Y.finish(),ht=new Xf(I,b,w,i.getOverlaps(),at,n.getRenderBuffer());return X&&(this.declutterExecutorGroup=new Xf(I,b,w,i.getOverlaps(),X.finish(),n.getRenderBuffer())),this.renderedResolution_=b,this.renderedRevision_=S,this.renderedRenderOrder_=A,this.renderedExtent_=L,this.wrappedRenderedExtent_=I,this.renderedCenter_=M,this.renderedProjection_=E,this.replayGroup_=ht,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0},e.prototype.renderFeature=function(t,n,i,a,u,p){if(!i)return!1;var g=!1;if(Array.isArray(i))for(var v=0,m=i.length;v<m;++v)g=Wf(a,t,i[v],n,this.boundHandleStyleImageChange_,u,p)||g;else g=Wf(a,t,i,n,this.boundHandleStyleImageChange_,u,p);return g},e}(nb),zb=Gb,Ub=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Vb=function(o){Ub(e,o);function e(t){return o.call(this,t)||this}return e.prototype.createRenderer=function(){return new zb(this)},e}(Px),Xb=Vb,jb=function(){function o(e){this.rbush_=new dp(e),this.items_={}}return o.prototype.insert=function(e,t){var n={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],value:t};this.rbush_.insert(n),this.items_[Xt(t)]=n},o.prototype.load=function(e,t){for(var n=new Array(t.length),i=0,a=t.length;i<a;i++){var u=e[i],p=t[i],g={minX:u[0],minY:u[1],maxX:u[2],maxY:u[3],value:p};n[i]=g,this.items_[Xt(p)]=g}this.rbush_.load(n)},o.prototype.remove=function(e){var t=Xt(e),n=this.items_[t];return delete this.items_[t],this.rbush_.remove(n)!==null},o.prototype.update=function(e,t){var n=this.items_[Xt(t)],i=[n.minX,n.minY,n.maxX,n.maxY];$s(i,e)||(this.remove(t),this.insert(e,t))},o.prototype.getAll=function(){var e=this.rbush_.all();return e.map(function(t){return t.value})},o.prototype.getInExtent=function(e){var t={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]},n=this.rbush_.search(t);return n.map(function(i){return i.value})},o.prototype.forEach=function(e){return this.forEach_(this.getAll(),e)},o.prototype.forEachInExtent=function(e,t){return this.forEach_(this.getInExtent(e),t)},o.prototype.forEach_=function(e,t){for(var n,i=0,a=e.length;i<a;i++)if(n=t(e[i]),n)return n;return n},o.prototype.isEmpty=function(){return Ro(this.items_)},o.prototype.clear=function(){this.rbush_.clear(),this.items_={}},o.prototype.getExtent=function(e){var t=this.rbush_.toJSON();return bn(t.minX,t.minY,t.maxX,t.maxY,e)},o.prototype.concat=function(e){this.rbush_.load(e.rbush_.all());for(var t in e.items_)this.items_[t]=e.items_[t]},o}(),Hf=jb,Wb=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Hb=function(o){Wb(e,o);function e(t){var n=o.call(this)||this;n.projection=qe(t.projection),n.attributions_=Yf(t.attributions),n.attributionsCollapsible_=t.attributionsCollapsible!==void 0?t.attributionsCollapsible:!0,n.loading=!1,n.state_=t.state!==void 0?t.state:Oe.READY,n.wrapX_=t.wrapX!==void 0?t.wrapX:!1,n.interpolate_=!!t.interpolate,n.viewResolver=null,n.viewRejector=null;var i=n;return n.viewPromise_=new Promise(function(a,u){i.viewResolver=a,i.viewRejector=u}),n}return e.prototype.getAttributions=function(){return this.attributions_},e.prototype.getAttributionsCollapsible=function(){return this.attributionsCollapsible_},e.prototype.getProjection=function(){return this.projection},e.prototype.getResolutions=function(){return Ct()},e.prototype.getView=function(){return this.viewPromise_},e.prototype.getState=function(){return this.state_},e.prototype.getWrapX=function(){return this.wrapX_},e.prototype.getInterpolate=function(){return this.interpolate_},e.prototype.refresh=function(){this.changed()},e.prototype.setAttributions=function(t){this.attributions_=Yf(t),this.changed()},e.prototype.setState=function(t){this.state_=t,this.changed()},e}(Tn);function Yf(o){return o?Array.isArray(o)?function(e){return o}:typeof o=="function"?o:function(e){return[o]}:null}var yp=Hb,nn={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};function Yb(o,e){return[[-1/0,-1/0,1/0,1/0]]}var po={ARRAY_BUFFER:"arraybuffer",JSON:"json",TEXT:"text",XML:"xml"},$b=!1;function Kb(o,e,t,n,i,a,u){var p=new XMLHttpRequest;p.open("GET",typeof o=="function"?o(t,n,i):o,!0),e.getType()==po.ARRAY_BUFFER&&(p.responseType="arraybuffer"),p.withCredentials=$b,p.onload=function(g){if(!p.status||p.status>=200&&p.status<300){var v=e.getType(),m=void 0;v==po.JSON||v==po.TEXT?m=p.responseText:v==po.XML?(m=p.responseXML,m||(m=new DOMParser().parseFromString(p.responseText,"application/xml"))):v==po.ARRAY_BUFFER&&(m=p.response),m?a(e.readFeatures(m,{extent:t,featureProjection:i}),e.readProjection(m)):u()}else u()},p.onerror=u,p.send()}function $f(o,e){return function(t,n,i,a,u){var p=this;Kb(o,e,t,n,i,function(g,v){p.addFeatures(g),a!==void 0&&a(g)},u||Vi)}}var mp=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),ti=function(o){mp(e,o);function e(t,n,i){var a=o.call(this,t)||this;return a.feature=n,a.features=i,a}return e}(Bn),Zb=function(o){mp(e,o);function e(t){var n=this,i=t||{};n=o.call(this,{attributions:i.attributions,interpolate:!0,projection:void 0,state:Oe.READY,wrapX:i.wrapX!==void 0?i.wrapX:!0})||this,n.on,n.once,n.un,n.loader_=Vi,n.format_=i.format,n.overlaps_=i.overlaps===void 0?!0:i.overlaps,n.url_=i.url,i.loader!==void 0?n.loader_=i.loader:n.url_!==void 0&&(Ot(n.format_,7),n.loader_=$f(n.url_,n.format_)),n.strategy_=i.strategy!==void 0?i.strategy:Yb;var a=i.useSpatialIndex!==void 0?i.useSpatialIndex:!0;n.featuresRtree_=a?new Hf:null,n.loadedExtentsRtree_=new Hf,n.loadingExtentsCount_=0,n.nullGeometryFeatures_={},n.idIndex_={},n.uidIndex_={},n.featureChangeKeys_={},n.featuresCollection_=null;var u,p;return Array.isArray(i.features)?p=i.features:i.features&&(u=i.features,p=u.getArray()),!a&&u===void 0&&(u=new Ze(p)),p!==void 0&&n.addFeaturesInternal(p),u!==void 0&&n.bindFeaturesCollection_(u),n}return e.prototype.addFeature=function(t){this.addFeatureInternal(t),this.changed()},e.prototype.addFeatureInternal=function(t){var n=Xt(t);if(!this.addToIndex_(n,t)){this.featuresCollection_&&this.featuresCollection_.remove(t);return}this.setupChangeEvents_(n,t);var i=t.getGeometry();if(i){var a=i.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(a,t)}else this.nullGeometryFeatures_[n]=t;this.dispatchEvent(new ti(nn.ADDFEATURE,t))},e.prototype.setupChangeEvents_=function(t,n){this.featureChangeKeys_[t]=[Lt(n,pt.CHANGE,this.handleFeatureChange_,this),Lt(n,Ir.PROPERTYCHANGE,this.handleFeatureChange_,this)]},e.prototype.addToIndex_=function(t,n){var i=!0,a=n.getId();return a!==void 0&&(a.toString()in this.idIndex_?i=!1:this.idIndex_[a.toString()]=n),i&&(Ot(!(t in this.uidIndex_),30),this.uidIndex_[t]=n),i},e.prototype.addFeatures=function(t){this.addFeaturesInternal(t),this.changed()},e.prototype.addFeaturesInternal=function(t){for(var n=[],i=[],a=[],u=0,p=t.length;u<p;u++){var g=t[u],v=Xt(g);this.addToIndex_(v,g)&&i.push(g)}for(var u=0,m=i.length;u<m;u++){var g=i[u],v=Xt(g);this.setupChangeEvents_(v,g);var E=g.getGeometry();if(E){var b=E.getExtent();n.push(b),a.push(g)}else this.nullGeometryFeatures_[v]=g}if(this.featuresRtree_&&this.featuresRtree_.load(n,a),this.hasListener(nn.ADDFEATURE))for(var u=0,w=i.length;u<w;u++)this.dispatchEvent(new ti(nn.ADDFEATURE,i[u]))},e.prototype.bindFeaturesCollection_=function(t){var n=!1;this.addEventListener(nn.ADDFEATURE,function(i){n||(n=!0,t.push(i.feature),n=!1)}),this.addEventListener(nn.REMOVEFEATURE,function(i){n||(n=!0,t.remove(i.feature),n=!1)}),t.addEventListener(Fe.ADD,function(i){n||(n=!0,this.addFeature(i.element),n=!1)}.bind(this)),t.addEventListener(Fe.REMOVE,function(i){n||(n=!0,this.removeFeature(i.element),n=!1)}.bind(this)),this.featuresCollection_=t},e.prototype.clear=function(t){if(t){for(var n in this.featureChangeKeys_){var i=this.featureChangeKeys_[n];i.forEach(qt)}this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){var a=function(g){this.removeFeatureInternal(g)}.bind(this);this.featuresRtree_.forEach(a);for(var u in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[u])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};var p=new ti(nn.CLEAR);this.dispatchEvent(p),this.changed()},e.prototype.forEachFeature=function(t){if(this.featuresRtree_)return this.featuresRtree_.forEach(t);this.featuresCollection_&&this.featuresCollection_.forEach(t)},e.prototype.forEachFeatureAtCoordinateDirect=function(t,n){var i=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(i,function(a){var u=a.getGeometry();if(u.intersectsCoordinate(t))return n(a)})},e.prototype.forEachFeatureInExtent=function(t,n){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(t,n);this.featuresCollection_&&this.featuresCollection_.forEach(n)},e.prototype.forEachFeatureIntersectingExtent=function(t,n){return this.forEachFeatureInExtent(t,function(i){var a=i.getGeometry();if(a.intersectsExtent(t)){var u=n(i);if(u)return u}})},e.prototype.getFeaturesCollection=function(){return this.featuresCollection_},e.prototype.getFeatures=function(){var t;return this.featuresCollection_?t=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(t=this.featuresRtree_.getAll(),Ro(this.nullGeometryFeatures_)||Td(t,wd(this.nullGeometryFeatures_))),t},e.prototype.getFeaturesAtCoordinate=function(t){var n=[];return this.forEachFeatureAtCoordinateDirect(t,function(i){n.push(i)}),n},e.prototype.getFeaturesInExtent=function(t){return this.featuresRtree_?this.featuresRtree_.getInExtent(t):this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]},e.prototype.getClosestFeatureToCoordinate=function(t,n){var i=t[0],a=t[1],u=null,p=[NaN,NaN],g=1/0,v=[-1/0,-1/0,1/0,1/0],m=n||Sr;return this.featuresRtree_.forEachInExtent(v,function(E){if(m(E)){var b=E.getGeometry(),w=g;if(g=b.closestPointXY(i,a,p,g),g<w){u=E;var S=Math.sqrt(g);v[0]=i-S,v[1]=a-S,v[2]=i+S,v[3]=a+S}}}),u},e.prototype.getExtent=function(t){return this.featuresRtree_.getExtent(t)},e.prototype.getFeatureById=function(t){var n=this.idIndex_[t.toString()];return n!==void 0?n:null},e.prototype.getFeatureByUid=function(t){var n=this.uidIndex_[t];return n!==void 0?n:null},e.prototype.getFormat=function(){return this.format_},e.prototype.getOverlaps=function(){return this.overlaps_},e.prototype.getUrl=function(){return this.url_},e.prototype.handleFeatureChange_=function(t){var n=t.target,i=Xt(n),a=n.getGeometry();if(!a)i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(n),this.nullGeometryFeatures_[i]=n);else{var u=a.getExtent();i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(u,n)):this.featuresRtree_&&this.featuresRtree_.update(u,n)}var p=n.getId();if(p!==void 0){var g=p.toString();this.idIndex_[g]!==n&&(this.removeFromIdIndex_(n),this.idIndex_[g]=n)}else this.removeFromIdIndex_(n),this.uidIndex_[i]=n;this.changed(),this.dispatchEvent(new ti(nn.CHANGEFEATURE,n))},e.prototype.hasFeature=function(t){var n=t.getId();return n!==void 0?n in this.idIndex_:Xt(t)in this.uidIndex_},e.prototype.isEmpty=function(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&Ro(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0},e.prototype.loadFeatures=function(t,n,i){for(var a=this.loadedExtentsRtree_,u=this.strategy_(t,n,i),p=function(E,b){var w=u[E],S=a.forEachInExtent(w,function(C){return vr(C.extent,w)});S||(++g.loadingExtentsCount_,g.dispatchEvent(new ti(nn.FEATURESLOADSTART)),g.loader_.call(g,w,n,i,function(C){--this.loadingExtentsCount_,this.dispatchEvent(new ti(nn.FEATURESLOADEND,void 0,C))}.bind(g),function(){--this.loadingExtentsCount_,this.dispatchEvent(new ti(nn.FEATURESLOADERROR))}.bind(g)),a.insert(w,{extent:w.slice()}))},g=this,v=0,m=u.length;v<m;++v)p(v);this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0},e.prototype.refresh=function(){this.clear(!0),this.loadedExtentsRtree_.clear(),o.prototype.refresh.call(this)},e.prototype.removeLoadedExtent=function(t){var n=this.loadedExtentsRtree_,i;n.forEachInExtent(t,function(a){if($s(a.extent,t))return i=a,!0}),i&&n.remove(i)},e.prototype.removeFeature=function(t){if(!!t){var n=Xt(t);n in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[n]:this.featuresRtree_&&this.featuresRtree_.remove(t);var i=this.removeFeatureInternal(t);i&&this.changed()}},e.prototype.removeFeatureInternal=function(t){var n=Xt(t),i=this.featureChangeKeys_[n];if(!!i){i.forEach(qt),delete this.featureChangeKeys_[n];var a=t.getId();return a!==void 0&&delete this.idIndex_[a.toString()],delete this.uidIndex_[n],this.dispatchEvent(new ti(nn.REMOVEFEATURE,t)),t}},e.prototype.removeFromIdIndex_=function(t){var n=!1;for(var i in this.idIndex_)if(this.idIndex_[i]===t){delete this.idIndex_[i],n=!0;break}return n},e.prototype.setLoader=function(t){this.loader_=t},e.prototype.setUrl=function(t){Ot(this.format_,7),this.url_=t,this.setLoader($f(t,this.format_))},e}(yp),qb=Zb,xp=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),oi=function(o){xp(e,o);function e(t,n){var i=o.call(this,t)||this;return i.layer=n,i}return e}(Bn),Bl={LAYERS:"layers"},Jb=function(o){xp(e,o);function e(t){var n=this,i=t||{},a=se({},i);delete a.layers;var u=i.layers;return n=o.call(this,a)||this,n.on,n.once,n.un,n.layersListenerKeys_=[],n.listenerKeys_={},n.addChangeListener(Bl.LAYERS,n.handleLayersChanged_),u?Array.isArray(u)?u=new Ze(u.slice(),{unique:!0}):Ot(typeof u.getArray=="function",43):u=new Ze(void 0,{unique:!0}),n.setLayers(u),n}return e.prototype.handleLayerChange_=function(){this.changed()},e.prototype.handleLayersChanged_=function(){this.layersListenerKeys_.forEach(qt),this.layersListenerKeys_.length=0;var t=this.getLayers();this.layersListenerKeys_.push(Lt(t,Fe.ADD,this.handleLayersAdd_,this),Lt(t,Fe.REMOVE,this.handleLayersRemove_,this));for(var n in this.listenerKeys_)this.listenerKeys_[n].forEach(qt);Lr(this.listenerKeys_);for(var i=t.getArray(),a=0,u=i.length;a<u;a++){var p=i[a];this.registerLayerListeners_(p),this.dispatchEvent(new oi("addlayer",p))}this.changed()},e.prototype.registerLayerListeners_=function(t){var n=[Lt(t,Ir.PROPERTYCHANGE,this.handleLayerChange_,this),Lt(t,pt.CHANGE,this.handleLayerChange_,this)];t instanceof e&&n.push(Lt(t,"addlayer",this.handleLayerGroupAdd_,this),Lt(t,"removelayer",this.handleLayerGroupRemove_,this)),this.listenerKeys_[Xt(t)]=n},e.prototype.handleLayerGroupAdd_=function(t){this.dispatchEvent(new oi("addlayer",t.layer))},e.prototype.handleLayerGroupRemove_=function(t){this.dispatchEvent(new oi("removelayer",t.layer))},e.prototype.handleLayersAdd_=function(t){var n=t.element;this.registerLayerListeners_(n),this.dispatchEvent(new oi("addlayer",n)),this.changed()},e.prototype.handleLayersRemove_=function(t){var n=t.element,i=Xt(n);this.listenerKeys_[i].forEach(qt),delete this.listenerKeys_[i],this.dispatchEvent(new oi("removelayer",n)),this.changed()},e.prototype.getLayers=function(){return this.get(Bl.LAYERS)},e.prototype.setLayers=function(t){var n=this.getLayers();if(n)for(var i=n.getArray(),a=0,u=i.length;a<u;++a)this.dispatchEvent(new oi("removelayer",i[a]));this.set(Bl.LAYERS,t)},e.prototype.getLayersArray=function(t){var n=t!==void 0?t:[];return this.getLayers().forEach(function(i){i.getLayersArray(n)}),n},e.prototype.getLayerStatesArray=function(t){var n=t!==void 0?t:[],i=n.length;this.getLayers().forEach(function(m){m.getLayerStatesArray(n)});var a=this.getLayerState(),u=a.zIndex;!t&&a.zIndex===void 0&&(u=0);for(var p=i,g=n.length;p<g;p++){var v=n[p];v.opacity*=a.opacity,v.visible=v.visible&&a.visible,v.maxResolution=Math.min(v.maxResolution,a.maxResolution),v.minResolution=Math.max(v.minResolution,a.minResolution),v.minZoom=Math.max(v.minZoom,a.minZoom),v.maxZoom=Math.min(v.maxZoom,a.maxZoom),a.extent!==void 0&&(v.extent!==void 0?v.extent=zi(v.extent,a.extent):v.extent=a.extent),v.zIndex===void 0&&(v.zIndex=u)}return n},e.prototype.getSourceState=function(){return Oe.READY},e}(up),Ia=Jb,Mh=34962,Lh=34963,Qb=35040,Dh=35044,t1=35048,e1=5121,n1=5123,i1=5125,bp=5126,Kf=["experimental-webgl","webgl","webkit-3d","moz-webgl"];function Ep(o,e){for(var t=se({preserveDrawingBuffer:!0,antialias:!bm},e),n=Kf.length,i=0;i<n;++i)try{var a=o.getContext(Kf[i],t);if(a)return a}catch{}return null}var r1={STATIC_DRAW:Dh,STREAM_DRAW:Qb,DYNAMIC_DRAW:t1},o1=function(){function o(e,t){this.array=null,this.type=e,Ot(e===Mh||e===Lh,62),this.usage=t!==void 0?t:r1.STATIC_DRAW}return o.prototype.ofSize=function(e){this.array=new(Gl(this.type))(e)},o.prototype.fromArray=function(e){var t=Gl(this.type);this.array=t.from?t.from(e):new t(e)},o.prototype.fromArrayBuffer=function(e){this.array=new(Gl(this.type))(e)},o.prototype.getType=function(){return this.type},o.prototype.getArray=function(){return this.array},o.prototype.getUsage=function(){return this.usage},o.prototype.getSize=function(){return this.array?this.array.length:0},o}();function Gl(o){switch(o){case Mh:return Float32Array;case Lh:return Uint32Array;default:return Float32Array}}var Tp=o1,As={LOST:"webglcontextlost",RESTORED:"webglcontextrestored"},s1=`
  precision mediump float;
  
  attribute vec2 a_position;
  varying vec2 v_texCoord;
  varying vec2 v_screenCoord;
  
  uniform vec2 u_screenSize;
   
  void main() {
    v_texCoord = a_position * 0.5 + 0.5;
    v_screenCoord = v_texCoord * u_screenSize;
    gl_Position = vec4(a_position, 0.0, 1.0);
  }
`,a1=`
  precision mediump float;
   
  uniform sampler2D u_image;
  uniform float u_opacity;
   
  varying vec2 v_texCoord;
   
  void main() {
    gl_FragColor = texture2D(u_image, v_texCoord) * u_opacity;
  }
`,l1=function(){function o(e){this.gl_=e.webGlContext;var t=this.gl_;this.scaleRatio_=e.scaleRatio||1,this.renderTargetTexture_=t.createTexture(),this.renderTargetTextureSize_=null,this.frameBuffer_=t.createFramebuffer();var n=t.createShader(t.VERTEX_SHADER);t.shaderSource(n,e.vertexShader||s1),t.compileShader(n);var i=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(i,e.fragmentShader||a1),t.compileShader(i),this.renderTargetProgram_=t.createProgram(),t.attachShader(this.renderTargetProgram_,n),t.attachShader(this.renderTargetProgram_,i),t.linkProgram(this.renderTargetProgram_),this.renderTargetVerticesBuffer_=t.createBuffer();var a=[-1,-1,1,-1,-1,1,1,-1,1,1,-1,1];t.bindBuffer(t.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),t.bufferData(t.ARRAY_BUFFER,new Float32Array(a),t.STATIC_DRAW),this.renderTargetAttribLocation_=t.getAttribLocation(this.renderTargetProgram_,"a_position"),this.renderTargetUniformLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_screenSize"),this.renderTargetOpacityLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_opacity"),this.renderTargetTextureLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_image"),this.uniforms_=[],e.uniforms&&Object.keys(e.uniforms).forEach(function(u){this.uniforms_.push({value:e.uniforms[u],location:t.getUniformLocation(this.renderTargetProgram_,u)})}.bind(this))}return o.prototype.getGL=function(){return this.gl_},o.prototype.init=function(e){var t=this.getGL(),n=[t.drawingBufferWidth*this.scaleRatio_,t.drawingBufferHeight*this.scaleRatio_];if(t.bindFramebuffer(t.FRAMEBUFFER,this.getFrameBuffer()),t.viewport(0,0,n[0],n[1]),!this.renderTargetTextureSize_||this.renderTargetTextureSize_[0]!==n[0]||this.renderTargetTextureSize_[1]!==n[1]){this.renderTargetTextureSize_=n;var i=0,a=t.RGBA,u=0,p=t.RGBA,g=t.UNSIGNED_BYTE,v=null;t.bindTexture(t.TEXTURE_2D,this.renderTargetTexture_),t.texImage2D(t.TEXTURE_2D,i,a,n[0],n[1],u,p,g,v),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.renderTargetTexture_,0)}},o.prototype.apply=function(e,t,n,i){var a=this.getGL(),u=e.size;if(a.bindFramebuffer(a.FRAMEBUFFER,t?t.getFrameBuffer():null),a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,this.renderTargetTexture_),!t){var p=Xt(a.canvas);if(!e.renderTargets[p]){var g=a.getContextAttributes();g&&g.preserveDrawingBuffer&&(a.clearColor(0,0,0,0),a.clear(a.COLOR_BUFFER_BIT)),e.renderTargets[p]=!0}}a.enable(a.BLEND),a.blendFunc(a.ONE,a.ONE_MINUS_SRC_ALPHA),a.viewport(0,0,a.drawingBufferWidth,a.drawingBufferHeight),a.bindBuffer(a.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),a.useProgram(this.renderTargetProgram_),a.enableVertexAttribArray(this.renderTargetAttribLocation_),a.vertexAttribPointer(this.renderTargetAttribLocation_,2,a.FLOAT,!1,0,0),a.uniform2f(this.renderTargetUniformLocation_,u[0],u[1]),a.uniform1i(this.renderTargetTextureLocation_,0);var v=e.layerStatesArray[e.layerIndex].opacity;a.uniform1f(this.renderTargetOpacityLocation_,v),this.applyUniforms(e),n&&n(a,e),a.drawArrays(a.TRIANGLES,0,6),i&&i(a,e)},o.prototype.getFrameBuffer=function(){return this.frameBuffer_},o.prototype.applyUniforms=function(e){var t=this.getGL(),n,i=1;this.uniforms_.forEach(function(a){if(n=typeof a.value=="function"?a.value(e):a.value,n instanceof HTMLCanvasElement||n instanceof ImageData)a.texture||(a.texture=t.createTexture()),t.activeTexture(t["TEXTURE".concat(i)]),t.bindTexture(t.TEXTURE_2D,a.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),n instanceof ImageData?t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,n.width,n.height,0,t.UNSIGNED_BYTE,new Uint8Array(n.data)):t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n),t.uniform1i(a.location,i++);else if(Array.isArray(n))switch(n.length){case 2:t.uniform2f(a.location,n[0],n[1]);return;case 3:t.uniform3f(a.location,n[0],n[1],n[2]);return;case 4:t.uniform4f(a.location,n[0],n[1],n[2],n[3]);return;default:return}else typeof n=="number"&&t.uniform1f(a.location,n)})},o}(),Zf=l1;function wp(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function zs(o,e){return o[0]=e[0],o[1]=e[1],o[4]=e[2],o[5]=e[3],o[12]=e[4],o[13]=e[5],o}var h1=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),go={PROJECTION_MATRIX:"u_projectionMatrix",OFFSET_SCALE_MATRIX:"u_offsetScaleMatrix",OFFSET_ROTATION_MATRIX:"u_offsetRotateMatrix",TIME:"u_time",ZOOM:"u_zoom",RESOLUTION:"u_resolution"},xo={UNSIGNED_BYTE:e1,UNSIGNED_SHORT:n1,UNSIGNED_INT:i1,FLOAT:bp},aa={};function qf(o){return"shared/"+o}var Jf=0;function c1(){var o="unique/"+Jf;return Jf+=1,o}function u1(o){var e=aa[o];if(!e){var t=document.createElement("canvas");t.style.position="absolute",t.style.left="0",e={users:0,canvas:t},aa[o]=e}return e.users+=1,e.canvas}function f1(o){var e=aa[o];if(!!e&&(e.users-=1,!(e.users>0))){var t=e.canvas,n=Ep(t),i=n.getExtension("WEBGL_lose_context");i&&i.loseContext(),delete aa[o]}}var d1=function(o){h1(e,o);function e(t){var n=o.call(this)||this,i=t||{};n.boundHandleWebGLContextLost_=n.handleWebGLContextLost.bind(n),n.boundHandleWebGLContextRestored_=n.handleWebGLContextRestored.bind(n),n.canvasCacheKey_=i.canvasCacheKey?qf(i.canvasCacheKey):c1(),n.canvas_=u1(n.canvasCacheKey_),n.gl_=Ep(n.canvas_),n.bufferCache_={},n.extensionCache_={},n.currentProgram_=null,n.canvas_.addEventListener(As.LOST,n.boundHandleWebGLContextLost_),n.canvas_.addEventListener(As.RESTORED,n.boundHandleWebGLContextRestored_),n.offsetRotateMatrix_=Ge(),n.offsetScaleMatrix_=Ge(),n.tmpMat4_=wp(),n.uniformLocations_={},n.attribLocations_={},n.uniforms_=[],i.uniforms&&n.setUniforms(i.uniforms);var a=n.getGL();return n.postProcessPasses_=i.postProcesses?i.postProcesses.map(function(u){return new Zf({webGlContext:a,scaleRatio:u.scaleRatio,vertexShader:u.vertexShader,fragmentShader:u.fragmentShader,uniforms:u.uniforms})}):[new Zf({webGlContext:a})],n.shaderCompileErrors_=null,n.startTime_=Date.now(),n}return e.prototype.setUniforms=function(t){this.uniforms_=[];for(var n in t)this.uniforms_.push({name:n,value:t[n]});this.uniformLocations_={}},e.prototype.canvasCacheKeyMatches=function(t){return this.canvasCacheKey_===qf(t)},e.prototype.getExtension=function(t){if(t in this.extensionCache_)return this.extensionCache_[t];var n=this.gl_.getExtension(t);return this.extensionCache_[t]=n,n},e.prototype.bindBuffer=function(t){var n=this.getGL(),i=Xt(t),a=this.bufferCache_[i];if(!a){var u=n.createBuffer();a={buffer:t,webGlBuffer:u},this.bufferCache_[i]=a}n.bindBuffer(t.getType(),a.webGlBuffer)},e.prototype.flushBufferData=function(t){var n=this.getGL();this.bindBuffer(t),n.bufferData(t.getType(),t.getArray(),t.getUsage())},e.prototype.deleteBuffer=function(t){var n=this.getGL(),i=Xt(t),a=this.bufferCache_[i];a&&!n.isContextLost()&&n.deleteBuffer(a.webGlBuffer),delete this.bufferCache_[i]},e.prototype.disposeInternal=function(){this.canvas_.removeEventListener(As.LOST,this.boundHandleWebGLContextLost_),this.canvas_.removeEventListener(As.RESTORED,this.boundHandleWebGLContextRestored_),f1(this.canvasCacheKey_),delete this.gl_,delete this.canvas_},e.prototype.prepareDraw=function(t,n){var i=this.getGL(),a=this.getCanvas(),u=t.size,p=t.pixelRatio;a.width=u[0]*p,a.height=u[1]*p,a.style.width=u[0]+"px",a.style.height=u[1]+"px",i.useProgram(this.currentProgram_);for(var g=this.postProcessPasses_.length-1;g>=0;g--)this.postProcessPasses_[g].init(t);i.bindTexture(i.TEXTURE_2D,null),i.clearColor(0,0,0,0),i.clear(i.COLOR_BUFFER_BIT),i.enable(i.BLEND),i.blendFunc(i.ONE,n?i.ZERO:i.ONE_MINUS_SRC_ALPHA),i.useProgram(this.currentProgram_),this.applyFrameState(t),this.applyUniforms(t)},e.prototype.prepareDrawToRenderTarget=function(t,n,i){var a=this.getGL(),u=n.getSize();a.bindFramebuffer(a.FRAMEBUFFER,n.getFramebuffer()),a.viewport(0,0,u[0],u[1]),a.bindTexture(a.TEXTURE_2D,n.getTexture()),a.clearColor(0,0,0,0),a.clear(a.COLOR_BUFFER_BIT),a.enable(a.BLEND),a.blendFunc(a.ONE,i?a.ZERO:a.ONE_MINUS_SRC_ALPHA),a.useProgram(this.currentProgram_),this.applyFrameState(t),this.applyUniforms(t)},e.prototype.drawElements=function(t,n){var i=this.getGL();this.getExtension("OES_element_index_uint");var a=i.UNSIGNED_INT,u=4,p=n-t,g=t*u;i.drawElements(i.TRIANGLES,p,a,g)},e.prototype.finalizeDraw=function(t,n,i){for(var a=0,u=this.postProcessPasses_.length;a<u;a++)a===u-1?this.postProcessPasses_[a].apply(t,null,n,i):this.postProcessPasses_[a].apply(t,this.postProcessPasses_[a+1])},e.prototype.getCanvas=function(){return this.canvas_},e.prototype.getGL=function(){return this.gl_},e.prototype.applyFrameState=function(t){var n=t.size,i=t.viewState.rotation,a=Ml(this.offsetScaleMatrix_);Cm(a,2/n[0],2/n[1]);var u=Ml(this.offsetRotateMatrix_);i!==0&&Rm(u,-i),this.setUniformMatrixValue(go.OFFSET_SCALE_MATRIX,zs(this.tmpMat4_,a)),this.setUniformMatrixValue(go.OFFSET_ROTATION_MATRIX,zs(this.tmpMat4_,u)),this.setUniformFloatValue(go.TIME,(Date.now()-this.startTime_)*.001),this.setUniformFloatValue(go.ZOOM,t.viewState.zoom),this.setUniformFloatValue(go.RESOLUTION,t.viewState.resolution)},e.prototype.applyUniforms=function(t){var n=this.getGL(),i,a=0;this.uniforms_.forEach(function(u){if(i=typeof u.value=="function"?u.value(t):u.value,i instanceof HTMLCanvasElement||i instanceof HTMLImageElement||i instanceof ImageData){u.texture||(u.prevValue=void 0,u.texture=n.createTexture()),n.activeTexture(n["TEXTURE".concat(a)]),n.bindTexture(n.TEXTURE_2D,u.texture),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE);var p=!(i instanceof HTMLImageElement)||i.complete;p&&u.prevValue!==i&&(u.prevValue=i,n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,i)),n.uniform1i(this.getUniformLocation(u.name),a++)}else if(Array.isArray(i)&&i.length===6)this.setUniformMatrixValue(u.name,zs(this.tmpMat4_,i));else if(Array.isArray(i)&&i.length<=4)switch(i.length){case 2:n.uniform2f(this.getUniformLocation(u.name),i[0],i[1]);return;case 3:n.uniform3f(this.getUniformLocation(u.name),i[0],i[1],i[2]);return;case 4:n.uniform4f(this.getUniformLocation(u.name),i[0],i[1],i[2],i[3]);return;default:return}else typeof i=="number"&&n.uniform1f(this.getUniformLocation(u.name),i)}.bind(this))},e.prototype.useProgram=function(t){if(t==this.currentProgram_)return!1;var n=this.getGL();return n.useProgram(t),this.currentProgram_=t,this.uniformLocations_={},this.attribLocations_={},!0},e.prototype.compileShader=function(t,n){var i=this.getGL(),a=i.createShader(n);return i.shaderSource(a,t),i.compileShader(a),a},e.prototype.getProgram=function(t,n){var i=this.getGL(),a=this.compileShader(t,i.FRAGMENT_SHADER),u=this.compileShader(n,i.VERTEX_SHADER),p=i.createProgram();if(i.attachShader(p,a),i.attachShader(p,u),i.linkProgram(p),!i.getShaderParameter(a,i.COMPILE_STATUS)){var g="Fragment shader compliation failed: ".concat(i.getShaderInfoLog(a));throw new Error(g)}if(i.deleteShader(a),!i.getShaderParameter(u,i.COMPILE_STATUS)){var g="Vertex shader compilation failed: ".concat(i.getShaderInfoLog(u));throw new Error(g)}if(i.deleteShader(u),!i.getProgramParameter(p,i.LINK_STATUS)){var g="GL program linking failed: ".concat(i.getShaderInfoLog(u));throw new Error(g)}return p},e.prototype.getUniformLocation=function(t){return this.uniformLocations_[t]===void 0&&(this.uniformLocations_[t]=this.getGL().getUniformLocation(this.currentProgram_,t)),this.uniformLocations_[t]},e.prototype.getAttributeLocation=function(t){return this.attribLocations_[t]===void 0&&(this.attribLocations_[t]=this.getGL().getAttribLocation(this.currentProgram_,t)),this.attribLocations_[t]},e.prototype.makeProjectionTransform=function(t,n){var i=t.size,a=t.viewState.rotation,u=t.viewState.resolution,p=t.viewState.center;return Ml(n),mn(n,0,0,2/(u*i[0]),2/(u*i[1]),-a,-p[0],-p[1]),n},e.prototype.setUniformFloatValue=function(t,n){this.getGL().uniform1f(this.getUniformLocation(t),n)},e.prototype.setUniformFloatVec4=function(t,n){this.getGL().uniform4fv(this.getUniformLocation(t),n)},e.prototype.setUniformMatrixValue=function(t,n){this.getGL().uniformMatrix4fv(this.getUniformLocation(t),!1,n)},e.prototype.enableAttributeArray_=function(t,n,i,a,u){var p=this.getAttributeLocation(t);p<0||(this.getGL().enableVertexAttribArray(p),this.getGL().vertexAttribPointer(p,n,i,!1,a,u))},e.prototype.enableAttributes=function(t){for(var n=p1(t),i=0,a=0;a<t.length;a++){var u=t[a];this.enableAttributeArray_(u.name,u.size,u.type||bp,n,i),i+=u.size*Sp(u.type)}},e.prototype.handleWebGLContextLost=function(){Lr(this.bufferCache_),this.currentProgram_=null},e.prototype.handleWebGLContextRestored=function(){},e.prototype.createTexture=function(t,n,i){var a=this.getGL(),u=i||a.createTexture(),p=0,g=a.RGBA,v=0,m=a.RGBA,E=a.UNSIGNED_BYTE;return a.bindTexture(a.TEXTURE_2D,u),n?a.texImage2D(a.TEXTURE_2D,p,g,m,E,n):a.texImage2D(a.TEXTURE_2D,p,g,t[0],t[1],v,m,E,null),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),u},e}(_a);function p1(o){for(var e=0,t=0;t<o.length;t++){var n=o[t];e+=n.size*Sp(n.type)}return e}function Sp(o){switch(o){case xo.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case xo.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case xo.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case xo.FLOAT:default:return Float32Array.BYTES_PER_ELEMENT}}var g1=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),_1=function(o){g1(e,o);function e(t,n){var i=o.call(this,t)||this,a=n||{};return i.inversePixelTransform_=Ge(),i.pixelContext_=null,i.postProcesses_=a.postProcesses,i.uniforms_=a.uniforms,i.helper,t.addChangeListener(Bt.MAP,i.removeHelper.bind(i)),i.dispatchPreComposeEvent=i.dispatchPreComposeEvent.bind(i),i.dispatchPostComposeEvent=i.dispatchPostComposeEvent.bind(i),i}return e.prototype.dispatchPreComposeEvent=function(t,n){var i=this.getLayer();if(i.hasListener(Ne.PRECOMPOSE)){var a=new wo(Ne.PRECOMPOSE,void 0,n,t);i.dispatchEvent(a)}},e.prototype.dispatchPostComposeEvent=function(t,n){var i=this.getLayer();if(i.hasListener(Ne.POSTCOMPOSE)){var a=new wo(Ne.POSTCOMPOSE,void 0,n,t);i.dispatchEvent(a)}},e.prototype.reset=function(t){this.uniforms_=t.uniforms,this.helper&&this.helper.setUniforms(this.uniforms_)},e.prototype.removeHelper=function(){this.helper&&(this.helper.dispose(),delete this.helper)},e.prototype.prepareFrame=function(t){if(this.getLayer().getRenderSource()){for(var n=!0,i=-1,a=void 0,u=0,p=t.layerStatesArray.length;u<p;u++){var g=t.layerStatesArray[u].layer,v=g.getRenderer();if(!(v instanceof e)){n=!0;continue}var m=g.getClassName();if((n||m!==a)&&(i+=1,n=!1),a=m,v===this)break}var E="map/"+t.mapId+"/group/"+i;(!this.helper||!this.helper.canvasCacheKeyMatches(E))&&(this.removeHelper(),this.helper=new d1({postProcesses:this.postProcesses_,uniforms:this.uniforms_,canvasCacheKey:E}),a&&(this.helper.getCanvas().className=a),this.afterHelperCreated())}return this.prepareFrameInternal(t)},e.prototype.afterHelperCreated=function(){},e.prototype.prepareFrameInternal=function(t){return!0},e.prototype.disposeInternal=function(){this.removeHelper(),o.prototype.disposeInternal.call(this)},e.prototype.dispatchRenderEvent_=function(t,n,i){var a=this.getLayer();if(a.hasListener(t)){mn(this.inversePixelTransform_,0,0,i.pixelRatio,-i.pixelRatio,0,0,-i.size[1]);var u=new wo(t,this.inversePixelTransform_,i,n);a.dispatchEvent(u)}},e.prototype.preRender=function(t,n){this.dispatchRenderEvent_(Ne.PRERENDER,t,n)},e.prototype.postRender=function(t,n){this.dispatchRenderEvent_(Ne.POSTRENDER,t,n)},e.prototype.getDataAtPixel=function(t,n,i){var a=re([n.pixelRatio,0,0,n.pixelRatio,0,0],t.slice()),u=this.helper.getGL();if(!u)return null;var p=this.getLayer(),g=p.getExtent();if(g){var v=re(n.pixelToCoordinateTransform,t.slice());if(!Xi(g,v))return null}var m=u.getContextAttributes();if(!m||!m.preserveDrawingBuffer)return new Uint8Array;var E=Math.round(a[0]),b=Math.round(a[1]),w=this.pixelContext_;if(!w){var S=document.createElement("canvas");S.width=1,S.height=1,w=S.getContext("2d"),this.pixelContext_=w}w.clearRect(0,0,1,1);var C;try{w.drawImage(u.canvas,E,b,1,1,0,0,1,1),C=w.getImageData(0,0,1,1).data}catch{return C}return C[3]===0?null:C},e}(gp),v1=_1,y1=.5,ph={imageSmoothingEnabled:!1,msImageSmoothingEnabled:!1},m1=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},dt={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function Rp(o){return Math.pow(o,3)}function kr(o){return 1-Rp(1-o)}function x1(o){return 3*o*o-2*o*o*o}function b1(o){return o}var E1=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),T1=function(o){E1(e,o);function e(t,n,i){var a=o.call(this)||this,u=i||{};return a.tileCoord=t,a.state=n,a.interimTile=null,a.key="",a.transition_=u.transition===void 0?250:u.transition,a.transitionStarts_={},a.interpolate=!!u.interpolate,a}return e.prototype.changed=function(){this.dispatchEvent(pt.CHANGE)},e.prototype.release=function(){},e.prototype.getKey=function(){return this.key+"/"+this.tileCoord},e.prototype.getInterimTile=function(){if(!this.interimTile)return this;var t=this.interimTile;do{if(t.getState()==dt.LOADED)return this.transition_=0,t;t=t.interimTile}while(t);return this},e.prototype.refreshInterimChain=function(){if(!!this.interimTile){var t=this.interimTile,n=this;do{if(t.getState()==dt.LOADED){t.interimTile=null;break}else t.getState()==dt.LOADING?n=t:t.getState()==dt.IDLE?n.interimTile=t.interimTile:n=t;t=n.interimTile}while(t)}},e.prototype.getTileCoord=function(){return this.tileCoord},e.prototype.getState=function(){return this.state},e.prototype.setState=function(t){if(this.state!==dt.ERROR&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()},e.prototype.load=function(){Ct()},e.prototype.getAlpha=function(t,n){if(!this.transition_)return 1;var i=this.transitionStarts_[t];if(!i)i=n,this.transitionStarts_[t]=i;else if(i===-1)return 1;var a=n-i+1e3/60;return a>=this.transition_?1:Rp(a/this.transition_)},e.prototype.inTransition=function(t){return this.transition_?this.transitionStarts_[t]!==-1:!1},e.prototype.endTransition=function(t){this.transition_&&(this.transitionStarts_[t]=-1)},e}(Hi),kh=T1,w1=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),S1=function(o){w1(e,o);function e(t,n,i,a,u,p){var g=o.call(this,t,n,p)||this;return g.crossOrigin_=a,g.src_=i,g.key=i,g.image_=new Image,a!==null&&(g.image_.crossOrigin=a),g.unlisten_=null,g.tileLoadFunction_=u,g}return e.prototype.getImage=function(){return this.image_},e.prototype.setImage=function(t){this.image_=t,this.state=dt.LOADED,this.unlistenImage_(),this.changed()},e.prototype.handleImageError_=function(){this.state=dt.ERROR,this.unlistenImage_(),this.image_=R1(),this.changed()},e.prototype.handleImageLoad_=function(){var t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=dt.LOADED:this.state=dt.EMPTY,this.unlistenImage_(),this.changed()},e.prototype.load=function(){this.state==dt.ERROR&&(this.state=dt.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==dt.IDLE&&(this.state=dt.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=Ph(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))},e.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)},e}(kh);function R1(){var o=je(1,1);return o.fillStyle="rgba(0,0,0,0)",o.fillRect(0,0,1,1),o.canvas}var Qf=S1,C1=10,td=.25,O1=function(){function o(e,t,n,i,a,u){this.sourceProj_=e,this.targetProj_=t;var p={},g=Js(this.targetProj_,this.sourceProj_);this.transformInv_=function(L){var k=L[0]+"/"+L[1];return p[k]||(p[k]=g(L)),p[k]},this.maxSourceExtent_=i,this.errorThresholdSquared_=a*a,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!i&&!!this.sourceProj_.getExtent()&&ee(i)==ee(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?ee(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?ee(this.targetProj_.getExtent()):null;var v=Dr(n),m=wa(n),E=Ta(n),b=Ea(n),w=this.transformInv_(v),S=this.transformInv_(m),C=this.transformInv_(E),A=this.transformInv_(b),M=C1+(u?Math.max(0,Math.ceil(Nd(sh(n)/(u*u*256*256)))):0);if(this.addQuad_(v,m,E,b,w,S,C,A,M),this.wrapsXInSource_){var I=1/0;this.triangles_.forEach(function(L,k,N){I=Math.min(I,L.source[0][0],L.source[1][0],L.source[2][0])}),this.triangles_.forEach(function(L){if(Math.max(L.source[0][0],L.source[1][0],L.source[2][0])-I>this.sourceWorldWidth_/2){var k=[[L.source[0][0],L.source[0][1]],[L.source[1][0],L.source[1][1]],[L.source[2][0],L.source[2][1]]];k[0][0]-I>this.sourceWorldWidth_/2&&(k[0][0]-=this.sourceWorldWidth_),k[1][0]-I>this.sourceWorldWidth_/2&&(k[1][0]-=this.sourceWorldWidth_),k[2][0]-I>this.sourceWorldWidth_/2&&(k[2][0]-=this.sourceWorldWidth_);var N=Math.min(k[0][0],k[1][0],k[2][0]),G=Math.max(k[0][0],k[1][0],k[2][0]);G-N<this.sourceWorldWidth_/2&&(L.source=k)}}.bind(this))}p={}}return o.prototype.addTriangle_=function(e,t,n,i,a,u){this.triangles_.push({source:[i,a,u],target:[e,t,n]})},o.prototype.addQuad_=function(e,t,n,i,a,u,p,g,v){var m=pf([a,u,p,g]),E=this.sourceWorldWidth_?ee(m)/this.sourceWorldWidth_:null,b=this.sourceWorldWidth_,w=this.sourceProj_.canWrapX()&&E>.5&&E<1,S=!1;if(v>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){var C=pf([e,t,n,i]),A=ee(C)/this.targetWorldWidth_;S=A>td||S}!w&&this.sourceProj_.isGlobal()&&E&&(S=E>td||S)}if(!(!S&&this.maxSourceExtent_&&isFinite(m[0])&&isFinite(m[1])&&isFinite(m[2])&&isFinite(m[3])&&!ke(m,this.maxSourceExtent_))){var M=0;if(!S&&(!isFinite(a[0])||!isFinite(a[1])||!isFinite(u[0])||!isFinite(u[1])||!isFinite(p[0])||!isFinite(p[1])||!isFinite(g[0])||!isFinite(g[1]))){if(v>0)S=!0;else if(M=(!isFinite(a[0])||!isFinite(a[1])?8:0)+(!isFinite(u[0])||!isFinite(u[1])?4:0)+(!isFinite(p[0])||!isFinite(p[1])?2:0)+(!isFinite(g[0])||!isFinite(g[1])?1:0),M!=1&&M!=2&&M!=4&&M!=8)return}if(v>0){if(!S){var I=[(e[0]+n[0])/2,(e[1]+n[1])/2],L=this.transformInv_(I),k=void 0;if(w){var N=(To(a[0],b)+To(p[0],b))/2;k=N-To(L[0],b)}else k=(a[0]+p[0])/2-L[0];var G=(a[1]+p[1])/2-L[1],z=k*k+G*G;S=z>this.errorThresholdSquared_}if(S){if(Math.abs(e[0]-n[0])<=Math.abs(e[1]-n[1])){var V=[(t[0]+n[0])/2,(t[1]+n[1])/2],Y=this.transformInv_(V),X=[(i[0]+e[0])/2,(i[1]+e[1])/2],J=this.transformInv_(X);this.addQuad_(e,t,V,X,a,u,Y,J,v-1),this.addQuad_(X,V,n,i,J,Y,p,g,v-1)}else{var q=[(e[0]+t[0])/2,(e[1]+t[1])/2],K=this.transformInv_(q),Q=[(n[0]+i[0])/2,(n[1]+i[1])/2],tt=this.transformInv_(Q);this.addQuad_(e,q,Q,i,a,K,tt,g,v-1),this.addQuad_(q,t,n,Q,K,u,p,tt,v-1)}return}}if(w){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}(M&11)==0&&this.addTriangle_(e,n,i,a,p,g),(M&14)==0&&this.addTriangle_(e,n,t,a,p,u),M&&((M&13)==0&&this.addTriangle_(t,i,e,u,g,a),(M&7)==0&&this.addTriangle_(t,i,n,u,g,p))}},o.prototype.calculateSourceExtent=function(){var e=xn();return this.triangles_.forEach(function(t,n,i){var a=t.source;Eo(e,a[0]),Eo(e,a[1]),Eo(e,a[2])}),e},o.prototype.getTriangles=function(){return this.triangles_},o}(),I1=O1,zl;function ed(o,e,t,n,i){o.beginPath(),o.moveTo(0,0),o.lineTo(e,t),o.lineTo(n,i),o.closePath(),o.save(),o.clip(),o.fillRect(0,0,Math.max(e,n)+1,Math.max(t,i)),o.restore()}function Ul(o,e){return Math.abs(o[e*4]-210)>2||Math.abs(o[e*4+3]-.75*255)>2}function A1(){if(zl===void 0){var o=document.createElement("canvas").getContext("2d");o.globalCompositeOperation="lighter",o.fillStyle="rgba(210, 0, 0, 0.75)",ed(o,4,5,4,0),ed(o,4,5,0,5);var e=o.getImageData(0,0,3,3).data;zl=Ul(e,0)||Ul(e,4)||Ul(e,8)}return zl}function nd(o,e,t,n){var i=h0(t,e,o),a=mf(e,n,t),u=e.getMetersPerUnit();u!==void 0&&(a*=u);var p=o.getMetersPerUnit();p!==void 0&&(a/=p);var g=o.getExtent();if(!g||Xi(g,i)){var v=mf(o,a,i)/a;isFinite(v)&&v>0&&(a/=v)}return a}function P1(o,e,t,n){var i=ji(t),a=nd(o,e,i,n);return(!isFinite(a)||a<=0)&&Th(t,function(u){return a=nd(o,e,u,n),isFinite(a)&&a>0}),a}function M1(o,e,t,n,i,a,u,p,g,v,m,E){var b=je(Math.round(t*o),Math.round(t*e));if(E||se(b,ph),g.length===0)return b.canvas;b.scale(t,t);function w(k){return Math.round(k*t)/t}b.globalCompositeOperation="lighter";var S=xn();g.forEach(function(k,N,G){Lm(S,k.extent)});var C=ee(S),A=on(S),M=je(Math.round(t*C/n),Math.round(t*A/n));E||se(M,ph);var I=t/n;g.forEach(function(k,N,G){var z=k.extent[0]-S[0],V=-(k.extent[3]-S[3]),Y=ee(k.extent),X=on(k.extent);k.image.width>0&&k.image.height>0&&M.drawImage(k.image,v,v,k.image.width-2*v,k.image.height-2*v,z*I,V*I,Y*I,X*I)});var L=Dr(u);return p.getTriangles().forEach(function(k,N,G){var z=k.source,V=k.target,Y=z[0][0],X=z[0][1],J=z[1][0],q=z[1][1],K=z[2][0],Q=z[2][1],tt=w((V[0][0]-L[0])/a),nt=w(-(V[0][1]-L[1])/a),ot=w((V[1][0]-L[0])/a),at=w(-(V[1][1]-L[1])/a),ht=w((V[2][0]-L[0])/a),ut=w(-(V[2][1]-L[1])/a),Rt=Y,W=X;Y=0,X=0,J-=Rt,q-=W,K-=Rt,Q-=W;var Yt=[[J,q,0,0,ot-tt],[K,Q,0,0,ht-tt],[0,0,J,q,at-nt],[0,0,K,Q,ut-nt]],Ut=Vm(Yt);if(!!Ut){if(b.save(),b.beginPath(),A1()||!E){b.moveTo(ot,at);for(var Jt=4,ne=tt-ot,ze=nt-at,ie=0;ie<Jt;ie++)b.lineTo(ot+w((ie+1)*ne/Jt),at+w(ie*ze/(Jt-1))),ie!=Jt-1&&b.lineTo(ot+w((ie+1)*ne/Jt),at+w((ie+1)*ze/(Jt-1)));b.lineTo(ht,ut)}else b.moveTo(ot,at),b.lineTo(tt,nt),b.lineTo(ht,ut);b.clip(),b.transform(Ut[0],Ut[2],Ut[1],Ut[3],tt,nt),b.translate(S[0]-Rt,S[3]-W),b.scale(n/t,-n/t),b.drawImage(M.canvas,0,0),b.restore()}}),m&&(b.save(),b.globalCompositeOperation="source-over",b.strokeStyle="black",b.lineWidth=1,p.getTriangles().forEach(function(k,N,G){var z=k.target,V=(z[0][0]-L[0])/a,Y=-(z[0][1]-L[1])/a,X=(z[1][0]-L[0])/a,J=-(z[1][1]-L[1])/a,q=(z[2][0]-L[0])/a,K=-(z[2][1]-L[1])/a;b.beginPath(),b.moveTo(X,J),b.lineTo(V,Y),b.lineTo(q,K),b.closePath(),b.stroke()}),b.restore()),b.canvas}var L1=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),D1=function(o){L1(e,o);function e(t,n,i,a,u,p,g,v,m,E,b,w){var S=o.call(this,u,dt.IDLE,{interpolate:!!w})||this;S.renderEdges_=b!==void 0?b:!1,S.pixelRatio_=g,S.gutter_=v,S.canvas_=null,S.sourceTileGrid_=n,S.targetTileGrid_=a,S.wrappedTileCoord_=p||u,S.sourceTiles_=[],S.sourcesListenerKeys_=null,S.sourceZ_=0;var C=a.getTileCoordExtent(S.wrappedTileCoord_),A=S.targetTileGrid_.getExtent(),M=S.sourceTileGrid_.getExtent(),I=A?zi(C,A):C;if(sh(I)===0)return S.state=dt.EMPTY,S;var L=t.getExtent();L&&(M?M=zi(M,L):M=L);var k=a.getResolution(S.wrappedTileCoord_[0]),N=P1(t,i,I,k);if(!isFinite(N)||N<=0)return S.state=dt.EMPTY,S;var G=E!==void 0?E:y1;if(S.triangulation_=new I1(t,i,I,M,N*G,k),S.triangulation_.getTriangles().length===0)return S.state=dt.EMPTY,S;S.sourceZ_=n.getZForResolution(N);var z=S.triangulation_.calculateSourceExtent();if(M&&(t.canWrapX()?(z[1]=ae(z[1],M[1],M[3]),z[3]=ae(z[3],M[1],M[3])):z=zi(z,M)),!sh(z))S.state=dt.EMPTY;else{for(var V=n.getTileRangeForExtentAndZ(z,S.sourceZ_),Y=V.minX;Y<=V.maxX;Y++)for(var X=V.minY;X<=V.maxY;X++){var J=m(S.sourceZ_,Y,X,g);J&&S.sourceTiles_.push(J)}S.sourceTiles_.length===0&&(S.state=dt.EMPTY)}return S}return e.prototype.getImage=function(){return this.canvas_},e.prototype.reproject_=function(){var t=[];if(this.sourceTiles_.forEach(function(m,E,b){m&&m.getState()==dt.LOADED&&t.push({extent:this.sourceTileGrid_.getTileCoordExtent(m.tileCoord),image:m.getImage()})}.bind(this)),this.sourceTiles_.length=0,t.length===0)this.state=dt.ERROR;else{var n=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(n),a=typeof i=="number"?i:i[0],u=typeof i=="number"?i:i[1],p=this.targetTileGrid_.getResolution(n),g=this.sourceTileGrid_.getResolution(this.sourceZ_),v=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=M1(a,u,this.pixelRatio_,g,this.sourceTileGrid_.getExtent(),p,v,this.triangulation_,t,this.gutter_,this.renderEdges_,this.interpolate),this.state=dt.LOADED}this.changed()},e.prototype.load=function(){if(this.state==dt.IDLE){this.state=dt.LOADING,this.changed();var t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(function(n,i,a){var u=n.getState();if(u==dt.IDLE||u==dt.LOADING){t++;var p=Lt(n,pt.CHANGE,function(g){var v=n.getState();(v==dt.LOADED||v==dt.ERROR||v==dt.EMPTY)&&(qt(p),t--,t===0&&(this.unlistenSources_(),this.reproject_()))},this);this.sourcesListenerKeys_.push(p)}}.bind(this)),t===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function(n,i,a){var u=n.getState();u==dt.IDLE&&n.load()})}},e.prototype.unlistenSources_=function(){this.sourcesListenerKeys_.forEach(qt),this.sourcesListenerKeys_=null},e}(kh),k1=D1,Cp=function(){function o(e,t,n,i){this.minX=e,this.maxX=t,this.minY=n,this.maxY=i}return o.prototype.contains=function(e){return this.containsXY(e[1],e[2])},o.prototype.containsTileRange=function(e){return this.minX<=e.minX&&e.maxX<=this.maxX&&this.minY<=e.minY&&e.maxY<=this.maxY},o.prototype.containsXY=function(e,t){return this.minX<=e&&e<=this.maxX&&this.minY<=t&&t<=this.maxY},o.prototype.equals=function(e){return this.minX==e.minX&&this.minY==e.minY&&this.maxX==e.maxX&&this.maxY==e.maxY},o.prototype.extend=function(e){e.minX<this.minX&&(this.minX=e.minX),e.maxX>this.maxX&&(this.maxX=e.maxX),e.minY<this.minY&&(this.minY=e.minY),e.maxY>this.maxY&&(this.maxY=e.maxY)},o.prototype.getHeight=function(){return this.maxY-this.minY+1},o.prototype.getSize=function(){return[this.getWidth(),this.getHeight()]},o.prototype.getWidth=function(){return this.maxX-this.minX+1},o.prototype.intersects=function(e){return this.minX<=e.maxX&&this.maxX>=e.minX&&this.minY<=e.maxY&&this.maxY>=e.minY},o}();function fr(o,e,t,n,i){return i!==void 0?(i.minX=o,i.maxX=e,i.minY=t,i.maxY=n,i):new Cp(o,e,t,n)}var Op=Cp,Ps={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"},F1=function(){function o(e){this.highWaterMark=e!==void 0?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}return o.prototype.canExpireCache=function(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark},o.prototype.expireCache=function(e){for(;this.canExpireCache();)this.pop()},o.prototype.clear=function(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null},o.prototype.containsKey=function(e){return this.entries_.hasOwnProperty(e)},o.prototype.forEach=function(e){for(var t=this.oldest_;t;)e(t.value_,t.key_,this),t=t.newer},o.prototype.get=function(e,t){var n=this.entries_[e];return Ot(n!==void 0,15),n===this.newest_||(n===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(n.newer.older=n.older,n.older.newer=n.newer),n.newer=null,n.older=this.newest_,this.newest_.newer=n,this.newest_=n),n.value_},o.prototype.remove=function(e){var t=this.entries_[e];return Ot(t!==void 0,15),t===this.newest_?(this.newest_=t.older,this.newest_&&(this.newest_.newer=null)):t===this.oldest_?(this.oldest_=t.newer,this.oldest_&&(this.oldest_.older=null)):(t.newer.older=t.older,t.older.newer=t.newer),delete this.entries_[e],--this.count_,t.value_},o.prototype.getCount=function(){return this.count_},o.prototype.getKeys=function(){var e=new Array(this.count_),t=0,n;for(n=this.newest_;n;n=n.older)e[t++]=n.key_;return e},o.prototype.getValues=function(){var e=new Array(this.count_),t=0,n;for(n=this.newest_;n;n=n.older)e[t++]=n.value_;return e},o.prototype.peekLast=function(){return this.oldest_.value_},o.prototype.peekLastKey=function(){return this.oldest_.key_},o.prototype.peekFirstKey=function(){return this.newest_.key_},o.prototype.pop=function(){var e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_},o.prototype.replace=function(e,t){this.get(e),this.entries_[e].value_=t},o.prototype.set=function(e,t){Ot(!(e in this.entries_),16);var n={key_:e,newer:null,older:this.newest_,value_:t};this.newest_?this.newest_.newer=n:this.oldest_=n,this.newest_=n,this.entries_[e]=n,++this.count_},o.prototype.setSize=function(e){this.highWaterMark=e},o}(),Ip=F1;function la(o,e,t,n){return n!==void 0?(n[0]=o,n[1]=e,n[2]=t,n):[o,e,t]}function Fh(o,e,t){return o+"/"+e+"/"+t}function ha(o){return Fh(o[0],o[1],o[2])}function N1(o){return o.split("/").map(Number)}function B1(o,e){var t=o[0],n=o[1],i=o[2];if(e.getMinZoom()>t||t>e.getMaxZoom())return!1;var a=e.getFullTileRange(t);return a?a.containsXY(n,i):!0}var G1=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),z1=function(o){G1(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return e.prototype.expireCache=function(t){for(;this.canExpireCache();){var n=this.peekLast();if(n.getKey()in t)break;this.pop().release()}},e.prototype.pruneExceptNewestZ=function(){if(this.getCount()!==0){var t=this.peekFirstKey(),n=N1(t),i=n[0];this.forEach(function(a){a.tileCoord[0]!==i&&(this.remove(ha(a.tileCoord)),a.release())}.bind(this))}},e}(Ip),U1=z1,Vl={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"},V1=42,Nh=256,X1=[0,0,0],ei=5,j1=function(){function o(e){this.minZoom=e.minZoom!==void 0?e.minZoom:0,this.resolutions_=e.resolutions,Ot(nm(this.resolutions_,function(u,p){return p-u},!0),17);var t;if(!e.origins){for(var n=0,i=this.resolutions_.length-1;n<i;++n)if(!t)t=this.resolutions_[n]/this.resolutions_[n+1];else if(this.resolutions_[n]/this.resolutions_[n+1]!==t){t=void 0;break}}this.zoomFactor_=t,this.maxZoom=this.resolutions_.length-1,this.origin_=e.origin!==void 0?e.origin:null,this.origins_=null,e.origins!==void 0&&(this.origins_=e.origins,Ot(this.origins_.length==this.resolutions_.length,20));var a=e.extent;a!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=Dr(a)),Ot(!this.origin_&&this.origins_||this.origin_&&!this.origins_,18),this.tileSizes_=null,e.tileSizes!==void 0&&(this.tileSizes_=e.tileSizes,Ot(this.tileSizes_.length==this.resolutions_.length,19)),this.tileSize_=e.tileSize!==void 0?e.tileSize:this.tileSizes_?null:Nh,Ot(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,22),this.extent_=a!==void 0?a:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],e.sizes!==void 0?this.fullTileRanges_=e.sizes.map(function(u,p){var g=new Op(Math.min(0,u[0]),Math.max(u[0]-1,-1),Math.min(0,u[1]),Math.max(u[1]-1,-1));if(a){var v=this.getTileRangeForExtentAndZ(a,p);g.minX=Math.max(v.minX,g.minX),g.maxX=Math.min(v.maxX,g.maxX),g.minY=Math.max(v.minY,g.minY),g.maxY=Math.min(v.maxY,g.maxY)}return g},this):a&&this.calculateTileRanges_(a)}return o.prototype.forEachTileCoord=function(e,t,n){for(var i=this.getTileRangeForExtentAndZ(e,t),a=i.minX,u=i.maxX;a<=u;++a)for(var p=i.minY,g=i.maxY;p<=g;++p)n([t,a,p])},o.prototype.forEachTileCoordParentTileRange=function(e,t,n,i){var a,u,p,g=null,v=e[0]-1;for(this.zoomFactor_===2?(u=e[1],p=e[2]):g=this.getTileCoordExtent(e,i);v>=this.minZoom;){if(this.zoomFactor_===2?(u=Math.floor(u/2),p=Math.floor(p/2),a=fr(u,u,p,p,n)):a=this.getTileRangeForExtentAndZ(g,v,n),t(v,a))return!0;--v}return!1},o.prototype.getExtent=function(){return this.extent_},o.prototype.getMaxZoom=function(){return this.maxZoom},o.prototype.getMinZoom=function(){return this.minZoom},o.prototype.getOrigin=function(e){return this.origin_?this.origin_:this.origins_[e]},o.prototype.getResolution=function(e){return this.resolutions_[e]},o.prototype.getResolutions=function(){return this.resolutions_},o.prototype.getTileCoordChildTileRange=function(e,t,n){if(e[0]<this.maxZoom){if(this.zoomFactor_===2){var i=e[1]*2,a=e[2]*2;return fr(i,i+1,a,a+1,t)}var u=this.getTileCoordExtent(e,n||this.tmpExtent_);return this.getTileRangeForExtentAndZ(u,e[0]+1,t)}return null},o.prototype.getTileRangeForTileCoordAndZ=function(e,t,n){if(t>this.maxZoom||t<this.minZoom)return null;var i=e[0],a=e[1],u=e[2];if(t===i)return fr(a,u,a,u,n);if(this.zoomFactor_){var p=Math.pow(this.zoomFactor_,t-i),g=Math.floor(a*p),v=Math.floor(u*p);if(t<i)return fr(g,g,v,v,n);var m=Math.floor(p*(a+1))-1,E=Math.floor(p*(u+1))-1;return fr(g,m,v,E,n)}var b=this.getTileCoordExtent(e,this.tmpExtent_);return this.getTileRangeForExtentAndZ(b,t,n)},o.prototype.getTileRangeExtent=function(e,t,n){var i=this.getOrigin(e),a=this.getResolution(e),u=Be(this.getTileSize(e),this.tmpSize_),p=i[0]+t.minX*u[0]*a,g=i[0]+(t.maxX+1)*u[0]*a,v=i[1]+t.minY*u[1]*a,m=i[1]+(t.maxY+1)*u[1]*a;return bn(p,v,g,m,n)},o.prototype.getTileRangeForExtentAndZ=function(e,t,n){var i=X1;this.getTileCoordForXYAndZ_(e[0],e[3],t,!1,i);var a=i[1],u=i[2];return this.getTileCoordForXYAndZ_(e[2],e[1],t,!0,i),fr(a,i[1],u,i[2],n)},o.prototype.getTileCoordCenter=function(e){var t=this.getOrigin(e[0]),n=this.getResolution(e[0]),i=Be(this.getTileSize(e[0]),this.tmpSize_);return[t[0]+(e[1]+.5)*i[0]*n,t[1]-(e[2]+.5)*i[1]*n]},o.prototype.getTileCoordExtent=function(e,t){var n=this.getOrigin(e[0]),i=this.getResolution(e[0]),a=Be(this.getTileSize(e[0]),this.tmpSize_),u=n[0]+e[1]*a[0]*i,p=n[1]-(e[2]+1)*a[1]*i,g=u+a[0]*i,v=p+a[1]*i;return bn(u,p,g,v,t)},o.prototype.getTileCoordForCoordAndResolution=function(e,t,n){return this.getTileCoordForXYAndResolution_(e[0],e[1],t,!1,n)},o.prototype.getTileCoordForXYAndResolution_=function(e,t,n,i,a){var u=this.getZForResolution(n),p=n/this.getResolution(u),g=this.getOrigin(u),v=Be(this.getTileSize(u),this.tmpSize_),m=p*(e-g[0])/n/v[0],E=p*(g[1]-t)/n/v[1];return i?(m=Ts(m,ei)-1,E=Ts(E,ei)-1):(m=Es(m,ei),E=Es(E,ei)),la(u,m,E,a)},o.prototype.getTileCoordForXYAndZ_=function(e,t,n,i,a){var u=this.getOrigin(n),p=this.getResolution(n),g=Be(this.getTileSize(n),this.tmpSize_),v=(e-u[0])/p/g[0],m=(u[1]-t)/p/g[1];return i?(v=Ts(v,ei)-1,m=Ts(m,ei)-1):(v=Es(v,ei),m=Es(m,ei)),la(n,v,m,a)},o.prototype.getTileCoordForCoordAndZ=function(e,t,n){return this.getTileCoordForXYAndZ_(e[0],e[1],t,!1,n)},o.prototype.getTileCoordResolution=function(e){return this.resolutions_[e[0]]},o.prototype.getTileSize=function(e){return this.tileSize_?this.tileSize_:this.tileSizes_[e]},o.prototype.getFullTileRange=function(e){return this.fullTileRanges_?this.fullTileRanges_[e]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,e):null},o.prototype.getZForResolution=function(e,t){var n=bh(this.resolutions_,e,t||0);return ae(n,this.minZoom,this.maxZoom)},o.prototype.calculateTileRanges_=function(e){for(var t=this.resolutions_.length,n=new Array(t),i=this.minZoom;i<t;++i)n[i]=this.getTileRangeForExtentAndZ(e,i);this.fullTileRanges_=n},o}(),Bh=j1;function W1(o){var e=o.getDefaultTileGrid();return e||(e=K1(o),o.setDefaultTileGrid(e)),e}function H1(o,e,t){var n=e[0],i=o.getTileCoordCenter(e),a=Gh(t);if(Xi(a,i))return e;var u=ee(a),p=Math.ceil((a[0]-i[0])/u);return i[0]+=u*p,o.getTileCoordForCoordAndZ(i,n)}function Y1(o,e,t,n){var i=n!==void 0?n:_o.TOP_LEFT,a=Ap(o,e,t);return new Bh({extent:o,origin:km(o,i),resolutions:a,tileSize:t})}function $1(o){var e=o||{},t=e.extent||qe("EPSG:3857").getExtent(),n={extent:t,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:Ap(t,e.maxZoom,e.tileSize,e.maxResolution)};return new Bh(n)}function Ap(o,e,t,n){for(var i=e!==void 0?e:V1,a=on(o),u=ee(o),p=Be(t!==void 0?t:Nh),g=n>0?n:Math.max(u/p[0],a/p[1]),v=i+1,m=new Array(v),E=0;E<v;++E)m[E]=g/Math.pow(2,E);return m}function K1(o,e,t,n){var i=Gh(o);return Y1(i,e,t,n)}function Gh(o){o=qe(o);var e=o.getExtent();if(!e){var t=180*yn[ge.DEGREES]/o.getMetersPerUnit();e=bn(-t,-t,t,t)}return e}var Pp=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Z1=function(o){Pp(e,o);function e(t){var n=o.call(this,{attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,projection:t.projection,state:t.state,wrapX:t.wrapX,interpolate:t.interpolate})||this;n.on,n.once,n.un,n.opaque_=t.opaque!==void 0?t.opaque:!1,n.tilePixelRatio_=t.tilePixelRatio!==void 0?t.tilePixelRatio:1,n.tileGrid=t.tileGrid!==void 0?t.tileGrid:null;var i=[256,256];return n.tileGrid&&Be(n.tileGrid.getTileSize(n.tileGrid.getMinZoom()),i),n.tileCache=new U1(t.cacheSize||0),n.tmpSize=[0,0],n.key_=t.key||"",n.tileOptions={transition:t.transition,interpolate:t.interpolate},n.zDirection=t.zDirection?t.zDirection:0,n}return e.prototype.canExpireCache=function(){return this.tileCache.canExpireCache()},e.prototype.expireCache=function(t,n){var i=this.getTileCacheForProjection(t);i&&i.expireCache(n)},e.prototype.forEachLoadedTile=function(t,n,i,a){var u=this.getTileCacheForProjection(t);if(!u)return!1;for(var p=!0,g,v,m,E=i.minX;E<=i.maxX;++E)for(var b=i.minY;b<=i.maxY;++b)v=Fh(n,E,b),m=!1,u.containsKey(v)&&(g=u.get(v),m=g.getState()===dt.LOADED,m&&(m=a(g)!==!1)),m||(p=!1);return p},e.prototype.getGutterForProjection=function(t){return 0},e.prototype.getKey=function(){return this.key_},e.prototype.setKey=function(t){this.key_!==t&&(this.key_=t,this.changed())},e.prototype.getOpaque=function(t){return this.opaque_},e.prototype.getResolutions=function(){return this.tileGrid?this.tileGrid.getResolutions():null},e.prototype.getTile=function(t,n,i,a,u){return Ct()},e.prototype.getTileGrid=function(){return this.tileGrid},e.prototype.getTileGridForProjection=function(t){return this.tileGrid?this.tileGrid:W1(t)},e.prototype.getTileCacheForProjection=function(t){return Ot(l0(this.getProjection(),t),68),this.tileCache},e.prototype.getTilePixelRatio=function(t){return this.tilePixelRatio_},e.prototype.getTilePixelSize=function(t,n,i){var a=this.getTileGridForProjection(i),u=this.getTilePixelRatio(n),p=Be(a.getTileSize(t),this.tmpSize);return u==1?p:$0(p,u,this.tmpSize)},e.prototype.getTileCoordForTileUrlFunction=function(t,n){var i=n!==void 0?n:this.getProjection(),a=this.getTileGridForProjection(i);return this.getWrapX()&&i.isGlobal()&&(t=H1(a,t,i)),B1(t,a)?t:null},e.prototype.clear=function(){this.tileCache.clear()},e.prototype.refresh=function(){this.clear(),o.prototype.refresh.call(this)},e.prototype.updateCacheSize=function(t,n){var i=this.getTileCacheForProjection(n);t>i.highWaterMark&&(i.highWaterMark=t)},e.prototype.useTile=function(t,n,i,a){},e}(yp),q1=function(o){Pp(e,o);function e(t,n){var i=o.call(this,t)||this;return i.tile=n,i}return e}(Bn),J1=Z1,Q1=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),tE=function(o){Q1(e,o);function e(t){var n=o.call(this)||this;return n.map_=t,n}return e.prototype.dispatchRenderEvent=function(t,n){Ct()},e.prototype.calculateMatrices2D=function(t){var n=t.viewState,i=t.coordinateToPixelTransform,a=t.pixelToCoordinateTransform;mn(i,t.size[0]/2,t.size[1]/2,1/n.resolution,-1/n.resolution,-n.rotation,-n.center[0],-n.center[1]),Md(a,i)},e.prototype.forEachFeatureAtCoordinate=function(t,n,i,a,u,p,g,v){var m,E=n.viewState;function b(tt,nt,ot,at){return u.call(p,nt,tt?ot:null,at)}var w=E.projection,S=Gd(t.slice(),w),C=[[0,0]];if(w.canWrapX()&&a){var A=w.getExtent(),M=ee(A);C.push([-M,0],[M,0])}for(var I=n.layerStatesArray,L=I.length,k=[],N=[],G=0;G<C.length;G++)for(var z=L-1;z>=0;--z){var V=I[z],Y=V.layer;if(Y.hasRenderer()&&ra(V,E)&&g.call(v,Y)){var X=Y.getRenderer(),J=Y.getSource();if(X&&J){var q=J.getWrapX()?S:t,K=b.bind(null,V.managed);N[0]=q[0]+C[G][0],N[1]=q[1]+C[G][1],m=X.forEachFeatureAtCoordinate(N,n,i,K,k)}if(m)return m}}if(k.length!==0){var Q=1/k.length;return k.forEach(function(tt,nt){return tt.distanceSq+=nt*Q}),k.sort(function(tt,nt){return tt.distanceSq-nt.distanceSq}),k.some(function(tt){return m=tt.callback(tt.feature,tt.layer,tt.geometry)}),m}},e.prototype.forEachLayerAtPixel=function(t,n,i,a,u){return Ct()},e.prototype.hasFeatureAtCoordinate=function(t,n,i,a,u,p){var g=this.forEachFeatureAtCoordinate(t,n,i,a,Sr,this,u,p);return g!==void 0},e.prototype.getMap=function(){return this.map_},e.prototype.renderFrame=function(t){Ct()},e.prototype.scheduleExpireIconCache=function(t){sa.canExpireCache()&&t.postRenderFunctions.push(eE)},e}(_a);function eE(o,e){sa.expire()}var nE=tE,iE=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),rE=function(o){iE(e,o);function e(t){var n=o.call(this,t)||this;n.fontChangeListenerKey_=Lt(Mn,Ir.PROPERTYCHANGE,t.redrawText.bind(t)),n.element_=document.createElement("div");var i=n.element_.style;i.position="absolute",i.width="100%",i.height="100%",i.zIndex="0",n.element_.className=Ca+" ol-layers";var a=t.getViewport();return a.insertBefore(n.element_,a.firstChild||null),n.children_=[],n.renderedVisible_=!0,n}return e.prototype.dispatchRenderEvent=function(t,n){var i=this.getMap();if(i.hasListener(t)){var a=new wo(t,void 0,n);i.dispatchEvent(a)}},e.prototype.disposeInternal=function(){qt(this.fontChangeListenerKey_),this.element_.parentNode.removeChild(this.element_),o.prototype.disposeInternal.call(this)},e.prototype.renderFrame=function(t){if(!t){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(t),this.dispatchRenderEvent(Ne.PRECOMPOSE,t);var n=t.layerStatesArray.sort(function(w,S){return w.zIndex-S.zIndex}),i=t.viewState;this.children_.length=0;for(var a=[],u=null,p=0,g=n.length;p<g;++p){var v=n[p];t.layerIndex=p;var m=v.layer,E=m.getSourceState();if(!ra(v,i)||E!=Oe.READY&&E!=Oe.UNDEFINED){m.unrender();continue}var b=m.render(t,u);!b||(b!==u&&(this.children_.push(b),u=b),"getDeclutter"in m&&a.push(m))}for(var p=a.length-1;p>=0;--p)a[p].renderDeclutter(t);Q0(this.element_,this.children_),this.dispatchRenderEvent(Ne.POSTCOMPOSE,t),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(t)},e.prototype.forEachLayerAtPixel=function(t,n,i,a,u){for(var p=n.viewState,g=n.layerStatesArray,v=g.length,m=v-1;m>=0;--m){var E=g[m],b=E.layer;if(b.hasRenderer()&&ra(E,p)&&u(b)){var w=b.getRenderer(),S=w.getDataAtPixel(t,n,i);if(S){var C=a(b,S);if(C)return C}}}},e}(nE),oE=rE,sE=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),aE=function(o){sE(e,o);function e(t,n,i){var a=o.call(this,t)||this;return a.map=n,a.frameState=i!==void 0?i:null,a}return e}(Bn),_r=aE,lE=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),hE=function(o){lE(e,o);function e(t,n,i,a,u){var p=o.call(this,t,n,u)||this;return p.originalEvent=i,p.pixel_=null,p.coordinate_=null,p.dragging=a!==void 0?a:!1,p}return Object.defineProperty(e.prototype,"pixel",{get:function(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_},set:function(t){this.pixel_=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"coordinate",{get:function(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_},set:function(t){this.coordinate_=t},enumerable:!1,configurable:!0}),e.prototype.preventDefault=function(){o.prototype.preventDefault.call(this),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()},e.prototype.stopPropagation=function(){o.prototype.stopPropagation.call(this),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()},e}(_r),ni=hE,$t={SINGLECLICK:"singleclick",CLICK:pt.CLICK,DBLCLICK:pt.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},gh={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},cE=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),uE=function(o){cE(e,o);function e(t,n){var i=o.call(this,t)||this;i.map_=t,i.clickTimeoutId_,i.emulateClicks_=!1,i.dragging_=!1,i.dragListenerKeys_=[],i.moveTolerance_=n===void 0?1:n,i.down_=null;var a=i.map_.getViewport();return i.activePointers_=0,i.trackedTouches_={},i.element_=a,i.pointerdownListenerKey_=Lt(a,gh.POINTERDOWN,i.handlePointerDown_,i),i.originalPointerMoveEvent_,i.relayedListenerKey_=Lt(a,gh.POINTERMOVE,i.relayEvent_,i),i.boundHandleTouchMove_=i.handleTouchMove_.bind(i),i.element_.addEventListener(pt.TOUCHMOVE,i.boundHandleTouchMove_,Id?{passive:!1}:!1),i}return e.prototype.emulateClick_=function(t){var n=new ni($t.CLICK,this.map_,t);this.dispatchEvent(n),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,n=new ni($t.DBLCLICK,this.map_,t),this.dispatchEvent(n)):this.clickTimeoutId_=setTimeout(function(){this.clickTimeoutId_=void 0;var i=new ni($t.SINGLECLICK,this.map_,t);this.dispatchEvent(i)}.bind(this),250)},e.prototype.updateActivePointers_=function(t){var n=t;n.type==$t.POINTERUP||n.type==$t.POINTERCANCEL?delete this.trackedTouches_[n.pointerId]:n.type==$t.POINTERDOWN&&(this.trackedTouches_[n.pointerId]=!0),this.activePointers_=Object.keys(this.trackedTouches_).length},e.prototype.handlePointerUp_=function(t){this.updateActivePointers_(t);var n=new ni($t.POINTERUP,this.map_,t);this.dispatchEvent(n),this.emulateClicks_&&!n.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(t)&&this.emulateClick_(this.down_),this.activePointers_===0&&(this.dragListenerKeys_.forEach(qt),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)},e.prototype.isMouseActionButton_=function(t){return t.button===0},e.prototype.handlePointerDown_=function(t){this.emulateClicks_=this.activePointers_===0,this.updateActivePointers_(t);var n=new ni($t.POINTERDOWN,this.map_,t);this.dispatchEvent(n),this.down_={};for(var i in t){var a=t[i];this.down_[i]=typeof a=="function"?Vi:a}if(this.dragListenerKeys_.length===0){var u=this.map_.getOwnerDocument();this.dragListenerKeys_.push(Lt(u,$t.POINTERMOVE,this.handlePointerMove_,this),Lt(u,$t.POINTERUP,this.handlePointerUp_,this),Lt(this.element_,$t.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==u&&this.dragListenerKeys_.push(Lt(this.element_.getRootNode(),$t.POINTERUP,this.handlePointerUp_,this))}},e.prototype.handlePointerMove_=function(t){if(this.isMoving_(t)){this.dragging_=!0;var n=new ni($t.POINTERDRAG,this.map_,t,this.dragging_);this.dispatchEvent(n)}},e.prototype.relayEvent_=function(t){this.originalPointerMoveEvent_=t;var n=!!(this.down_&&this.isMoving_(t));this.dispatchEvent(new ni(t.type,this.map_,t,n))},e.prototype.handleTouchMove_=function(t){var n=this.originalPointerMoveEvent_;(!n||n.defaultPrevented)&&(typeof t.cancelable!="boolean"||t.cancelable===!0)&&t.preventDefault()},e.prototype.isMoving_=function(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_},e.prototype.disposeInternal=function(){this.relayedListenerKey_&&(qt(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(pt.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(qt(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(qt),this.dragListenerKeys_.length=0,this.element_=null,o.prototype.disposeInternal.call(this)},e}(Hi),fE=uE,ii={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},be={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"},ca=1/0,dE=function(){function o(e,t){this.priorityFunction_=e,this.keyFunction_=t,this.elements_=[],this.priorities_=[],this.queuedElements_={}}return o.prototype.clear=function(){this.elements_.length=0,this.priorities_.length=0,Lr(this.queuedElements_)},o.prototype.dequeue=function(){var e=this.elements_,t=this.priorities_,n=e[0];e.length==1?(e.length=0,t.length=0):(e[0]=e.pop(),t[0]=t.pop(),this.siftUp_(0));var i=this.keyFunction_(n);return delete this.queuedElements_[i],n},o.prototype.enqueue=function(e){Ot(!(this.keyFunction_(e)in this.queuedElements_),31);var t=this.priorityFunction_(e);return t!=ca?(this.elements_.push(e),this.priorities_.push(t),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1},o.prototype.getCount=function(){return this.elements_.length},o.prototype.getLeftChildIndex_=function(e){return e*2+1},o.prototype.getRightChildIndex_=function(e){return e*2+2},o.prototype.getParentIndex_=function(e){return e-1>>1},o.prototype.heapify_=function(){var e;for(e=(this.elements_.length>>1)-1;e>=0;e--)this.siftUp_(e)},o.prototype.isEmpty=function(){return this.elements_.length===0},o.prototype.isKeyQueued=function(e){return e in this.queuedElements_},o.prototype.isQueued=function(e){return this.isKeyQueued(this.keyFunction_(e))},o.prototype.siftUp_=function(e){for(var t=this.elements_,n=this.priorities_,i=t.length,a=t[e],u=n[e],p=e;e<i>>1;){var g=this.getLeftChildIndex_(e),v=this.getRightChildIndex_(e),m=v<i&&n[v]<n[g]?v:g;t[e]=t[m],n[e]=n[m],e=m}t[e]=a,n[e]=u,this.siftDown_(p,e)},o.prototype.siftDown_=function(e,t){for(var n=this.elements_,i=this.priorities_,a=n[t],u=i[t];t>e;){var p=this.getParentIndex_(t);if(i[p]>u)n[t]=n[p],i[t]=i[p],t=p;else break}n[t]=a,i[t]=u},o.prototype.reprioritize=function(){var e=this.priorityFunction_,t=this.elements_,n=this.priorities_,i=0,a=t.length,u,p,g;for(p=0;p<a;++p)u=t[p],g=e(u),g==ca?delete this.queuedElements_[this.keyFunction_(u)]:(n[i]=g,t[i++]=u);t.length=i,n.length=i,this.heapify_()},o}(),pE=dE,gE=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),_E=function(o){gE(e,o);function e(t,n){var i=o.call(this,function(a){return t.apply(null,a)},function(a){return a[0].getKey()})||this;return i.boundHandleTileChange_=i.handleTileChange.bind(i),i.tileChangeCallback_=n,i.tilesLoading_=0,i.tilesLoadingKeys_={},i}return e.prototype.enqueue=function(t){var n=o.prototype.enqueue.call(this,t);if(n){var i=t[0];i.addEventListener(pt.CHANGE,this.boundHandleTileChange_)}return n},e.prototype.getTilesLoading=function(){return this.tilesLoading_},e.prototype.handleTileChange=function(t){var n=t.target,i=n.getState();if(i===dt.LOADED||i===dt.ERROR||i===dt.EMPTY){n.removeEventListener(pt.CHANGE,this.boundHandleTileChange_);var a=n.getKey();a in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[a],--this.tilesLoading_),this.tileChangeCallback_()}},e.prototype.loadMoreTiles=function(t,n){for(var i=0,a,u,p;this.tilesLoading_<t&&i<n&&this.getCount()>0;)u=this.dequeue()[0],p=u.getKey(),a=u.getState(),a===dt.IDLE&&!(p in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[p]=!0,++this.tilesLoading_,++i,u.load())},e}(pE),vE=_E;function yE(o,e,t,n,i){if(!o||!(t in o.wantedTiles)||!o.wantedTiles[t][e.getKey()])return ca;var a=o.viewState.center,u=n[0]-a[0],p=n[1]-a[1];return 65536*Math.log(i)+Math.sqrt(u*u+p*p)/i}var rn={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function id(o,e,t){return function(n,i,a,u,p){if(!!n){if(!i&&!e)return n;var g=e?0:a[0]*i,v=e?0:a[1]*i,m=p?p[0]:0,E=p?p[1]:0,b=o[0]+g/2+m,w=o[2]-g/2+m,S=o[1]+v/2+E,C=o[3]-v/2+E;b>w&&(b=(w+b)/2,w=b),S>C&&(S=(C+S)/2,C=S);var A=ae(n[0],b,w),M=ae(n[1],S,C);if(u&&t&&i){var I=30*i;A+=-I*Math.log(1+Math.max(0,b-n[0])/I)+I*Math.log(1+Math.max(0,n[0]-w)/I),M+=-I*Math.log(1+Math.max(0,S-n[1])/I)+I*Math.log(1+Math.max(0,n[1]-C)/I)}return[A,M]}}}function mE(o){return o}function zh(o,e,t,n){var i=ee(e)/t[0],a=on(e)/t[1];return n?Math.min(o,Math.max(i,a)):Math.min(o,Math.min(i,a))}function Uh(o,e,t){var n=Math.min(o,e),i=50;return n*=Math.log(1+i*Math.max(0,o/e-1))/i+1,t&&(n=Math.max(n,t),n/=Math.log(1+i*Math.max(0,t/o-1))/i+1),ae(n,t/2,e*2)}function xE(o,e,t,n){return function(i,a,u,p){if(i!==void 0){var g=o[0],v=o[o.length-1],m=t?zh(g,t,u,n):g;if(p){var E=e!==void 0?e:!0;return E?Uh(i,m,v):ae(i,v,m)}var b=Math.min(m,i),w=Math.floor(bh(o,b,a));return o[w]>m&&w<o.length-1?o[w+1]:o[w]}else return}}function bE(o,e,t,n,i,a){return function(u,p,g,v){if(u!==void 0){var m=i?zh(e,i,g,a):e,E=t!==void 0?t:0;if(v){var b=n!==void 0?n:!0;return b?Uh(u,m,E):ae(u,E,m)}var w=1e-9,S=Math.ceil(Math.log(e/m)/Math.log(o)-w),C=-p*(.5-w)+.5,A=Math.min(m,u),M=Math.floor(Math.log(e/A)/Math.log(o)+C),I=Math.max(S,M),L=e/Math.pow(o,I);return ae(L,E,m)}else return}}function rd(o,e,t,n,i){return function(a,u,p,g){if(a!==void 0){var v=n?zh(o,n,p,i):o,m=t!==void 0?t:!0;return!m||!g?ae(a,e,v):Uh(a,v,e)}else return}}function Vh(o){if(o!==void 0)return 0}function od(o){if(o!==void 0)return o}function EE(o){var e=2*Math.PI/o;return function(t,n){if(n)return t;if(t!==void 0)return t=Math.floor(t/e+.5)*e,t}}function TE(o){var e=o||Gs(5);return function(t,n){if(n)return t;if(t!==void 0)return Math.abs(t)<=e?0:t}}var wE=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Xl=0,SE=function(o){wE(e,o);function e(t){var n=o.call(this)||this;n.on,n.once,n.un;var i=se({},t);return n.hints_=[0,0],n.animations_=[],n.updateAnimationKey_,n.projection_=Rh(i.projection,"EPSG:3857"),n.viewportSize_=[100,100],n.targetCenter_=null,n.targetResolution_,n.targetRotation_,n.nextCenter_=null,n.nextResolution_,n.nextRotation_,n.cancelAnchor_=void 0,i.projection&&r0(),i.center&&(i.center=Pn(i.center,n.projection_)),i.extent&&(i.extent=Di(i.extent,n.projection_)),n.applyOptions_(i),n}return e.prototype.applyOptions_=function(t){var n=se({},t);for(var i in rn)delete n[i];this.setProperties(n,!0);var a=CE(t);this.maxResolution_=a.maxResolution,this.minResolution_=a.minResolution,this.zoomFactor_=a.zoomFactor,this.resolutions_=t.resolutions,this.padding_=t.padding,this.minZoom_=a.minZoom;var u=RE(t),p=a.constraint,g=OE(t);this.constraints_={center:u,resolution:p,rotation:g},this.setRotation(t.rotation!==void 0?t.rotation:0),this.setCenterInternal(t.center!==void 0?t.center:null),t.resolution!==void 0?this.setResolution(t.resolution):t.zoom!==void 0&&this.setZoom(t.zoom)},Object.defineProperty(e.prototype,"padding",{get:function(){return this.padding_},set:function(t){var n=this.padding_;this.padding_=t;var i=this.getCenter();if(i){var a=t||[0,0,0,0];n=n||[0,0,0,0];var u=this.getResolution(),p=u/2*(a[3]-n[3]+n[1]-a[1]),g=u/2*(a[0]-n[0]+n[2]-a[2]);this.setCenterInternal([i[0]+p,i[1]-g])}},enumerable:!1,configurable:!0}),e.prototype.getUpdatedOptions_=function(t){var n=this.getProperties();return n.resolution!==void 0?n.resolution=this.getResolution():n.zoom=this.getZoom(),n.center=this.getCenterInternal(),n.rotation=this.getRotation(),se({},n,t)},e.prototype.animate=function(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);for(var n=new Array(arguments.length),i=0;i<n.length;++i){var a=arguments[i];a.center&&(a=se({},a),a.center=Pn(a.center,this.getProjection())),a.anchor&&(a=se({},a),a.anchor=Pn(a.anchor,this.getProjection())),n[i]=a}this.animateInternal.apply(this,n)},e.prototype.animateInternal=function(t){var n=arguments.length,i;n>1&&typeof arguments[n-1]=="function"&&(i=arguments[n-1],--n);for(var a=0;a<n&&!this.isDef();++a){var u=arguments[a];u.center&&this.setCenterInternal(u.center),u.zoom!==void 0?this.setZoom(u.zoom):u.resolution&&this.setResolution(u.resolution),u.rotation!==void 0&&this.setRotation(u.rotation)}if(a===n){i&&Ms(i,!0);return}for(var p=Date.now(),g=this.targetCenter_.slice(),v=this.targetResolution_,m=this.targetRotation_,E=[];a<n;++a){var b=arguments[a],w={start:p,complete:!1,anchor:b.anchor,duration:b.duration!==void 0?b.duration:1e3,easing:b.easing||x1,callback:i};if(b.center&&(w.sourceCenter=g,w.targetCenter=b.center.slice(),g=w.targetCenter),b.zoom!==void 0?(w.sourceResolution=v,w.targetResolution=this.getResolutionForZoom(b.zoom),v=w.targetResolution):b.resolution&&(w.sourceResolution=v,w.targetResolution=b.resolution,v=w.targetResolution),b.rotation!==void 0){w.sourceRotation=m;var S=To(b.rotation-m+Math.PI,2*Math.PI)-Math.PI;w.targetRotation=m+S,m=w.targetRotation}IE(w)?w.complete=!0:p+=w.duration,E.push(w)}this.animations_.push(E),this.setHint(Ee.ANIMATING,1),this.updateAnimations_()},e.prototype.getAnimating=function(){return this.hints_[Ee.ANIMATING]>0},e.prototype.getInteracting=function(){return this.hints_[Ee.INTERACTING]>0},e.prototype.cancelAnimations=function(){this.setHint(Ee.ANIMATING,-this.hints_[Ee.ANIMATING]);for(var t,n=0,i=this.animations_.length;n<i;++n){var a=this.animations_[n];if(a[0].callback&&Ms(a[0].callback,!1),!t)for(var u=0,p=a.length;u<p;++u){var g=a[u];if(!g.complete){t=g.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN},e.prototype.updateAnimations_=function(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!!this.getAnimating()){for(var t=Date.now(),n=!1,i=this.animations_.length-1;i>=0;--i){for(var a=this.animations_[i],u=!0,p=0,g=a.length;p<g;++p){var v=a[p];if(!v.complete){var m=t-v.start,E=v.duration>0?m/v.duration:1;E>=1?(v.complete=!0,E=1):u=!1;var b=v.easing(E);if(v.sourceCenter){var w=v.sourceCenter[0],S=v.sourceCenter[1],C=v.targetCenter[0],A=v.targetCenter[1];this.nextCenter_=v.targetCenter;var M=w+b*(C-w),I=S+b*(A-S);this.targetCenter_=[M,I]}if(v.sourceResolution&&v.targetResolution){var L=b===1?v.targetResolution:v.sourceResolution+b*(v.targetResolution-v.sourceResolution);if(v.anchor){var k=this.getViewportSize_(this.getRotation()),N=this.constraints_.resolution(L,0,k,!0);this.targetCenter_=this.calculateCenterZoom(N,v.anchor)}this.nextResolution_=v.targetResolution,this.targetResolution_=L,this.applyTargetState_(!0)}if(v.sourceRotation!==void 0&&v.targetRotation!==void 0){var G=b===1?To(v.targetRotation+Math.PI,2*Math.PI)-Math.PI:v.sourceRotation+b*(v.targetRotation-v.sourceRotation);if(v.anchor){var z=this.constraints_.rotation(G,!0);this.targetCenter_=this.calculateCenterRotate(z,v.anchor)}this.nextRotation_=v.targetRotation,this.targetRotation_=G}if(this.applyTargetState_(!0),n=!0,!v.complete)break}}if(u){this.animations_[i]=null,this.setHint(Ee.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;var V=a[0].callback;V&&Ms(V,!0)}}this.animations_=this.animations_.filter(Boolean),n&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}},e.prototype.calculateCenterRotate=function(t,n){var i,a=this.getCenterInternal();return a!==void 0&&(i=[a[0]-n[0],a[1]-n[1]],wh(i,t-this.getRotation()),t0(i,n)),i},e.prototype.calculateCenterZoom=function(t,n){var i,a=this.getCenterInternal(),u=this.getResolution();if(a!==void 0&&u!==void 0){var p=n[0]-t*(n[0]-a[0])/u,g=n[1]-t*(n[1]-a[1])/u;i=[p,g]}return i},e.prototype.getViewportSize_=function(t){var n=this.viewportSize_;if(t){var i=n[0],a=n[1];return[Math.abs(i*Math.cos(t))+Math.abs(a*Math.sin(t)),Math.abs(i*Math.sin(t))+Math.abs(a*Math.cos(t))]}else return n},e.prototype.setViewportSize=function(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)},e.prototype.getCenter=function(){var t=this.getCenterInternal();return t&&Qs(t,this.getProjection())},e.prototype.getCenterInternal=function(){return this.get(rn.CENTER)},e.prototype.getConstraints=function(){return this.constraints_},e.prototype.getConstrainResolution=function(){return this.get("constrainResolution")},e.prototype.getHints=function(t){return t!==void 0?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()},e.prototype.calculateExtent=function(t){var n=this.calculateExtentInternal(t);return Oh(n,this.getProjection())},e.prototype.calculateExtentInternal=function(t){var n=t||this.getViewportSizeMinusPadding_(),i=this.getCenterInternal();Ot(i,1);var a=this.getResolution();Ot(a!==void 0,2);var u=this.getRotation();return Ot(u!==void 0,3),ah(i,a,u,n)},e.prototype.getMaxResolution=function(){return this.maxResolution_},e.prototype.getMinResolution=function(){return this.minResolution_},e.prototype.getMaxZoom=function(){return this.getZoomForResolution(this.minResolution_)},e.prototype.setMaxZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))},e.prototype.getMinZoom=function(){return this.getZoomForResolution(this.maxResolution_)},e.prototype.setMinZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))},e.prototype.setConstrainResolution=function(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))},e.prototype.getProjection=function(){return this.projection_},e.prototype.getResolution=function(){return this.get(rn.RESOLUTION)},e.prototype.getResolutions=function(){return this.resolutions_},e.prototype.getResolutionForExtent=function(t,n){return this.getResolutionForExtentInternal(Di(t,this.getProjection()),n)},e.prototype.getResolutionForExtentInternal=function(t,n){var i=n||this.getViewportSizeMinusPadding_(),a=ee(t)/i[0],u=on(t)/i[1];return Math.max(a,u)},e.prototype.getResolutionForValueFunction=function(t){var n=t||2,i=this.getConstrainedResolution(this.maxResolution_),a=this.minResolution_,u=Math.log(i/a)/Math.log(n);return function(p){var g=i/Math.pow(n,p*u);return g}},e.prototype.getRotation=function(){return this.get(rn.ROTATION)},e.prototype.getValueForResolutionFunction=function(t){var n=Math.log(t||2),i=this.getConstrainedResolution(this.maxResolution_),a=this.minResolution_,u=Math.log(i/a)/n;return function(p){var g=Math.log(i/p)/n/u;return g}},e.prototype.getViewportSizeMinusPadding_=function(t){var n=this.getViewportSize_(t),i=this.padding_;return i&&(n=[n[0]-i[1]-i[3],n[1]-i[0]-i[2]]),n},e.prototype.getState=function(){var t=this.getProjection(),n=this.getResolution(),i=this.getRotation(),a=this.getCenterInternal(),u=this.padding_;if(u){var p=this.getViewportSizeMinusPadding_();a=jl(a,this.getViewportSize_(),[p[0]/2+u[3],p[1]/2+u[0]],n,i)}return{center:a.slice(0),projection:t!==void 0?t:null,resolution:n,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:i,zoom:this.getZoom()}},e.prototype.getZoom=function(){var t,n=this.getResolution();return n!==void 0&&(t=this.getZoomForResolution(n)),t},e.prototype.getZoomForResolution=function(t){var n=this.minZoom_||0,i,a;if(this.resolutions_){var u=bh(this.resolutions_,t,1);n=u,i=this.resolutions_[u],u==this.resolutions_.length-1?a=2:a=i/this.resolutions_[u+1]}else i=this.maxResolution_,a=this.zoomFactor_;return n+Math.log(i/t)/Math.log(a)},e.prototype.getResolutionForZoom=function(t){if(this.resolutions_){if(this.resolutions_.length<=1)return 0;var n=ae(Math.floor(t),0,this.resolutions_.length-2),i=this.resolutions_[n]/this.resolutions_[n+1];return this.resolutions_[n]/Math.pow(i,ae(t-n,0,1))}else return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)},e.prototype.fit=function(t,n){var i;if(Ot(Array.isArray(t)||typeof t.getSimplifiedGeometry=="function",24),Array.isArray(t)){Ot(!Sa(t),25);var a=Di(t,this.getProjection());i=Cf(a)}else if(t.getType()===mt.CIRCLE){var a=Di(t.getExtent(),this.getProjection());i=Cf(a),i.rotate(this.getRotation(),ji(a))}else{var u=u0();u?i=t.clone().transform(u,this.getProjection()):i=t}this.fitInternal(i,n)},e.prototype.rotatedExtentForGeometry=function(t){for(var n=this.getRotation(),i=Math.cos(n),a=Math.sin(-n),u=t.getFlatCoordinates(),p=t.getStride(),g=1/0,v=1/0,m=-1/0,E=-1/0,b=0,w=u.length;b<w;b+=p){var S=u[b]*i-u[b+1]*a,C=u[b]*a+u[b+1]*i;g=Math.min(g,S),v=Math.min(v,C),m=Math.max(m,S),E=Math.max(E,C)}return[g,v,m,E]},e.prototype.fitInternal=function(t,n){var i=n||{},a=i.size;a||(a=this.getViewportSizeMinusPadding_());var u=i.padding!==void 0?i.padding:[0,0,0,0],p=i.nearest!==void 0?i.nearest:!1,g;i.minResolution!==void 0?g=i.minResolution:i.maxZoom!==void 0?g=this.getResolutionForZoom(i.maxZoom):g=0;var v=this.rotatedExtentForGeometry(t),m=this.getResolutionForExtentInternal(v,[a[0]-u[1]-u[3],a[1]-u[0]-u[2]]);m=isNaN(m)?g:Math.max(m,g),m=this.getConstrainedResolution(m,p?0:1);var E=this.getRotation(),b=Math.sin(E),w=Math.cos(E),S=ji(v);S[0]+=(u[1]-u[3])/2*m,S[1]+=(u[0]-u[2])/2*m;var C=S[0]*w-S[1]*b,A=S[1]*w+S[0]*b,M=this.getConstrainedCenter([C,A],m),I=i.callback?i.callback:Vi;i.duration!==void 0?this.animateInternal({resolution:m,center:M,duration:i.duration,easing:i.easing},I):(this.targetResolution_=m,this.targetCenter_=M,this.applyTargetState_(!1,!0),Ms(I,!0))},e.prototype.centerOn=function(t,n,i){this.centerOnInternal(Pn(t,this.getProjection()),n,i)},e.prototype.centerOnInternal=function(t,n,i){this.setCenterInternal(jl(t,n,i,this.getResolution(),this.getRotation()))},e.prototype.calculateCenterShift=function(t,n,i,a){var u,p=this.padding_;if(p&&t){var g=this.getViewportSizeMinusPadding_(-i),v=jl(t,a,[g[0]/2+p[3],g[1]/2+p[0]],n,i);u=[t[0]-v[0],t[1]-v[1]]}return u},e.prototype.isDef=function(){return!!this.getCenterInternal()&&this.getResolution()!==void 0},e.prototype.adjustCenter=function(t){var n=Qs(this.targetCenter_,this.getProjection());this.setCenter([n[0]+t[0],n[1]+t[1]])},e.prototype.adjustCenterInternal=function(t){var n=this.targetCenter_;this.setCenterInternal([n[0]+t[0],n[1]+t[1]])},e.prototype.adjustResolution=function(t,n){var i=n&&Pn(n,this.getProjection());this.adjustResolutionInternal(t,i)},e.prototype.adjustResolutionInternal=function(t,n){var i=this.getAnimating()||this.getInteracting(),a=this.getViewportSize_(this.getRotation()),u=this.constraints_.resolution(this.targetResolution_*t,0,a,i);n&&(this.targetCenter_=this.calculateCenterZoom(u,n)),this.targetResolution_*=t,this.applyTargetState_()},e.prototype.adjustZoom=function(t,n){this.adjustResolution(Math.pow(this.zoomFactor_,-t),n)},e.prototype.adjustRotation=function(t,n){n&&(n=Pn(n,this.getProjection())),this.adjustRotationInternal(t,n)},e.prototype.adjustRotationInternal=function(t,n){var i=this.getAnimating()||this.getInteracting(),a=this.constraints_.rotation(this.targetRotation_+t,i);n&&(this.targetCenter_=this.calculateCenterRotate(a,n)),this.targetRotation_+=t,this.applyTargetState_()},e.prototype.setCenter=function(t){this.setCenterInternal(t&&Pn(t,this.getProjection()))},e.prototype.setCenterInternal=function(t){this.targetCenter_=t,this.applyTargetState_()},e.prototype.setHint=function(t,n){return this.hints_[t]+=n,this.changed(),this.hints_[t]},e.prototype.setResolution=function(t){this.targetResolution_=t,this.applyTargetState_()},e.prototype.setRotation=function(t){this.targetRotation_=t,this.applyTargetState_()},e.prototype.setZoom=function(t){this.setResolution(this.getResolutionForZoom(t))},e.prototype.applyTargetState_=function(t,n){var i=this.getAnimating()||this.getInteracting()||n,a=this.constraints_.rotation(this.targetRotation_,i),u=this.getViewportSize_(a),p=this.constraints_.resolution(this.targetResolution_,0,u,i),g=this.constraints_.center(this.targetCenter_,p,u,i,this.calculateCenterShift(this.targetCenter_,p,a,u));this.get(rn.ROTATION)!==a&&this.set(rn.ROTATION,a),this.get(rn.RESOLUTION)!==p&&(this.set(rn.RESOLUTION,p),this.set("zoom",this.getZoom(),!0)),(!g||!this.get(rn.CENTER)||!qs(this.get(rn.CENTER),g))&&this.set(rn.CENTER,g),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0},e.prototype.resolveConstraints=function(t,n,i){var a=t!==void 0?t:200,u=n||0,p=this.constraints_.rotation(this.targetRotation_),g=this.getViewportSize_(p),v=this.constraints_.resolution(this.targetResolution_,u,g),m=this.constraints_.center(this.targetCenter_,v,g,!1,this.calculateCenterShift(this.targetCenter_,v,p,g));if(a===0&&!this.cancelAnchor_){this.targetResolution_=v,this.targetRotation_=p,this.targetCenter_=m,this.applyTargetState_();return}var E=i||(a===0?this.cancelAnchor_:void 0);this.cancelAnchor_=void 0,(this.getResolution()!==v||this.getRotation()!==p||!this.getCenterInternal()||!qs(this.getCenterInternal(),m))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:p,center:m,resolution:v,duration:a,easing:kr,anchor:E}))},e.prototype.beginInteraction=function(){this.resolveConstraints(0),this.setHint(Ee.INTERACTING,1)},e.prototype.endInteraction=function(t,n,i){var a=i&&Pn(i,this.getProjection());this.endInteractionInternal(t,n,a)},e.prototype.endInteractionInternal=function(t,n,i){this.setHint(Ee.INTERACTING,-1),this.resolveConstraints(t,n,i)},e.prototype.getConstrainedCenter=function(t,n){var i=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,n||this.getResolution(),i)},e.prototype.getConstrainedZoom=function(t,n){var i=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(i,n))},e.prototype.getConstrainedResolution=function(t,n){var i=n||0,a=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,i,a)},e}(Tn);function Ms(o,e){setTimeout(function(){o(e)},0)}function RE(o){if(o.extent!==void 0){var e=o.smoothExtentConstraint!==void 0?o.smoothExtentConstraint:!0;return id(o.extent,o.constrainOnlyCenter,e)}var t=Rh(o.projection,"EPSG:3857");if(o.multiWorld!==!0&&t.isGlobal()){var n=t.getExtent().slice();return n[0]=-1/0,n[2]=1/0,id(n,!1,!1)}return mE}function CE(o){var e,t,n,i=28,a=2,u=o.minZoom!==void 0?o.minZoom:Xl,p=o.maxZoom!==void 0?o.maxZoom:i,g=o.zoomFactor!==void 0?o.zoomFactor:a,v=o.multiWorld!==void 0?o.multiWorld:!1,m=o.smoothResolutionConstraint!==void 0?o.smoothResolutionConstraint:!0,E=o.showFullExtent!==void 0?o.showFullExtent:!1,b=Rh(o.projection,"EPSG:3857"),w=b.getExtent(),S=o.constrainOnlyCenter,C=o.extent;if(!v&&!C&&b.isGlobal()&&(S=!1,C=w),o.resolutions!==void 0){var A=o.resolutions;t=A[u],n=A[p]!==void 0?A[p]:A[A.length-1],o.constrainResolution?e=xE(A,m,!S&&C,E):e=rd(t,n,m,!S&&C,E)}else{var M=w?Math.max(ee(w),on(w)):360*yn[ge.DEGREES]/b.getMetersPerUnit(),I=M/Nh/Math.pow(a,Xl),L=I/Math.pow(a,i-Xl);t=o.maxResolution,t!==void 0?u=0:t=I/Math.pow(g,u),n=o.minResolution,n===void 0&&(o.maxZoom!==void 0?o.maxResolution!==void 0?n=t/Math.pow(g,p):n=I/Math.pow(g,p):n=L),p=u+Math.floor(Math.log(t/n)/Math.log(g)),n=t/Math.pow(g,p-u),o.constrainResolution?e=bE(g,t,n,m,!S&&C,E):e=rd(t,n,m,!S&&C,E)}return{constraint:e,maxResolution:t,minResolution:n,minZoom:u,zoomFactor:g}}function OE(o){var e=o.enableRotation!==void 0?o.enableRotation:!0;if(e){var t=o.constrainRotation;return t===void 0||t===!0?TE():t===!1?od:typeof t=="number"?EE(t):od}else return Vh}function IE(o){return!(o.sourceCenter&&o.targetCenter&&!qs(o.sourceCenter,o.targetCenter)||o.sourceResolution!==o.targetResolution||o.sourceRotation!==o.targetRotation)}function jl(o,e,t,n,i){var a=Math.cos(-i),u=Math.sin(-i),p=o[0]*a-o[1]*u,g=o[1]*a+o[0]*u;p+=(e[0]/2-t[0])*n,g+=(t[1]-e[1]/2)*n,u=-u;var v=p*a-g*u,m=g*a+p*u;return[v,m]}var Li=SE,AE=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();function Mp(o){if(o instanceof Oa){o.setMapInternal(null);return}o instanceof Ia&&o.getLayers().forEach(Mp)}function Lp(o,e){if(o instanceof Oa){o.setMapInternal(e);return}if(o instanceof Ia)for(var t=o.getLayers().getArray(),n=0,i=t.length;n<i;++n)Lp(t[n],e)}var PE=function(o){AE(e,o);function e(t){var n=o.call(this)||this;n.on,n.once,n.un;var i=ME(t);n.renderComplete_,n.loaded_=!0,n.boundHandleBrowserEvent_=n.handleBrowserEvent.bind(n),n.maxTilesLoading_=t.maxTilesLoading!==void 0?t.maxTilesLoading:16,n.pixelRatio_=t.pixelRatio!==void 0?t.pixelRatio:Od,n.postRenderTimeoutHandle_,n.animationDelayKey_,n.animationDelay_=function(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}.bind(n),n.coordinateToPixelTransform_=Ge(),n.pixelToCoordinateTransform_=Ge(),n.frameIndex_=0,n.frameState_=null,n.previousExtent_=null,n.viewPropertyListenerKey_=null,n.viewChangeListenerKey_=null,n.layerGroupPropertyListenerKeys_=null,n.viewport_=document.createElement("div"),n.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),n.viewport_.style.position="relative",n.viewport_.style.overflow="hidden",n.viewport_.style.width="100%",n.viewport_.style.height="100%",n.overlayContainer_=document.createElement("div"),n.overlayContainer_.style.position="absolute",n.overlayContainer_.style.zIndex="0",n.overlayContainer_.style.width="100%",n.overlayContainer_.style.height="100%",n.overlayContainer_.style.pointerEvents="none",n.overlayContainer_.className="ol-overlaycontainer",n.viewport_.appendChild(n.overlayContainer_),n.overlayContainerStopEvent_=document.createElement("div"),n.overlayContainerStopEvent_.style.position="absolute",n.overlayContainerStopEvent_.style.zIndex="0",n.overlayContainerStopEvent_.style.width="100%",n.overlayContainerStopEvent_.style.height="100%",n.overlayContainerStopEvent_.style.pointerEvents="none",n.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",n.viewport_.appendChild(n.overlayContainerStopEvent_),n.mapBrowserEventHandler_=null,n.moveTolerance_=t.moveTolerance,n.keyboardEventTarget_=i.keyboardEventTarget,n.targetChangeHandlerKeys_=null,n.controls=i.controls||new Ze,n.interactions=i.interactions||new Ze,n.overlays_=i.overlays,n.overlayIdIndex_={},n.renderer_=null,n.postRenderFunctions_=[],n.tileQueue_=new vE(n.getTilePriority.bind(n),n.handleTileChange_.bind(n)),n.addChangeListener(be.LAYERGROUP,n.handleLayerGroupChanged_),n.addChangeListener(be.VIEW,n.handleViewChanged_),n.addChangeListener(be.SIZE,n.handleSizeChanged_),n.addChangeListener(be.TARGET,n.handleTargetChanged_),n.setProperties(i.values);var a=n;return t.view&&!(t.view instanceof Li)&&t.view.then(function(u){a.setView(new Li(u))}),n.controls.addEventListener(Fe.ADD,function(u){u.element.setMap(this)}.bind(n)),n.controls.addEventListener(Fe.REMOVE,function(u){u.element.setMap(null)}.bind(n)),n.interactions.addEventListener(Fe.ADD,function(u){u.element.setMap(this)}.bind(n)),n.interactions.addEventListener(Fe.REMOVE,function(u){u.element.setMap(null)}.bind(n)),n.overlays_.addEventListener(Fe.ADD,function(u){this.addOverlayInternal_(u.element)}.bind(n)),n.overlays_.addEventListener(Fe.REMOVE,function(u){var p=u.element,g=p.getId();g!==void 0&&delete this.overlayIdIndex_[g.toString()],u.element.setMap(null)}.bind(n)),n.controls.forEach(function(u){u.setMap(this)}.bind(n)),n.interactions.forEach(function(u){u.setMap(this)}.bind(n)),n.overlays_.forEach(n.addOverlayInternal_.bind(n)),n}return e.prototype.createRenderer=function(){throw new Error("Use a map type that has a createRenderer method")},e.prototype.addControl=function(t){this.getControls().push(t)},e.prototype.addInteraction=function(t){this.getInteractions().push(t)},e.prototype.addLayer=function(t){var n=this.getLayerGroup().getLayers();n.push(t)},e.prototype.handleLayerAdd_=function(t){Lp(t.layer,this)},e.prototype.addOverlay=function(t){this.getOverlays().push(t)},e.prototype.addOverlayInternal_=function(t){var n=t.getId();n!==void 0&&(this.overlayIdIndex_[n.toString()]=t),t.setMap(this)},e.prototype.disposeInternal=function(){this.setTarget(null),o.prototype.disposeInternal.call(this)},e.prototype.forEachFeatureAtPixel=function(t,n,i){if(!(!this.frameState_||!this.renderer_)){var a=this.getCoordinateFromPixelInternal(t);i=i!==void 0?i:{};var u=i.hitTolerance!==void 0?i.hitTolerance:0,p=i.layerFilter!==void 0?i.layerFilter:Sr,g=i.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(a,this.frameState_,u,g,n,null,p,null)}},e.prototype.getFeaturesAtPixel=function(t,n){var i=[];return this.forEachFeatureAtPixel(t,function(a){i.push(a)},n),i},e.prototype.getAllLayers=function(){var t=[];function n(i){i.forEach(function(a){a instanceof Ia?n(a.getLayers()):t.push(a)})}return n(this.getLayers()),t},e.prototype.forEachLayerAtPixel=function(t,n,i){if(!(!this.frameState_||!this.renderer_)){var a=i||{},u=a.hitTolerance!==void 0?a.hitTolerance:0,p=a.layerFilter||Sr;return this.renderer_.forEachLayerAtPixel(t,this.frameState_,u,n,p)}},e.prototype.hasFeatureAtPixel=function(t,n){if(!this.frameState_||!this.renderer_)return!1;var i=this.getCoordinateFromPixelInternal(t);n=n!==void 0?n:{};var a=n.layerFilter!==void 0?n.layerFilter:Sr,u=n.hitTolerance!==void 0?n.hitTolerance:0,p=n.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,u,p,a,null)},e.prototype.getEventCoordinate=function(t){return this.getCoordinateFromPixel(this.getEventPixel(t))},e.prototype.getEventCoordinateInternal=function(t){return this.getCoordinateFromPixelInternal(this.getEventPixel(t))},e.prototype.getEventPixel=function(t){var n=this.viewport_.getBoundingClientRect(),i="changedTouches"in t?t.changedTouches[0]:t;return[i.clientX-n.left,i.clientY-n.top]},e.prototype.getTarget=function(){return this.get(be.TARGET)},e.prototype.getTargetElement=function(){var t=this.getTarget();return t!==void 0?typeof t=="string"?document.getElementById(t):t:null},e.prototype.getCoordinateFromPixel=function(t){return Qs(this.getCoordinateFromPixelInternal(t),this.getView().getProjection())},e.prototype.getCoordinateFromPixelInternal=function(t){var n=this.frameState_;return n?re(n.pixelToCoordinateTransform,t.slice()):null},e.prototype.getControls=function(){return this.controls},e.prototype.getOverlays=function(){return this.overlays_},e.prototype.getOverlayById=function(t){var n=this.overlayIdIndex_[t.toString()];return n!==void 0?n:null},e.prototype.getInteractions=function(){return this.interactions},e.prototype.getLayerGroup=function(){return this.get(be.LAYERGROUP)},e.prototype.setLayers=function(t){var n=this.getLayerGroup();if(t instanceof Ze){n.setLayers(t);return}var i=n.getLayers();i.clear(),i.extend(t)},e.prototype.getLayers=function(){var t=this.getLayerGroup().getLayers();return t},e.prototype.getLoadingOrNotReady=function(){for(var t=this.getLayerGroup().getLayerStatesArray(),n=0,i=t.length;n<i;++n){var a=t[n];if(!!a.visible){var u=a.layer.getRenderer();if(u&&!u.ready)return!0;var p=a.layer.getSource();if(p&&p.loading)return!0}}return!1},e.prototype.getPixelFromCoordinate=function(t){var n=Pn(t,this.getView().getProjection());return this.getPixelFromCoordinateInternal(n)},e.prototype.getPixelFromCoordinateInternal=function(t){var n=this.frameState_;return n?re(n.coordinateToPixelTransform,t.slice(0,2)):null},e.prototype.getRenderer=function(){return this.renderer_},e.prototype.getSize=function(){return this.get(be.SIZE)},e.prototype.getView=function(){return this.get(be.VIEW)},e.prototype.getViewport=function(){return this.viewport_},e.prototype.getOverlayContainer=function(){return this.overlayContainer_},e.prototype.getOverlayContainerStopEvent=function(){return this.overlayContainerStopEvent_},e.prototype.getOwnerDocument=function(){var t=this.getTargetElement();return t?t.ownerDocument:document},e.prototype.getTilePriority=function(t,n,i,a){return yE(this.frameState_,t,n,i,a)},e.prototype.handleBrowserEvent=function(t,n){var i=n||t.type,a=new ni(i,this,t);this.handleMapBrowserEvent(a)},e.prototype.handleMapBrowserEvent=function(t){if(!!this.frameState_){var n=t.originalEvent,i=n.type;if(i===gh.POINTERDOWN||i===pt.WHEEL||i===pt.KEYDOWN){var a=this.getOwnerDocument(),u=this.viewport_.getRootNode?this.viewport_.getRootNode():a,p=n.target;if(this.overlayContainerStopEvent_.contains(p)||!(u===a?a.documentElement:u).contains(p))return}if(t.frameState=this.frameState_,this.dispatchEvent(t)!==!1)for(var g=this.getInteractions().getArray().slice(),v=g.length-1;v>=0;v--){var m=g[v];if(!(m.getMap()!==this||!m.getActive()||!this.getTargetElement())){var E=m.handleEvent(t);if(!E||t.propagationStopped)break}}}},e.prototype.handlePostRender=function(){var t=this.frameState_,n=this.tileQueue_;if(!n.isEmpty()){var i=this.maxTilesLoading_,a=i;if(t){var u=t.viewHints;if(u[Ee.ANIMATING]||u[Ee.INTERACTING]){var p=Date.now()-t.time>8;i=p?0:8,a=p?0:2}}n.getTilesLoading()<i&&(n.reprioritize(),n.loadMoreTiles(i,a))}t&&this.renderer_&&!t.animate&&(this.renderComplete_===!0?(this.hasListener(Ne.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(Ne.RENDERCOMPLETE,t),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new _r(ii.LOADEND,this,t)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new _r(ii.LOADSTART,this,t))));for(var g=this.postRenderFunctions_,v=0,m=g.length;v<m;++v)g[v](this,t);g.length=0},e.prototype.handleSizeChanged_=function(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()},e.prototype.handleTargetChanged_=function(){if(this.mapBrowserEventHandler_){for(var t=0,n=this.targetChangeHandlerKeys_.length;t<n;++t)qt(this.targetChangeHandlerKeys_[t]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(pt.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(pt.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,ch(this.viewport_)}var i=this.getTargetElement();if(!i)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{i.appendChild(this.viewport_),this.renderer_||(this.renderer_=this.createRenderer()),this.mapBrowserEventHandler_=new fE(this,this.moveTolerance_);for(var a in $t)this.mapBrowserEventHandler_.addEventListener($t[a],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(pt.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(pt.WHEEL,this.boundHandleBrowserEvent_,Id?{passive:!1}:!1);var u=this.getOwnerDocument().defaultView,p=this.keyboardEventTarget_?this.keyboardEventTarget_:i;this.targetChangeHandlerKeys_=[Lt(p,pt.KEYDOWN,this.handleBrowserEvent,this),Lt(p,pt.KEYPRESS,this.handleBrowserEvent,this),Lt(u,pt.RESIZE,this.updateSize,this)]}this.updateSize()},e.prototype.handleTileChange_=function(){this.render()},e.prototype.handleViewPropertyChanged_=function(){this.render()},e.prototype.handleViewChanged_=function(){this.viewPropertyListenerKey_&&(qt(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(qt(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);var t=this.getView();t&&(this.updateViewportSize_(),this.viewPropertyListenerKey_=Lt(t,Ir.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=Lt(t,pt.CHANGE,this.handleViewPropertyChanged_,this),t.resolveConstraints(0)),this.render()},e.prototype.handleLayerGroupChanged_=function(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(qt),this.layerGroupPropertyListenerKeys_=null);var t=this.getLayerGroup();t&&(this.handleLayerAdd_(new oi("addlayer",t)),this.layerGroupPropertyListenerKeys_=[Lt(t,Ir.PROPERTYCHANGE,this.render,this),Lt(t,pt.CHANGE,this.render,this),Lt(t,"addlayer",this.handleLayerAdd_,this),Lt(t,"removelayer",this.handleLayerRemove_,this)]),this.render()},e.prototype.isRendered=function(){return!!this.frameState_},e.prototype.renderSync=function(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()},e.prototype.redrawText=function(){for(var t=this.getLayerGroup().getLayerStatesArray(),n=0,i=t.length;n<i;++n){var a=t[n].layer;a.hasRenderer()&&a.getRenderer().handleFontsChanged()}},e.prototype.render=function(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))},e.prototype.removeControl=function(t){return this.getControls().remove(t)},e.prototype.removeInteraction=function(t){return this.getInteractions().remove(t)},e.prototype.removeLayer=function(t){var n=this.getLayerGroup().getLayers();return n.remove(t)},e.prototype.handleLayerRemove_=function(t){Mp(t.layer)},e.prototype.removeOverlay=function(t){return this.getOverlays().remove(t)},e.prototype.renderFrame_=function(t){var n=this,i=this.getSize(),a=this.getView(),u=this.frameState_,p=null;if(i!==void 0&&If(i)&&a&&a.isDef()){var g=a.getHints(this.frameState_?this.frameState_.viewHints:void 0),v=a.getState();if(p={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutterTree:null,extent:ah(v.center,v.resolution,v.rotation,i),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:i,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:v,viewHints:g,wantedTiles:{},mapId:Xt(this),renderTargets:{}},v.nextCenter&&v.nextResolution){var m=isNaN(v.nextRotation)?v.rotation:v.nextRotation;p.nextExtent=ah(v.nextCenter,v.nextResolution,m,i)}}if(this.frameState_=p,this.renderer_.renderFrame(p),p){if(p.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,p.postRenderFunctions),u){var E=!this.previousExtent_||!Sa(this.previousExtent_)&&!$s(p.extent,this.previousExtent_);E&&(this.dispatchEvent(new _r(ii.MOVESTART,this,u)),this.previousExtent_=ba(this.previousExtent_))}var b=this.previousExtent_&&!p.viewHints[Ee.ANIMATING]&&!p.viewHints[Ee.INTERACTING]&&!$s(p.extent,this.previousExtent_);b&&(this.dispatchEvent(new _r(ii.MOVEEND,this,p)),Ld(p.extent,this.previousExtent_))}this.dispatchEvent(new _r(ii.POSTRENDER,this,p)),this.renderComplete_=this.hasListener(ii.LOADSTART)||this.hasListener(ii.LOADEND)||this.hasListener(Ne.RENDERCOMPLETE)?!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady():void 0,this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(function(){n.postRenderTimeoutHandle_=void 0,n.handlePostRender()},0))},e.prototype.setLayerGroup=function(t){var n=this.getLayerGroup();n&&this.handleLayerRemove_(new oi("removelayer",n)),this.set(be.LAYERGROUP,t)},e.prototype.setSize=function(t){this.set(be.SIZE,t)},e.prototype.setTarget=function(t){this.set(be.TARGET,t)},e.prototype.setView=function(t){if(!t||t instanceof Li){this.set(be.VIEW,t);return}this.set(be.VIEW,new Li);var n=this;t.then(function(i){n.setView(new Li(i))})},e.prototype.updateSize=function(){var t=this.getTargetElement(),n=void 0;if(t){var i=getComputedStyle(t),a=t.offsetWidth-parseFloat(i.borderLeftWidth)-parseFloat(i.paddingLeft)-parseFloat(i.paddingRight)-parseFloat(i.borderRightWidth),u=t.offsetHeight-parseFloat(i.borderTopWidth)-parseFloat(i.paddingTop)-parseFloat(i.paddingBottom)-parseFloat(i.borderBottomWidth);!isNaN(a)&&!isNaN(u)&&(n=[a,u],!If(n)&&!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)&&console.warn("No map visible because the map container's width or height are 0."))}this.setSize(n),this.updateViewportSize_()},e.prototype.updateViewportSize_=function(){var t=this.getView();if(t){var n=void 0,i=getComputedStyle(this.viewport_);i.width&&i.height&&(n=[parseInt(i.width,10),parseInt(i.height,10)]),t.setViewportSize(n)}},e}(Tn);function ME(o){var e=null;o.keyboardEventTarget!==void 0&&(e=typeof o.keyboardEventTarget=="string"?document.getElementById(o.keyboardEventTarget):o.keyboardEventTarget);var t={},n=o.layers&&typeof o.layers.getLayers=="function"?o.layers:new Ia({layers:o.layers});t[be.LAYERGROUP]=n,t[be.TARGET]=o.target,t[be.VIEW]=o.view instanceof Li?o.view:new Li;var i;o.controls!==void 0&&(Array.isArray(o.controls)?i=new Ze(o.controls.slice()):(Ot(typeof o.controls.getArray=="function",47),i=o.controls));var a;o.interactions!==void 0&&(Array.isArray(o.interactions)?a=new Ze(o.interactions.slice()):(Ot(typeof o.interactions.getArray=="function",48),a=o.interactions));var u;return o.overlays!==void 0?Array.isArray(o.overlays)?u=new Ze(o.overlays.slice()):(Ot(typeof o.overlays.getArray=="function",49),u=o.overlays):u=new Ze,{controls:i,interactions:a,keyboardEventTarget:e,overlays:u,values:t}}var LE=PE,DE=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),kE=function(o){DE(e,o);function e(t){var n=o.call(this)||this,i=t.element;return i&&!t.target&&!i.style.pointerEvents&&(i.style.pointerEvents="auto"),n.element=i||null,n.target_=null,n.map_=null,n.listenerKeys=[],t.render&&(n.render=t.render),t.target&&n.setTarget(t.target),n}return e.prototype.disposeInternal=function(){ch(this.element),o.prototype.disposeInternal.call(this)},e.prototype.getMap=function(){return this.map_},e.prototype.setMap=function(t){this.map_&&ch(this.element);for(var n=0,i=this.listenerKeys.length;n<i;++n)qt(this.listenerKeys[n]);if(this.listenerKeys.length=0,this.map_=t,t){var a=this.target_?this.target_:t.getOverlayContainerStopEvent();a.appendChild(this.element),this.render!==Vi&&this.listenerKeys.push(Lt(t,ii.POSTRENDER,this.render,this)),t.render()}},e.prototype.render=function(t){},e.prototype.setTarget=function(t){this.target_=typeof t=="string"?document.getElementById(t):t},e}(Tn),Xh=kE,FE=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),NE=function(o){FE(e,o);function e(t){var n=this,i=t||{};n=o.call(this,{element:document.createElement("div"),render:i.render,target:i.target})||this,n.ulElement_=document.createElement("ul"),n.collapsed_=i.collapsed!==void 0?i.collapsed:!0,n.userCollapsed_=n.collapsed_,n.overrideCollapsible_=i.collapsible!==void 0,n.collapsible_=i.collapsible!==void 0?i.collapsible:!0,n.collapsible_||(n.collapsed_=!1);var a=i.className!==void 0?i.className:"ol-attribution",u=i.tipLabel!==void 0?i.tipLabel:"Attributions",p=i.expandClassName!==void 0?i.expandClassName:a+"-expand",g=i.collapseLabel!==void 0?i.collapseLabel:"\u203A",v=i.collapseClassName!==void 0?i.collapseClassName:a+"-collapse";typeof g=="string"?(n.collapseLabel_=document.createElement("span"),n.collapseLabel_.textContent=g,n.collapseLabel_.className=v):n.collapseLabel_=g;var m=i.label!==void 0?i.label:"i";typeof m=="string"?(n.label_=document.createElement("span"),n.label_.textContent=m,n.label_.className=p):n.label_=m;var E=n.collapsible_&&!n.collapsed_?n.collapseLabel_:n.label_;n.toggleButton_=document.createElement("button"),n.toggleButton_.setAttribute("type","button"),n.toggleButton_.setAttribute("aria-expanded",String(!n.collapsed_)),n.toggleButton_.title=u,n.toggleButton_.appendChild(E),n.toggleButton_.addEventListener(pt.CLICK,n.handleClick_.bind(n),!1);var b=a+" "+Ca+" "+Ah+(n.collapsed_&&n.collapsible_?" "+Mf:"")+(n.collapsible_?"":" ol-uncollapsible"),w=n.element;return w.className=b,w.appendChild(n.toggleButton_),w.appendChild(n.ulElement_),n.renderedAttributions_=[],n.renderedVisible_=!0,n}return e.prototype.collectSourceAttributions_=function(t){for(var n={},i=[],a=!0,u=t.layerStatesArray,p=0,g=u.length;p<g;++p){var v=u[p];if(!!ra(v,t.viewState)){var m=v.layer.getSource();if(!!m){var E=m.getAttributions();if(!!E){var b=E(t);if(!!b)if(a=a&&m.getAttributionsCollapsible()!==!1,Array.isArray(b))for(var w=0,S=b.length;w<S;++w)b[w]in n||(i.push(b[w]),n[b[w]]=!0);else b in n||(i.push(b),n[b]=!0)}}}}return this.overrideCollapsible_||this.setCollapsible(a),i},e.prototype.updateElement_=function(t){if(!t){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}var n=this.collectSourceAttributions_(t),i=n.length>0;if(this.renderedVisible_!=i&&(this.element.style.display=i?"":"none",this.renderedVisible_=i),!Wi(n,this.renderedAttributions_)){J0(this.ulElement_);for(var a=0,u=n.length;a<u;++a){var p=document.createElement("li");p.innerHTML=n[a],this.ulElement_.appendChild(p)}this.renderedAttributions_=n}},e.prototype.handleClick_=function(t){t.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_},e.prototype.handleToggle_=function(){this.element.classList.toggle(Mf),this.collapsed_?Pf(this.collapseLabel_,this.label_):Pf(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))},e.prototype.getCollapsible=function(){return this.collapsible_},e.prototype.setCollapsible=function(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())},e.prototype.setCollapsed=function(t){this.userCollapsed_=t,!(!this.collapsible_||this.collapsed_===t)&&this.handleToggle_()},e.prototype.getCollapsed=function(){return this.collapsed_},e.prototype.render=function(t){this.updateElement_(t.frameState)},e}(Xh),BE=NE,GE=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),zE=function(o){GE(e,o);function e(t){var n=this,i=t||{};n=o.call(this,{element:document.createElement("div"),render:i.render,target:i.target})||this;var a=i.className!==void 0?i.className:"ol-rotate",u=i.label!==void 0?i.label:"\u21E7",p=i.compassClassName!==void 0?i.compassClassName:"ol-compass";n.label_=null,typeof u=="string"?(n.label_=document.createElement("span"),n.label_.className=p,n.label_.textContent=u):(n.label_=u,n.label_.classList.add(p));var g=i.tipLabel?i.tipLabel:"Reset rotation",v=document.createElement("button");v.className=a+"-reset",v.setAttribute("type","button"),v.title=g,v.appendChild(n.label_),v.addEventListener(pt.CLICK,n.handleClick_.bind(n),!1);var m=a+" "+Ca+" "+Ah,E=n.element;return E.className=m,E.appendChild(v),n.callResetNorth_=i.resetNorth?i.resetNorth:void 0,n.duration_=i.duration!==void 0?i.duration:250,n.autoHide_=i.autoHide!==void 0?i.autoHide:!0,n.rotation_=void 0,n.autoHide_&&n.element.classList.add(Rs),n}return e.prototype.handleClick_=function(t){t.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()},e.prototype.resetNorth_=function(){var t=this.getMap(),n=t.getView();if(!!n){var i=n.getRotation();i!==void 0&&(this.duration_>0&&i%(2*Math.PI)!==0?n.animate({rotation:0,duration:this.duration_,easing:kr}):n.setRotation(0))}},e.prototype.render=function(t){var n=t.frameState;if(!!n){var i=n.viewState.rotation;if(i!=this.rotation_){var a="rotate("+i+"rad)";if(this.autoHide_){var u=this.element.classList.contains(Rs);!u&&i===0?this.element.classList.add(Rs):u&&i!==0&&this.element.classList.remove(Rs)}this.label_.style.transform=a}this.rotation_=i}},e}(Xh),UE=zE,VE=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),XE=function(o){VE(e,o);function e(t){var n=this,i=t||{};n=o.call(this,{element:document.createElement("div"),target:i.target})||this;var a=i.className!==void 0?i.className:"ol-zoom",u=i.delta!==void 0?i.delta:1,p=i.zoomInClassName!==void 0?i.zoomInClassName:a+"-in",g=i.zoomOutClassName!==void 0?i.zoomOutClassName:a+"-out",v=i.zoomInLabel!==void 0?i.zoomInLabel:"+",m=i.zoomOutLabel!==void 0?i.zoomOutLabel:"\u2013",E=i.zoomInTipLabel!==void 0?i.zoomInTipLabel:"Zoom in",b=i.zoomOutTipLabel!==void 0?i.zoomOutTipLabel:"Zoom out",w=document.createElement("button");w.className=p,w.setAttribute("type","button"),w.title=E,w.appendChild(typeof v=="string"?document.createTextNode(v):v),w.addEventListener(pt.CLICK,n.handleClick_.bind(n,u),!1);var S=document.createElement("button");S.className=g,S.setAttribute("type","button"),S.title=b,S.appendChild(typeof m=="string"?document.createTextNode(m):m),S.addEventListener(pt.CLICK,n.handleClick_.bind(n,-u),!1);var C=a+" "+Ca+" "+Ah,A=n.element;return A.className=C,A.appendChild(w),A.appendChild(S),n.duration_=i.duration!==void 0?i.duration:250,n}return e.prototype.handleClick_=function(t,n){n.preventDefault(),this.zoomByDelta_(t)},e.prototype.zoomByDelta_=function(t){var n=this.getMap(),i=n.getView();if(!!i){var a=i.getZoom();if(a!==void 0){var u=i.getConstrainedZoom(a+t);this.duration_>0?(i.getAnimating()&&i.cancelAnimations(),i.animate({zoom:u,duration:this.duration_,easing:kr})):i.setZoom(u)}}},e}(Xh),jE=XE;function WE(o){var e=o||{},t=new Ze,n=e.zoom!==void 0?e.zoom:!0;n&&t.push(new jE(e.zoomOptions));var i=e.rotate!==void 0?e.rotate:!0;i&&t.push(new UE(e.rotateOptions));var a=e.attribution!==void 0?e.attribution:!0;return a&&t.push(new BE(e.attributionOptions)),t}var sd={ACTIVE:"active"},HE=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),YE=function(o){HE(e,o);function e(t){var n=o.call(this)||this;return n.on,n.once,n.un,t&&t.handleEvent&&(n.handleEvent=t.handleEvent),n.map_=null,n.setActive(!0),n}return e.prototype.getActive=function(){return this.get(sd.ACTIVE)},e.prototype.getMap=function(){return this.map_},e.prototype.handleEvent=function(t){return!0},e.prototype.setActive=function(t){this.set(sd.ACTIVE,t)},e.prototype.setMap=function(t){this.map_=t},e}(Tn);function $E(o,e,t){var n=o.getCenterInternal();if(n){var i=[n[0]+e[0],n[1]+e[1]];o.animateInternal({duration:t!==void 0?t:250,easing:b1,center:o.getConstrainedCenter(i)})}}function jh(o,e,t,n){var i=o.getZoom();if(i!==void 0){var a=o.getConstrainedZoom(i+e),u=o.getResolutionForZoom(a);o.getAnimating()&&o.cancelAnimations(),o.animate({resolution:u,anchor:t,duration:n!==void 0?n:250,easing:kr})}}var Bo=YE,KE=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),ZE=function(o){KE(e,o);function e(t){var n=o.call(this)||this,i=t||{};return n.delta_=i.delta?i.delta:1,n.duration_=i.duration!==void 0?i.duration:250,n}return e.prototype.handleEvent=function(t){var n=!1;if(t.type==$t.DBLCLICK){var i=t.originalEvent,a=t.map,u=t.coordinate,p=i.shiftKey?-this.delta_:this.delta_,g=a.getView();jh(g,p,u,this.duration_),i.preventDefault(),n=!0}return!n},e}(Bo),qE=ZE,JE=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),QE=function(o){JE(e,o);function e(t){var n=this,i=t||{};return n=o.call(this,i)||this,i.handleDownEvent&&(n.handleDownEvent=i.handleDownEvent),i.handleDragEvent&&(n.handleDragEvent=i.handleDragEvent),i.handleMoveEvent&&(n.handleMoveEvent=i.handleMoveEvent),i.handleUpEvent&&(n.handleUpEvent=i.handleUpEvent),i.stopDown&&(n.stopDown=i.stopDown),n.handlingDownUpSequence=!1,n.trackedPointers_={},n.targetPointers=[],n}return e.prototype.getPointerCount=function(){return this.targetPointers.length},e.prototype.handleDownEvent=function(t){return!1},e.prototype.handleDragEvent=function(t){},e.prototype.handleEvent=function(t){if(!t.originalEvent)return!0;var n=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==$t.POINTERDRAG)this.handleDragEvent(t),t.originalEvent.preventDefault();else if(t.type==$t.POINTERUP){var i=this.handleUpEvent(t);this.handlingDownUpSequence=i&&this.targetPointers.length>0}}else if(t.type==$t.POINTERDOWN){var a=this.handleDownEvent(t);this.handlingDownUpSequence=a,n=this.stopDown(a)}else t.type==$t.POINTERMOVE&&this.handleMoveEvent(t);return!n},e.prototype.handleMoveEvent=function(t){},e.prototype.handleUpEvent=function(t){return!1},e.prototype.stopDown=function(t){return t},e.prototype.updateTrackedPointers_=function(t){if(tT(t)){var n=t.originalEvent,i=n.pointerId.toString();t.type==$t.POINTERUP?delete this.trackedPointers_[i]:t.type==$t.POINTERDOWN?this.trackedPointers_[i]=n:i in this.trackedPointers_&&(this.trackedPointers_[i]=n),this.targetPointers=wd(this.trackedPointers_)}},e}(Bo);function Wh(o){for(var e=o.length,t=0,n=0,i=0;i<e;i++)t+=o[i].clientX,n+=o[i].clientY;return[t/e,n/e]}function tT(o){var e=o.type;return e===$t.POINTERDOWN||e===$t.POINTERDRAG||e===$t.POINTERUP}var Go=QE;function _h(o){var e=arguments;return function(t){for(var n=!0,i=0,a=e.length;i<a&&(n=n&&e[i](t),!!n);++i);return n}}var eT=function(o){var e=o.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},nT=function(o){var e=o.map.getTargetElement(),t=o.map.getOwnerDocument().activeElement;return e.contains(t)},Dp=function(o){return o.map.getTargetElement().hasAttribute("tabindex")?nT(o):!0},iT=Sr,kp=function(o){var e=o.originalEvent;return e.button==0&&!(Em&&Tm&&e.ctrlKey)},Fp=function(o){var e=o.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},rT=function(o){var e=o.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},Np=function(o){var e=o.originalEvent,t=e.target.tagName;return t!=="INPUT"&&t!=="SELECT"&&t!=="TEXTAREA"},Wl=function(o){var e=o.originalEvent;return Ot(e!==void 0,56),e.pointerType=="mouse"},oT=function(o){var e=o.originalEvent;return Ot(e!==void 0,56),e.isPrimary&&e.button===0},sT=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),aT=function(o){sT(e,o);function e(t){var n=o.call(this,{stopDown:va})||this,i=t||{};n.kinetic_=i.kinetic,n.lastCentroid=null,n.lastPointersCount_,n.panning_=!1;var a=i.condition?i.condition:_h(Fp,oT);return n.condition_=i.onFocusOnly?_h(Dp,a):a,n.noKinetic_=!1,n}return e.prototype.handleDragEvent=function(t){this.panning_||(this.panning_=!0,this.getMap().getView().beginInteraction());var n=this.targetPointers,i=Wh(n);if(n.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(i[0],i[1]),this.lastCentroid){var a=[this.lastCentroid[0]-i[0],i[1]-this.lastCentroid[1]],u=t.map,p=u.getView();e0(a,p.getResolution()),wh(a,p.getRotation()),p.adjustCenterInternal(a)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=i,this.lastPointersCount_=n.length,t.originalEvent.preventDefault()},e.prototype.handleUpEvent=function(t){var n=t.map,i=n.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){var a=this.kinetic_.getDistance(),u=this.kinetic_.getAngle(),p=i.getCenterInternal(),g=n.getPixelFromCoordinateInternal(p),v=n.getCoordinateFromPixelInternal([g[0]-a*Math.cos(u),g[1]-a*Math.sin(u)]);i.animateInternal({center:i.getConstrainedCenter(v),duration:500,easing:kr})}return this.panning_&&(this.panning_=!1,i.endInteraction()),!1}else return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0},e.prototype.handleDownEvent=function(t){if(this.targetPointers.length>0&&this.condition_(t)){var n=t.map,i=n.getView();return this.lastCentroid=null,i.getAnimating()&&i.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}else return!1},e}(Go),lT=aT,hT=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),cT=function(o){hT(e,o);function e(t){var n=this,i=t||{};return n=o.call(this,{stopDown:va})||this,n.condition_=i.condition?i.condition:eT,n.lastAngle_=void 0,n.duration_=i.duration!==void 0?i.duration:250,n}return e.prototype.handleDragEvent=function(t){if(!!Wl(t)){var n=t.map,i=n.getView();if(i.getConstraints().rotation!==Vh){var a=n.getSize(),u=t.pixel,p=Math.atan2(a[1]/2-u[1],u[0]-a[0]/2);if(this.lastAngle_!==void 0){var g=p-this.lastAngle_;i.adjustRotationInternal(-g)}this.lastAngle_=p}}},e.prototype.handleUpEvent=function(t){if(!Wl(t))return!0;var n=t.map,i=n.getView();return i.endInteraction(this.duration_),!1},e.prototype.handleDownEvent=function(t){if(!Wl(t))return!1;if(kp(t)&&this.condition_(t)){var n=t.map;return n.getView().beginInteraction(),this.lastAngle_=void 0,!0}else return!1},e}(Go),uT=cT,fT=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),dT=function(o){fT(e,o);function e(t){var n=o.call(this)||this;return n.geometry_=null,n.element_=document.createElement("div"),n.element_.style.position="absolute",n.element_.style.pointerEvents="auto",n.element_.className="ol-box "+t,n.map_=null,n.startPixel_=null,n.endPixel_=null,n}return e.prototype.disposeInternal=function(){this.setMap(null)},e.prototype.render_=function(){var t=this.startPixel_,n=this.endPixel_,i="px",a=this.element_.style;a.left=Math.min(t[0],n[0])+i,a.top=Math.min(t[1],n[1])+i,a.width=Math.abs(n[0]-t[0])+i,a.height=Math.abs(n[1]-t[1])+i},e.prototype.setMap=function(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);var n=this.element_.style;n.left="inherit",n.top="inherit",n.width="inherit",n.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)},e.prototype.setPixels=function(t,n){this.startPixel_=t,this.endPixel_=n,this.createOrUpdateGeometry(),this.render_()},e.prototype.createOrUpdateGeometry=function(){var t=this.startPixel_,n=this.endPixel_,i=[t,[t[0],n[1]],n,[n[0],t[1]]],a=i.map(this.map_.getCoordinateFromPixelInternal,this.map_);a[4]=a[0].slice(),this.geometry_?this.geometry_.setCoordinates([a]):this.geometry_=new qd([a])},e.prototype.getGeometry=function(){return this.geometry_},e}(_a),pT=dT,Bp=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Ls={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"},Hl=function(o){Bp(e,o);function e(t,n,i){var a=o.call(this,t)||this;return a.coordinate=n,a.mapBrowserEvent=i,a}return e}(Bn),gT=function(o){Bp(e,o);function e(t){var n=o.call(this)||this;n.on,n.once,n.un;var i=t||{};return n.box_=new pT(i.className||"ol-dragbox"),n.minArea_=i.minArea!==void 0?i.minArea:64,i.onBoxEnd&&(n.onBoxEnd=i.onBoxEnd),n.startPixel_=null,n.condition_=i.condition?i.condition:kp,n.boxEndCondition_=i.boxEndCondition?i.boxEndCondition:n.defaultBoxEndCondition,n}return e.prototype.defaultBoxEndCondition=function(t,n,i){var a=i[0]-n[0],u=i[1]-n[1];return a*a+u*u>=this.minArea_},e.prototype.getGeometry=function(){return this.box_.getGeometry()},e.prototype.handleDragEvent=function(t){this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new Hl(Ls.BOXDRAG,t.coordinate,t))},e.prototype.handleUpEvent=function(t){this.box_.setMap(null);var n=this.boxEndCondition_(t,this.startPixel_,t.pixel);return n&&this.onBoxEnd(t),this.dispatchEvent(new Hl(n?Ls.BOXEND:Ls.BOXCANCEL,t.coordinate,t)),!1},e.prototype.handleDownEvent=function(t){return this.condition_(t)?(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new Hl(Ls.BOXSTART,t.coordinate,t)),!0):!1},e.prototype.onBoxEnd=function(t){},e}(Go),_T=gT,vT=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),yT=function(o){vT(e,o);function e(t){var n=this,i=t||{},a=i.condition?i.condition:rT;return n=o.call(this,{condition:a,className:i.className||"ol-dragzoom",minArea:i.minArea})||this,n.duration_=i.duration!==void 0?i.duration:200,n.out_=i.out!==void 0?i.out:!1,n}return e.prototype.onBoxEnd=function(t){var n=this.getMap(),i=n.getView(),a=this.getGeometry();if(this.out_){var u=i.rotatedExtentForGeometry(a),p=i.getResolutionForExtentInternal(u),g=i.getResolution()/p;a=a.clone(),a.scale(g*g)}i.fitInternal(a,{duration:this.duration_,easing:kr})},e}(_T),mT=yT,Ii={LEFT:37,UP:38,RIGHT:39,DOWN:40},xT=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),bT=function(o){xT(e,o);function e(t){var n=o.call(this)||this,i=t||{};return n.defaultCondition_=function(a){return Fp(a)&&Np(a)},n.condition_=i.condition!==void 0?i.condition:n.defaultCondition_,n.duration_=i.duration!==void 0?i.duration:100,n.pixelDelta_=i.pixelDelta!==void 0?i.pixelDelta:128,n}return e.prototype.handleEvent=function(t){var n=!1;if(t.type==pt.KEYDOWN){var i=t.originalEvent,a=i.keyCode;if(this.condition_(t)&&(a==Ii.DOWN||a==Ii.LEFT||a==Ii.RIGHT||a==Ii.UP)){var u=t.map,p=u.getView(),g=p.getResolution()*this.pixelDelta_,v=0,m=0;a==Ii.DOWN?m=-g:a==Ii.LEFT?v=-g:a==Ii.RIGHT?v=g:m=g;var E=[v,m];wh(E,p.getRotation()),$E(p,E,this.duration_),i.preventDefault(),n=!0}}return!n},e}(Bo),ET=bT,TT=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),wT=function(o){TT(e,o);function e(t){var n=o.call(this)||this,i=t||{};return n.condition_=i.condition?i.condition:Np,n.delta_=i.delta?i.delta:1,n.duration_=i.duration!==void 0?i.duration:100,n}return e.prototype.handleEvent=function(t){var n=!1;if(t.type==pt.KEYDOWN||t.type==pt.KEYPRESS){var i=t.originalEvent,a=i.charCode;if(this.condition_(t)&&(a=="+".charCodeAt(0)||a=="-".charCodeAt(0))){var u=t.map,p=a=="+".charCodeAt(0)?this.delta_:-this.delta_,g=u.getView();jh(g,p,void 0,this.duration_),i.preventDefault(),n=!0}}return!n},e}(Bo),ST=wT,RT=function(){function o(e,t,n){this.decay_=e,this.minVelocity_=t,this.delay_=n,this.points_=[],this.angle_=0,this.initialVelocity_=0}return o.prototype.begin=function(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0},o.prototype.update=function(e,t){this.points_.push(e,t,Date.now())},o.prototype.end=function(){if(this.points_.length<6)return!1;var e=Date.now()-this.delay_,t=this.points_.length-3;if(this.points_[t+2]<e)return!1;for(var n=t-3;n>0&&this.points_[n+2]>e;)n-=3;var i=this.points_[t+2]-this.points_[n+2];if(i<1e3/60)return!1;var a=this.points_[t]-this.points_[n],u=this.points_[t+1]-this.points_[n+1];return this.angle_=Math.atan2(u,a),this.initialVelocity_=Math.sqrt(a*a+u*u)/i,this.initialVelocity_>this.minVelocity_},o.prototype.getDistance=function(){return(this.minVelocity_-this.initialVelocity_)/this.decay_},o.prototype.getAngle=function(){return this.angle_},o}(),CT=RT,OT=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Yl={TRACKPAD:"trackpad",WHEEL:"wheel"},IT=function(o){OT(e,o);function e(t){var n=this,i=t||{};n=o.call(this,i)||this,n.totalDelta_=0,n.lastDelta_=0,n.maxDelta_=i.maxDelta!==void 0?i.maxDelta:1,n.duration_=i.duration!==void 0?i.duration:250,n.timeout_=i.timeout!==void 0?i.timeout:80,n.useAnchor_=i.useAnchor!==void 0?i.useAnchor:!0,n.constrainResolution_=i.constrainResolution!==void 0?i.constrainResolution:!1;var a=i.condition?i.condition:iT;return n.condition_=i.onFocusOnly?_h(Dp,a):a,n.lastAnchor_=null,n.startTime_=void 0,n.timeoutId_,n.mode_=void 0,n.trackpadEventGap_=400,n.trackpadTimeoutId_,n.deltaPerZoom_=300,n}return e.prototype.endInteraction_=function(){this.trackpadTimeoutId_=void 0;var t=this.getMap().getView();t.endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_)},e.prototype.handleEvent=function(t){if(!this.condition_(t))return!0;var n=t.type;if(n!==pt.WHEEL)return!0;var i=t.map,a=t.originalEvent;a.preventDefault(),this.useAnchor_&&(this.lastAnchor_=t.coordinate);var u;if(t.type==pt.WHEEL&&(u=a.deltaY,mm&&a.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(u/=Od),a.deltaMode===WheelEvent.DOM_DELTA_LINE&&(u*=40)),u===0)return!1;this.lastDelta_=u;var p=Date.now();this.startTime_===void 0&&(this.startTime_=p),(!this.mode_||p-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(u)<4?Yl.TRACKPAD:Yl.WHEEL);var g=i.getView();if(this.mode_===Yl.TRACKPAD&&!(g.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(g.getAnimating()&&g.cancelAnimations(),g.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),g.adjustZoom(-u/this.deltaPerZoom_,this.lastAnchor_),this.startTime_=p,!1;this.totalDelta_+=u;var v=Math.max(this.timeout_-(p-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,i),v),!1},e.prototype.handleWheelZoom_=function(t){var n=t.getView();n.getAnimating()&&n.cancelAnimations();var i=-ae(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(n.getConstrainResolution()||this.constrainResolution_)&&(i=i?i>0?1:-1:0),jh(n,i,this.lastAnchor_,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0},e.prototype.setMouseAnchor=function(t){this.useAnchor_=t,t||(this.lastAnchor_=null)},e}(Bo),AT=IT,PT=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),MT=function(o){PT(e,o);function e(t){var n=this,i=t||{},a=i;return a.stopDown||(a.stopDown=va),n=o.call(this,a)||this,n.anchor_=null,n.lastAngle_=void 0,n.rotating_=!1,n.rotationDelta_=0,n.threshold_=i.threshold!==void 0?i.threshold:.3,n.duration_=i.duration!==void 0?i.duration:250,n}return e.prototype.handleDragEvent=function(t){var n=0,i=this.targetPointers[0],a=this.targetPointers[1],u=Math.atan2(a.clientY-i.clientY,a.clientX-i.clientX);if(this.lastAngle_!==void 0){var p=u-this.lastAngle_;this.rotationDelta_+=p,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),n=p}this.lastAngle_=u;var g=t.map,v=g.getView();if(v.getConstraints().rotation!==Vh){var m=g.getViewport().getBoundingClientRect(),E=Wh(this.targetPointers);E[0]-=m.left,E[1]-=m.top,this.anchor_=g.getCoordinateFromPixelInternal(E),this.rotating_&&(g.render(),v.adjustRotationInternal(n,this.anchor_))}},e.prototype.handleUpEvent=function(t){if(this.targetPointers.length<2){var n=t.map,i=n.getView();return i.endInteraction(this.duration_),!1}else return!0},e.prototype.handleDownEvent=function(t){if(this.targetPointers.length>=2){var n=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||n.getView().beginInteraction(),!0}else return!1},e}(Go),LT=MT,DT=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),kT=function(o){DT(e,o);function e(t){var n=this,i=t||{},a=i;return a.stopDown||(a.stopDown=va),n=o.call(this,a)||this,n.anchor_=null,n.duration_=i.duration!==void 0?i.duration:400,n.lastDistance_=void 0,n.lastScaleDelta_=1,n}return e.prototype.handleDragEvent=function(t){var n=1,i=this.targetPointers[0],a=this.targetPointers[1],u=i.clientX-a.clientX,p=i.clientY-a.clientY,g=Math.sqrt(u*u+p*p);this.lastDistance_!==void 0&&(n=this.lastDistance_/g),this.lastDistance_=g;var v=t.map,m=v.getView();n!=1&&(this.lastScaleDelta_=n);var E=v.getViewport().getBoundingClientRect(),b=Wh(this.targetPointers);b[0]-=E.left,b[1]-=E.top,this.anchor_=v.getCoordinateFromPixelInternal(b),v.render(),m.adjustResolutionInternal(n,this.anchor_)},e.prototype.handleUpEvent=function(t){if(this.targetPointers.length<2){var n=t.map,i=n.getView(),a=this.lastScaleDelta_>1?1:-1;return i.endInteraction(this.duration_,a),!1}else return!0},e.prototype.handleDownEvent=function(t){if(this.targetPointers.length>=2){var n=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||n.getView().beginInteraction(),!0}else return!1},e}(Go),FT=kT;function NT(o){var e=o||{},t=new Ze,n=new CT(-.005,.05,100),i=e.altShiftDragRotate!==void 0?e.altShiftDragRotate:!0;i&&t.push(new uT);var a=e.doubleClickZoom!==void 0?e.doubleClickZoom:!0;a&&t.push(new qE({delta:e.zoomDelta,duration:e.zoomDuration}));var u=e.dragPan!==void 0?e.dragPan:!0;u&&t.push(new lT({onFocusOnly:e.onFocusOnly,kinetic:n}));var p=e.pinchRotate!==void 0?e.pinchRotate:!0;p&&t.push(new LT);var g=e.pinchZoom!==void 0?e.pinchZoom:!0;g&&t.push(new FT({duration:e.zoomDuration}));var v=e.keyboard!==void 0?e.keyboard:!0;v&&(t.push(new ET),t.push(new ST({delta:e.zoomDelta,duration:e.zoomDuration})));var m=e.mouseWheelZoom!==void 0?e.mouseWheelZoom:!0;m&&t.push(new AT({onFocusOnly:e.onFocusOnly,duration:e.zoomDuration}));var E=e.shiftDragZoom!==void 0?e.shiftDragZoom:!0;return E&&t.push(new mT({duration:e.zoomDuration})),t}var BT=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),GT=function(o){BT(e,o);function e(t){return t=se({},t),t.controls||(t.controls=WE()),t.interactions||(t.interactions=NT({onFocusOnly:!0})),o.call(this,t)||this}return e.prototype.createRenderer=function(){return new oE(this)},e}(LE),zT=GT,UT=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),VT=function(o){UT(e,o);function e(t){var n=this,i=t||{},a=se({},i);return delete a.preload,delete a.useInterimTilesOnError,n=o.call(this,a)||this,n.on,n.once,n.un,n.setPreload(i.preload!==void 0?i.preload:0),n.setUseInterimTilesOnError(i.useInterimTilesOnError!==void 0?i.useInterimTilesOnError:!0),n}return e.prototype.getPreload=function(){return this.get(Ps.PRELOAD)},e.prototype.setPreload=function(t){this.set(Ps.PRELOAD,t)},e.prototype.getUseInterimTilesOnError=function(){return this.get(Ps.USE_INTERIM_TILES_ON_ERROR)},e.prototype.setUseInterimTilesOnError=function(t){this.set(Ps.USE_INTERIM_TILES_ON_ERROR,t)},e.prototype.getData=function(t){return o.prototype.getData.call(this,t)},e}(Oa),XT=VT,jT=function(){function o(e,t){this.name=e,this.data=t,this.texture_=null}return o.prototype.getTexture=function(e){if(!this.texture_){var t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.data.length/4,1,0,e.RGBA,e.UNSIGNED_BYTE,this.data),this.texture_=t}return this.texture_},o}(),WT=jT,HT=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),YT=function(o){HT(e,o);function e(t){var n=this,i=dt.IDLE;return n=o.call(this,t.tileCoord,i,{transition:t.transition,interpolate:t.interpolate})||this,n.loader_=t.loader,n.data_=null,n.error_=null,n}return e.prototype.getData=function(){return this.data_},e.prototype.getError=function(){return this.error_},e.prototype.load=function(){this.state=dt.LOADING,this.changed();var t=this;this.loader_().then(function(n){t.data_=n,t.state=dt.LOADED,t.changed()}).catch(function(n){t.error_=n,t.state=dt.ERROR,t.changed()})},e}(kh),Gp=YT,$T=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();function zp(o,e,t){var n=t?o.LINEAR:o.NEAREST;o.bindTexture(o.TEXTURE_2D,e),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,n),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,n)}function KT(o,e,t,n){zp(o,e,n),o.texImage2D(o.TEXTURE_2D,0,o.RGBA,o.RGBA,o.UNSIGNED_BYTE,t)}function ad(o,e,t,n,i,a){var u=o.getGL(),p,g;if(t instanceof Float32Array){p=u.FLOAT,o.getExtension("OES_texture_float");var v=o.getExtension("OES_texture_float_linear");g=v!==null}else p=u.UNSIGNED_BYTE,g=!0;zp(u,e,a&&g);var m=t.byteLength/n[1],E=1;m%8===0?E=8:m%4===0?E=4:m%2===0&&(E=2);var b;switch(i){case 1:{b=u.LUMINANCE;break}case 2:{b=u.LUMINANCE_ALPHA;break}case 3:{b=u.RGB;break}case 4:{b=u.RGBA;break}default:throw new Error("Unsupported number of bands: ".concat(i))}var w=u.getParameter(u.UNPACK_ALIGNMENT);u.pixelStorei(u.UNPACK_ALIGNMENT,E),u.texImage2D(u.TEXTURE_2D,0,b,n[0],n[1],0,b,p,t),u.pixelStorei(u.UNPACK_ALIGNMENT,w)}var bo=null;function ZT(){var o=document.createElement("canvas");o.width=1,o.height=1,bo=o.getContext("2d")}var qT=function(o){$T(e,o);function e(t){var n=o.call(this)||this;n.tile,n.textures=[],n.handleTileChange_=n.handleTileChange_.bind(n),n.size=Be(t.grid.getTileSize(t.tile.tileCoord[0])),n.tilePixelRatio_=t.tilePixelRatio||1,n.gutter_=t.gutter||0,n.bandCount=NaN,n.helper_=t.helper;var i=new Tp(Mh,Dh);return i.fromArray([0,1,1,1,1,0,0,0]),n.helper_.flushBufferData(i),n.coords=i,n.setTile(t.tile),n}return e.prototype.setTile=function(t){if(t!==this.tile)if(this.tile&&this.tile.removeEventListener(pt.CHANGE,this.handleTileChange_),this.tile=t,this.textures.length=0,this.loaded=t.getState()===dt.LOADED,this.loaded)this.uploadTile_();else{if(t instanceof Qf){var n=t.getImage();n instanceof Image&&!n.crossOrigin&&(n.crossOrigin="anonymous")}t.addEventListener(pt.CHANGE,this.handleTileChange_)}},e.prototype.uploadTile_=function(){var t=this.helper_,n=t.getGL(),i=this.tile;if(i instanceof Qf||i instanceof k1){var a=i.getImage();if(this.gutter_!==0){var u=this.tilePixelRatio_*this.gutter_,p=Math.round(a.width-2*u),g=Math.round(a.height-2*u),v=je(p,g);i.interpolate||se(v,ph),v.drawImage(a,u,u,p,g,0,0,p,g),a=v.canvas}var m=n.createTexture();this.textures.push(m),this.bandCount=4,KT(n,m,a,i.interpolate);return}var E=[this.size[0]*this.tilePixelRatio_,this.size[1]*this.tilePixelRatio_],b=i.getData(),w=b instanceof Float32Array,S=E[0]*E[1],C=w?Float32Array:Uint8Array,A=C.BYTES_PER_ELEMENT,M=b.byteLength/E[1];this.bandCount=Math.floor(M/A/E[0]);var I=Math.ceil(this.bandCount/4);if(I===1){var m=n.createTexture();this.textures.push(m),ad(t,m,b,E,this.bandCount,i.interpolate);return}for(var L=new Array(I),k=0;k<I;++k){var m=n.createTexture();this.textures.push(m);var N=k<I-1?4:this.bandCount%4;L[k]=new C(S*N)}for(var G=0,z=0,V=E[0]*this.bandCount,Y=0;Y<E[1];++Y){for(var X=0;X<V;++X){var J=b[z+X],q=Math.floor(G/this.bandCount),K=X%this.bandCount,k=Math.floor(K/4),Q=L[k],N=Q.length/S,tt=K%4;Q[q*N+tt]=J,++G}z+=M/A}for(var k=0;k<I;++k){var m=this.textures[k],Q=L[k],N=Q.length/S;ad(t,m,Q,E,N,i.interpolate)}},e.prototype.handleTileChange_=function(){this.tile.getState()===dt.LOADED&&(this.loaded=!0,this.uploadTile_(),this.dispatchEvent(pt.CHANGE))},e.prototype.disposeInternal=function(){var t=this.helper_.getGL();this.helper_.deleteBuffer(this.coords);for(var n=0;n<this.textures.length;++n)t.deleteTexture(this.textures[n]);this.tile.removeEventListener(pt.CHANGE,this.handleTileChange_)},e.prototype.getPixelData=function(t,n){if(!this.loaded)return null;if(t=Math.floor(this.tilePixelRatio_*t),n=Math.floor(this.tilePixelRatio_*n),this.tile instanceof Gp){var i=this.tile.getData(),a=Math.floor(this.tilePixelRatio_*this.size[0]);if(i instanceof DataView){var u=i.byteLength/(this.size[0]*this.size[1]),p=n*a*u+t*u,g=i.buffer.slice(p,p+u);return new DataView(g)}var v=n*a*this.bandCount+t*this.bandCount;return i.slice(v,v+this.bandCount)}bo||ZT(),bo.clearRect(0,0,1,1);var m,E=this.tile.getImage();try{bo.drawImage(E,t,n,1,1,0,0,1,1),m=bo.getImageData(0,0,1,1).data}catch{return null}return m},e}(Hi),JT=qT,QT=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),_t={TILE_TEXTURE_ARRAY:"u_tileTextures",TILE_TRANSFORM:"u_tileTransform",TRANSITION_ALPHA:"u_transitionAlpha",DEPTH:"u_depth",TEXTURE_PIXEL_WIDTH:"u_texturePixelWidth",TEXTURE_PIXEL_HEIGHT:"u_texturePixelHeight",TEXTURE_RESOLUTION:"u_textureResolution",TEXTURE_ORIGIN_X:"u_textureOriginX",TEXTURE_ORIGIN_Y:"u_textureOriginY",RENDER_EXTENT:"u_renderExtent",RESOLUTION:"u_resolution",ZOOM:"u_zoom"},Us={TEXTURE_COORD:"a_textureCoord"},tw=[{name:Us.TEXTURE_COORD,size:2,type:xo.FLOAT}],ew={};function nw(o){return 2*(1-1/(o+1))-1}function ld(o,e,t){t in o||(o[t]=[]),o[t].push(e)}function $l(o,e){var t=o.layerStatesArray[o.layerIndex];t.extent&&(e=zi(e,Di(t.extent,o.viewState.projection)));var n=t.layer.getRenderSource();if(!n.getWrapX()){var i=n.getTileGridForProjection(o.viewState.projection).getExtent();i&&(e=zi(e,i))}return e}function Kl(o,e){return"".concat(o.getKey(),",").concat(ha(e))}var iw=function(o){QT(e,o);function e(t,n){var i=o.call(this,t,{uniforms:n.uniforms})||this;i.renderComplete=!1,i.tileTransform_=Ge(),i.tempMat4_=wp(),i.tempTileRange_=new Op(0,0,0,0),i.tempTileCoord_=la(0,0,0),i.tempSize_=[0,0],i.program_,i.vertexShader_=n.vertexShader,i.fragmentShader_=n.fragmentShader,i.indices_=new Tp(Lh,Dh),i.indices_.fromArray([0,1,3,1,2,3]);var a=n.cacheSize!==void 0?n.cacheSize:512;return i.tileTextureCache_=new Ip(a),i.paletteTextures_=n.paletteTextures||[],i.frameState_=null,i}return e.prototype.reset=function(t){o.prototype.reset.call(this,{uniforms:t.uniforms}),this.vertexShader_=t.vertexShader,this.fragmentShader_=t.fragmentShader,this.paletteTextures_=t.paletteTextures||[],this.helper&&(this.program_=this.helper.getProgram(this.fragmentShader_,this.vertexShader_))},e.prototype.afterHelperCreated=function(){this.program_=this.helper.getProgram(this.fragmentShader_,this.vertexShader_),this.helper.flushBufferData(this.indices_)},e.prototype.isDrawableTile_=function(t){var n=this.getLayer(),i=t.getState(),a=n.getUseInterimTilesOnError();return i==dt.LOADED||i==dt.EMPTY||i==dt.ERROR&&!a},e.prototype.prepareFrameInternal=function(t){var n=this.getLayer(),i=n.getRenderSource();return!i||Sa($l(t,t.extent))?!1:i.getState()===Oe.READY},e.prototype.enqueueTiles=function(t,n,i,a){var u=t.viewState,p=this.getLayer(),g=p.getRenderSource(),v=g.getTileGridForProjection(u.projection),m=g.getTilePixelRatio(t.pixelRatio),E=g.getGutterForProjection(u.projection),b=Xt(g);b in t.wantedTiles||(t.wantedTiles[b]={});for(var w=t.wantedTiles[b],S=this.tileTextureCache_,C=Math.max(i-p.getPreload(),v.getMinZoom(),p.getMinZoom()),A=i;A>=C;--A)for(var M=v.getTileRangeForExtentAndZ(n,A,this.tempTileRange_),I=v.getResolution(A),L=M.minX;L<=M.maxX;++L)for(var k=M.minY;k<=M.maxY;++k){var N=la(A,L,k,this.tempTileCoord_),G=Kl(g,N),z=void 0,V=void 0;if(S.containsKey(G)&&(z=S.get(G),V=z.tile),!z||z.tile.key!==g.getKey())if(V=g.getTile(A,L,k,t.pixelRatio,u.projection),!z)z=new JT({tile:V,grid:v,helper:this.helper,tilePixelRatio:m,gutter:E}),S.set(G,z);else if(this.isDrawableTile_(V))z.setTile(V);else{var Y=V.getInterimTile();z.setTile(Y)}ld(a,z,A);var X=V.getKey();w[X]=!0,V.getState()===dt.IDLE&&(t.tileQueue.isKeyQueued(X)||t.tileQueue.enqueue([V,b,v.getTileCoordCenter(N),I]))}},e.prototype.renderFrame=function(t){this.frameState_=t,this.renderComplete=!0;var n=this.helper.getGL();this.preRender(n,t);var i=t.viewState,a=this.getLayer(),u=a.getRenderSource(),p=u.getTileGridForProjection(i.projection),g=$l(t,t.extent),v=p.getZForResolution(i.resolution,u.zDirection),m={};if(t.nextExtent){var E=p.getZForResolution(i.nextResolution,u.zDirection),b=$l(t,t.nextExtent);this.enqueueTiles(t,b,E,m)}this.enqueueTiles(t,g,v,m);for(var w={},S=Xt(this),C=t.time,A=!1,M=m[v],I=0,L=M.length;I<L;++I){var k=M[I],N=k.tile,G=N.tileCoord;if(k.loaded){var z=N.getAlpha(S,C);if(z===1){N.endTransition(S);continue}A=!0;var V=ha(G);w[V]=z}this.renderComplete=!1;var Y=this.findAltTiles_(p,G,v+1,m);if(!Y)for(var X=p.getMinZoom(),J=v-1;J>=X;--J){var q=this.findAltTiles_(p,G,J,m);if(q)break}}this.helper.useProgram(this.program_),this.helper.prepareDraw(t,!A);for(var K=Object.keys(m).map(Number).sort(Ar),Q=i.center[0],tt=i.center[1],nt=0,ot=K.length;nt<ot;++nt)for(var at=K[nt],ht=p.getResolution(at),ut=Be(p.getTileSize(at),this.tempSize_),Rt=p.getOrigin(at),W=(Q-Rt[0])/(ut[0]*ht),Yt=(Rt[1]-tt)/(ut[1]*ht),Ut=i.resolution/ht,Jt=nw(at),ne=m[at],I=0,L=ne.length;I<L;++I){var k=ne[I];if(!!k.loaded){var N=k.tile,G=N.tileCoord,V=ha(G),ze=G[1],ie=G[2];mn(this.tileTransform_,0,0,2/(t.size[0]*Ut/ut[0]),-2/(t.size[1]*Ut/ut[1]),i.rotation,-(W-ze),-(Yt-ie)),this.helper.setUniformMatrixValue(_t.TILE_TRANSFORM,zs(this.tempMat4_,this.tileTransform_)),this.helper.bindBuffer(k.coords),this.helper.bindBuffer(this.indices_),this.helper.enableAttributes(tw);for(var ue=0;ue<k.textures.length;){var wn="TEXTURE"+ue,Yi="".concat(_t.TILE_TEXTURE_ARRAY,"[").concat(ue,"]");n.activeTexture(n[wn]),n.bindTexture(n.TEXTURE_2D,k.textures[ue]),n.uniform1i(this.helper.getUniformLocation(Yi),ue),++ue}for(var Gn=0;Gn<this.paletteTextures_.length;++Gn){var ui=this.paletteTextures_[Gn];n.activeTexture(n["TEXTURE"+ue]);var We=ui.getTexture(n);n.bindTexture(n.TEXTURE_2D,We),n.uniform1i(this.helper.getUniformLocation(ui.name),ue),++ue}var z=V in w?w[V]:1;z<1&&(t.animate=!0),this.helper.setUniformFloatValue(_t.TRANSITION_ALPHA,z),this.helper.setUniformFloatValue(_t.DEPTH,Jt),this.helper.setUniformFloatValue(_t.TEXTURE_PIXEL_WIDTH,ut[0]),this.helper.setUniformFloatValue(_t.TEXTURE_PIXEL_HEIGHT,ut[1]),this.helper.setUniformFloatValue(_t.TEXTURE_RESOLUTION,ht),this.helper.setUniformFloatValue(_t.TEXTURE_ORIGIN_X,Rt[0]+ze*ut[0]*ht),this.helper.setUniformFloatValue(_t.TEXTURE_ORIGIN_Y,Rt[1]-ie*ut[1]*ht),this.helper.setUniformFloatVec4(_t.RENDER_EXTENT,g),this.helper.setUniformFloatValue(_t.RESOLUTION,i.resolution),this.helper.setUniformFloatValue(_t.ZOOM,i.zoom),this.helper.drawElements(0,this.indices_.getSize())}}this.helper.finalizeDraw(t,this.dispatchPreComposeEvent,this.dispatchPostComposeEvent);for(var zn=this.helper.getCanvas(),fi=this.tileTextureCache_;fi.canExpireCache();){var k=fi.pop();k.dispose()}var di=function(pi,Te){u.expireCache(Te.viewState.projection,ew)};return t.postRenderFunctions.push(di),this.postRender(n,t),zn},e.prototype.getData=function(t){var n=this.helper.getGL();if(!n)return null;var i=this.frameState_;if(!i)return null;var a=this.getLayer(),u=re(i.pixelToCoordinateTransform,t.slice()),p=i.viewState,g=a.getExtent();if(g&&!Xi(Di(g,p.projection),u))return null;var v=a.getRenderSource(),m=v.getTileGridForProjection(p.projection);if(!v.getWrapX()){var E=m.getExtent();if(E&&!Xi(E,u))return null}for(var b=this.tileTextureCache_,w=m.getZForResolution(p.resolution);w>=m.getMinZoom();--w){var S=m.getTileCoordForCoordAndZ(u,w),C=Kl(v,S);if(!!b.containsKey(C)){var A=b.get(C);if(!!A.loaded){var M=m.getOrigin(w),I=Be(m.getTileSize(w)),L=m.getResolution(w),k=(u[0]-M[0])/L-S[1]*I[0],N=(M[1]-u[1])/L-S[2]*I[1];return A.getPixelData(k,N)}}}return null},e.prototype.findAltTiles_=function(t,n,i,a){var u=t.getTileRangeForTileCoordAndZ(n,i,this.tempTileRange_);if(!u)return!1;for(var p=!0,g=this.tileTextureCache_,v=this.getLayer().getRenderSource(),m=u.minX;m<=u.maxX;++m)for(var E=u.minY;E<=u.maxY;++E){var b=Kl(v,[i,m,E]),w=!1;if(g.containsKey(b)){var S=g.get(b);S.loaded&&(ld(a,S,i),w=!0)}w||(p=!1)}return p},e.prototype.removeHelper=function(){if(this.helper){var t=this.tileTextureCache_;t.forEach(function(n){return n.dispose()}),t.clear()}o.prototype.removeHelper.call(this)},e.prototype.disposeInternal=function(){var t=this.helper;if(t){var n=t.getGL();n.deleteProgram(this.program_),delete this.program_,t.deleteBuffer(this.indices_)}o.prototype.disposeInternal.call(this),delete this.indices_,delete this.tileTextureCache_,delete this.frameState_},e}(v1),rw=iw,it={NUMBER:1,STRING:2,COLOR:4,BOOLEAN:8,NUMBER_ARRAY:16,ANY:31,NONE:0},xt={};function En(o){if(typeof o=="number")return it.NUMBER;if(typeof o=="boolean")return it.BOOLEAN;if(typeof o=="string")return q0(o)?it.COLOR|it.STRING:it.STRING;if(!Array.isArray(o))throw new Error("Unhandled value type: ".concat(JSON.stringify(o)));var e=o,t=e.every(function(i){return typeof i=="number"});if(t)return e.length===3||e.length===4?it.COLOR|it.NUMBER_ARRAY:it.NUMBER_ARRAY;if(typeof e[0]!="string")throw new Error("Expected an expression operator but received: ".concat(JSON.stringify(e)));var n=xt[e[0]];if(n===void 0)throw new Error("Unrecognized expression operator: ".concat(JSON.stringify(e)));return n.getReturnType(e.slice(1))}function ow(o){return Nd(o)%1===0}function Aa(o){var e=o.toString();return e.indexOf(".")===-1?e+".0":e}function Up(o){if(o.length<2||o.length>4)throw new Error("`formatArray` can only output `vec2`, `vec3` or `vec4` arrays.");return"vec".concat(o.length,"(").concat(o.map(Aa).join(", "),")")}function sw(o){var e=Co(o).slice();return e.length<4&&e.push(1),Up(e.map(function(t,n){return n<3?t/255:t}))}function Vp(o,e){return o.stringLiteralsMap[e]===void 0&&(o.stringLiteralsMap[e]=Object.keys(o.stringLiteralsMap).length),o.stringLiteralsMap[e]}function aw(o,e){return Aa(Vp(o,e))}function st(o,e,t){if(Array.isArray(e)&&typeof e[0]=="string"){var n=xt[e[0]];if(n===void 0)throw new Error("Unrecognized expression operator: ".concat(JSON.stringify(e)));return n.toGlsl(o,e.slice(1),t)}var i=En(e);if((i&it.NUMBER)>0)return Aa(e);if((i&it.BOOLEAN)>0)return e.toString();if((i&it.STRING)>0&&(t===void 0||t==it.STRING))return aw(o,e.toString());if((i&it.COLOR)>0&&(t===void 0||t==it.COLOR))return sw(e);if((i&it.NUMBER_ARRAY)>0)return Up(e);throw new Error("Unexpected expression ".concat(e," (expected type ").concat(t,")"))}function Xp(o){if(!(En(o)&it.NUMBER))throw new Error("A numeric value was expected, got ".concat(JSON.stringify(o)," instead"))}function le(o){for(var e=0;e<o.length;e++)Xp(o[e])}function jp(o){if(!(En(o)&it.STRING))throw new Error("A string value was expected, got ".concat(JSON.stringify(o)," instead"))}function Hh(o){if(!(En(o)&it.BOOLEAN))throw new Error("A boolean value was expected, got ".concat(JSON.stringify(o)," instead"))}function Ht(o,e){if(o.length!==e)throw new Error("Exactly ".concat(e," arguments were expected, got ").concat(o.length," instead"))}function hi(o,e){if(o.length<e)throw new Error("At least ".concat(e," arguments were expected, got ").concat(o.length," instead"))}function Pa(o,e){if(o.length>e)throw new Error("At most ".concat(e," arguments were expected, got ").concat(o.length," instead"))}function Wp(o){if(o.length%2!==0)throw new Error("An even amount of arguments was expected, got ".concat(o," instead"))}function lw(o){if(o.length%2===0)throw new Error("An odd amount of arguments was expected, got ".concat(o," instead"))}function Yh(o,e){if(!ow(e))throw new Error("Could not infer only one type from the following expression: ".concat(JSON.stringify(o)))}xt.get={getReturnType:function(o){return it.ANY},toGlsl:function(o,e){Ht(e,1),jp(e[0]);var t=e[0].toString();o.attributes.indexOf(t)===-1&&o.attributes.push(t);var n=o.inFragmentShader?"v_":"a_";return n+t}};function Hp(o){return"u_var_"+o}xt.var={getReturnType:function(o){return it.ANY},toGlsl:function(o,e){Ht(e,1),jp(e[0]);var t=e[0].toString();return o.variables.indexOf(t)===-1&&o.variables.push(t),Hp(t)}};var Yp="u_paletteTextures";xt.palette={getReturnType:function(o){return it.COLOR},toGlsl:function(o,e){Ht(e,2),Xp(e[0]);var t=st(o,e[0]),n=e[1];if(!Array.isArray(n))throw new Error("The second argument of palette must be an array");for(var i=n.length,a=new Uint8Array(i*4),u=0;u<i;u++){var p=n[u],g=void 0;if(typeof p=="string")g=op(p);else{if(!Array.isArray(p))throw new Error("The second argument of palette must be an array of strings or colors");var v=p.length;if(v===4)g=p;else{if(v!==3)throw new Error("Expected palette color to have 3 or 4 values, got ".concat(v));g=[p[0],p[1],p[2],1]}}var m=u*4;a[m]=g[0],a[m+1]=g[1],a[m+2]=g[2],a[m+3]=g[3]*255}o.paletteTextures||(o.paletteTextures=[]);var E="".concat(Yp,"[").concat(o.paletteTextures.length,"]"),b=new WT(E,a);return o.paletteTextures.push(b),"texture2D(".concat(E,", vec2((").concat(t," + 0.5) / ").concat(i,".0, 0.5))")}};var Zl="getBandValue";xt.band={getReturnType:function(o){return it.NUMBER},toGlsl:function(o,e){hi(e,1),Pa(e,3);var t=e[0];if(!(Zl in o.functions)){for(var n="",i=o.bandCount||1,a=0;a<i;a++){var u=Math.floor(a/4),p=a%4;p===i-1&&p===1&&(p=3);var g="".concat(_t.TILE_TEXTURE_ARRAY,"[").concat(u,"]");n+=`
          if (band == `.concat(a+1,`.0) {
            return texture2D(`).concat(g,", v_textureCoord + vec2(dx, dy))[").concat(p,`];
          }
        `)}o.functions[Zl]=`
        float getBandValue(float band, float xOffset, float yOffset) {
          float dx = xOffset / `.concat(_t.TEXTURE_PIXEL_WIDTH,`;
          float dy = yOffset / `).concat(_t.TEXTURE_PIXEL_HEIGHT,`;
          `).concat(n,`
        }
      `)}var v=st(o,t),m=st(o,e[1]||0),E=st(o,e[2]||0);return"".concat(Zl,"(").concat(v,", ").concat(m,", ").concat(E,")")}};xt.time={getReturnType:function(o){return it.NUMBER},toGlsl:function(o,e){return Ht(e,0),"u_time"}};xt.zoom={getReturnType:function(o){return it.NUMBER},toGlsl:function(o,e){return Ht(e,0),"u_zoom"}};xt.resolution={getReturnType:function(o){return it.NUMBER},toGlsl:function(o,e){return Ht(e,0),"u_resolution"}};xt["*"]={getReturnType:function(o){return it.NUMBER},toGlsl:function(o,e){return Ht(e,2),le(e),"(".concat(st(o,e[0])," * ").concat(st(o,e[1]),")")}};xt["/"]={getReturnType:function(o){return it.NUMBER},toGlsl:function(o,e){return Ht(e,2),le(e),"(".concat(st(o,e[0])," / ").concat(st(o,e[1]),")")}};xt["+"]={getReturnType:function(o){return it.NUMBER},toGlsl:function(o,e){return Ht(e,2),le(e),"(".concat(st(o,e[0])," + ").concat(st(o,e[1]),")")}};xt["-"]={getReturnType:function(o){return it.NUMBER},toGlsl:function(o,e){return Ht(e,2),le(e),"(".concat(st(o,e[0])," - ").concat(st(o,e[1]),")")}};xt.clamp={getReturnType:function(o){return it.NUMBER},toGlsl:function(o,e){Ht(e,3),le(e);var t=st(o,e[1]),n=st(o,e[2]);return"clamp(".concat(st(o,e[0]),", ").concat(t,", ").concat(n,")")}};xt["%"]={getReturnType:function(o){return it.NUMBER},toGlsl:function(o,e){return Ht(e,2),le(e),"mod(".concat(st(o,e[0]),", ").concat(st(o,e[1]),")")}};xt["^"]={getReturnType:function(o){return it.NUMBER},toGlsl:function(o,e){return Ht(e,2),le(e),"pow(".concat(st(o,e[0]),", ").concat(st(o,e[1]),")")}};xt.abs={getReturnType:function(o){return it.NUMBER},toGlsl:function(o,e){return Ht(e,1),le(e),"abs(".concat(st(o,e[0]),")")}};xt.floor={getReturnType:function(o){return it.NUMBER},toGlsl:function(o,e){return Ht(e,1),le(e),"floor(".concat(st(o,e[0]),")")}};xt.round={getReturnType:function(o){return it.NUMBER},toGlsl:function(o,e){return Ht(e,1),le(e),"floor(".concat(st(o,e[0])," + 0.5)")}};xt.ceil={getReturnType:function(o){return it.NUMBER},toGlsl:function(o,e){return Ht(e,1),le(e),"ceil(".concat(st(o,e[0]),")")}};xt.sin={getReturnType:function(o){return it.NUMBER},toGlsl:function(o,e){return Ht(e,1),le(e),"sin(".concat(st(o,e[0]),")")}};xt.cos={getReturnType:function(o){return it.NUMBER},toGlsl:function(o,e){return Ht(e,1),le(e),"cos(".concat(st(o,e[0]),")")}};xt.atan={getReturnType:function(o){return it.NUMBER},toGlsl:function(o,e){return hi(e,1),Pa(e,2),le(e),e.length===2?"atan(".concat(st(o,e[0]),", ").concat(st(o,e[1]),")"):"atan(".concat(st(o,e[0]),")")}};xt[">"]={getReturnType:function(o){return it.BOOLEAN},toGlsl:function(o,e){return Ht(e,2),le(e),"(".concat(st(o,e[0])," > ").concat(st(o,e[1]),")")}};xt[">="]={getReturnType:function(o){return it.BOOLEAN},toGlsl:function(o,e){return Ht(e,2),le(e),"(".concat(st(o,e[0])," >= ").concat(st(o,e[1]),")")}};xt["<"]={getReturnType:function(o){return it.BOOLEAN},toGlsl:function(o,e){return Ht(e,2),le(e),"(".concat(st(o,e[0])," < ").concat(st(o,e[1]),")")}};xt["<="]={getReturnType:function(o){return it.BOOLEAN},toGlsl:function(o,e){return Ht(e,2),le(e),"(".concat(st(o,e[0])," <= ").concat(st(o,e[1]),")")}};function $p(o){return{getReturnType:function(e){return it.BOOLEAN},toGlsl:function(e,t){Ht(t,2);for(var n=it.ANY,i=0;i<t.length;i++)n&=En(t[i]);if(n===it.NONE)throw new Error("All arguments should be of compatible type, got ".concat(JSON.stringify(t)," instead"));return n&=~it.COLOR,"(".concat(st(e,t[0],n)," ").concat(o," ").concat(st(e,t[1],n),")")}}}xt["=="]=$p("==");xt["!="]=$p("!=");xt["!"]={getReturnType:function(o){return it.BOOLEAN},toGlsl:function(o,e){return Ht(e,1),Hh(e[0]),"(!".concat(st(o,e[0]),")")}};function Kp(o){return{getReturnType:function(e){return it.BOOLEAN},toGlsl:function(e,t){hi(t,2);for(var n=0;n<t.length;n++)Hh(t[n]);var i="";return i=t.map(function(a){return st(e,a)}).join(" ".concat(o," ")),i="(".concat(i,")"),i}}}xt.all=Kp("&&");xt.any=Kp("||");xt.between={getReturnType:function(o){return it.BOOLEAN},toGlsl:function(o,e){Ht(e,3),le(e);var t=st(o,e[1]),n=st(o,e[2]),i=st(o,e[0]);return"(".concat(i," >= ").concat(t," && ").concat(i," <= ").concat(n,")")}};xt.array={getReturnType:function(o){return it.NUMBER_ARRAY},toGlsl:function(o,e){hi(e,2),Pa(e,4),le(e);var t=e.map(function(n){return st(o,n,it.NUMBER)});return"vec".concat(e.length,"(").concat(t.join(", "),")")}};xt.color={getReturnType:function(o){return it.COLOR},toGlsl:function(o,e){hi(e,3),Pa(e,4),le(e);var t=e;e.length===3&&t.push(1);var n=e.map(function(i,a){return st(o,i,it.NUMBER)+(a<3?" / 255.0":"")});return"vec".concat(e.length,"(").concat(n.join(", "),")")}};xt.interpolate={getReturnType:function(o){for(var e=it.COLOR|it.NUMBER,t=3;t<o.length;t+=2)e=e&En(o[t]);return e},toGlsl:function(o,e,t){Wp(e),hi(e,6);var n=e[0],i;switch(n[0]){case"linear":i=1;break;case"exponential":i=n[1];break;default:i=null}if(!i)throw new Error('Invalid interpolation type for "interpolate" operator, received: '.concat(JSON.stringify(n)));var a=t!==void 0?t:it.ANY,u=xt.interpolate.getReturnType(e)&a;Yh(e,u);for(var p=st(o,e[1]),g=Aa(i),v="",m=2;m<e.length-2;m+=2){var E=st(o,e[m]),b=v||st(o,e[m+1],u),w=st(o,e[m+2]),S=st(o,e[m+3],u);v="mix(".concat(b,", ").concat(S,", pow(clamp((").concat(p," - ").concat(E,") / (").concat(w," - ").concat(E,"), 0.0, 1.0), ").concat(g,"))")}return v}};xt.match={getReturnType:function(o){for(var e=it.ANY,t=2;t<o.length;t+=2)e=e&En(o[t]);return e=e&En(o[o.length-1]),e},toGlsl:function(o,e,t){Wp(e),hi(e,4);var n=t!==void 0?t:it.ANY,i=xt.match.getReturnType(e)&n;Yh(e,i);for(var a=st(o,e[0]),u=st(o,e[e.length-1],i),p=null,g=e.length-3;g>=1;g-=2){var v=st(o,e[g]),m=st(o,e[g+1],i);p="(".concat(a," == ").concat(v," ? ").concat(m," : ").concat(p||u,")")}return p}};xt.case={getReturnType:function(o){for(var e=it.ANY,t=1;t<o.length;t+=2)e=e&En(o[t]);return e=e&En(o[o.length-1]),e},toGlsl:function(o,e,t){lw(e),hi(e,3);var n=t!==void 0?t:it.ANY,i=xt.case.getReturnType(e)&n;Yh(e,i);for(var a=0;a<e.length-1;a+=2)Hh(e[a]);for(var u=st(o,e[e.length-1],i),p=null,a=e.length-3;a>=0;a-=2){var g=st(o,e[a]),v=st(o,e[a+1],i);p="(".concat(g," ? ").concat(v," : ").concat(p||u,")")}return p}};var hw=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();function hd(o,e){var t=`
    attribute vec2 `.concat(Us.TEXTURE_COORD,`;
    uniform mat4 `).concat(_t.TILE_TRANSFORM,`;
    uniform float `).concat(_t.TEXTURE_PIXEL_WIDTH,`;
    uniform float `).concat(_t.TEXTURE_PIXEL_HEIGHT,`;
    uniform float `).concat(_t.TEXTURE_RESOLUTION,`;
    uniform float `).concat(_t.TEXTURE_ORIGIN_X,`;
    uniform float `).concat(_t.TEXTURE_ORIGIN_Y,`;
    uniform float `).concat(_t.DEPTH,`;

    varying vec2 v_textureCoord;
    varying vec2 v_mapCoord;

    void main() {
      v_textureCoord = `).concat(Us.TEXTURE_COORD,`;
      v_mapCoord = vec2(
        `).concat(_t.TEXTURE_ORIGIN_X," + ").concat(_t.TEXTURE_RESOLUTION," * ").concat(_t.TEXTURE_PIXEL_WIDTH,` * v_textureCoord[0],
        `).concat(_t.TEXTURE_ORIGIN_Y," - ").concat(_t.TEXTURE_RESOLUTION," * ").concat(_t.TEXTURE_PIXEL_HEIGHT,` * v_textureCoord[1]
      );
      gl_Position = `).concat(_t.TILE_TRANSFORM," * vec4(").concat(Us.TEXTURE_COORD,", ").concat(_t.DEPTH,`, 1.0);
    }
  `),n={inFragmentShader:!0,variables:[],attributes:[],stringLiteralsMap:{},functions:{},bandCount:e},i=[];if(o.color!==void 0){var a=st(n,o.color,it.COLOR);i.push("color = ".concat(a,";"))}if(o.contrast!==void 0){var u=st(n,o.contrast,it.NUMBER);i.push("color.rgb = clamp((".concat(u," + 1.0) * color.rgb - (").concat(u," / 2.0), vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));"))}if(o.exposure!==void 0){var p=st(n,o.exposure,it.NUMBER);i.push("color.rgb = clamp((".concat(p," + 1.0) * color.rgb, vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));"))}if(o.saturation!==void 0){var g=st(n,o.saturation,it.NUMBER);i.push(`
      float saturation = `.concat(g,` + 1.0;
      float sr = (1.0 - saturation) * 0.2126;
      float sg = (1.0 - saturation) * 0.7152;
      float sb = (1.0 - saturation) * 0.0722;
      mat3 saturationMatrix = mat3(
        sr + saturation, sr, sr,
        sg, sg + saturation, sg,
        sb, sb, sb + saturation
      );
      color.rgb = clamp(saturationMatrix * color.rgb, vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));
    `))}if(o.gamma!==void 0){var v=st(n,o.gamma,it.NUMBER);i.push("color.rgb = pow(color.rgb, vec3(1.0 / ".concat(v,"));"))}if(o.brightness!==void 0){var m=st(n,o.brightness,it.NUMBER);i.push("color.rgb = clamp(color.rgb + ".concat(m,", vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));"))}var E={},b=n.variables.length;if(b>1&&!o.variables)throw new Error("Missing variables in style (expected ".concat(n.variables,")"));for(var w=function(L){var k=n.variables[L];if(!(k in o.variables))throw new Error("Missing '".concat(k,"' in style variables"));var N=Hp(k);E[N]=function(){var G=o.variables[k];return typeof G=="string"&&(G=Vp(n,G)),G!==void 0?G:-9999999}},S=0;S<b;++S)w(S);var C=Object.keys(E).map(function(L){return"uniform float ".concat(L,";")}),A=Math.ceil(e/4);C.push("uniform sampler2D ".concat(_t.TILE_TEXTURE_ARRAY,"[").concat(A,"];")),n.paletteTextures&&C.push("uniform sampler2D ".concat(Yp,"[").concat(n.paletteTextures.length,"];"));var M=Object.keys(n.functions).map(function(L){return n.functions[L]}),I=`
    #ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    #else
    precision mediump float;
    #endif

    varying vec2 v_textureCoord;
    varying vec2 v_mapCoord;
    uniform vec4 `.concat(_t.RENDER_EXTENT,`;
    uniform float `).concat(_t.TRANSITION_ALPHA,`;
    uniform float `).concat(_t.TEXTURE_PIXEL_WIDTH,`;
    uniform float `).concat(_t.TEXTURE_PIXEL_HEIGHT,`;
    uniform float `).concat(_t.RESOLUTION,`;
    uniform float `).concat(_t.ZOOM,`;

    `).concat(C.join(`
`),`

    `).concat(M.join(`
`),`

    void main() {
      if (
        v_mapCoord[0] < `).concat(_t.RENDER_EXTENT,`[0] ||
        v_mapCoord[1] < `).concat(_t.RENDER_EXTENT,`[1] ||
        v_mapCoord[0] > `).concat(_t.RENDER_EXTENT,`[2] ||
        v_mapCoord[1] > `).concat(_t.RENDER_EXTENT,`[3]
      ) {
        discard;
      }

      vec4 color = texture2D(`).concat(_t.TILE_TEXTURE_ARRAY,`[0],  v_textureCoord);

      `).concat(i.join(`
`),`

      if (color.a == 0.0) {
        discard;
      }

      gl_FragColor = color;
      gl_FragColor.rgb *= gl_FragColor.a;
      gl_FragColor *= `).concat(_t.TRANSITION_ALPHA,`;
    }`);return{vertexShader:t,fragmentShader:I,uniforms:E,paletteTextures:n.paletteTextures}}var Zp=function(o){hw(e,o);function e(t){var n=this,i=t?se({},t):{},a=i.style||{};delete i.style;var u=i.cacheSize;return delete i.cacheSize,n=o.call(this,i)||this,n.sources_=i.sources,n.renderedSource_=null,n.renderedResolution_=NaN,n.style_=a,n.cacheSize_=u,n.styleVariables_=n.style_.variables||{},n.addChangeListener(Bt.SOURCE,n.handleSourceUpdate_),n}return e.prototype.getSources=function(t,n){var i=this.getSource();return this.sources_?typeof this.sources_=="function"?this.sources_(t,n):this.sources_:i?[i]:[]},e.prototype.getRenderSource=function(){return this.renderedSource_||this.getSource()},e.prototype.getSourceState=function(){var t=this.getRenderSource();return t?t.getState():Oe.UNDEFINED},e.prototype.handleSourceUpdate_=function(){this.getSource()&&this.setStyle(this.style_)},e.prototype.getSourceBandCount_=function(){var t=this.getSource();return t&&"bandCount"in t?t.bandCount:4},e.prototype.createRenderer=function(){var t=hd(this.style_,this.getSourceBandCount_());return new rw(this,{vertexShader:t.vertexShader,fragmentShader:t.fragmentShader,uniforms:t.uniforms,cacheSize:this.cacheSize_,paletteTextures:t.paletteTextures})},e.prototype.renderSources=function(t,n){for(var i=this.getRenderer(),a,u=0,p=n.length;u<p;++u)this.renderedSource_=n[u],i.prepareFrame(t)&&(a=i.renderFrame(t));return a},e.prototype.render=function(t,n){var i=this;this.rendered=!0;for(var a=t.viewState,u=this.getSources(t.extent,a.resolution),p=!0,g=function(w,S){var C=u[w],A=C.getState();if(A==Oe.LOADING){var M=function(){C.getState()==Oe.READY&&(C.removeEventListener("change",M),i.changed())};C.addEventListener("change",M)}p=p&&A==Oe.READY},v=0,m=u.length;v<m;++v)g(v);var E=this.renderSources(t,u);if(this.getRenderer().renderComplete&&p)return this.renderedResolution_=a.resolution,E;if(this.renderedResolution_>.5*a.resolution){var b=this.getSources(t.extent,this.renderedResolution_).filter(function(w){return!u.includes(w)});if(b.length>0)return this.renderSources(t,b)}return E},e.prototype.setStyle=function(t){this.styleVariables_=t.variables||{},this.style_=t;var n=hd(this.style_,this.getSourceBandCount_()),i=this.getRenderer();i.reset({vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,uniforms:n.uniforms,paletteTextures:n.paletteTextures}),this.changed()},e.prototype.updateStyleVariables=function(t){se(this.styleVariables_,t),this.changed()},e}(XT);Zp.prototype.dispose;var cw=Zp;var uw=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),fw=function(o){uw(e,o);function e(t){var n=this,i=t.projection===void 0?"EPSG:3857":t.projection,a=t.tileGrid;return a===void 0&&i&&(a=$1({extent:Gh(i),maxResolution:t.maxResolution,maxZoom:t.maxZoom,minZoom:t.minZoom,tileSize:t.tileSize})),n=o.call(this,{cacheSize:.1,attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,projection:i,tileGrid:a,opaque:t.opaque,state:t.state,tilePixelRatio:t.tilePixelRatio,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate})||this,n.tileLoadingKeys_={},n.loader_=t.loader,n.handleTileChange_=n.handleTileChange_.bind(n),n.bandCount=t.bandCount===void 0?4:t.bandCount,n}return e.prototype.setLoader=function(t){this.loader_=t},e.prototype.getTile=function(t,n,i,a,u){var p=Fh(t,n,i);if(this.tileCache.containsKey(p))return this.tileCache.get(p);var g=this.loader_;function v(){return rm(function(){return g(t,n,i)})}var m=new Gp(se({tileCoord:[t,n,i],loader:v},this.tileOptions));return m.key=this.getKey(),m.addEventListener(pt.CHANGE,this.handleTileChange_),this.tileCache.set(p,m),m},e.prototype.handleTileChange_=function(t){var n=t.target,i=Xt(n),a=n.getState(),u;a==dt.LOADING?(this.tileLoadingKeys_[i]=!0,u=Vl.TILELOADSTART):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],u=a==dt.ERROR?Vl.TILELOADERROR:a==dt.LOADED?Vl.TILELOADEND:void 0),u&&this.dispatchEvent(new q1(u,n))},e}(J1),dw=fw;function xe(o){return(e,...t)=>pw(o,e,t)}function Fr(o,e){return xe(qp(o,e).get)}const{apply:pw,construct:IR,defineProperty:AR,get:PR,getOwnPropertyDescriptor:qp,getPrototypeOf:$h,has:MR,ownKeys:gw,set:LR,setPrototypeOf:DR}=Reflect,{iterator:zo,species:kR,toStringTag:_w,for:FR}=Symbol,vw=Object,{create:Kh,defineProperty:yw,freeze:NR,is:BR}=vw,mw=Array,xw=mw.prototype,Jp=xw[zo],bw=xe(Jp),Qp=ArrayBuffer,Ew=Qp.prototype;Fr(Ew,"byteLength");const cd=typeof SharedArrayBuffer!="undefined"?SharedArrayBuffer:null;cd&&Fr(cd.prototype,"byteLength");const tg=$h(Uint8Array);tg.from;const Ie=tg.prototype;Ie[zo];xe(Ie.keys);xe(Ie.values);xe(Ie.entries);xe(Ie.set);xe(Ie.reverse);xe(Ie.fill);xe(Ie.copyWithin);xe(Ie.sort);xe(Ie.slice);xe(Ie.subarray);Fr(Ie,"buffer");Fr(Ie,"byteOffset");Fr(Ie,"length");Fr(Ie,_w);const Nr=Uint32Array,Tw=Float32Array,ua=$h([][zo]()),ww=xe(ua.next),Sw=xe(function*(){}().next),Rw=$h(ua),Cw=DataView.prototype,Ow=xe(Cw.getUint16),Zh=WeakMap,eg=Zh.prototype,ng=xe(eg.get),Iw=xe(eg.set),ig=new Zh,Aw=Kh(null,{next:{value:function(){const e=ng(ig,this);return ww(e)}},[zo]:{value:function(){return this}}});function Pw(o){if(o[zo]===Jp)return o;const e=Kh(Aw);return Iw(ig,e,bw(o)),e}const Mw=new Zh,Lw=Kh(Rw,{next:{value:function(){const e=ng(Mw,this);return Sw(e)},writable:!0,configurable:!0}});for(const o of gw(ua))o!=="next"&&yw(Lw,o,qp(ua,o));const rg=new Qp(4),Dw=new Tw(rg),kw=new Nr(rg),fn=new Nr(512),dn=new Nr(512);for(let o=0;o<256;++o){const e=o-127;e<-27?(fn[o]=0,fn[o|256]=32768,dn[o]=24,dn[o|256]=24):e<-14?(fn[o]=1024>>-e-14,fn[o|256]=1024>>-e-14|32768,dn[o]=-e-1,dn[o|256]=-e-1):e<=15?(fn[o]=e+15<<10,fn[o|256]=e+15<<10|32768,dn[o]=13,dn[o|256]=13):e<128?(fn[o]=31744,fn[o|256]=64512,dn[o]=24,dn[o|256]=24):(fn[o]=31744,fn[o|256]=64512,dn[o]=13,dn[o|256]=13)}const qh=new Nr(2048),Br=new Nr(64),og=new Nr(64);for(let o=1;o<1024;++o){let e=o<<13,t=0;for(;(e&8388608)===0;)e<<=1,t-=8388608;e&=-8388609,t+=947912704,qh[o]=e|t}for(let o=1024;o<2048;++o)qh[o]=939524096+(o-1024<<13);for(let o=1;o<31;++o)Br[o]=o<<23;Br[31]=1199570944;Br[32]=2147483648;for(let o=33;o<63;++o)Br[o]=2147483648+(o-32<<23);Br[63]=3347054592;for(let o=1;o<64;++o)o!==32&&(og[o]=1024);function Fw(o){const e=o>>10;return kw[0]=qh[og[e]+(o&1023)]+Br[e],Dw[0]}function sg(o,e,...t){return Fw(Ow(o,e,...Pw(t)))}function Nw(o,e,t){const n=t&&t.debug||!1;n&&console.log("getting "+e+" in "+o);const i=typeof o=="object"?o.outer:o,a=`${e}\\="([^"]*)"`;n&&console.log("pattern:",a);const p=new RegExp(a).exec(i);if(n&&console.log("match:",p),p)return p[1]}var ql=Nw;function Bw(o,e,t){const i=new RegExp(e).exec(o.slice(t));return i?t+i.index:-1}var Gw=Bw;const Jl=Gw;function zw(o,e,t){const n=t&&t.debug||!1,i=t&&t.startIndex||0;n&&console.log("starting findTagByName with",e," and ",t);const a=Jl(o,`<${e}[ >]`,i);if(n&&console.log("start:",a),a===-1)return;const u=o.slice(a+e.length);let p=Jl(u,"[ /]"+e+">",0);const g=p===-1;g&&(p=Jl(u,"[ /]>",0));const v=a+e.length+p+1+(g?0:e.length)+1;if(n&&console.log("end:",v),v===-1)return;const m=o.slice(a,v);let E;return g?E=null:E=m.slice(m.indexOf(">")+1,m.lastIndexOf("<")),{inner:E,outer:m,start:a,end:v}}var Uw=zw;const Vw=Uw;function Xw(o,e,t){const n=[],i=t&&t.debug||!1;let a=t&&t.startIndex||0,u;for(;u=Vw(o,e,{debug:i,startIndex:a});)a=u.end,n.push(u);return i&&console.log("findTagsByName found",n.length,"tags"),n}var jw=Xw;const So={315:"Artist",258:"BitsPerSample",265:"CellLength",264:"CellWidth",320:"ColorMap",259:"Compression",33432:"Copyright",306:"DateTime",338:"ExtraSamples",266:"FillOrder",289:"FreeByteCounts",288:"FreeOffsets",291:"GrayResponseCurve",290:"GrayResponseUnit",316:"HostComputer",270:"ImageDescription",257:"ImageLength",256:"ImageWidth",271:"Make",281:"MaxSampleValue",280:"MinSampleValue",272:"Model",254:"NewSubfileType",274:"Orientation",262:"PhotometricInterpretation",284:"PlanarConfiguration",296:"ResolutionUnit",278:"RowsPerStrip",277:"SamplesPerPixel",305:"Software",279:"StripByteCounts",273:"StripOffsets",255:"SubfileType",263:"Threshholding",282:"XResolution",283:"YResolution",326:"BadFaxLines",327:"CleanFaxData",343:"ClipPath",328:"ConsecutiveBadFaxLines",433:"Decode",434:"DefaultImageColor",269:"DocumentName",336:"DotRange",321:"HalftoneHints",346:"Indexed",347:"JPEGTables",285:"PageName",297:"PageNumber",317:"Predictor",319:"PrimaryChromaticities",532:"ReferenceBlackWhite",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",559:"StripRowCounts",330:"SubIFDs",292:"T4Options",293:"T6Options",325:"TileByteCounts",323:"TileLength",324:"TileOffsets",322:"TileWidth",301:"TransferFunction",318:"WhitePoint",344:"XClipPathUnits",286:"XPosition",529:"YCbCrCoefficients",531:"YCbCrPositioning",530:"YCbCrSubSampling",345:"YClipPathUnits",287:"YPosition",37378:"ApertureValue",40961:"ColorSpace",36868:"DateTimeDigitized",36867:"DateTimeOriginal",34665:"Exif IFD",36864:"ExifVersion",33434:"ExposureTime",41728:"FileSource",37385:"Flash",40960:"FlashpixVersion",33437:"FNumber",42016:"ImageUniqueID",37384:"LightSource",37500:"MakerNote",37377:"ShutterSpeedValue",37510:"UserComment",33723:"IPTC",34675:"ICC Profile",700:"XMP",42112:"GDAL_METADATA",42113:"GDAL_NODATA",34377:"Photoshop",33550:"ModelPixelScale",33922:"ModelTiepoint",34264:"ModelTransformation",34735:"GeoKeyDirectory",34736:"GeoDoubleParams",34737:"GeoAsciiParams",50674:"LercParameters"},pn={};for(const o in So)So.hasOwnProperty(o)&&(pn[So[o]]=parseInt(o,10));const Ww=[pn.BitsPerSample,pn.ExtraSamples,pn.SampleFormat,pn.StripByteCounts,pn.StripOffsets,pn.StripRowCounts,pn.TileByteCounts,pn.TileOffsets,pn.SubIFDs],Ql={1:"BYTE",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",6:"SBYTE",7:"UNDEFINED",8:"SSHORT",9:"SLONG",10:"SRATIONAL",11:"FLOAT",12:"DOUBLE",13:"IFD",16:"LONG8",17:"SLONG8",18:"IFD8"},yt={};for(const o in Ql)Ql.hasOwnProperty(o)&&(yt[Ql[o]]=parseInt(o,10));const Ve={WhiteIsZero:0,BlackIsZero:1,RGB:2,Palette:3,TransparencyMask:4,CMYK:5,YCbCr:6,CIELab:8,ICCLab:9},Hw={Unspecified:0,Assocalpha:1,Unassalpha:2},GR={Version:0,AddCompression:1},zR={None:0,Deflate:1},Vs={1024:"GTModelTypeGeoKey",1025:"GTRasterTypeGeoKey",1026:"GTCitationGeoKey",2048:"GeographicTypeGeoKey",2049:"GeogCitationGeoKey",2050:"GeogGeodeticDatumGeoKey",2051:"GeogPrimeMeridianGeoKey",2052:"GeogLinearUnitsGeoKey",2053:"GeogLinearUnitSizeGeoKey",2054:"GeogAngularUnitsGeoKey",2055:"GeogAngularUnitSizeGeoKey",2056:"GeogEllipsoidGeoKey",2057:"GeogSemiMajorAxisGeoKey",2058:"GeogSemiMinorAxisGeoKey",2059:"GeogInvFlatteningGeoKey",2060:"GeogAzimuthUnitsGeoKey",2061:"GeogPrimeMeridianLongGeoKey",2062:"GeogTOWGS84GeoKey",3072:"ProjectedCSTypeGeoKey",3073:"PCSCitationGeoKey",3074:"ProjectionGeoKey",3075:"ProjCoordTransGeoKey",3076:"ProjLinearUnitsGeoKey",3077:"ProjLinearUnitSizeGeoKey",3078:"ProjStdParallel1GeoKey",3079:"ProjStdParallel2GeoKey",3080:"ProjNatOriginLongGeoKey",3081:"ProjNatOriginLatGeoKey",3082:"ProjFalseEastingGeoKey",3083:"ProjFalseNorthingGeoKey",3084:"ProjFalseOriginLongGeoKey",3085:"ProjFalseOriginLatGeoKey",3086:"ProjFalseOriginEastingGeoKey",3087:"ProjFalseOriginNorthingGeoKey",3088:"ProjCenterLongGeoKey",3089:"ProjCenterLatGeoKey",3090:"ProjCenterEastingGeoKey",3091:"ProjCenterNorthingGeoKey",3092:"ProjScaleAtNatOriginGeoKey",3093:"ProjScaleAtCenterGeoKey",3094:"ProjAzimuthAngleGeoKey",3095:"ProjStraightVertPoleLongGeoKey",3096:"ProjRectifiedGridAngleGeoKey",4096:"VerticalCSTypeGeoKey",4097:"VerticalCitationGeoKey",4098:"VerticalDatumGeoKey",4099:"VerticalUnitsGeoKey"},Yw={};for(const o in Vs)Vs.hasOwnProperty(o)&&(Yw[Vs[o]]=parseInt(o,10));function $w(o,e){const{width:t,height:n}=o,i=new Uint8Array(t*n*3);let a;for(let u=0,p=0;u<o.length;++u,p+=3)a=256-o[u]/e*256,i[p]=a,i[p+1]=a,i[p+2]=a;return i}function Kw(o,e){const{width:t,height:n}=o,i=new Uint8Array(t*n*3);let a;for(let u=0,p=0;u<o.length;++u,p+=3)a=o[u]/e*256,i[p]=a,i[p+1]=a,i[p+2]=a;return i}function Zw(o,e){const{width:t,height:n}=o,i=new Uint8Array(t*n*3),a=e.length/3,u=e.length/3*2;for(let p=0,g=0;p<o.length;++p,g+=3){const v=o[p];i[g]=e[v]/65536*256,i[g+1]=e[v+a]/65536*256,i[g+2]=e[v+u]/65536*256}return i}function qw(o){const{width:e,height:t}=o,n=new Uint8Array(e*t*3);for(let i=0,a=0;i<o.length;i+=4,a+=3){const u=o[i],p=o[i+1],g=o[i+2],v=o[i+3];n[a]=255*((255-u)/256)*((255-v)/256),n[a+1]=255*((255-p)/256)*((255-v)/256),n[a+2]=255*((255-g)/256)*((255-v)/256)}return n}function Jw(o){const{width:e,height:t}=o,n=new Uint8ClampedArray(e*t*3);for(let i=0,a=0;i<o.length;i+=3,a+=3){const u=o[i],p=o[i+1],g=o[i+2];n[a]=u+1.402*(g-128),n[a+1]=u-.34414*(p-128)-.71414*(g-128),n[a+2]=u+1.772*(p-128)}return n}const Qw=.95047,tS=1,eS=1.08883;function nS(o){const{width:e,height:t}=o,n=new Uint8Array(e*t*3);for(let i=0,a=0;i<o.length;i+=3,a+=3){const u=o[i+0],p=o[i+1]<<24>>24,g=o[i+2]<<24>>24;let v=(u+16)/116,m=p/500+v,E=v-g/200,b,w,S;m=Qw*(m*m*m>.008856?m*m*m:(m-16/116)/7.787),v=tS*(v*v*v>.008856?v*v*v:(v-16/116)/7.787),E=eS*(E*E*E>.008856?E*E*E:(E-16/116)/7.787),b=m*3.2406+v*-1.5372+E*-.4986,w=m*-.9689+v*1.8758+E*.0415,S=m*.0557+v*-.204+E*1.057,b=b>.0031308?1.055*b**(1/2.4)-.055:12.92*b,w=w>.0031308?1.055*w**(1/2.4)-.055:12.92*w,S=S>.0031308?1.055*S**(1/2.4)-.055:12.92*S,n[a]=Math.max(0,Math.min(1,b))*255,n[a+1]=Math.max(0,Math.min(1,w))*255,n[a+2]=Math.max(0,Math.min(1,S))*255}return n}const ag=new Map;function ci(o,e){Array.isArray(o)||(o=[o]),o.forEach(t=>ag.set(t,e))}async function lg(o){const e=ag.get(o.Compression);if(!e)throw new Error(`Unknown compression method identifier: ${o.Compression}`);const t=await e();return new t(o)}ci([void 0,1],()=>import("./raw-ccb56981.js").then(o=>o.default));ci(5,()=>import("./lzw-05abbee1.js").then(o=>o.default));ci(6,()=>{throw new Error("old style JPEG compression is not supported.")});ci(7,()=>import("./jpeg-5aaea2f6.js").then(o=>o.default));ci([8,32946],()=>import("./deflate-ed6ab470.js").then(o=>o.default));ci(32773,()=>import("./packbits-60c5dccc.js").then(o=>o.default));ci(34887,()=>import("./lerc-43bba044.js").then(o=>o.default));ci(50001,()=>import("./webimage-a471043f.js").then(o=>o.default));function Ma(o,e,t,n=1){return new(Object.getPrototypeOf(o)).constructor(e*t*n)}function iS(o,e,t,n,i){const a=e/n,u=t/i;return o.map(p=>{const g=Ma(p,n,i);for(let v=0;v<i;++v){const m=Math.min(Math.round(u*v),t-1);for(let E=0;E<n;++E){const b=Math.min(Math.round(a*E),e-1),w=p[m*e+b];g[v*n+E]=w}}return g})}function Or(o,e,t){return(1-t)*o+t*e}function rS(o,e,t,n,i){const a=e/n,u=t/i;return o.map(p=>{const g=Ma(p,n,i);for(let v=0;v<i;++v){const m=u*v,E=Math.floor(m),b=Math.min(Math.ceil(m),t-1);for(let w=0;w<n;++w){const S=a*w,C=S%1,A=Math.floor(S),M=Math.min(Math.ceil(S),e-1),I=p[E*e+A],L=p[E*e+M],k=p[b*e+A],N=p[b*e+M],G=Or(Or(I,L,C),Or(k,N,C),m%1);g[v*n+w]=G}}return g})}function oS(o,e,t,n,i,a="nearest"){switch(a.toLowerCase()){case"nearest":return iS(o,e,t,n,i);case"bilinear":case"linear":return rS(o,e,t,n,i);default:throw new Error(`Unsupported resampling method: '${a}'`)}}function sS(o,e,t,n,i,a){const u=e/n,p=t/i,g=Ma(o,n,i,a);for(let v=0;v<i;++v){const m=Math.min(Math.round(p*v),t-1);for(let E=0;E<n;++E){const b=Math.min(Math.round(u*E),e-1);for(let w=0;w<a;++w){const S=o[m*e*a+b*a+w];g[v*n*a+E*a+w]=S}}}return g}function aS(o,e,t,n,i,a){const u=e/n,p=t/i,g=Ma(o,n,i,a);for(let v=0;v<i;++v){const m=p*v,E=Math.floor(m),b=Math.min(Math.ceil(m),t-1);for(let w=0;w<n;++w){const S=u*w,C=S%1,A=Math.floor(S),M=Math.min(Math.ceil(S),e-1);for(let I=0;I<a;++I){const L=o[E*e*a+A*a+I],k=o[E*e*a+M*a+I],N=o[b*e*a+A*a+I],G=o[b*e*a+M*a+I],z=Or(Or(L,k,C),Or(N,G,C),m%1);g[v*n*a+w*a+I]=z}}}return g}function lS(o,e,t,n,i,a,u="nearest"){switch(u.toLowerCase()){case"nearest":return sS(o,e,t,n,i,a);case"bilinear":case"linear":return aS(o,e,t,n,i,a);default:throw new Error(`Unsupported resampling method: '${u}'`)}}function hS(o,e,t){let n=0;for(let i=e;i<t;++i)n+=o[i];return n}function vh(o,e,t){switch(o){case 1:if(e<=8)return new Uint8Array(t);if(e<=16)return new Uint16Array(t);if(e<=32)return new Uint32Array(t);break;case 2:if(e===8)return new Int8Array(t);if(e===16)return new Int16Array(t);if(e===32)return new Int32Array(t);break;case 3:switch(e){case 16:case 32:return new Float32Array(t);case 64:return new Float64Array(t)}break}throw Error("Unsupported data format/bitsPerSample")}function cS(o,e){return(o===1||o===2)&&e<=32&&e%8===0?!1:!(o===3&&(e===16||e===32||e===64))}function uS(o,e,t,n,i,a,u){const p=new DataView(o),g=t===2?u*a:u*a*n,v=t===2?1:n,m=vh(e,i,g),E=parseInt("1".repeat(i),2);if(e===1){let b;t===1?b=n*i:b=i;let w=a*b;(w&7)!==0&&(w=w+7&-8);for(let S=0;S<u;++S){const C=S*w;for(let A=0;A<a;++A){const M=C+A*v*i;for(let I=0;I<v;++I){const L=M+I*i,k=(S*a+A)*v+I,N=Math.floor(L/8),G=L%8;if(G+i<=8)m[k]=p.getUint8(N)>>8-i-G&E;else if(G+i<=16)m[k]=p.getUint16(N)>>16-i-G&E;else if(G+i<=24){const z=p.getUint16(N)<<8|p.getUint8(N+2);m[k]=z>>24-i-G&E}else m[k]=p.getUint32(N)>>32-i-G&E}}}}return m.buffer}class fS{constructor(e,t,n,i,a,u){this.fileDirectory=e,this.geoKeys=t,this.dataView=n,this.littleEndian=i,this.tiles=a?{}:null,this.isTiled=!e.StripOffsets;const p=e.PlanarConfiguration;if(this.planarConfiguration=typeof p=="undefined"?1:p,this.planarConfiguration!==1&&this.planarConfiguration!==2)throw new Error("Invalid planar configuration.");this.source=u}getFileDirectory(){return this.fileDirectory}getGeoKeys(){return this.geoKeys}getWidth(){return this.fileDirectory.ImageWidth}getHeight(){return this.fileDirectory.ImageLength}getSamplesPerPixel(){return typeof this.fileDirectory.SamplesPerPixel!="undefined"?this.fileDirectory.SamplesPerPixel:1}getTileWidth(){return this.isTiled?this.fileDirectory.TileWidth:this.getWidth()}getTileHeight(){return this.isTiled?this.fileDirectory.TileLength:typeof this.fileDirectory.RowsPerStrip!="undefined"?Math.min(this.fileDirectory.RowsPerStrip,this.getHeight()):this.getHeight()}getBlockWidth(){return this.getTileWidth()}getBlockHeight(e){return this.isTiled||(e+1)*this.getTileHeight()<=this.getHeight()?this.getTileHeight():this.getHeight()-e*this.getTileHeight()}getBytesPerPixel(){let e=0;for(let t=0;t<this.fileDirectory.BitsPerSample.length;++t)e+=this.getSampleByteSize(t);return e}getSampleByteSize(e){if(e>=this.fileDirectory.BitsPerSample.length)throw new RangeError(`Sample index ${e} is out of range.`);return Math.ceil(this.fileDirectory.BitsPerSample[e]/8)}getReaderForSample(e){const t=this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[e]:1,n=this.fileDirectory.BitsPerSample[e];switch(t){case 1:if(n<=8)return DataView.prototype.getUint8;if(n<=16)return DataView.prototype.getUint16;if(n<=32)return DataView.prototype.getUint32;break;case 2:if(n<=8)return DataView.prototype.getInt8;if(n<=16)return DataView.prototype.getInt16;if(n<=32)return DataView.prototype.getInt32;break;case 3:switch(n){case 16:return function(i,a){return sg(this,i,a)};case 32:return DataView.prototype.getFloat32;case 64:return DataView.prototype.getFloat64}break}throw Error("Unsupported data format/bitsPerSample")}getSampleFormat(e=0){return this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[e]:1}getBitsPerSample(e=0){return this.fileDirectory.BitsPerSample[e]}getArrayForSample(e,t){const n=this.getSampleFormat(e),i=this.getBitsPerSample(e);return vh(n,i,t)}async getTileOrStrip(e,t,n,i,a){const u=Math.ceil(this.getWidth()/this.getTileWidth()),p=Math.ceil(this.getHeight()/this.getTileHeight());let g;const{tiles:v}=this;this.planarConfiguration===1?g=t*u+e:this.planarConfiguration===2&&(g=n*u*p+t*u+e);let m,E;this.isTiled?(m=this.fileDirectory.TileOffsets[g],E=this.fileDirectory.TileByteCounts[g]):(m=this.fileDirectory.StripOffsets[g],E=this.fileDirectory.StripByteCounts[g]);const b=(await this.source.fetch([{offset:m,length:E}],a))[0];let w;return v===null||!v[g]?(w=(async()=>{let S=await i.decode(this.fileDirectory,b);const C=this.getSampleFormat(),A=this.getBitsPerSample();return cS(C,A)&&(S=uS(S,C,this.planarConfiguration,this.getSamplesPerPixel(),A,this.getTileWidth(),this.getBlockHeight(t))),S})(),v!==null&&(v[g]=w)):w=v[g],{x:e,y:t,sample:n,data:await w}}async _readRaster(e,t,n,i,a,u,p,g,v){const m=this.getTileWidth(),E=this.getTileHeight(),b=this.getWidth(),w=this.getHeight(),S=Math.max(Math.floor(e[0]/m),0),C=Math.min(Math.ceil(e[2]/m),Math.ceil(b/m)),A=Math.max(Math.floor(e[1]/E),0),M=Math.min(Math.ceil(e[3]/E),Math.ceil(w/E)),I=e[2]-e[0];let L=this.getBytesPerPixel();const k=[],N=[];for(let V=0;V<t.length;++V)this.planarConfiguration===1?k.push(hS(this.fileDirectory.BitsPerSample,0,t[V])/8):k.push(0),N.push(this.getReaderForSample(t[V]));const G=[],{littleEndian:z}=this;for(let V=A;V<M;++V)for(let Y=S;Y<C;++Y)for(let X=0;X<t.length;++X){const J=X,q=t[X];this.planarConfiguration===2&&(L=this.getSampleByteSize(X));const K=this.getTileOrStrip(Y,V,q,a,v).then(Q=>{const tt=Q.data,nt=new DataView(tt),ot=this.getBlockHeight(Q.y),at=Q.y*E,ht=Q.x*m,ut=at+ot,Rt=(Q.x+1)*m,W=N[J],Yt=Math.min(ot,ot-(ut-e[3]),w-at),Ut=Math.min(m,m-(Rt-e[2]),b-ht);for(let Jt=Math.max(0,e[1]-at);Jt<Yt;++Jt)for(let ne=Math.max(0,e[0]-ht);ne<Ut;++ne){const ze=(Jt*m+ne)*L,ie=W.call(nt,ze+k[J],z);let ue;i?(ue=(Jt+at-e[1])*I*t.length+(ne+ht-e[0])*t.length+J,n[ue]=ie):(ue=(Jt+at-e[1])*I+ne+ht-e[0],n[J][ue]=ie)}});G.push(K)}if(await Promise.all(G),u&&e[2]-e[0]!==u||p&&e[3]-e[1]!==p){let V;return i?V=lS(n,e[2]-e[0],e[3]-e[1],u,p,t.length,g):V=oS(n,e[2]-e[0],e[3]-e[1],u,p,g),V.width=u,V.height=p,V}return n.width=u||e[2]-e[0],n.height=p||e[3]-e[1],n}async readRasters({window:e,samples:t=[],interleave:n,pool:i=null,width:a,height:u,resampleMethod:p,fillValue:g,signal:v}={}){const m=e||[0,0,this.getWidth(),this.getHeight()];if(m[0]>m[2]||m[1]>m[3])throw new Error("Invalid subsets");const E=m[2]-m[0],b=m[3]-m[1],w=E*b,S=this.getSamplesPerPixel();if(!t||!t.length)for(let I=0;I<S;++I)t.push(I);else for(let I=0;I<t.length;++I)if(t[I]>=S)return Promise.reject(new RangeError(`Invalid sample index '${t[I]}'.`));let C;if(n){const I=this.fileDirectory.SampleFormat?Math.max.apply(null,this.fileDirectory.SampleFormat):1,L=Math.max.apply(null,this.fileDirectory.BitsPerSample);C=vh(I,L,w*t.length),g&&C.fill(g)}else{C=[];for(let I=0;I<t.length;++I){const L=this.getArrayForSample(t[I],w);Array.isArray(g)&&I<g.length?L.fill(g[I]):g&&!Array.isArray(g)&&L.fill(g),C.push(L)}}const A=i||await lg(this.fileDirectory);return await this._readRaster(m,t,C,n,A,a,u,p,v)}async readRGB({window:e,interleave:t=!0,pool:n=null,width:i,height:a,resampleMethod:u,enableAlpha:p=!1,signal:g}={}){const v=e||[0,0,this.getWidth(),this.getHeight()];if(v[0]>v[2]||v[1]>v[3])throw new Error("Invalid subsets");const m=this.fileDirectory.PhotometricInterpretation;if(m===Ve.RGB){let M=[0,1,2];if(this.fileDirectory.ExtraSamples!==Hw.Unspecified&&p){M=[];for(let I=0;I<this.fileDirectory.BitsPerSample.length;I+=1)M.push(I)}return this.readRasters({window:e,interleave:t,samples:M,pool:n,width:i,height:a,resampleMethod:u,signal:g})}let E;switch(m){case Ve.WhiteIsZero:case Ve.BlackIsZero:case Ve.Palette:E=[0];break;case Ve.CMYK:E=[0,1,2,3];break;case Ve.YCbCr:case Ve.CIELab:E=[0,1,2];break;default:throw new Error("Invalid or unsupported photometric interpretation.")}const b={window:v,interleave:!0,samples:E,pool:n,width:i,height:a,resampleMethod:u,signal:g},{fileDirectory:w}=this,S=await this.readRasters(b),C=2**this.fileDirectory.BitsPerSample[0];let A;switch(m){case Ve.WhiteIsZero:A=$w(S,C);break;case Ve.BlackIsZero:A=Kw(S,C);break;case Ve.Palette:A=Zw(S,w.ColorMap);break;case Ve.CMYK:A=qw(S);break;case Ve.YCbCr:A=Jw(S);break;case Ve.CIELab:A=nS(S);break;default:throw new Error("Unsupported photometric interpretation.")}if(!t){const M=new Uint8Array(A.length/3),I=new Uint8Array(A.length/3),L=new Uint8Array(A.length/3);for(let k=0,N=0;k<A.length;k+=3,++N)M[N]=A[k],I[N]=A[k+1],L[N]=A[k+2];A=[M,I,L]}return A.width=S.width,A.height=S.height,A}getTiePoints(){if(!this.fileDirectory.ModelTiepoint)return[];const e=[];for(let t=0;t<this.fileDirectory.ModelTiepoint.length;t+=6)e.push({i:this.fileDirectory.ModelTiepoint[t],j:this.fileDirectory.ModelTiepoint[t+1],k:this.fileDirectory.ModelTiepoint[t+2],x:this.fileDirectory.ModelTiepoint[t+3],y:this.fileDirectory.ModelTiepoint[t+4],z:this.fileDirectory.ModelTiepoint[t+5]});return e}getGDALMetadata(e=null){const t={};if(!this.fileDirectory.GDAL_METADATA)return null;const n=this.fileDirectory.GDAL_METADATA;let i=jw(n,"Item");e===null?i=i.filter(a=>ql(a,"sample")===void 0):i=i.filter(a=>Number(ql(a,"sample"))===e);for(let a=0;a<i.length;++a){const u=i[a];t[ql(u,"name")]=u.inner}return t}getGDALNoData(){if(!this.fileDirectory.GDAL_NODATA)return null;const e=this.fileDirectory.GDAL_NODATA;return Number(e.substring(0,e.length-1))}getOrigin(){const e=this.fileDirectory.ModelTiepoint,t=this.fileDirectory.ModelTransformation;if(e&&e.length===6)return[e[3],e[4],e[5]];if(t)return[t[3],t[7],t[11]];throw new Error("The image does not have an affine transformation.")}getResolution(e=null){const t=this.fileDirectory.ModelPixelScale,n=this.fileDirectory.ModelTransformation;if(t)return[t[0],-t[1],t[2]];if(n)return[n[0],n[5],n[10]];if(e){const[i,a,u]=e.getResolution();return[i*e.getWidth()/this.getWidth(),a*e.getHeight()/this.getHeight(),u*e.getWidth()/this.getWidth()]}throw new Error("The image does not have an affine transformation.")}pixelIsArea(){return this.geoKeys.GTRasterTypeGeoKey===1}getBoundingBox(){const e=this.getOrigin(),t=this.getResolution(),n=e[0],i=e[1],a=n+t[0]*this.getWidth(),u=i+t[1]*this.getHeight();return[Math.min(n,a),Math.min(i,u),Math.max(n,a),Math.max(i,u)]}}var hg=fS;class dS{constructor(e){this._dataView=new DataView(e)}get buffer(){return this._dataView.buffer}getUint64(e,t){const n=this.getUint32(e,t),i=this.getUint32(e+4,t);let a;if(t){if(a=n+2**32*i,!Number.isSafeInteger(a))throw new Error(`${a} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return a}if(a=2**32*n+i,!Number.isSafeInteger(a))throw new Error(`${a} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return a}getInt64(e,t){let n=0;const i=(this._dataView.getUint8(e+(t?7:0))&128)>0;let a=!0;for(let u=0;u<8;u++){let p=this._dataView.getUint8(e+(t?u:7-u));i&&(a?p!==0&&(p=~(p-1)&255,a=!1):p=~p&255),n+=p*256**u}return i&&(n=-n),n}getUint8(e,t){return this._dataView.getUint8(e,t)}getInt8(e,t){return this._dataView.getInt8(e,t)}getUint16(e,t){return this._dataView.getUint16(e,t)}getInt16(e,t){return this._dataView.getInt16(e,t)}getUint32(e,t){return this._dataView.getUint32(e,t)}getInt32(e,t){return this._dataView.getInt32(e,t)}getFloat16(e,t){return sg(this._dataView,e,t)}getFloat32(e,t){return this._dataView.getFloat32(e,t)}getFloat64(e,t){return this._dataView.getFloat64(e,t)}}class pS{constructor(e,t,n,i){this._dataView=new DataView(e),this._sliceOffset=t,this._littleEndian=n,this._bigTiff=i}get sliceOffset(){return this._sliceOffset}get sliceTop(){return this._sliceOffset+this.buffer.byteLength}get littleEndian(){return this._littleEndian}get bigTiff(){return this._bigTiff}get buffer(){return this._dataView.buffer}covers(e,t){return this.sliceOffset<=e&&this.sliceTop>=e+t}readUint8(e){return this._dataView.getUint8(e-this._sliceOffset,this._littleEndian)}readInt8(e){return this._dataView.getInt8(e-this._sliceOffset,this._littleEndian)}readUint16(e){return this._dataView.getUint16(e-this._sliceOffset,this._littleEndian)}readInt16(e){return this._dataView.getInt16(e-this._sliceOffset,this._littleEndian)}readUint32(e){return this._dataView.getUint32(e-this._sliceOffset,this._littleEndian)}readInt32(e){return this._dataView.getInt32(e-this._sliceOffset,this._littleEndian)}readFloat32(e){return this._dataView.getFloat32(e-this._sliceOffset,this._littleEndian)}readFloat64(e){return this._dataView.getFloat64(e-this._sliceOffset,this._littleEndian)}readUint64(e){const t=this.readUint32(e),n=this.readUint32(e+4);let i;if(this._littleEndian){if(i=t+2**32*n,!Number.isSafeInteger(i))throw new Error(`${i} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return i}if(i=2**32*t+n,!Number.isSafeInteger(i))throw new Error(`${i} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return i}readInt64(e){let t=0;const n=(this._dataView.getUint8(e+(this._littleEndian?7:0))&128)>0;let i=!0;for(let a=0;a<8;a++){let u=this._dataView.getUint8(e+(this._littleEndian?a:7-a));n&&(i?u!==0&&(u=~(u-1)&255,i=!1):u=~u&255),t+=u*256**a}return n&&(t=-t),t}readOffset(e){return this._bigTiff?this.readUint64(e):this.readUint32(e)}}const gS=typeof navigator!="undefined"&&navigator.hardwareConcurrency||2;class _S{constructor(e=gS,t){this.workers=null,this._awaitingDecoder=null,this.size=e,this.messageId=0,e&&(this._awaitingDecoder=t?Promise.resolve(t):new Promise(n=>{import("./decoder-0d3742f1.js").then(i=>{n(i.create)})}),this._awaitingDecoder.then(n=>{this._awaitingDecoder=null,this.workers=[];for(let i=0;i<e;i++)this.workers.push({worker:n(),idle:!0})}))}async decode(e,t){return this._awaitingDecoder&&await this._awaitingDecoder,this.size===0?lg(e).then(n=>n.decode(e,t)):new Promise(n=>{const i=this.workers.find(p=>p.idle)||this.workers[Math.floor(Math.random()*this.size)];i.idle=!1;const a=this.messageId++,u=p=>{p.data.id===a&&(i.idle=!0,n(p.data.decoded),i.worker.removeEventListener("message",u))};i.worker.addEventListener("message",u),i.worker.postMessage({fileDirectory:e,buffer:t,id:a},[t])})}destroy(){this.workers&&(this.workers.forEach(e=>{e.worker.terminate()}),this.workers=null)}}var vS=_S;const ud=`\r
\r
`;function cg(o){if(typeof Object.fromEntries!="undefined")return Object.fromEntries(o);const e={};for(const[t,n]of o)e[t.toLowerCase()]=n;return e}function yS(o){const e=o.split(`\r
`).map(t=>{const n=t.split(":").map(i=>i.trim());return n[0]=n[0].toLowerCase(),n});return cg(e)}function mS(o){const[e,...t]=o.split(";").map(i=>i.trim()),n=t.map(i=>i.split("="));return{type:e,params:cg(n)}}function yh(o){let e,t,n;return o&&([,e,t,n]=o.match(/bytes (\d+)-(\d+)\/(\d+)/),e=parseInt(e,10),t=parseInt(t,10),n=parseInt(n,10)),{start:e,end:t,total:n}}function xS(o,e){let t=null;const n=new TextDecoder("ascii"),i=[],a=`--${e}`,u=`${a}--`;for(let p=0;p<10;++p)n.decode(new Uint8Array(o,p,a.length))===a&&(t=p);if(t===null)throw new Error("Could not find initial boundary");for(;t<o.byteLength;){const p=n.decode(new Uint8Array(o,t,Math.min(a.length+1024,o.byteLength-t)));if(p.length===0||p.startsWith(u))break;if(!p.startsWith(a))throw new Error("Part does not start with boundary");const g=p.substr(a.length+2);if(g.length===0)break;const v=g.indexOf(ud),m=yS(g.substr(0,v)),{start:E,end:b,total:w}=yh(m["content-range"]),S=t+a.length+v+ud.length,C=parseInt(b,10)+1-parseInt(E,10);i.push({headers:m,data:o.slice(S,S+C),offset:E,length:C,fileSize:w}),t=S+C+4}return i}class ug{async fetch(e,t=void 0){return Promise.all(e.map(n=>this.fetchSlice(n,t)))}async fetchSlice(e){throw new Error(`fetching of slice ${e} not possible, not implemented`)}get fileSize(){return null}async close(){}}class bS extends Map{constructor(e={}){super();if(!(e.maxSize&&e.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");if(typeof e.maxAge=="number"&&e.maxAge===0)throw new TypeError("`maxAge` must be a number greater than 0");this.maxSize=e.maxSize,this.maxAge=e.maxAge||Number.POSITIVE_INFINITY,this.onEviction=e.onEviction,this.cache=new Map,this.oldCache=new Map,this._size=0}_emitEvictions(e){if(typeof this.onEviction=="function")for(const[t,n]of e)this.onEviction(t,n.value)}_deleteIfExpired(e,t){return typeof t.expiry=="number"&&t.expiry<=Date.now()?(typeof this.onEviction=="function"&&this.onEviction(e,t.value),this.delete(e)):!1}_getOrDeleteIfExpired(e,t){if(this._deleteIfExpired(e,t)===!1)return t.value}_getItemValue(e,t){return t.expiry?this._getOrDeleteIfExpired(e,t):t.value}_peek(e,t){const n=t.get(e);return this._getItemValue(e,n)}_set(e,t){this.cache.set(e,t),this._size++,this._size>=this.maxSize&&(this._size=0,this._emitEvictions(this.oldCache),this.oldCache=this.cache,this.cache=new Map)}_moveToRecent(e,t){this.oldCache.delete(e),this._set(e,t)}*_entriesAscending(){for(const e of this.oldCache){const[t,n]=e;this.cache.has(t)||this._deleteIfExpired(t,n)===!1&&(yield e)}for(const e of this.cache){const[t,n]=e;this._deleteIfExpired(t,n)===!1&&(yield e)}}get(e){if(this.cache.has(e)){const t=this.cache.get(e);return this._getItemValue(e,t)}if(this.oldCache.has(e)){const t=this.oldCache.get(e);if(this._deleteIfExpired(e,t)===!1)return this._moveToRecent(e,t),t.value}}set(e,t,{maxAge:n=this.maxAge}={}){const i=typeof n=="number"&&n!==Number.POSITIVE_INFINITY?Date.now()+n:void 0;this.cache.has(e)?this.cache.set(e,{value:t,expiry:i}):this._set(e,{value:t,expiry:i})}has(e){return this.cache.has(e)?!this._deleteIfExpired(e,this.cache.get(e)):this.oldCache.has(e)?!this._deleteIfExpired(e,this.oldCache.get(e)):!1}peek(e){if(this.cache.has(e))return this._peek(e,this.cache);if(this.oldCache.has(e))return this._peek(e,this.oldCache)}delete(e){const t=this.cache.delete(e);return t&&this._size--,this.oldCache.delete(e)||t}clear(){this.cache.clear(),this.oldCache.clear(),this._size=0}resize(e){if(!(e&&e>0))throw new TypeError("`maxSize` must be a number greater than 0");const t=[...this._entriesAscending()],n=t.length-e;n<0?(this.cache=new Map(t),this.oldCache=new Map,this._size=t.length):(n>0&&this._emitEvictions(t.slice(0,n)),this.oldCache=new Map(t.slice(n)),this.cache=new Map,this._size=0),this.maxSize=e}*keys(){for(const[e]of this)yield e}*values(){for(const[,e]of this)yield e}*[Symbol.iterator](){for(const e of this.cache){const[t,n]=e;this._deleteIfExpired(t,n)===!1&&(yield[t,n.value])}for(const e of this.oldCache){const[t,n]=e;this.cache.has(t)||this._deleteIfExpired(t,n)===!1&&(yield[t,n.value])}}*entriesDescending(){let e=[...this.cache];for(let t=e.length-1;t>=0;--t){const n=e[t],[i,a]=n;this._deleteIfExpired(i,a)===!1&&(yield[i,a.value])}e=[...this.oldCache];for(let t=e.length-1;t>=0;--t){const n=e[t],[i,a]=n;this.cache.has(i)||this._deleteIfExpired(i,a)===!1&&(yield[i,a.value])}}*entriesAscending(){for(const[e,t]of this._entriesAscending())yield[e,t.value]}get size(){if(!this._size)return this.oldCache.size;let e=0;for(const t of this.oldCache.keys())this.cache.has(t)||e++;return Math.min(this._size+e,this.maxSize)}entries(){return this.entriesAscending()}forEach(e,t=this){for(const[n,i]of this.entriesAscending())e.call(t,i,n,this)}get[Symbol.toStringTag](){return JSON.stringify([...this.entriesAscending()])}}async function ES(o){return new Promise(e=>setTimeout(e,o))}function TS(o,e){const t=Array.isArray(o)?o:Array.from(o),n=Array.isArray(e)?e:Array.from(e);return t.map((i,a)=>[i,n[a]])}class Mr extends Error{constructor(e){super(e);Error.captureStackTrace&&Error.captureStackTrace(this,Mr),this.name="AbortError"}}class wS extends Error{constructor(e,t){super(t);this.errors=e,this.message=t,this.name="AggregateError"}}const SS=wS;class RS{constructor(e,t,n=null){this.offset=e,this.length=t,this.data=n}get top(){return this.offset+this.length}}class fd{constructor(e,t,n){this.offset=e,this.length=t,this.blockIds=n}}class CS extends ug{constructor(e,{blockSize:t=65536,cacheSize:n=100}={}){super();this.source=e,this.blockSize=t,this.blockCache=new bS({maxSize:n}),this.blockRequests=new Map,this.blockIdsToFetch=new Set,this.abortedBlockIds=new Set}get fileSize(){return this.source.fileSize}async fetch(e,t){const n=[],i=[],a=[];for(const{offset:b,length:w}of e){let S=b+w;const{fileSize:C}=this;C!==null&&(S=Math.min(S,C));const A=Math.floor(b/this.blockSize)*this.blockSize;for(let M=A;M<S;M+=this.blockSize){const I=Math.floor(M/this.blockSize);!this.blockCache.has(I)&&!this.blockRequests.has(I)&&(this.blockIdsToFetch.add(I),i.push(I)),this.blockRequests.has(I)&&n.push(this.blockRequests.get(I)),a.push(I)}}await ES(),this.fetchBlocks(t);const u=[];for(const b of i)this.blockRequests.has(b)&&u.push(this.blockRequests.get(b));await Promise.allSettled(n),await Promise.allSettled(u);const p=[],g=a.filter(b=>this.abortedBlockIds.has(b)||!this.blockCache.has(b));if(g.forEach(b=>this.blockIdsToFetch.add(b)),g.length>0&&t&&!t.aborted){this.fetchBlocks(null);for(const b of g){const w=this.blockRequests.get(b);if(!w)throw new Error(`Block ${b} is not in the block requests`);p.push(w)}await Promise.allSettled(p)}if(t&&t.aborted)throw new Mr("Request was aborted");const v=a.map(b=>this.blockCache.get(b)),m=v.filter(b=>!b);if(m.length)throw new SS(m,"Request failed");const E=new Map(TS(a,v));return this.readSliceData(e,E)}fetchBlocks(e){if(this.blockIdsToFetch.size>0){const t=this.groupBlocks(this.blockIdsToFetch),n=this.source.fetch(t,e);for(let i=0;i<t.length;++i){const a=t[i];for(const u of a.blockIds)this.blockRequests.set(u,(async()=>{try{const p=(await n)[i],g=u*this.blockSize,v=g-p.offset,m=Math.min(v+this.blockSize,p.data.byteLength),E=p.data.slice(v,m),b=new RS(g,E.byteLength,E,u);this.blockCache.set(u,b),this.abortedBlockIds.delete(u)}catch(p){if(p.name==="AbortError")p.signal=e,this.blockCache.delete(u),this.abortedBlockIds.add(u);else throw p}finally{this.blockRequests.delete(u)}})())}this.blockIdsToFetch.clear()}}groupBlocks(e){const t=Array.from(e).sort((u,p)=>u-p);if(t.length===0)return[];let n=[],i=null;const a=[];for(const u of t)i===null||i+1===u?(n.push(u),i=u):(a.push(new fd(n[0]*this.blockSize,n.length*this.blockSize,n)),n=[u],i=u);return a.push(new fd(n[0]*this.blockSize,n.length*this.blockSize,n)),a}readSliceData(e,t){return e.map(n=>{let i=n.offset+n.length;this.fileSize!==null&&(i=Math.min(this.fileSize,i));const a=Math.floor(n.offset/this.blockSize),u=Math.floor(i/this.blockSize),p=new ArrayBuffer(n.length),g=new Uint8Array(p);for(let v=a;v<=u;++v){const m=t.get(v),E=m.offset-n.offset,b=m.top-i;let w=0,S=0,C;E<0?w=-E:E>0&&(S=E),b<0?C=m.length-w:C=i-m.offset-w;const A=new Uint8Array(m.data,w,C);g.set(A,S)}return p})}}class Jh{get ok(){return this.status>=200&&this.status<=299}get status(){throw new Error("not implemented")}getHeader(e){throw new Error("not implemented")}async getData(){throw new Error("not implemented")}}class Qh{constructor(e){this.url=e}async request({headers:e,credentials:t,signal:n}={}){throw new Error("request is not implemented")}}class OS extends Jh{constructor(e){super();this.response=e}get status(){return this.response.status}getHeader(e){return this.response.headers.get(e)}async getData(){return this.response.arrayBuffer?await this.response.arrayBuffer():(await this.response.buffer()).buffer}}class IS extends Qh{constructor(e,t){super(e);this.credentials=t}async request({headers:e,credentials:t,signal:n}={}){const i=await fetch(this.url,{headers:e,credentials:t,signal:n});return new OS(i)}}class AS extends Jh{constructor(e,t){super();this.xhr=e,this.data=t}get status(){return this.xhr.status}getHeader(e){return this.xhr.getResponseHeader(e)}async getData(){return this.data}}class PS extends Qh{constructRequest(e,t){return new Promise((n,i)=>{const a=new XMLHttpRequest;a.open("GET",this.url),a.responseType="arraybuffer";for(const[u,p]of Object.entries(e))a.setRequestHeader(u,p);a.onload=()=>{const u=a.response;n(new AS(a,u))},a.onerror=i,a.onabort=()=>i(new Mr("Request aborted")),a.send(),t&&(t.aborted&&a.abort(),t.addEventListener("abort",()=>a.abort()))})}async request({headers:e,signal:t}={}){return await this.constructRequest(e,t)}}var th={};class MS extends Jh{constructor(e,t){super();this.response=e,this.dataPromise=t}get status(){return this.response.statusCode}getHeader(e){return this.response.headers[e]}async getData(){return await this.dataPromise}}class LS extends Qh{constructor(e){super(e);this.parsedUrl=th.parse(this.url),this.httpApi=(this.parsedUrl.protocol==="http:",th)}constructRequest(e,t){return new Promise((n,i)=>{const a=this.httpApi.get(qn(On({},this.parsedUrl),{headers:e}),u=>{const p=new Promise(g=>{const v=[];u.on("data",m=>{v.push(m)}),u.on("end",()=>{const m=Buffer.concat(v).buffer;g(m)}),u.on("error",i)});n(new MS(u,p))});a.on("error",i),t&&(t.aborted&&a.destroy(new Mr("Request aborted")),t.addEventListener("abort",()=>a.destroy(new Mr("Request aborted"))))})}async request({headers:e,signal:t}={}){return await this.constructRequest(e,t)}}class tc extends ug{constructor(e,t,n,i){super();this.client=e,this.headers=t,this.maxRanges=n,this.allowFullFile=i,this._fileSize=null}async fetch(e,t){return this.maxRanges>=e.length?this.fetchSlices(e,t):(this.maxRanges>0&&e.length>1,Promise.all(e.map(n=>this.fetchSlice(n,t))))}async fetchSlices(e,t){const n=await this.client.request({headers:qn(On({},this.headers),{Range:`bytes=${e.map(({offset:i,length:a})=>`${i}-${i+a}`).join(",")}`}),signal:t});if(n.ok)if(n.status===206){const{type:i,params:a}=mS(n.getHeader("content-type"));if(i==="multipart/byteranges"){const E=xS(await n.getData(),a.boundary);return this._fileSize=E[0].fileSize||null,E}const u=await n.getData(),{start:p,end:g,total:v}=yh(n.getHeader("content-range"));this._fileSize=v||null;const m=[{data:u,offset:p,length:g-p}];if(e.length>1){const E=await Promise.all(e.slice(1).map(b=>this.fetchSlice(b,t)));return m.concat(E)}return m}else{if(!this.allowFullFile)throw new Error("Server responded with full file");const i=await n.getData();return this._fileSize=i.byteLength,[{data:i,offset:0,length:i.byteLength}]}else throw new Error("Error fetching data.")}async fetchSlice(e,t){const{offset:n,length:i}=e,a=await this.client.request({headers:qn(On({},this.headers),{Range:`bytes=${n}-${n+i}`}),signal:t});if(a.ok)if(a.status===206){const u=await a.getData(),{total:p}=yh(a.getHeader("content-range"));return this._fileSize=p||null,{data:u,offset:n,length:i}}else{if(!this.allowFullFile)throw new Error("Server responded with full file");const u=await a.getData();return this._fileSize=u.byteLength,{data:u,offset:0,length:u.byteLength}}else throw new Error("Error fetching data.")}get fileSize(){return this._fileSize}}function ec(o,{blockSize:e,cacheSize:t}){return e===null?o:new CS(o,{blockSize:e,cacheSize:t})}function DS(o,u={}){var p=u,{headers:e={},credentials:t,maxRanges:n=0,allowFullFile:i=!1}=p,a=co(p,["headers","credentials","maxRanges","allowFullFile"]);const g=new IS(o,t),v=new tc(g,e,n,i);return ec(v,a)}function kS(o,a={}){var u=a,{headers:e={},maxRanges:t=0,allowFullFile:n=!1}=u,i=co(u,["headers","maxRanges","allowFullFile"]);const p=new PS(o),g=new tc(p,e,t,n);return ec(g,i)}function FS(o,a={}){var u=a,{headers:e={},maxRanges:t=0,allowFullFile:n=!1}=u,i=co(u,["headers","maxRanges","allowFullFile"]);const p=new LS(o),g=new tc(p,e,t,n);return ec(g,i)}function mh(o,n={}){var i=n,{forceXHR:e=!1}=i,t=co(i,["forceXHR"]);return typeof fetch=="function"&&!e?DS(o,t):typeof XMLHttpRequest!="undefined"?kS(o,t):FS(o,t)}function xh(o){switch(o){case yt.BYTE:case yt.ASCII:case yt.SBYTE:case yt.UNDEFINED:return 1;case yt.SHORT:case yt.SSHORT:return 2;case yt.LONG:case yt.SLONG:case yt.FLOAT:case yt.IFD:return 4;case yt.RATIONAL:case yt.SRATIONAL:case yt.DOUBLE:case yt.LONG8:case yt.SLONG8:case yt.IFD8:return 8;default:throw new RangeError(`Invalid field type: ${o}`)}}function NS(o){const e=o.GeoKeyDirectory;if(!e)return null;const t={};for(let n=4;n<=e[3]*4;n+=4){const i=Vs[e[n]],a=e[n+1]?So[e[n+1]]:null,u=e[n+2],p=e[n+3];let g=null;if(!a)g=p;else{if(g=o[a],typeof g=="undefined"||g===null)throw new Error(`Could not get value of geoKey '${i}'.`);typeof g=="string"?g=g.substring(p,p+u-1):g.subarray&&(g=g.subarray(p,p+u),u===1&&(g=g[0]))}t[i]=g}return t}function dr(o,e,t,n){let i=null,a=null;const u=xh(e);switch(e){case yt.BYTE:case yt.ASCII:case yt.UNDEFINED:i=new Uint8Array(t),a=o.readUint8;break;case yt.SBYTE:i=new Int8Array(t),a=o.readInt8;break;case yt.SHORT:i=new Uint16Array(t),a=o.readUint16;break;case yt.SSHORT:i=new Int16Array(t),a=o.readInt16;break;case yt.LONG:case yt.IFD:i=new Uint32Array(t),a=o.readUint32;break;case yt.SLONG:i=new Int32Array(t),a=o.readInt32;break;case yt.LONG8:case yt.IFD8:i=new Array(t),a=o.readUint64;break;case yt.SLONG8:i=new Array(t),a=o.readInt64;break;case yt.RATIONAL:i=new Uint32Array(t*2),a=o.readUint32;break;case yt.SRATIONAL:i=new Int32Array(t*2),a=o.readInt32;break;case yt.FLOAT:i=new Float32Array(t),a=o.readFloat32;break;case yt.DOUBLE:i=new Float64Array(t),a=o.readFloat64;break;default:throw new RangeError(`Invalid field type: ${e}`)}if(e===yt.RATIONAL||e===yt.SRATIONAL)for(let p=0;p<t;p+=2)i[p]=a.call(o,n+p*u),i[p+1]=a.call(o,n+(p*u+4));else for(let p=0;p<t;++p)i[p]=a.call(o,n+p*u);return e===yt.ASCII?new TextDecoder("utf-8").decode(i):i}class BS{constructor(e,t,n){this.fileDirectory=e,this.geoKeyDirectory=t,this.nextIFDByteOffset=n}}class Ds extends Error{constructor(e){super(`No image at index ${e}`);this.index=e}}class fg{async readRasters(e={}){const{window:t,width:n,height:i}=e;let{resX:a,resY:u,bbox:p}=e;const g=await this.getImage();let v=g;const m=await this.getImageCount(),E=g.getBoundingBox();if(t&&p)throw new Error('Both "bbox" and "window" passed.');if(n||i){if(t){const[S,C]=g.getOrigin(),[A,M]=g.getResolution();p=[S+t[0]*A,C+t[1]*M,S+t[2]*A,C+t[3]*M]}const w=p||E;if(n){if(a)throw new Error("Both width and resX passed");a=(w[2]-w[0])/n}if(i){if(u)throw new Error("Both width and resY passed");u=(w[3]-w[1])/i}}if(a||u){const w=[];for(let S=0;S<m;++S){const C=await this.getImage(S),{SubfileType:A,NewSubfileType:M}=C.fileDirectory;(S===0||A===2||M&1)&&w.push(C)}w.sort((S,C)=>S.getWidth()-C.getWidth());for(let S=0;S<w.length;++S){const C=w[S],A=(E[2]-E[0])/C.getWidth(),M=(E[3]-E[1])/C.getHeight();if(v=C,a&&a>A||u&&u>M)break}}let b=t;if(p){const[w,S]=g.getOrigin(),[C,A]=v.getResolution(g);b=[Math.round((p[0]-w)/C),Math.round((p[1]-S)/A),Math.round((p[2]-w)/C),Math.round((p[3]-S)/A)],b=[Math.min(b[0],b[2]),Math.min(b[1],b[3]),Math.max(b[0],b[2]),Math.max(b[1],b[3])]}return v.readRasters(qn(On({},e),{window:b}))}}class Do extends fg{constructor(e,t,n,i,a={}){super();this.source=e,this.littleEndian=t,this.bigTiff=n,this.firstIFDOffset=i,this.cache=a.cache||!1,this.ifdRequests=[],this.ghostValues=null}async getSlice(e,t){const n=this.bigTiff?4048:1024;return new pS((await this.source.fetch([{offset:e,length:typeof t!="undefined"?t:n}]))[0],e,this.littleEndian,this.bigTiff)}async parseFileDirectoryAt(e){const t=this.bigTiff?20:12,n=this.bigTiff?8:2;let i=await this.getSlice(e);const a=this.bigTiff?i.readUint64(e):i.readUint16(e),u=a*t+(this.bigTiff?16:6);i.covers(e,u)||(i=await this.getSlice(e,u));const p={};let g=e+(this.bigTiff?8:2);for(let E=0;E<a;g+=t,++E){const b=i.readUint16(g),w=i.readUint16(g+2),S=this.bigTiff?i.readUint64(g+4):i.readUint32(g+4);let C,A;const M=xh(w),I=g+(this.bigTiff?12:8);if(M*S<=(this.bigTiff?8:4))C=dr(i,w,S,I);else{const L=i.readOffset(I),k=xh(w)*S;if(i.covers(L,k))C=dr(i,w,S,L);else{const N=await this.getSlice(L,k);C=dr(N,w,S,L)}}S===1&&Ww.indexOf(b)===-1&&!(w===yt.RATIONAL||w===yt.SRATIONAL)?A=C[0]:A=C,p[So[b]]=A}const v=NS(p),m=i.readOffset(e+n+t*a);return new BS(p,v,m)}async requestIFD(e){if(this.ifdRequests[e])return this.ifdRequests[e];if(e===0)return this.ifdRequests[e]=this.parseFileDirectoryAt(this.firstIFDOffset),this.ifdRequests[e];if(!this.ifdRequests[e-1])try{this.ifdRequests[e-1]=this.requestIFD(e-1)}catch(t){throw t instanceof Ds?new Ds(e):t}return this.ifdRequests[e]=(async()=>{const t=await this.ifdRequests[e-1];if(t.nextIFDByteOffset===0)throw new Ds(e);return this.parseFileDirectoryAt(t.nextIFDByteOffset)})(),this.ifdRequests[e]}async getImage(e=0){const t=await this.requestIFD(e);return new hg(t.fileDirectory,t.geoKeyDirectory,this.dataView,this.littleEndian,this.cache,this.source)}async getImageCount(){let e=0,t=!0;for(;t;)try{await this.requestIFD(e),++e}catch(n){if(n instanceof Ds)t=!1;else throw n}return e}async getGhostValues(){const e=this.bigTiff?16:8;if(this.ghostValues)return this.ghostValues;const t="GDAL_STRUCTURAL_METADATA_SIZE=",n=t.length+100;let i=await this.getSlice(e,n);if(t===dr(i,yt.ASCII,t.length,e)){const u=dr(i,yt.ASCII,n,e).split(`
`)[0],p=Number(u.split("=")[1].split(" ")[0])+u.length;p>n&&(i=await this.getSlice(e,p));const g=dr(i,yt.ASCII,p,e);this.ghostValues={},g.split(`
`).filter(v=>v.length>0).map(v=>v.split("=")).forEach(([v,m])=>{this.ghostValues[v]=m})}return this.ghostValues}static async fromSource(e,t,n){const i=(await e.fetch([{offset:0,length:1024}],n))[0],a=new dS(i),u=a.getUint16(0,0);let p;if(u===18761)p=!0;else if(u===19789)p=!1;else throw new TypeError("Invalid byte order value.");const g=a.getUint16(2,p);let v;if(g===42)v=!1;else if(g===43){if(v=!0,a.getUint16(4,p)!==8)throw new Error("Unsupported offset byte-size.")}else throw new TypeError("Invalid magic number.");const m=v?a.getUint64(8,p):a.getUint32(4,p);return new Do(e,p,v,m,t)}close(){return typeof this.source.close=="function"?this.source.close():!1}}class GS extends fg{constructor(e,t){super();this.mainFile=e,this.overviewFiles=t,this.imageFiles=[e].concat(t),this.fileDirectoriesPerFile=null,this.fileDirectoriesPerFileParsing=null,this.imageCount=null}async parseFileDirectoriesPerFile(){const e=[this.mainFile.parseFileDirectoryAt(this.mainFile.firstIFDOffset)].concat(this.overviewFiles.map(t=>t.parseFileDirectoryAt(t.firstIFDOffset)));return this.fileDirectoriesPerFile=await Promise.all(e),this.fileDirectoriesPerFile}async getImage(e=0){await this.getImageCount(),await this.parseFileDirectoriesPerFile();let t=0,n=0;for(let i=0;i<this.imageFiles.length;i++){const a=this.imageFiles[i];for(let u=0;u<this.imageCounts[i];u++){if(e===t){const p=await a.requestIFD(n);return new hg(p.fileDirectory,p.geoKeyDirectory,a.dataView,a.littleEndian,a.cache,a.source)}t++,n++}n=0}throw new RangeError("Invalid image index")}async getImageCount(){if(this.imageCount!==null)return this.imageCount;const e=[this.mainFile.getImageCount()].concat(this.overviewFiles.map(t=>t.getImageCount()));return this.imageCounts=await Promise.all(e),this.imageCount=this.imageCounts.reduce((t,n)=>t+n,0),this.imageCount}}async function zS(o,e={},t){return Do.fromSource(mh(o,e),t)}async function US(o,e=[],t={},n){const i=await Do.fromSource(mh(o,t),n),a=await Promise.all(e.map(u=>Do.fromSource(mh(u,t))));return new GS(i,a)}var VS=globalThis&&globalThis.__extends||function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),dd="STATISTICS_MAXIMUM",pd="STATISTICS_MINIMUM",eh;function XS(){return eh||(eh=new vS),eh}function jS(o){try{return o.getBoundingBox()}catch{var e=o.fileDirectory;return[0,0,e.ImageWidth,e.ImageLength]}}function WS(o){try{return o.getOrigin().slice(0,2)}catch{return[0,o.fileDirectory.ImageLength]}}function HS(o,e){try{return o.getResolution(e)[0]}catch{return e.fileDirectory.ImageWidth/o.fileDirectory.ImageWidth}}function YS(o){var e=o.geoKeys;if(!e)return null;if(e.ProjectedCSTypeGeoKey){var t="EPSG:"+e.ProjectedCSTypeGeoKey,n=qe(t);if(!n){var i=ff(e.ProjLinearUnitsGeoKey);i&&(n=new Ks({code:t,units:i}))}return n}if(e.GeographicTypeGeoKey){var t="EPSG:"+e.GeographicTypeGeoKey,n=qe(t);if(!n){var i=ff(e.GeogAngularUnitsGeoKey);i&&(n=new Ks({code:t,units:i}))}return n}return null}function $S(o){return o.getImageCount().then(function(e){for(var t=new Array(e),n=0;n<e;++n)t[n]=o.getImage(n);return Promise.all(t)})}function KS(o,e){var t;return o.overviews?t=US(o.url,o.overviews,e):t=zS(o.url,e),t.then($S)}function Xs(o,e,t,n,i){if(Array.isArray(o)){var a=o.length;if(!Array.isArray(e)||a!=e.length){var u=new Error(n);throw i(u),u}for(var p=0;p<a;++p)Xs(o[p],e[p],t,n,i);return}if(e=e,Math.abs(o-e)>t*o)throw new Error(n)}function ZS(o){return o instanceof Int8Array?-128:o instanceof Int16Array?-32768:o instanceof Int32Array?-2147483648:o instanceof Float32Array?12e-39:0}function qS(o){return o instanceof Int8Array?127:o instanceof Uint8Array||o instanceof Uint8ClampedArray?255:o instanceof Int16Array?32767:o instanceof Uint16Array?65535:o instanceof Int32Array?2147483647:o instanceof Uint32Array?4294967295:o instanceof Float32Array?34e37:255}var dg=function(o){VS(e,o);function e(t){var n=o.call(this,{state:Oe.LOADING,tileGrid:null,projection:null,opaque:t.opaque,transition:t.transition,interpolate:t.interpolate!==!1,wrapX:t.wrapX})||this;n.sourceInfo_=t.sources;var i=n.sourceInfo_.length;n.sourceOptions_=t.sourceOptions,n.sourceImagery_=new Array(i),n.resolutionFactors_=new Array(i),n.samplesPerPixel_,n.nodataValues_,n.metadata_,n.normalize_=t.normalize!==!1,n.addAlpha_=!1,n.error_=null,n.readMethod_=t.convertToRGB?"readRGB":"readRasters",n.setKey(n.sourceInfo_.map(function(g){return g.url}).join(","));for(var a=n,u=new Array(i),p=0;p<i;++p)u[p]=KS(n.sourceInfo_[p],n.sourceOptions_);return Promise.all(u).then(function(g){a.configure_(g)}).catch(function(g){console.error(g),a.error_=g,a.setState(Oe.ERROR)}),n}return e.prototype.getError=function(){return this.error_},e.prototype.configure_=function(t){for(var n,i,a,u,p=new Array(t.length),g=new Array(t.length),v=new Array(t.length),m=0,E=t.length,b=function(X){var J=t[X],q=J.length,K=void 0,Q=void 0,tt=new Array(q),nt=new Array(q);g[X]=new Array(q),v[X]=new Array(q);for(var ot=0;ot<q;++ot){var at=J[ot],ht=at.getGDALNoData();v[X][ot]=at.getGDALMetadata(0),g[X][ot]=ht===null?NaN:ht;var ut=w.sourceInfo_[X].bands;p[X]=ut?ut.length:at.getSamplesPerPixel();var Rt=q-(ot+1);K||(K=jS(at)),Q||(Q=WS(at)),nt[Rt]=HS(at,J[0]),tt[Rt]=[at.getTileWidth(),at.getTileHeight()]}if(n?zi(n,K,n):n=K,!i)i=Q;else{var W="Origin mismatch for source ".concat(X,", got [").concat(Q,"] but expected [").concat(i,"]");Xs(i,Q,0,W,w.viewRejector)}if(!u)u=nt,w.resolutionFactors_[X]=1;else{u.length-m>nt.length&&(m=u.length-nt.length);var Yt=u[u.length-1]/nt[nt.length-1];w.resolutionFactors_[X]=Yt;var Ut=nt.map(function(ne){return ne*=Yt}),W="Resolution mismatch for source ".concat(X,", got [").concat(Ut,"] but expected [").concat(u,"]");Xs(u.slice(m,u.length),Ut,.02,W,w.viewRejector)}a?Xs(a.slice(m,a.length),tt,0,"Tile size mismatch for source ".concat(X),w.viewRejector):a=tt,w.sourceImagery_[X]=J.reverse()},w=this,S=0;S<E;++S)b(S);for(var C=0,A=this.sourceImagery_.length;C<A;++C)for(var M=this.sourceImagery_[C];M.length<u.length;)M.unshift(void 0);if(!this.getProjection())for(var I=t[0],C=I.length-1;C>=0;--C){var L=I[C],k=YS(L);if(k){this.projection=k;break}}this.samplesPerPixel_=p,this.nodataValues_=g,this.metadata_=v;t:for(var S=0;S<E;++S){if(this.sourceInfo_[S].nodata!==void 0){this.addAlpha_=!0;break}var N=g[S],G=this.sourceInfo_[S].bands;if(G){for(var C=0;C<G.length;++C)if(!isNaN(N[G[C]-1])){this.addAlpha_=!0;break t}continue}for(var z=0;z<N.length;++z)if(!isNaN(N[z])){this.addAlpha_=!0;break t}}var V=this.addAlpha_?1:0;this.bandCount=p.reduce(function(X,J){return X+=J,X},0)+V;var Y=new Bh({extent:n,minZoom:m,origin:i,resolutions:u,tileSizes:a});this.tileGrid=Y,this.setLoader(this.loadTile_.bind(this)),this.setState(Oe.READY),this.viewResolver({projection:this.projection,resolutions:u,center:Qs(ji(n),this.projection),extent:Oh(n,this.projection),zoom:0})},e.prototype.loadTile_=function(t,n,i){for(var a=Be(this.tileGrid.getTileSize(t)),u=this.sourceImagery_.length,p=new Array(u),g=this.addAlpha_,v=this.bandCount,m=this.samplesPerPixel_,E=this.nodataValues_,b=this.sourceInfo_,w=function(k){var N=b[k],G=S.resolutionFactors_[k],z=[Math.round(n*(a[0]*G)),Math.round(i*(a[1]*G)),Math.round((n+1)*(a[0]*G)),Math.round((i+1)*(a[1]*G))],V=S.sourceImagery_[k][t],Y=void 0;N.bands&&(Y=N.bands.map(function(J){return J-1}));var X=void 0;isNaN(N.nodata)?Y?X=Y.map(function(J){return E[k][J]}):X=E[k]:X=N.nodata,p[k]=V[S.readMethod_]({window:z,width:a[0],height:a[1],samples:Y,fillValue:X,pool:XS(),interleave:!1})},S=this,C=0;C<u;++C)w(C);var A=a[0]*a[1],M=A*v,I=this.normalize_,L=this.metadata_;return Promise.all(p).then(function(k){var N;I?N=new Uint8Array(M):N=new Float32Array(M);for(var G=0,z=0;z<A;++z){for(var V=g,Y=0;Y<u;++Y){var X=b[Y],J=X.min,q=X.max,K=void 0,Q=void 0;if(I){var tt=L[Y][0];J===void 0&&(tt&&pd in tt?J=parseFloat(tt[pd]):J=ZS(k[Y][0])),q===void 0&&(tt&&dd in tt?q=parseFloat(tt[dd]):q=qS(k[Y][0])),K=255/(q-J),Q=-J*K}for(var nt=0;nt<m[Y];++nt){var ot=k[Y][nt][z],at=void 0;if(I?at=ae(K*ot+Q,0,255):at=ot,!g)N[G]=at;else{var ht=X.nodata;if(ht===void 0){var ut=void 0;X.bands?ut=X.bands[nt]-1:ut=nt,ht=E[Y][ut]}ot!==ht&&(V=!1,N[G]=at)}G++}}g&&(V||(N[G]=255),G++)}return N})},e}(dw);dg.prototype.getView;var JS=dg;function gd(o,e,t){const n=o.slice();return n[6]=e[t],n}function _d(o){let e,t=o[6]+"",n,i,a,u;function p(){return o[4](o[6])}return{c(){e=Kt("button"),n=kn(t),this.h()},l(g){e=Zt(g,"BUTTON",{class:!0});var v=oe(e);n=Fn(v,t),v.forEach(Gt),this.h()},h(){wt(e,"class",i=`${xr(o[2],o[0]===o[6])} button-base border-t border-b border-r`)},m(g,v){gn(g,e,v),St(e,n),a||(u=Dn(e,"click",p),a=!0)},p(g,v){o=g,v&2&&t!==(t=o[6]+"")&&Hs(n,t),v&7&&i!==(i=`${xr(o[2],o[0]===o[6])} button-base border-t border-b border-r`)&&wt(e,"class",i)},d(g){g&&Gt(e),a=!1,u()}}}function QS(o){let e,t,n=o[1][0]+"",i,a,u,p,g,v=o[1][o[1].length-1]+"",m,E,b,w,S=o[1].slice(1,-1),C=[];for(let A=0;A<S.length;A+=1)C[A]=_d(gd(o,S,A));return{c(){e=Kt("div"),t=Kt("button"),i=kn(n),u=Le();for(let A=0;A<C.length;A+=1)C[A].c();p=Le(),g=Kt("button"),m=kn(v),this.h()},l(A){e=Zt(A,"DIV",{class:!0,role:!0});var M=oe(e);t=Zt(M,"BUTTON",{class:!0});var I=oe(t);i=Fn(I,n),I.forEach(Gt),u=De(M);for(let k=0;k<C.length;k+=1)C[k].l(M);p=De(M),g=Zt(M,"BUTTON",{class:!0});var L=oe(g);m=Fn(L,v),L.forEach(Gt),M.forEach(Gt),this.h()},h(){wt(t,"class",a=`${xr(o[2],o[0]===o[1][0])} button-base rounded-l-lg border`),wt(g,"class",E=`${xr(o[2],o[0]===o[1][o[1].length-1])} button-base rounded-r-lg border-t border-b border-r`),wt(e,"class","inline-flex flex-wrap rounded-md shadow-sm"),wt(e,"role","group")},m(A,M){gn(A,e,M),St(e,t),St(t,i),St(e,u);for(let I=0;I<C.length;I+=1)C[I].m(e,null);St(e,p),St(e,g),St(g,m),b||(w=[Dn(t,"click",o[3]),Dn(g,"click",o[5])],b=!0)},p(A,[M]){if(M&2&&n!==(n=A[1][0]+"")&&Hs(i,n),M&7&&a!==(a=`${xr(A[2],A[0]===A[1][0])} button-base rounded-l-lg border`)&&wt(t,"class",a),M&7){S=A[1].slice(1,-1);let I;for(I=0;I<S.length;I+=1){const L=gd(A,S,I);C[I]?C[I].p(L,M):(C[I]=_d(L),C[I].c(),C[I].m(e,p))}for(;I<C.length;I+=1)C[I].d(1);C.length=S.length}M&2&&v!==(v=A[1][A[1].length-1]+"")&&Hs(m,v),M&7&&E!==(E=`${xr(A[2],A[0]===A[1][A[1].length-1])} button-base rounded-r-lg border-t border-b border-r`)&&wt(g,"class",E)},i:me,o:me,d(A){A&&Gt(e),Ky(C,A),b=!1,xd(w)}}}function xr(o,e){switch(o){case"blue":return`border-blue-700/50 ${e?"bg-blue-700 hover:bg-blue-600":"bg-blue-900/50 hover:bg-blue-800 active:bg-blue-700"}`;case"green":return`border-green-700/50 ${e?"bg-green-700 hover:bg-green-700":"bg-green-900/50 hover:bg-green-800 active:bg-green-700"}`;case"red":return`border-red-700/50 ${e?"bg-red-800 hover:bg-red-700 active:bg-red-600":"bg-red-900/50 hover:bg-red-800 active:bg-red-700"}`;case"slate":return`border-slate-700/50 ${e?"bg-slate-700 hover:bg-slate-700":"bg-slate-900/50 hover:bg-slate-800 active:bg-slate-700"}`;default:console.error("Incorrect color")}}function tR(o,e,t){let{names:n}=e,{color:i}=e,{curr:a}=e;const u=()=>t(0,a=n[0]),p=v=>t(0,a=v),g=()=>t(0,a=n[n.length-1]);return o.$$set=v=>{"names"in v&&t(1,n=v.names),"color"in v&&t(2,i=v.color),"curr"in v&&t(0,a=v.curr)},[a,n,i,u,p,g]}class js extends da{constructor(e){super();pa(this,e,tR,QS,ga,{names:1,color:2,curr:0})}}const Ln=Jy({showingType:"",locked:-1,lockedCoords:{x:0,y:0},currIdx:0,currCoords:{x:0,y:0}});function eR(o){let e,t,n,i,a,u,p,g,v,m,E,b,w,S,C,A,M,I,L,k,N,G;function z(K){o[7](K)}let V={names:o[2],color:"blue"};o[1][0]!==void 0&&(V.curr=o[1][0]),n=new js({props:V}),Fs.push(()=>Ns(n,"curr",z));function Y(K){o[8](K)}let X={names:o[2],color:"green"};o[1][1]!==void 0&&(X.curr=o[1][1]),u=new js({props:X}),Fs.push(()=>Ns(u,"curr",Y));function J(K){o[9](K)}let q={names:o[2],color:"red"};return o[1][2]!==void 0&&(q.curr=o[1][2]),v=new js({props:q}),Fs.push(()=>Ns(v,"curr",J)),{c(){e=Kt("div"),t=Kt("div"),br(n.$$.fragment),a=Le(),br(u.$$.fragment),g=Le(),br(v.$$.fragment),E=Le(),b=Kt("div"),w=Kt("input"),S=Le(),C=Kt("input"),A=Le(),M=Kt("input"),I=Le(),L=Kt("div"),this.h()},l(K){e=Zt(K,"DIV",{class:!0});var Q=oe(e);t=Zt(Q,"DIV",{class:!0});var tt=oe(t);Er(n.$$.fragment,tt),a=De(tt),Er(u.$$.fragment,tt),g=De(tt),Er(v.$$.fragment,tt),tt.forEach(Gt),E=De(Q),b=Zt(Q,"DIV",{class:!0});var nt=oe(b);w=Zt(nt,"INPUT",{type:!0,min:!0,max:!0,class:!0}),S=De(nt),C=Zt(nt,"INPUT",{type:!0,min:!0,max:!0,class:!0}),A=De(nt),M=Zt(nt,"INPUT",{type:!0,min:!0,max:!0,class:!0}),nt.forEach(Gt),I=De(Q),L=Zt(Q,"DIV",{id:!0,class:!0}),oe(L).forEach(Gt),Q.forEach(Gt),this.h()},h(){wt(t,"class","flex flex-col"),wt(w,"type","range"),wt(w,"min","0"),wt(w,"max","254"),wt(w,"class",""),wt(C,"type","range"),wt(C,"min","0"),wt(C,"max","254"),wt(C,"class",""),wt(M,"type","range"),wt(M,"min","0"),wt(M,"max","254"),wt(M,"class",""),wt(b,"class","grid max-w-[600px] grid-cols-3 gap-x-4"),wt(L,"id","map"),wt(L,"class","h-[600px] w-[50vw] max-w-[600px]"),wt(e,"class","flex flex-col gap-y-6")},m(K,Q){gn(K,e,Q),St(e,t),Tr(n,t,null),St(t,a),Tr(u,t,null),St(t,g),Tr(v,t,null),St(e,E),St(e,b),St(b,w),ar(w,o[0][0]),St(b,S),St(b,C),ar(C,o[0][1]),St(b,A),St(b,M),ar(M,o[0][2]),St(e,I),St(e,L),k=!0,N||(G=[Dn(w,"change",o[10]),Dn(w,"input",o[10]),Dn(C,"change",o[11]),Dn(C,"input",o[11]),Dn(M,"change",o[12]),Dn(M,"input",o[12])],N=!0)},p(K,[Q]){const tt={};!i&&Q&2&&(i=!0,tt.curr=K[1][0],Bs(()=>i=!1)),n.$set(tt);const nt={};!p&&Q&2&&(p=!0,nt.curr=K[1][1],Bs(()=>p=!1)),u.$set(nt);const ot={};!m&&Q&2&&(m=!0,ot.curr=K[1][2],Bs(()=>m=!1)),v.$set(ot),Q&1&&ar(w,K[0][0]),Q&1&&ar(C,K[0][1]),Q&1&&ar(M,K[0][2])},i(K){k||(Bi(n.$$.fragment,K),Bi(u.$$.fragment,K),Bi(v.$$.fragment,K),k=!0)},o(K){Gi(n.$$.fragment,K),Gi(u.$$.fragment,K),Gi(v.$$.fragment,K),k=!1},d(K){K&&Gt(e),wr(n),wr(u),wr(v),N=!1,xd(G)}}}function nR(o,e,t){let n;bd(o,Ln,N=>t(6,n=N));let i,a,u,{sample:p}=e,g=[100,100,100],v=["DAPI","TMEM119","Olig2"];const m={DAPI:2,TMEM119:6,Olig2:5,GFAP:3,NeuN:4,Lipofuschin:1,None:7},E=Object.keys(m);function b(N,G){const z=E.length-1;return{blue:Math.min(m[N[0]],z),green:Math.min(m[N[1]],z),red:Math.min(m[N[2]],z),blueMax:255-G[0],greenMax:255-G[1],redMax:255-G[2],blueMask:m[N[0]]>z?0:1,greenMask:m[N[1]]>z?0:1,redMask:m[N[2]]>z?0:1}}const w=new vm({geometry:new T0([14e3,6e3],130.75/2)}),S=new Xb({source:new qb({features:[w]}),style:new _x({stroke:new Qd({color:"#eeeeee",width:1})})});Ed(()=>{a=new JS({normalize:!1,sources:[{url:`https://f004.backblazeb2.com/file/chaichontat-host/libd-rotation/${p}/${p}_1.tif`},{url:`https://f004.backblazeb2.com/file/chaichontat-host/libd-rotation/${p}/${p}_2.tif`}]}),t(4,i=new cw({style:{variables:b(v,g),color:["array",["*",["/",["band",["var","red"]],["var","redMax"]],["var","redMask"]],["*",["/",["band",["var","green"]],["var","greenMax"]],["var","greenMask"]],["*",["/",["band",["var","blue"]],["var","blueMax"]],["var","blueMask"]],1]},source:a})),t(5,u=new zT({target:"map",layers:[i,S],view:a.getView()}))});function C(N){o.$$.not_equal(v[0],N)&&(v[0]=N,t(1,v))}function A(N){o.$$.not_equal(v[1],N)&&(v[1]=N,t(1,v))}function M(N){o.$$.not_equal(v[2],N)&&(v[2]=N,t(1,v))}function I(){g[0]=Pl(this.value),t(0,g)}function L(){g[1]=Pl(this.value),t(0,g)}function k(){g[2]=Pl(this.value),t(0,g)}return o.$$set=N=>{"sample"in N&&t(3,p=N.sample)},o.$$.update=()=>{var N,G;if(o.$$.dirty&96&&n.locked!==-1&&u){let{x:z,y:V}=n.lockedCoords;u.getView().animate({center:[z,V],duration:100,zoom:5}),(N=w.getGeometry())==null||N.setCenter([z,V])}if(o.$$.dirty&19&&i&&i.updateStyleVariables(b(v,g)),o.$$.dirty&96&&u&&n.locked===-1){const{x:z,y:V}=n.currCoords;u.getView().animate({center:[z,V],zoom:4,duration:100}),(G=w.getGeometry())==null||G.setCenter([z,V])}},[g,v,E,p,i,u,n,C,A,M,I,L,k]}class iR extends da{constructor(e){super();pa(this,e,nR,eR,ga,{sample:3})}}var pg={exports:{}};/*!
 * Chart.js v3.7.1
 * https://www.chartjs.org
 * (c) 2022 Chart.js Contributors
 * Released under the MIT License
 */(function(o,e){(function(t,n){o.exports=n()})(m1,function(){function t(l,r,s){return r+" "+l+"px "+s}const n=function(){return typeof window=="undefined"?function(l){return l()}:window.requestAnimationFrame}();function i(l,r,s){const h=s||(d=>Array.prototype.slice.call(d));let c=!1,f=[];return function(...d){f=h(d),c||(c=!0,n.call(window,()=>{c=!1,l.apply(r,f)}))}}function a(l,r){let s;return function(...h){return r?(clearTimeout(s),s=setTimeout(l,r,h)):l.apply(this,h),r}}const u=l=>l==="start"?"left":l==="end"?"right":"center",p=(l,r,s)=>l==="start"?r:l==="end"?s:(r+s)/2,g=(l,r,s,h)=>l===(h?"left":"right")?s:l==="center"?(r+s)/2:r;class v{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(r,s,h,c){const f=s.listeners[c],d=s.duration;f.forEach(_=>_({chart:r,initial:s.initial,numSteps:d,currentStep:Math.min(h-s.start,d)}))}_refresh(){this._request||(this._running=!0,this._request=n.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(r=Date.now()){let s=0;this._charts.forEach((h,c)=>{if(!h.running||!h.items.length)return;const f=h.items;let d=f.length-1,_=!1,y;for(;d>=0;--d)y=f[d],y._active?(y._total>h.duration&&(h.duration=y._total),y.tick(r),_=!0):(f[d]=f[f.length-1],f.pop());_&&(c.draw(),this._notify(c,h,r,"progress")),f.length||(h.running=!1,this._notify(c,h,r,"complete"),h.initial=!1),s+=f.length}),this._lastDate=r,s===0&&(this._running=!1)}_getAnims(r){const s=this._charts;let h=s.get(r);return h||(h={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},s.set(r,h)),h}listen(r,s,h){this._getAnims(r).listeners[s].push(h)}add(r,s){!s||!s.length||this._getAnims(r).items.push(...s)}has(r){return this._getAnims(r).items.length>0}start(r){const s=this._charts.get(r);!s||(s.running=!0,s.start=Date.now(),s.duration=s.items.reduce((h,c)=>Math.max(h,c._duration),0),this._refresh())}running(r){if(!this._running)return!1;const s=this._charts.get(r);return!(!s||!s.running||!s.items.length)}stop(r){const s=this._charts.get(r);if(!s||!s.items.length)return;const h=s.items;let c=h.length-1;for(;c>=0;--c)h[c].cancel();s.items=[],this._notify(r,s,Date.now(),"complete")}remove(r){return this._charts.delete(r)}}var m=new v;/*!
 * @kurkle/color v0.1.9
 * https://github.com/kurkle/color#readme
 * (c) 2020 Jukka Kurkela
 * Released under the MIT License
 */const E={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},b="0123456789ABCDEF",w=l=>b[l&15],S=l=>b[(l&240)>>4]+b[l&15],C=l=>(l&240)>>4===(l&15);function A(l){return C(l.r)&&C(l.g)&&C(l.b)&&C(l.a)}function M(l){var r=l.length,s;return l[0]==="#"&&(r===4||r===5?s={r:255&E[l[1]]*17,g:255&E[l[2]]*17,b:255&E[l[3]]*17,a:r===5?E[l[4]]*17:255}:(r===7||r===9)&&(s={r:E[l[1]]<<4|E[l[2]],g:E[l[3]]<<4|E[l[4]],b:E[l[5]]<<4|E[l[6]],a:r===9?E[l[7]]<<4|E[l[8]]:255})),s}function I(l){var r=A(l)?w:S;return l&&"#"+r(l.r)+r(l.g)+r(l.b)+(l.a<255?r(l.a):"")}function L(l){return l+.5|0}const k=(l,r,s)=>Math.max(Math.min(l,s),r);function N(l){return k(L(l*2.55),0,255)}function G(l){return k(L(l*255),0,255)}function z(l){return k(L(l/2.55)/100,0,1)}function V(l){return k(L(l*100),0,100)}const Y=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function X(l){const r=Y.exec(l);let s=255,h,c,f;if(!!r){if(r[7]!==h){const d=+r[7];s=255&(r[8]?N(d):d*255)}return h=+r[1],c=+r[3],f=+r[5],h=255&(r[2]?N(h):h),c=255&(r[4]?N(c):c),f=255&(r[6]?N(f):f),{r:h,g:c,b:f,a:s}}}function J(l){return l&&(l.a<255?`rgba(${l.r}, ${l.g}, ${l.b}, ${z(l.a)})`:`rgb(${l.r}, ${l.g}, ${l.b})`)}const q=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function K(l,r,s){const h=r*Math.min(s,1-s),c=(f,d=(f+l/30)%12)=>s-h*Math.max(Math.min(d-3,9-d,1),-1);return[c(0),c(8),c(4)]}function Q(l,r,s){const h=(c,f=(c+l/60)%6)=>s-s*r*Math.max(Math.min(f,4-f,1),0);return[h(5),h(3),h(1)]}function tt(l,r,s){const h=K(l,1,.5);let c;for(r+s>1&&(c=1/(r+s),r*=c,s*=c),c=0;c<3;c++)h[c]*=1-r-s,h[c]+=r;return h}function nt(l){const s=l.r/255,h=l.g/255,c=l.b/255,f=Math.max(s,h,c),d=Math.min(s,h,c),_=(f+d)/2;let y,x,T;return f!==d&&(T=f-d,x=_>.5?T/(2-f-d):T/(f+d),y=f===s?(h-c)/T+(h<c?6:0):f===h?(c-s)/T+2:(s-h)/T+4,y=y*60+.5),[y|0,x||0,_]}function ot(l,r,s,h){return(Array.isArray(r)?l(r[0],r[1],r[2]):l(r,s,h)).map(G)}function at(l,r,s){return ot(K,l,r,s)}function ht(l,r,s){return ot(tt,l,r,s)}function ut(l,r,s){return ot(Q,l,r,s)}function Rt(l){return(l%360+360)%360}function W(l){const r=q.exec(l);let s=255,h;if(!r)return;r[5]!==h&&(s=r[6]?N(+r[5]):G(+r[5]));const c=Rt(+r[2]),f=+r[3]/100,d=+r[4]/100;return r[1]==="hwb"?h=ht(c,f,d):r[1]==="hsv"?h=ut(c,f,d):h=at(c,f,d),{r:h[0],g:h[1],b:h[2],a:s}}function Yt(l,r){var s=nt(l);s[0]=Rt(s[0]+r),s=at(s),l.r=s[0],l.g=s[1],l.b=s[2]}function Ut(l){if(!l)return;const r=nt(l),s=r[0],h=V(r[1]),c=V(r[2]);return l.a<255?`hsla(${s}, ${h}%, ${c}%, ${z(l.a)})`:`hsl(${s}, ${h}%, ${c}%)`}const Jt={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},ne={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function ze(){const l={},r=Object.keys(ne),s=Object.keys(Jt);let h,c,f,d,_;for(h=0;h<r.length;h++){for(d=_=r[h],c=0;c<s.length;c++)f=s[c],_=_.replace(f,Jt[f]);f=parseInt(ne[d],16),l[_]=[f>>16&255,f>>8&255,f&255]}return l}let ie;function ue(l){ie||(ie=ze(),ie.transparent=[0,0,0,0]);const r=ie[l.toLowerCase()];return r&&{r:r[0],g:r[1],b:r[2],a:r.length===4?r[3]:255}}function wn(l,r,s){if(l){let h=nt(l);h[r]=Math.max(0,Math.min(h[r]+h[r]*s,r===0?360:1)),h=at(h),l.r=h[0],l.g=h[1],l.b=h[2]}}function Yi(l,r){return l&&Object.assign(r||{},l)}function Gn(l){var r={r:0,g:0,b:0,a:255};return Array.isArray(l)?l.length>=3&&(r={r:l[0],g:l[1],b:l[2],a:255},l.length>3&&(r.a=G(l[3]))):(r=Yi(l,{r:0,g:0,b:0,a:1}),r.a=G(r.a)),r}function ui(l){return l.charAt(0)==="r"?X(l):W(l)}class We{constructor(r){if(r instanceof We)return r;const s=typeof r;let h;s==="object"?h=Gn(r):s==="string"&&(h=M(r)||ue(r)||ui(r)),this._rgb=h,this._valid=!!h}get valid(){return this._valid}get rgb(){var r=Yi(this._rgb);return r&&(r.a=z(r.a)),r}set rgb(r){this._rgb=Gn(r)}rgbString(){return this._valid?J(this._rgb):this._rgb}hexString(){return this._valid?I(this._rgb):this._rgb}hslString(){return this._valid?Ut(this._rgb):this._rgb}mix(r,s){const h=this;if(r){const c=h.rgb,f=r.rgb;let d;const _=s===d?.5:s,y=2*_-1,x=c.a-f.a,T=((y*x===-1?y:(y+x)/(1+y*x))+1)/2;d=1-T,c.r=255&T*c.r+d*f.r+.5,c.g=255&T*c.g+d*f.g+.5,c.b=255&T*c.b+d*f.b+.5,c.a=_*c.a+(1-_)*f.a,h.rgb=c}return h}clone(){return new We(this.rgb)}alpha(r){return this._rgb.a=G(r),this}clearer(r){const s=this._rgb;return s.a*=1-r,this}greyscale(){const r=this._rgb,s=L(r.r*.3+r.g*.59+r.b*.11);return r.r=r.g=r.b=s,this}opaquer(r){const s=this._rgb;return s.a*=1+r,this}negate(){const r=this._rgb;return r.r=255-r.r,r.g=255-r.g,r.b=255-r.b,this}lighten(r){return wn(this._rgb,2,r),this}darken(r){return wn(this._rgb,2,-r),this}saturate(r){return wn(this._rgb,1,r),this}desaturate(r){return wn(this._rgb,1,-r),this}rotate(r){return Yt(this._rgb,r),this}}function zn(l){return new We(l)}const fi=l=>l instanceof CanvasGradient||l instanceof CanvasPattern;function di(l){return fi(l)?l:zn(l)}function pi(l){return fi(l)?l:zn(l).saturate(.5).darken(.1).hexString()}function Te(){}const $i=function(){let l=0;return function(){return l++}}();function It(l){return l===null||typeof l=="undefined"}function Dt(l){if(Array.isArray&&Array.isArray(l))return!0;const r=Object.prototype.toString.call(l);return r.substr(0,7)==="[object"&&r.substr(-6)==="Array]"}function vt(l){return l!==null&&Object.prototype.toString.call(l)==="[object Object]"}const jt=l=>(typeof l=="number"||l instanceof Number)&&isFinite(+l);function we(l,r){return jt(l)?l:r}function gt(l,r){return typeof l=="undefined"?r:l}const Ki=(l,r)=>typeof l=="string"&&l.endsWith("%")?parseFloat(l)/100:l/r,gi=(l,r)=>typeof l=="string"&&l.endsWith("%")?parseFloat(l)/100*r:+l;function kt(l,r,s){if(l&&typeof l.call=="function")return l.apply(s,r)}function At(l,r,s,h){let c,f,d;if(Dt(l))if(f=l.length,h)for(c=f-1;c>=0;c--)r.call(s,l[c],c);else for(c=0;c<f;c++)r.call(s,l[c],c);else if(vt(l))for(d=Object.keys(l),f=d.length,c=0;c<f;c++)r.call(s,l[d[c]],d[c])}function _i(l,r){let s,h,c,f;if(!l||!r||l.length!==r.length)return!1;for(s=0,h=l.length;s<h;++s)if(c=l[s],f=r[s],c.datasetIndex!==f.datasetIndex||c.index!==f.index)return!1;return!0}function Se(l){if(Dt(l))return l.map(Se);if(vt(l)){const r=Object.create(null),s=Object.keys(l),h=s.length;let c=0;for(;c<h;++c)r[s[c]]=Se(l[s[c]]);return r}return l}function Gr(l){return["__proto__","prototype","constructor"].indexOf(l)===-1}function vi(l,r,s,h){if(!Gr(l))return;const c=r[l],f=s[l];vt(c)&&vt(f)?sn(c,f,h):r[l]=Se(f)}function sn(l,r,s){const h=Dt(r)?r:[r],c=h.length;if(!vt(l))return l;s=s||{};const f=s.merger||vi;for(let d=0;d<c;++d){if(r=h[d],!vt(r))continue;const _=Object.keys(r);for(let y=0,x=_.length;y<x;++y)f(_[y],l,r,s)}return l}function Je(l,r){return sn(l,r,{merger:zr})}function zr(l,r,s){if(!Gr(l))return;const h=r[l],c=s[l];vt(h)&&vt(c)?Je(h,c):Object.prototype.hasOwnProperty.call(r,l)||(r[l]=Se(c))}function Uo(l,r,s,h){r!==void 0&&console.warn(l+': "'+s+'" is deprecated. Please use "'+h+'" instead')}const Ur="",Da=".";function Vo(l,r){const s=l.indexOf(Da,r);return s===-1?l.length:s}function Qe(l,r){if(r===Ur)return l;let s=0,h=Vo(r,s);for(;l&&h>s;)l=l[r.substr(s,h-s)],s=h+1,h=Vo(r,s);return l}function yi(l){return l.charAt(0).toUpperCase()+l.slice(1)}const _e=l=>typeof l!="undefined",He=l=>typeof l=="function",mi=(l,r)=>{if(l.size!==r.size)return!1;for(const s of l)if(!r.has(s))return!1;return!0};function Un(l){return l.type==="mouseup"||l.type==="click"||l.type==="contextmenu"}const Ue=Object.create(null),Sn=Object.create(null);function Vn(l,r){if(!r)return l;const s=r.split(".");for(let h=0,c=s.length;h<c;++h){const f=s[h];l=l[f]||(l[f]=Object.create(null))}return l}function Zi(l,r,s){return typeof r=="string"?sn(Vn(l,r),s):sn(Vn(l,""),r)}class ka{constructor(r){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=s=>s.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(s,h)=>pi(h.backgroundColor),this.hoverBorderColor=(s,h)=>pi(h.borderColor),this.hoverColor=(s,h)=>pi(h.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(r)}set(r,s){return Zi(this,r,s)}get(r){return Vn(this,r)}describe(r,s){return Zi(Sn,r,s)}override(r,s){return Zi(Ue,r,s)}route(r,s,h,c){const f=Vn(this,r),d=Vn(this,h),_="_"+s;Object.defineProperties(f,{[_]:{value:f[s],writable:!0},[s]:{enumerable:!0,get(){const y=this[_],x=d[c];return vt(y)?Object.assign({},x,y):gt(y,x)},set(y){this[_]=y}}})}}var Et=new ka({_scriptable:l=>!l.startsWith("on"),_indexable:l=>l!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}});const Nt=Math.PI,Pt=2*Nt,tn=Pt+Nt,an=Number.POSITIVE_INFINITY,xi=Nt/180,bt=Nt/2,fe=Nt/4,bi=Nt*2/3,Re=Math.log10,Ae=Math.sign;function Fa(l){const r=Math.round(l);l=Ji(l,r,l/1e3)?r:l;const s=Math.pow(10,Math.floor(Re(l))),h=l/s;return(h<=1?1:h<=2?2:h<=5?5:10)*s}function rc(l){const r=[],s=Math.sqrt(l);let h;for(h=1;h<s;h++)l%h===0&&(r.push(h),r.push(l/h));return s===(s|0)&&r.push(s),r.sort((c,f)=>c-f).pop(),r}function qi(l){return!isNaN(parseFloat(l))&&isFinite(l)}function Ji(l,r,s){return Math.abs(l-r)<s}function oc(l,r){const s=Math.round(l);return s-r<=l&&s+r>=l}function Na(l,r,s){let h,c,f;for(h=0,c=l.length;h<c;h++)f=l[h][s],isNaN(f)||(r.min=Math.min(r.min,f),r.max=Math.max(r.max,f))}function Ye(l){return l*(Nt/180)}function Xo(l){return l*(180/Nt)}function Ba(l){if(!jt(l))return;let r=1,s=0;for(;Math.round(l*r)/r!==l;)r*=10,s++;return s}function Ga(l,r){const s=r.x-l.x,h=r.y-l.y,c=Math.sqrt(s*s+h*h);let f=Math.atan2(h,s);return f<-.5*Nt&&(f+=Pt),{angle:f,distance:c}}function jo(l,r){return Math.sqrt(Math.pow(r.x-l.x,2)+Math.pow(r.y-l.y,2))}function sc(l,r){return(l-r+tn)%Pt-Nt}function Pe(l){return(l%Pt+Pt)%Pt}function Qi(l,r,s,h){const c=Pe(l),f=Pe(r),d=Pe(s),_=Pe(f-c),y=Pe(d-c),x=Pe(c-f),T=Pe(c-d);return c===f||c===d||h&&f===d||_>y&&x<T}function de(l,r,s){return Math.max(r,Math.min(s,l))}function ac(l){return de(l,-32768,32767)}function ln(l,r,s,h=1e-6){return l>=Math.min(r,s)-h&&l<=Math.max(r,s)+h}function lc(l){return!l||It(l.size)||It(l.family)?null:(l.style?l.style+" ":"")+(l.weight?l.weight+" ":"")+l.size+"px "+l.family}function Vr(l,r,s,h,c){let f=r[c];return f||(f=r[c]=l.measureText(c).width,s.push(c)),f>h&&(h=f),h}function hc(l,r,s,h){h=h||{};let c=h.data=h.data||{},f=h.garbageCollect=h.garbageCollect||[];h.font!==r&&(c=h.data={},f=h.garbageCollect=[],h.font=r),l.save(),l.font=r;let d=0;const _=s.length;let y,x,T,R,O;for(y=0;y<_;y++)if(R=s[y],R!=null&&Dt(R)!==!0)d=Vr(l,c,f,d,R);else if(Dt(R))for(x=0,T=R.length;x<T;x++)O=R[x],O!=null&&!Dt(O)&&(d=Vr(l,c,f,d,O));l.restore();const P=f.length/2;if(P>s.length){for(y=0;y<P;y++)delete c[f[y]];f.splice(0,P)}return d}function Xn(l,r,s){const h=l.currentDevicePixelRatio,c=s!==0?Math.max(s/2,.5):0;return Math.round((r-c)*h)/h+c}function za(l,r){r=r||l.getContext("2d"),r.save(),r.resetTransform(),r.clearRect(0,0,l.width,l.height),r.restore()}function Xr(l,r,s,h){let c,f,d,_,y;const x=r.pointStyle,T=r.rotation,R=r.radius;let O=(T||0)*xi;if(x&&typeof x=="object"&&(c=x.toString(),c==="[object HTMLImageElement]"||c==="[object HTMLCanvasElement]")){l.save(),l.translate(s,h),l.rotate(O),l.drawImage(x,-x.width/2,-x.height/2,x.width,x.height),l.restore();return}if(!(isNaN(R)||R<=0)){switch(l.beginPath(),x){default:l.arc(s,h,R,0,Pt),l.closePath();break;case"triangle":l.moveTo(s+Math.sin(O)*R,h-Math.cos(O)*R),O+=bi,l.lineTo(s+Math.sin(O)*R,h-Math.cos(O)*R),O+=bi,l.lineTo(s+Math.sin(O)*R,h-Math.cos(O)*R),l.closePath();break;case"rectRounded":y=R*.516,_=R-y,f=Math.cos(O+fe)*_,d=Math.sin(O+fe)*_,l.arc(s-f,h-d,y,O-Nt,O-bt),l.arc(s+d,h-f,y,O-bt,O),l.arc(s+f,h+d,y,O,O+bt),l.arc(s-d,h+f,y,O+bt,O+Nt),l.closePath();break;case"rect":if(!T){_=Math.SQRT1_2*R,l.rect(s-_,h-_,2*_,2*_);break}O+=fe;case"rectRot":f=Math.cos(O)*R,d=Math.sin(O)*R,l.moveTo(s-f,h-d),l.lineTo(s+d,h-f),l.lineTo(s+f,h+d),l.lineTo(s-d,h+f),l.closePath();break;case"crossRot":O+=fe;case"cross":f=Math.cos(O)*R,d=Math.sin(O)*R,l.moveTo(s-f,h-d),l.lineTo(s+f,h+d),l.moveTo(s+d,h-f),l.lineTo(s-d,h+f);break;case"star":f=Math.cos(O)*R,d=Math.sin(O)*R,l.moveTo(s-f,h-d),l.lineTo(s+f,h+d),l.moveTo(s+d,h-f),l.lineTo(s-d,h+f),O+=fe,f=Math.cos(O)*R,d=Math.sin(O)*R,l.moveTo(s-f,h-d),l.lineTo(s+f,h+d),l.moveTo(s+d,h-f),l.lineTo(s-d,h+f);break;case"line":f=Math.cos(O)*R,d=Math.sin(O)*R,l.moveTo(s-f,h-d),l.lineTo(s+f,h+d);break;case"dash":l.moveTo(s,h),l.lineTo(s+Math.cos(O)*R,h+Math.sin(O)*R);break}l.fill(),r.borderWidth>0&&l.stroke()}}function jn(l,r,s){return s=s||.5,!r||l&&l.x>r.left-s&&l.x<r.right+s&&l.y>r.top-s&&l.y<r.bottom+s}function jr(l,r){l.save(),l.beginPath(),l.rect(r.left,r.top,r.right-r.left,r.bottom-r.top),l.clip()}function Wr(l){l.restore()}function cc(l,r,s,h,c){if(!r)return l.lineTo(s.x,s.y);if(c==="middle"){const f=(r.x+s.x)/2;l.lineTo(f,r.y),l.lineTo(f,s.y)}else c==="after"!=!!h?l.lineTo(r.x,s.y):l.lineTo(s.x,r.y);l.lineTo(s.x,s.y)}function uc(l,r,s,h){if(!r)return l.lineTo(s.x,s.y);l.bezierCurveTo(h?r.cp1x:r.cp2x,h?r.cp1y:r.cp2y,h?s.cp2x:s.cp1x,h?s.cp2y:s.cp1y,s.x,s.y)}function Wn(l,r,s,h,c,f={}){const d=Dt(r)?r:[r],_=f.strokeWidth>0&&f.strokeColor!=="";let y,x;for(l.save(),l.font=c.string,vg(l,f),y=0;y<d.length;++y)x=d[y],_&&(f.strokeColor&&(l.strokeStyle=f.strokeColor),It(f.strokeWidth)||(l.lineWidth=f.strokeWidth),l.strokeText(x,s,h,f.maxWidth)),l.fillText(x,s,h,f.maxWidth),yg(l,s,h,x,f),h+=c.lineHeight;l.restore()}function vg(l,r){r.translation&&l.translate(r.translation[0],r.translation[1]),It(r.rotation)||l.rotate(r.rotation),r.color&&(l.fillStyle=r.color),r.textAlign&&(l.textAlign=r.textAlign),r.textBaseline&&(l.textBaseline=r.textBaseline)}function yg(l,r,s,h,c){if(c.strikethrough||c.underline){const f=l.measureText(h),d=r-f.actualBoundingBoxLeft,_=r+f.actualBoundingBoxRight,y=s-f.actualBoundingBoxAscent,x=s+f.actualBoundingBoxDescent,T=c.strikethrough?(y+x)/2:x;l.strokeStyle=l.fillStyle,l.beginPath(),l.lineWidth=c.decorationWidth||2,l.moveTo(d,T),l.lineTo(_,T),l.stroke()}}function Hr(l,r){const{x:s,y:h,w:c,h:f,radius:d}=r;l.arc(s+d.topLeft,h+d.topLeft,d.topLeft,-bt,Nt,!0),l.lineTo(s,h+f-d.bottomLeft),l.arc(s+d.bottomLeft,h+f-d.bottomLeft,d.bottomLeft,Nt,bt,!0),l.lineTo(s+c-d.bottomRight,h+f),l.arc(s+c-d.bottomRight,h+f-d.bottomRight,d.bottomRight,bt,0,!0),l.lineTo(s+c,h+d.topRight),l.arc(s+c-d.topRight,h+d.topRight,d.topRight,0,-bt,!0),l.lineTo(s+d.topLeft,h)}function Wo(l,r,s){s=s||(d=>l[d]<r);let h=l.length-1,c=0,f;for(;h-c>1;)f=c+h>>1,s(f)?c=f:h=f;return{lo:c,hi:h}}const hn=(l,r,s)=>Wo(l,s,h=>l[h][r]<s),fc=(l,r,s)=>Wo(l,s,h=>l[h][r]>=s);function dc(l,r,s){let h=0,c=l.length;for(;h<c&&l[h]<r;)h++;for(;c>h&&l[c-1]>s;)c--;return h>0||c<l.length?l.slice(h,c):l}const pc=["push","pop","shift","splice","unshift"];function gc(l,r){if(l._chartjs){l._chartjs.listeners.push(r);return}Object.defineProperty(l,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[r]}}),pc.forEach(s=>{const h="_onData"+yi(s),c=l[s];Object.defineProperty(l,s,{configurable:!0,enumerable:!1,value(...f){const d=c.apply(this,f);return l._chartjs.listeners.forEach(_=>{typeof _[h]=="function"&&_[h](...f)}),d}})})}function Ua(l,r){const s=l._chartjs;if(!s)return;const h=s.listeners,c=h.indexOf(r);c!==-1&&h.splice(c,1),!(h.length>0)&&(pc.forEach(f=>{delete l[f]}),delete l._chartjs)}function Va(l){const r=new Set;let s,h;for(s=0,h=l.length;s<h;++s)r.add(l[s]);return r.size===h?l:Array.from(r)}function Xa(){return typeof window!="undefined"&&typeof document!="undefined"}function Ho(l){let r=l.parentNode;return r&&r.toString()==="[object ShadowRoot]"&&(r=r.host),r}function Yo(l,r,s){let h;return typeof l=="string"?(h=parseInt(l,10),l.indexOf("%")!==-1&&(h=h/100*r.parentNode[s])):h=l,h}const $o=l=>window.getComputedStyle(l,null);function _c(l,r){return $o(l).getPropertyValue(r)}const mg=["top","right","bottom","left"];function Ei(l,r,s){const h={};s=s?"-"+s:"";for(let c=0;c<4;c++){const f=mg[c];h[f]=parseFloat(l[r+"-"+f+s])||0}return h.width=h.left+h.right,h.height=h.top+h.bottom,h}const xg=(l,r,s)=>(l>0||r>0)&&(!s||!s.shadowRoot);function bg(l,r){const s=l.native||l,h=s.touches,c=h&&h.length?h[0]:s,{offsetX:f,offsetY:d}=c;let _=!1,y,x;if(xg(f,d,s.target))y=f,x=d;else{const T=r.getBoundingClientRect();y=c.clientX-T.left,x=c.clientY-T.top,_=!0}return{x:y,y:x,box:_}}function ja(l,r){const{canvas:s,currentDevicePixelRatio:h}=r,c=$o(s),f=c.boxSizing==="border-box",d=Ei(c,"padding"),_=Ei(c,"border","width"),{x:y,y:x,box:T}=bg(l,s),R=d.left+(T&&_.left),O=d.top+(T&&_.top);let{width:P,height:D}=r;return f&&(P-=d.width+_.width,D-=d.height+_.height),{x:Math.round((y-R)/P*s.width/h),y:Math.round((x-O)/D*s.height/h)}}function Eg(l,r,s){let h,c;if(r===void 0||s===void 0){const f=Ho(l);if(!f)r=l.clientWidth,s=l.clientHeight;else{const d=f.getBoundingClientRect(),_=$o(f),y=Ei(_,"border","width"),x=Ei(_,"padding");r=d.width-x.width-y.width,s=d.height-x.height-y.height,h=Yo(_.maxWidth,f,"clientWidth"),c=Yo(_.maxHeight,f,"clientHeight")}}return{width:r,height:s,maxWidth:h||an,maxHeight:c||an}}const Wa=l=>Math.round(l*10)/10;function vc(l,r,s,h){const c=$o(l),f=Ei(c,"margin"),d=Yo(c.maxWidth,l,"clientWidth")||an,_=Yo(c.maxHeight,l,"clientHeight")||an,y=Eg(l,r,s);let{width:x,height:T}=y;if(c.boxSizing==="content-box"){const R=Ei(c,"border","width"),O=Ei(c,"padding");x-=O.width+R.width,T-=O.height+R.height}return x=Math.max(0,x-f.width),T=Math.max(0,h?Math.floor(x/h):T-f.height),x=Wa(Math.min(x,d,y.maxWidth)),T=Wa(Math.min(T,_,y.maxHeight)),x&&!T&&(T=Wa(x/2)),{width:x,height:T}}function Ha(l,r,s){const h=r||1,c=Math.floor(l.height*h),f=Math.floor(l.width*h);l.height=c/h,l.width=f/h;const d=l.canvas;return d.style&&(s||!d.style.height&&!d.style.width)&&(d.style.height=`${l.height}px`,d.style.width=`${l.width}px`),l.currentDevicePixelRatio!==h||d.height!==c||d.width!==f?(l.currentDevicePixelRatio=h,d.height=c,d.width=f,l.ctx.setTransform(h,0,0,h,0,0),!0):!1}const yc=function(){let l=!1;try{const r={get passive(){return l=!0,!1}};window.addEventListener("test",null,r),window.removeEventListener("test",null,r)}catch{}return l}();function Ya(l,r){const s=_c(l,r),h=s&&s.match(/^(\d+)(\.\d+)?px$/);return h?+h[1]:void 0}function Yr(l,r){return"native"in l?{x:l.x,y:l.y}:ja(l,r)}function Tg(l,r){const s=l.getSortedVisibleDatasetMetas();let h,c,f;for(let d=0,_=s.length;d<_;++d){({index:h,data:c}=s[d]);for(let y=0,x=c.length;y<x;++y)f=c[y],f.skip||r(f,h,y)}}function wg(l,r,s,h){const{controller:c,data:f,_sorted:d}=l,_=c._cachedMeta.iScale;if(_&&r===_.axis&&r!=="r"&&d&&f.length){const y=_._reversePixels?fc:hn;if(h){if(c._sharedOptions){const x=f[0],T=typeof x.getRange=="function"&&x.getRange(r);if(T){const R=y(f,r,s-T),O=y(f,r,s+T);return{lo:R.lo,hi:O.hi}}}}else return y(f,r,s)}return{lo:0,hi:f.length-1}}function $a(l,r,s,h,c){const f=l.getSortedVisibleDatasetMetas(),d=s[r];for(let _=0,y=f.length;_<y;++_){const{index:x,data:T}=f[_],{lo:R,hi:O}=wg(f[_],r,d,c);for(let P=R;P<=O;++P){const D=T[P];D.skip||h(D,x,P)}}}function Sg(l){const r=l.indexOf("x")!==-1,s=l.indexOf("y")!==-1;return function(h,c){const f=r?Math.abs(h.x-c.x):0,d=s?Math.abs(h.y-c.y):0;return Math.sqrt(Math.pow(f,2)+Math.pow(d,2))}}function Ka(l,r,s,h){const c=[];return jn(r,l.chartArea,l._minPadding)&&$a(l,s,r,function(d,_,y){d.inRange(r.x,r.y,h)&&c.push({element:d,datasetIndex:_,index:y})},!0),c}function Rg(l,r,s,h){let c=[];function f(d,_,y){const{startAngle:x,endAngle:T}=d.getProps(["startAngle","endAngle"],h),{angle:R}=Ga(d,{x:r.x,y:r.y});Qi(R,x,T)&&c.push({element:d,datasetIndex:_,index:y})}return $a(l,s,r,f),c}function Cg(l,r,s,h,c){let f=[];const d=Sg(s);let _=Number.POSITIVE_INFINITY;function y(x,T,R){const O=x.inRange(r.x,r.y,c);if(h&&!O)return;const P=x.getCenterPoint(c);if(!jn(P,l.chartArea,l._minPadding)&&!O)return;const F=d(r,P);F<_?(f=[{element:x,datasetIndex:T,index:R}],_=F):F===_&&f.push({element:x,datasetIndex:T,index:R})}return $a(l,s,r,y),f}function Za(l,r,s,h,c){return jn(r,l.chartArea,l._minPadding)?s==="r"&&!h?Rg(l,r,s,c):Cg(l,r,s,h,c):[]}function mc(l,r,s,h){const c=Yr(r,l),f=[],d=s.axis,_=d==="x"?"inXRange":"inYRange";let y=!1;return Tg(l,(x,T,R)=>{x[_](c[d],h)&&f.push({element:x,datasetIndex:T,index:R}),x.inRange(c.x,c.y,h)&&(y=!0)}),s.intersect&&!y?[]:f}var xc={modes:{index(l,r,s,h){const c=Yr(r,l),f=s.axis||"x",d=s.intersect?Ka(l,c,f,h):Za(l,c,f,!1,h),_=[];return d.length?(l.getSortedVisibleDatasetMetas().forEach(y=>{const x=d[0].index,T=y.data[x];T&&!T.skip&&_.push({element:T,datasetIndex:y.index,index:x})}),_):[]},dataset(l,r,s,h){const c=Yr(r,l),f=s.axis||"xy";let d=s.intersect?Ka(l,c,f,h):Za(l,c,f,!1,h);if(d.length>0){const _=d[0].datasetIndex,y=l.getDatasetMeta(_).data;d=[];for(let x=0;x<y.length;++x)d.push({element:y[x],datasetIndex:_,index:x})}return d},point(l,r,s,h){const c=Yr(r,l),f=s.axis||"xy";return Ka(l,c,f,h)},nearest(l,r,s,h){const c=Yr(r,l),f=s.axis||"xy";return Za(l,c,f,s.intersect,h)},x(l,r,s,h){return mc(l,r,{axis:"x",intersect:s.intersect},h)},y(l,r,s,h){return mc(l,r,{axis:"y",intersect:s.intersect},h)}}};const Og=new RegExp(/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/),Ig=new RegExp(/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/);function bc(l,r){const s=(""+l).match(Og);if(!s||s[1]==="normal")return r*1.2;switch(l=+s[2],s[3]){case"px":return l;case"%":l/=100;break}return r*l}const Ag=l=>+l||0;function Ko(l,r){const s={},h=vt(r),c=h?Object.keys(r):r,f=vt(l)?h?d=>gt(l[d],l[r[d]]):d=>l[d]:()=>l;for(const d of c)s[d]=Ag(f(d));return s}function qa(l){return Ko(l,{top:"y",right:"x",bottom:"y",left:"x"})}function Ti(l){return Ko(l,["topLeft","topRight","bottomLeft","bottomRight"])}function ve(l){const r=qa(l);return r.width=r.left+r.right,r.height=r.top+r.bottom,r}function he(l,r){l=l||{},r=r||Et.font;let s=gt(l.size,r.size);typeof s=="string"&&(s=parseInt(s,10));let h=gt(l.style,r.style);h&&!(""+h).match(Ig)&&(console.warn('Invalid font style specified: "'+h+'"'),h="");const c={family:gt(l.family,r.family),lineHeight:bc(gt(l.lineHeight,r.lineHeight),s),size:s,style:h,weight:gt(l.weight,r.weight),string:""};return c.string=lc(c),c}function tr(l,r,s,h){let c=!0,f,d,_;for(f=0,d=l.length;f<d;++f)if(_=l[f],_!==void 0&&(r!==void 0&&typeof _=="function"&&(_=_(r),c=!1),s!==void 0&&Dt(_)&&(_=_[s%_.length],c=!1),_!==void 0))return h&&!c&&(h.cacheable=!1),_}function Ec(l,r,s){const{min:h,max:c}=l,f=gi(r,(c-h)/2),d=(_,y)=>s&&_===0?0:_+y;return{min:d(h,-Math.abs(f)),max:d(c,f)}}function Rn(l,r){return Object.assign(Object.create(l),r)}const Tc=["left","top","right","bottom"];function $r(l,r){return l.filter(s=>s.pos===r)}function wc(l,r){return l.filter(s=>Tc.indexOf(s.pos)===-1&&s.box.axis===r)}function Kr(l,r){return l.sort((s,h)=>{const c=r?h:s,f=r?s:h;return c.weight===f.weight?c.index-f.index:c.weight-f.weight})}function Pg(l){const r=[];let s,h,c,f,d,_;for(s=0,h=(l||[]).length;s<h;++s)c=l[s],{position:f,options:{stack:d,stackWeight:_=1}}=c,r.push({index:s,box:c,pos:f,horizontal:c.isHorizontal(),weight:c.weight,stack:d&&f+d,stackWeight:_});return r}function Mg(l){const r={};for(const s of l){const{stack:h,pos:c,stackWeight:f}=s;if(!h||!Tc.includes(c))continue;const d=r[h]||(r[h]={count:0,placed:0,weight:0,size:0});d.count++,d.weight+=f}return r}function Lg(l,r){const s=Mg(l),{vBoxMaxWidth:h,hBoxMaxHeight:c}=r;let f,d,_;for(f=0,d=l.length;f<d;++f){_=l[f];const{fullSize:y}=_.box,x=s[_.stack],T=x&&_.stackWeight/x.weight;_.horizontal?(_.width=T?T*h:y&&r.availableWidth,_.height=c):(_.width=h,_.height=T?T*c:y&&r.availableHeight)}return s}function Dg(l){const r=Pg(l),s=Kr(r.filter(x=>x.box.fullSize),!0),h=Kr($r(r,"left"),!0),c=Kr($r(r,"right")),f=Kr($r(r,"top"),!0),d=Kr($r(r,"bottom")),_=wc(r,"x"),y=wc(r,"y");return{fullSize:s,leftAndTop:h.concat(f),rightAndBottom:c.concat(y).concat(d).concat(_),chartArea:$r(r,"chartArea"),vertical:h.concat(c).concat(y),horizontal:f.concat(d).concat(_)}}function Sc(l,r,s,h){return Math.max(l[s],r[s])+Math.max(l[h],r[h])}function Rc(l,r){l.top=Math.max(l.top,r.top),l.left=Math.max(l.left,r.left),l.bottom=Math.max(l.bottom,r.bottom),l.right=Math.max(l.right,r.right)}function kg(l,r,s,h){const{pos:c,box:f}=s,d=l.maxPadding;if(!vt(c)){s.size&&(l[c]-=s.size);const R=h[s.stack]||{size:0,count:1};R.size=Math.max(R.size,s.horizontal?f.height:f.width),s.size=R.size/R.count,l[c]+=s.size}f.getPadding&&Rc(d,f.getPadding());const _=Math.max(0,r.outerWidth-Sc(d,l,"left","right")),y=Math.max(0,r.outerHeight-Sc(d,l,"top","bottom")),x=_!==l.w,T=y!==l.h;return l.w=_,l.h=y,s.horizontal?{same:x,other:T}:{same:T,other:x}}function Fg(l){const r=l.maxPadding;function s(h){const c=Math.max(r[h]-l[h],0);return l[h]+=c,c}l.y+=s("top"),l.x+=s("left"),s("right"),s("bottom")}function Ng(l,r){const s=r.maxPadding;function h(c){const f={left:0,top:0,right:0,bottom:0};return c.forEach(d=>{f[d]=Math.max(r[d],s[d])}),f}return h(l?["left","right"]:["top","bottom"])}function Zr(l,r,s,h){const c=[];let f,d,_,y,x,T;for(f=0,d=l.length,x=0;f<d;++f){_=l[f],y=_.box,y.update(_.width||r.w,_.height||r.h,Ng(_.horizontal,r));const{same:R,other:O}=kg(r,s,_,h);x|=R&&c.length,T=T||O,y.fullSize||c.push(_)}return x&&Zr(c,r,s,h)||T}function Zo(l,r,s,h,c){l.top=s,l.left=r,l.right=r+h,l.bottom=s+c,l.width=h,l.height=c}function Cc(l,r,s,h){const c=s.padding;let{x:f,y:d}=r;for(const _ of l){const y=_.box,x=h[_.stack]||{count:1,placed:0,weight:1},T=_.stackWeight/x.weight||1;if(_.horizontal){const R=r.w*T,O=x.size||y.height;_e(x.start)&&(d=x.start),y.fullSize?Zo(y,c.left,d,s.outerWidth-c.right-c.left,O):Zo(y,r.left+x.placed,d,R,O),x.start=d,x.placed+=R,d=y.bottom}else{const R=r.h*T,O=x.size||y.width;_e(x.start)&&(f=x.start),y.fullSize?Zo(y,f,c.top,O,s.outerHeight-c.bottom-c.top):Zo(y,f,r.top+x.placed,O,R),x.start=f,x.placed+=R,f=y.right}}r.x=f,r.y=d}Et.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}});var ye={addBox(l,r){l.boxes||(l.boxes=[]),r.fullSize=r.fullSize||!1,r.position=r.position||"top",r.weight=r.weight||0,r._layers=r._layers||function(){return[{z:0,draw(s){r.draw(s)}}]},l.boxes.push(r)},removeBox(l,r){const s=l.boxes?l.boxes.indexOf(r):-1;s!==-1&&l.boxes.splice(s,1)},configure(l,r,s){r.fullSize=s.fullSize,r.position=s.position,r.weight=s.weight},update(l,r,s,h){if(!l)return;const c=ve(l.options.layout.padding),f=Math.max(r-c.width,0),d=Math.max(s-c.height,0),_=Dg(l.boxes),y=_.vertical,x=_.horizontal;At(l.boxes,F=>{typeof F.beforeLayout=="function"&&F.beforeLayout()});const T=y.reduce((F,B)=>B.box.options&&B.box.options.display===!1?F:F+1,0)||1,R=Object.freeze({outerWidth:r,outerHeight:s,padding:c,availableWidth:f,availableHeight:d,vBoxMaxWidth:f/2/T,hBoxMaxHeight:d/2}),O=Object.assign({},c);Rc(O,ve(h));const P=Object.assign({maxPadding:O,w:f,h:d,x:c.left,y:c.top},c),D=Lg(y.concat(x),R);Zr(_.fullSize,P,R,D),Zr(y,P,R,D),Zr(x,P,R,D)&&Zr(y,P,R,D),Fg(P),Cc(_.leftAndTop,P,R,D),P.x+=P.w,P.y+=P.h,Cc(_.rightAndBottom,P,R,D),l.chartArea={left:P.left,top:P.top,right:P.left+P.w,bottom:P.top+P.h,height:P.h,width:P.w},At(_.chartArea,F=>{const B=F.box;Object.assign(B,l.chartArea),B.update(P.w,P.h,{left:0,top:0,right:0,bottom:0})})}};function qo(l,r=[""],s=l,h,c=()=>l[0]){_e(h)||(h=Pc("_fallback",l));const f={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:l,_rootScopes:s,_fallback:h,_getTarget:c,override:d=>qo([d,...l],r,s,h)};return new Proxy(f,{deleteProperty(d,_){return delete d[_],delete d._keys,delete l[0][_],!0},get(d,_){return Oc(d,_,()=>Wg(_,r,l,d))},getOwnPropertyDescriptor(d,_){return Reflect.getOwnPropertyDescriptor(d._scopes[0],_)},getPrototypeOf(){return Reflect.getPrototypeOf(l[0])},has(d,_){return Mc(d).includes(_)},ownKeys(d){return Mc(d)},set(d,_,y){const x=d._storage||(d._storage=c());return d[_]=x[_]=y,delete d._keys,!0}})}function wi(l,r,s,h){const c={_cacheable:!1,_proxy:l,_context:r,_subProxy:s,_stack:new Set,_descriptors:Ja(l,h),setContext:f=>wi(l,f,s,h),override:f=>wi(l.override(f),r,s,h)};return new Proxy(c,{deleteProperty(f,d){return delete f[d],delete l[d],!0},get(f,d,_){return Oc(f,d,()=>Gg(f,d,_))},getOwnPropertyDescriptor(f,d){return f._descriptors.allKeys?Reflect.has(l,d)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(l,d)},getPrototypeOf(){return Reflect.getPrototypeOf(l)},has(f,d){return Reflect.has(l,d)},ownKeys(){return Reflect.ownKeys(l)},set(f,d,_){return l[d]=_,delete f[d],!0}})}function Ja(l,r={scriptable:!0,indexable:!0}){const{_scriptable:s=r.scriptable,_indexable:h=r.indexable,_allKeys:c=r.allKeys}=l;return{allKeys:c,scriptable:s,indexable:h,isScriptable:He(s)?s:()=>s,isIndexable:He(h)?h:()=>h}}const Bg=(l,r)=>l?l+yi(r):r,Qa=(l,r)=>vt(r)&&l!=="adapters"&&(Object.getPrototypeOf(r)===null||r.constructor===Object);function Oc(l,r,s){if(Object.prototype.hasOwnProperty.call(l,r))return l[r];const h=s();return l[r]=h,h}function Gg(l,r,s){const{_proxy:h,_context:c,_subProxy:f,_descriptors:d}=l;let _=h[r];return He(_)&&d.isScriptable(r)&&(_=zg(r,_,l,s)),Dt(_)&&_.length&&(_=Ug(r,_,l,d.isIndexable)),Qa(r,_)&&(_=wi(_,c,f&&f[r],d)),_}function zg(l,r,s,h){const{_proxy:c,_context:f,_subProxy:d,_stack:_}=s;if(_.has(l))throw new Error("Recursion detected: "+Array.from(_).join("->")+"->"+l);return _.add(l),r=r(f,d||h),_.delete(l),Qa(l,r)&&(r=tl(c._scopes,c,l,r)),r}function Ug(l,r,s,h){const{_proxy:c,_context:f,_subProxy:d,_descriptors:_}=s;if(_e(f.index)&&h(l))r=r[f.index%r.length];else if(vt(r[0])){const y=r,x=c._scopes.filter(T=>T!==y);r=[];for(const T of y){const R=tl(x,c,l,T);r.push(wi(R,f,d&&d[l],_))}}return r}function Ic(l,r,s){return He(l)?l(r,s):l}const Vg=(l,r)=>l===!0?r:typeof l=="string"?Qe(r,l):void 0;function Xg(l,r,s,h,c){for(const f of r){const d=Vg(s,f);if(d){l.add(d);const _=Ic(d._fallback,s,c);if(_e(_)&&_!==s&&_!==h)return _}else if(d===!1&&_e(h)&&s!==h)return null}return!1}function tl(l,r,s,h){const c=r._rootScopes,f=Ic(r._fallback,s,h),d=[...l,...c],_=new Set;_.add(h);let y=Ac(_,d,s,f||s,h);return y===null||_e(f)&&f!==s&&(y=Ac(_,d,f,y,h),y===null)?!1:qo(Array.from(_),[""],c,f,()=>jg(r,s,h))}function Ac(l,r,s,h,c){for(;s;)s=Xg(l,r,s,h,c);return s}function jg(l,r,s){const h=l._getTarget();r in h||(h[r]={});const c=h[r];return Dt(c)&&vt(s)?s:c}function Wg(l,r,s,h){let c;for(const f of r)if(c=Pc(Bg(f,l),s),_e(c))return Qa(l,c)?tl(s,h,l,c):c}function Pc(l,r){for(const s of r){if(!s)continue;const h=s[l];if(_e(h))return h}}function Mc(l){let r=l._keys;return r||(r=l._keys=Hg(l._scopes)),r}function Hg(l){const r=new Set;for(const s of l)for(const h of Object.keys(s).filter(c=>!c.startsWith("_")))r.add(h);return Array.from(r)}const Yg=Number.EPSILON||1e-14,er=(l,r)=>r<l.length&&!l[r].skip&&l[r],Lc=l=>l==="x"?"y":"x";function Dc(l,r,s,h){const c=l.skip?r:l,f=r,d=s.skip?r:s,_=jo(f,c),y=jo(d,f);let x=_/(_+y),T=y/(_+y);x=isNaN(x)?0:x,T=isNaN(T)?0:T;const R=h*x,O=h*T;return{previous:{x:f.x-R*(d.x-c.x),y:f.y-R*(d.y-c.y)},next:{x:f.x+O*(d.x-c.x),y:f.y+O*(d.y-c.y)}}}function $g(l,r,s){const h=l.length;let c,f,d,_,y,x=er(l,0);for(let T=0;T<h-1;++T)if(y=x,x=er(l,T+1),!(!y||!x)){if(Ji(r[T],0,Yg)){s[T]=s[T+1]=0;continue}c=s[T]/r[T],f=s[T+1]/r[T],_=Math.pow(c,2)+Math.pow(f,2),!(_<=9)&&(d=3/Math.sqrt(_),s[T]=c*d*r[T],s[T+1]=f*d*r[T])}}function Kg(l,r,s="x"){const h=Lc(s),c=l.length;let f,d,_,y=er(l,0);for(let x=0;x<c;++x){if(d=_,_=y,y=er(l,x+1),!_)continue;const T=_[s],R=_[h];d&&(f=(T-d[s])/3,_[`cp1${s}`]=T-f,_[`cp1${h}`]=R-f*r[x]),y&&(f=(y[s]-T)/3,_[`cp2${s}`]=T+f,_[`cp2${h}`]=R+f*r[x])}}function kc(l,r="x"){const s=Lc(r),h=l.length,c=Array(h).fill(0),f=Array(h);let d,_,y,x=er(l,0);for(d=0;d<h;++d)if(_=y,y=x,x=er(l,d+1),!!y){if(x){const T=x[r]-y[r];c[d]=T!==0?(x[s]-y[s])/T:0}f[d]=_?x?Ae(c[d-1])!==Ae(c[d])?0:(c[d-1]+c[d])/2:c[d-1]:c[d]}$g(l,c,f),Kg(l,f,r)}function Jo(l,r,s){return Math.max(Math.min(l,s),r)}function Zg(l,r){let s,h,c,f,d,_=jn(l[0],r);for(s=0,h=l.length;s<h;++s)d=f,f=_,_=s<h-1&&jn(l[s+1],r),f&&(c=l[s],d&&(c.cp1x=Jo(c.cp1x,r.left,r.right),c.cp1y=Jo(c.cp1y,r.top,r.bottom)),_&&(c.cp2x=Jo(c.cp2x,r.left,r.right),c.cp2y=Jo(c.cp2y,r.top,r.bottom)))}function Fc(l,r,s,h,c){let f,d,_,y;if(r.spanGaps&&(l=l.filter(x=>!x.skip)),r.cubicInterpolationMode==="monotone")kc(l,c);else{let x=h?l[l.length-1]:l[0];for(f=0,d=l.length;f<d;++f)_=l[f],y=Dc(x,_,l[Math.min(f+1,d-(h?0:1))%d],r.tension),_.cp1x=y.previous.x,_.cp1y=y.previous.y,_.cp2x=y.next.x,_.cp2y=y.next.y,x=_}r.capBezierPoints&&Zg(l,s)}const Qo=l=>l===0||l===1,Nc=(l,r,s)=>-(Math.pow(2,10*(l-=1))*Math.sin((l-r)*Pt/s)),Bc=(l,r,s)=>Math.pow(2,-10*l)*Math.sin((l-r)*Pt/s)+1,nr={linear:l=>l,easeInQuad:l=>l*l,easeOutQuad:l=>-l*(l-2),easeInOutQuad:l=>(l/=.5)<1?.5*l*l:-.5*(--l*(l-2)-1),easeInCubic:l=>l*l*l,easeOutCubic:l=>(l-=1)*l*l+1,easeInOutCubic:l=>(l/=.5)<1?.5*l*l*l:.5*((l-=2)*l*l+2),easeInQuart:l=>l*l*l*l,easeOutQuart:l=>-((l-=1)*l*l*l-1),easeInOutQuart:l=>(l/=.5)<1?.5*l*l*l*l:-.5*((l-=2)*l*l*l-2),easeInQuint:l=>l*l*l*l*l,easeOutQuint:l=>(l-=1)*l*l*l*l+1,easeInOutQuint:l=>(l/=.5)<1?.5*l*l*l*l*l:.5*((l-=2)*l*l*l*l+2),easeInSine:l=>-Math.cos(l*bt)+1,easeOutSine:l=>Math.sin(l*bt),easeInOutSine:l=>-.5*(Math.cos(Nt*l)-1),easeInExpo:l=>l===0?0:Math.pow(2,10*(l-1)),easeOutExpo:l=>l===1?1:-Math.pow(2,-10*l)+1,easeInOutExpo:l=>Qo(l)?l:l<.5?.5*Math.pow(2,10*(l*2-1)):.5*(-Math.pow(2,-10*(l*2-1))+2),easeInCirc:l=>l>=1?l:-(Math.sqrt(1-l*l)-1),easeOutCirc:l=>Math.sqrt(1-(l-=1)*l),easeInOutCirc:l=>(l/=.5)<1?-.5*(Math.sqrt(1-l*l)-1):.5*(Math.sqrt(1-(l-=2)*l)+1),easeInElastic:l=>Qo(l)?l:Nc(l,.075,.3),easeOutElastic:l=>Qo(l)?l:Bc(l,.075,.3),easeInOutElastic(l){return Qo(l)?l:l<.5?.5*Nc(l*2,.1125,.45):.5+.5*Bc(l*2-1,.1125,.45)},easeInBack(l){return l*l*((1.70158+1)*l-1.70158)},easeOutBack(l){return(l-=1)*l*((1.70158+1)*l+1.70158)+1},easeInOutBack(l){let r=1.70158;return(l/=.5)<1?.5*(l*l*(((r*=1.525)+1)*l-r)):.5*((l-=2)*l*(((r*=1.525)+1)*l+r)+2)},easeInBounce:l=>1-nr.easeOutBounce(1-l),easeOutBounce(l){return l<1/2.75?7.5625*l*l:l<2/2.75?7.5625*(l-=1.5/2.75)*l+.75:l<2.5/2.75?7.5625*(l-=2.25/2.75)*l+.9375:7.5625*(l-=2.625/2.75)*l+.984375},easeInOutBounce:l=>l<.5?nr.easeInBounce(l*2)*.5:nr.easeOutBounce(l*2-1)*.5+.5};function Hn(l,r,s,h){return{x:l.x+s*(r.x-l.x),y:l.y+s*(r.y-l.y)}}function Gc(l,r,s,h){return{x:l.x+s*(r.x-l.x),y:h==="middle"?s<.5?l.y:r.y:h==="after"?s<1?l.y:r.y:s>0?r.y:l.y}}function zc(l,r,s,h){const c={x:l.cp2x,y:l.cp2y},f={x:r.cp1x,y:r.cp1y},d=Hn(l,c,s),_=Hn(c,f,s),y=Hn(f,r,s),x=Hn(d,_,s),T=Hn(_,y,s);return Hn(x,T,s)}const Uc=new Map;function qg(l,r){r=r||{};const s=l+JSON.stringify(r);let h=Uc.get(s);return h||(h=new Intl.NumberFormat(l,r),Uc.set(s,h)),h}function ir(l,r,s){return qg(r,s).format(l)}const Jg=function(l,r){return{x(s){return l+l+r-s},setWidth(s){r=s},textAlign(s){return s==="center"?s:s==="right"?"left":"right"},xPlus(s,h){return s-h},leftForLtr(s,h){return s-h}}},Qg=function(){return{x(l){return l},setWidth(l){},textAlign(l){return l},xPlus(l,r){return l+r},leftForLtr(l,r){return l}}};function Si(l,r,s){return l?Jg(r,s):Qg()}function el(l,r){let s,h;(r==="ltr"||r==="rtl")&&(s=l.canvas.style,h=[s.getPropertyValue("direction"),s.getPropertyPriority("direction")],s.setProperty("direction",r,"important"),l.prevTextDirection=h)}function nl(l,r){r!==void 0&&(delete l.prevTextDirection,l.canvas.style.setProperty("direction",r[0],r[1]))}function Vc(l){return l==="angle"?{between:Qi,compare:sc,normalize:Pe}:{between:ln,compare:(r,s)=>r-s,normalize:r=>r}}function Xc({start:l,end:r,count:s,loop:h,style:c}){return{start:l%s,end:r%s,loop:h&&(r-l+1)%s===0,style:c}}function t_(l,r,s){const{property:h,start:c,end:f}=s,{between:d,normalize:_}=Vc(h),y=r.length;let{start:x,end:T,loop:R}=l,O,P;if(R){for(x+=y,T+=y,O=0,P=y;O<P&&d(_(r[x%y][h]),c,f);++O)x--,T--;x%=y,T%=y}return T<x&&(T+=y),{start:x,end:T,loop:R,style:l.style}}function il(l,r,s){if(!s)return[l];const{property:h,start:c,end:f}=s,d=r.length,{compare:_,between:y,normalize:x}=Vc(h),{start:T,end:R,loop:O,style:P}=t_(l,r,s),D=[];let F=!1,B=null,U,j,Z;const $=()=>y(c,Z,U)&&_(c,Z)!==0,H=()=>_(f,U)===0||y(f,Z,U),rt=()=>F||$(),et=()=>!F||H();for(let ct=T,lt=T;ct<=R;++ct)j=r[ct%d],!j.skip&&(U=x(j[h]),U!==Z&&(F=y(U,c,f),B===null&&rt()&&(B=_(U,c)===0?ct:lt),B!==null&&et()&&(D.push(Xc({start:B,end:ct,loop:O,count:d,style:P})),B=null),lt=ct,Z=U));return B!==null&&D.push(Xc({start:B,end:R,loop:O,count:d,style:P})),D}function rl(l,r){const s=[],h=l.segments;for(let c=0;c<h.length;c++){const f=il(h[c],l.points,r);f.length&&s.push(...f)}return s}function e_(l,r,s,h){let c=0,f=r-1;if(s&&!h)for(;c<r&&!l[c].skip;)c++;for(;c<r&&l[c].skip;)c++;for(c%=r,s&&(f+=c);f>c&&l[f%r].skip;)f--;return f%=r,{start:c,end:f}}function n_(l,r,s,h){const c=l.length,f=[];let d=r,_=l[r],y;for(y=r+1;y<=s;++y){const x=l[y%c];x.skip||x.stop?_.skip||(h=!1,f.push({start:r%c,end:(y-1)%c,loop:h}),r=d=x.stop?y:null):(d=y,_.skip&&(r=y)),_=x}return d!==null&&f.push({start:r%c,end:d%c,loop:h}),f}function jc(l,r){const s=l.points,h=l.options.spanGaps,c=s.length;if(!c)return[];const f=!!l._loop,{start:d,end:_}=e_(s,c,f,h);if(h===!0)return Wc(l,[{start:d,end:_,loop:f}],s,r);const y=_<d?_+c:_,x=!!l._fullLoop&&d===0&&_===c-1;return Wc(l,n_(s,d,y,x),s,r)}function Wc(l,r,s,h){return!h||!h.setContext||!s?r:i_(l,r,s,h)}function i_(l,r,s,h){const c=l._chart.getContext(),f=Hc(l.options),{_datasetIndex:d,options:{spanGaps:_}}=l,y=s.length,x=[];let T=f,R=r[0].start,O=R;function P(D,F,B,U){const j=_?-1:1;if(D!==F){for(D+=y;s[D%y].skip;)D-=j;for(;s[F%y].skip;)F+=j;D%y!==F%y&&(x.push({start:D%y,end:F%y,loop:B,style:U}),T=U,R=F%y)}}for(const D of r){R=_?R:D.start;let F=s[R%y],B;for(O=R+1;O<=D.end;O++){const U=s[O%y];B=Hc(h.setContext(Rn(c,{type:"segment",p0:F,p1:U,p0DataIndex:(O-1)%y,p1DataIndex:O%y,datasetIndex:d}))),r_(B,T)&&P(R,O-1,D.loop,T),F=U,T=B}R<O-1&&P(R,O-1,D.loop,T)}return x}function Hc(l){return{backgroundColor:l.backgroundColor,borderCapStyle:l.borderCapStyle,borderDash:l.borderDash,borderDashOffset:l.borderDashOffset,borderJoinStyle:l.borderJoinStyle,borderWidth:l.borderWidth,borderColor:l.borderColor}}function r_(l,r){return r&&JSON.stringify(l)!==JSON.stringify(r)}var o_=Object.freeze({__proto__:null,easingEffects:nr,color:di,getHoverColor:pi,noop:Te,uid:$i,isNullOrUndef:It,isArray:Dt,isObject:vt,isFinite:jt,finiteOrDefault:we,valueOrDefault:gt,toPercentage:Ki,toDimension:gi,callback:kt,each:At,_elementsEqual:_i,clone:Se,_merger:vi,merge:sn,mergeIf:Je,_mergerIf:zr,_deprecated:Uo,resolveObjectKey:Qe,_capitalize:yi,defined:_e,isFunction:He,setsEqual:mi,_isClickEvent:Un,toFontString:lc,_measureText:Vr,_longestText:hc,_alignPixel:Xn,clearCanvas:za,drawPoint:Xr,_isPointInArea:jn,clipArea:jr,unclipArea:Wr,_steppedLineTo:cc,_bezierCurveTo:uc,renderText:Wn,addRoundedRectPath:Hr,_lookup:Wo,_lookupByKey:hn,_rlookupByKey:fc,_filterBetween:dc,listenArrayEvents:gc,unlistenArrayEvents:Ua,_arrayUnique:Va,_createResolver:qo,_attachContext:wi,_descriptors:Ja,splineCurve:Dc,splineCurveMonotone:kc,_updateBezierControlPoints:Fc,_isDomSupported:Xa,_getParentNode:Ho,getStyle:_c,getRelativePosition:ja,getMaximumSize:vc,retinaScale:Ha,supportsEventListenerOptions:yc,readUsedSize:Ya,fontString:t,requestAnimFrame:n,throttled:i,debounce:a,_toLeftRightCenter:u,_alignStartEnd:p,_textX:g,_pointInLine:Hn,_steppedInterpolation:Gc,_bezierInterpolation:zc,formatNumber:ir,toLineHeight:bc,_readValueToProps:Ko,toTRBL:qa,toTRBLCorners:Ti,toPadding:ve,toFont:he,resolve:tr,_addGrace:Ec,createContext:Rn,PI:Nt,TAU:Pt,PITAU:tn,INFINITY:an,RAD_PER_DEG:xi,HALF_PI:bt,QUARTER_PI:fe,TWO_THIRDS_PI:bi,log10:Re,sign:Ae,niceNum:Fa,_factorize:rc,isNumber:qi,almostEquals:Ji,almostWhole:oc,_setMinAndMaxByKey:Na,toRadians:Ye,toDegrees:Xo,_decimalPlaces:Ba,getAngleFromPoint:Ga,distanceBetweenPoints:jo,_angleDiff:sc,_normalizeAngle:Pe,_angleBetween:Qi,_limitValue:de,_int16Range:ac,_isBetween:ln,getRtlAdapter:Si,overrideTextDirection:el,restoreTextDirection:nl,_boundSegment:il,_boundSegments:rl,_computeSegments:jc});class ol{acquireContext(r,s){}releaseContext(r){return!1}addEventListener(r,s,h){}removeEventListener(r,s,h){}getDevicePixelRatio(){return 1}getMaximumSize(r,s,h,c){return s=Math.max(0,s||r.width),h=h||r.height,{width:s,height:Math.max(0,c?Math.floor(s/c):h)}}isAttached(r){return!0}updateConfig(r){}}class Yc extends ol{acquireContext(r){return r&&r.getContext&&r.getContext("2d")||null}updateConfig(r){r.options.animation=!1}}const ts="$chartjs",s_={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},$c=l=>l===null||l==="";function a_(l,r){const s=l.style,h=l.getAttribute("height"),c=l.getAttribute("width");if(l[ts]={initial:{height:h,width:c,style:{display:s.display,height:s.height,width:s.width}}},s.display=s.display||"block",s.boxSizing=s.boxSizing||"border-box",$c(c)){const f=Ya(l,"width");f!==void 0&&(l.width=f)}if($c(h))if(l.style.height==="")l.height=l.width/(r||2);else{const f=Ya(l,"height");f!==void 0&&(l.height=f)}return l}const Kc=yc?{passive:!0}:!1;function l_(l,r,s){l.addEventListener(r,s,Kc)}function h_(l,r,s){l.canvas.removeEventListener(r,s,Kc)}function c_(l,r){const s=s_[l.type]||l.type,{x:h,y:c}=ja(l,r);return{type:s,chart:r,native:l,x:h!==void 0?h:null,y:c!==void 0?c:null}}function es(l,r){for(const s of l)if(s===r||s.contains(r))return!0}function u_(l,r,s){const h=l.canvas,c=new MutationObserver(f=>{let d=!1;for(const _ of f)d=d||es(_.addedNodes,h),d=d&&!es(_.removedNodes,h);d&&s()});return c.observe(document,{childList:!0,subtree:!0}),c}function f_(l,r,s){const h=l.canvas,c=new MutationObserver(f=>{let d=!1;for(const _ of f)d=d||es(_.removedNodes,h),d=d&&!es(_.addedNodes,h);d&&s()});return c.observe(document,{childList:!0,subtree:!0}),c}const qr=new Map;let Zc=0;function qc(){const l=window.devicePixelRatio;l!==Zc&&(Zc=l,qr.forEach((r,s)=>{s.currentDevicePixelRatio!==l&&r()}))}function d_(l,r){qr.size||window.addEventListener("resize",qc),qr.set(l,r)}function p_(l){qr.delete(l),qr.size||window.removeEventListener("resize",qc)}function g_(l,r,s){const h=l.canvas,c=h&&Ho(h);if(!c)return;const f=i((_,y)=>{const x=c.clientWidth;s(_,y),x<c.clientWidth&&s()},window),d=new ResizeObserver(_=>{const y=_[0],x=y.contentRect.width,T=y.contentRect.height;x===0&&T===0||f(x,T)});return d.observe(c),d_(l,f),d}function sl(l,r,s){s&&s.disconnect(),r==="resize"&&p_(l)}function __(l,r,s){const h=l.canvas,c=i(f=>{l.ctx!==null&&s(c_(f,l))},l,f=>{const d=f[0];return[d,d.offsetX,d.offsetY]});return l_(h,r,c),c}class Jc extends ol{acquireContext(r,s){const h=r&&r.getContext&&r.getContext("2d");return h&&h.canvas===r?(a_(r,s),h):null}releaseContext(r){const s=r.canvas;if(!s[ts])return!1;const h=s[ts].initial;["height","width"].forEach(f=>{const d=h[f];It(d)?s.removeAttribute(f):s.setAttribute(f,d)});const c=h.style||{};return Object.keys(c).forEach(f=>{s.style[f]=c[f]}),s.width=s.width,delete s[ts],!0}addEventListener(r,s,h){this.removeEventListener(r,s);const c=r.$proxies||(r.$proxies={}),d={attach:u_,detach:f_,resize:g_}[s]||__;c[s]=d(r,s,h)}removeEventListener(r,s){const h=r.$proxies||(r.$proxies={}),c=h[s];if(!c)return;({attach:sl,detach:sl,resize:sl}[s]||h_)(r,s,c),h[s]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(r,s,h,c){return vc(r,s,h,c)}isAttached(r){const s=Ho(r);return!!(s&&s.isConnected)}}function Qc(l){return!Xa()||typeof OffscreenCanvas!="undefined"&&l instanceof OffscreenCanvas?Yc:Jc}var tu=Object.freeze({__proto__:null,_detectPlatform:Qc,BasePlatform:ol,BasicPlatform:Yc,DomPlatform:Jc});const eu="transparent",v_={boolean(l,r,s){return s>.5?r:l},color(l,r,s){const h=di(l||eu),c=h.valid&&di(r||eu);return c&&c.valid?c.mix(h,s).hexString():r},number(l,r,s){return l+(r-l)*s}};class nu{constructor(r,s,h,c){const f=s[h];c=tr([r.to,c,f,r.from]);const d=tr([r.from,f,c]);this._active=!0,this._fn=r.fn||v_[r.type||typeof d],this._easing=nr[r.easing]||nr.linear,this._start=Math.floor(Date.now()+(r.delay||0)),this._duration=this._total=Math.floor(r.duration),this._loop=!!r.loop,this._target=s,this._prop=h,this._from=d,this._to=c,this._promises=void 0}active(){return this._active}update(r,s,h){if(this._active){this._notify(!1);const c=this._target[this._prop],f=h-this._start,d=this._duration-f;this._start=h,this._duration=Math.floor(Math.max(d,r.duration)),this._total+=f,this._loop=!!r.loop,this._to=tr([r.to,s,c,r.from]),this._from=tr([r.from,c,s])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(r){const s=r-this._start,h=this._duration,c=this._prop,f=this._from,d=this._loop,_=this._to;let y;if(this._active=f!==_&&(d||s<h),!this._active){this._target[c]=_,this._notify(!0);return}if(s<0){this._target[c]=f;return}y=s/h%2,y=d&&y>1?2-y:y,y=this._easing(Math.min(1,Math.max(0,y))),this._target[c]=this._fn(f,_,y)}wait(){const r=this._promises||(this._promises=[]);return new Promise((s,h)=>{r.push({res:s,rej:h})})}_notify(r){const s=r?"res":"rej",h=this._promises||[];for(let c=0;c<h.length;c++)h[c][s]()}}const y_=["x","y","borderWidth","radius","tension"],m_=["color","borderColor","backgroundColor"];Et.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0});const x_=Object.keys(Et.animation);Et.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:l=>l!=="onProgress"&&l!=="onComplete"&&l!=="fn"}),Et.set("animations",{colors:{type:"color",properties:m_},numbers:{type:"number",properties:y_}}),Et.describe("animations",{_fallback:"animation"}),Et.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:l=>l|0}}}});class al{constructor(r,s){this._chart=r,this._properties=new Map,this.configure(s)}configure(r){if(!vt(r))return;const s=this._properties;Object.getOwnPropertyNames(r).forEach(h=>{const c=r[h];if(!vt(c))return;const f={};for(const d of x_)f[d]=c[d];(Dt(c.properties)&&c.properties||[h]).forEach(d=>{(d===h||!s.has(d))&&s.set(d,f)})})}_animateOptions(r,s){const h=s.options,c=E_(r,h);if(!c)return[];const f=this._createAnimations(c,h);return h.$shared&&b_(r.options.$animations,h).then(()=>{r.options=h},()=>{}),f}_createAnimations(r,s){const h=this._properties,c=[],f=r.$animations||(r.$animations={}),d=Object.keys(s),_=Date.now();let y;for(y=d.length-1;y>=0;--y){const x=d[y];if(x.charAt(0)==="$")continue;if(x==="options"){c.push(...this._animateOptions(r,s));continue}const T=s[x];let R=f[x];const O=h.get(x);if(R)if(O&&R.active()){R.update(O,T,_);continue}else R.cancel();if(!O||!O.duration){r[x]=T;continue}f[x]=R=new nu(O,r,x,T),c.push(R)}return c}update(r,s){if(this._properties.size===0){Object.assign(r,s);return}const h=this._createAnimations(r,s);if(h.length)return m.add(this._chart,h),!0}}function b_(l,r){const s=[],h=Object.keys(r);for(let c=0;c<h.length;c++){const f=l[h[c]];f&&f.active()&&s.push(f.wait())}return Promise.all(s)}function E_(l,r){if(!r)return;let s=l.options;if(!s){l.options=r;return}return s.$shared&&(l.options=s=Object.assign({},s,{$shared:!1,$animations:{}})),s}function iu(l,r){const s=l&&l.options||{},h=s.reverse,c=s.min===void 0?r:0,f=s.max===void 0?r:0;return{start:h?f:c,end:h?c:f}}function T_(l,r,s){if(s===!1)return!1;const h=iu(l,s),c=iu(r,s);return{top:c.end,right:h.end,bottom:c.start,left:h.start}}function w_(l){let r,s,h,c;return vt(l)?(r=l.top,s=l.right,h=l.bottom,c=l.left):r=s=h=c=l,{top:r,right:s,bottom:h,left:c,disabled:l===!1}}function ru(l,r){const s=[],h=l._getSortedDatasetMetas(r);let c,f;for(c=0,f=h.length;c<f;++c)s.push(h[c].index);return s}function ou(l,r,s,h={}){const c=l.keys,f=h.mode==="single";let d,_,y,x;if(r!==null){for(d=0,_=c.length;d<_;++d){if(y=+c[d],y===s){if(h.all)continue;break}x=l.values[y],jt(x)&&(f||r===0||Ae(r)===Ae(x))&&(r+=x)}return r}}function S_(l){const r=Object.keys(l),s=new Array(r.length);let h,c,f;for(h=0,c=r.length;h<c;++h)f=r[h],s[h]={x:f,y:l[f]};return s}function su(l,r){const s=l&&l.options.stacked;return s||s===void 0&&r.stack!==void 0}function R_(l,r,s){return`${l.id}.${r.id}.${s.stack||s.type}`}function C_(l){const{min:r,max:s,minDefined:h,maxDefined:c}=l.getUserBounds();return{min:h?r:Number.NEGATIVE_INFINITY,max:c?s:Number.POSITIVE_INFINITY}}function O_(l,r,s){const h=l[r]||(l[r]={});return h[s]||(h[s]={})}function au(l,r,s,h){for(const c of r.getMatchingVisibleMetas(h).reverse()){const f=l[c.index];if(s&&f>0||!s&&f<0)return c.index}return null}function lu(l,r){const{chart:s,_cachedMeta:h}=l,c=s._stacks||(s._stacks={}),{iScale:f,vScale:d,index:_}=h,y=f.axis,x=d.axis,T=R_(f,d,h),R=r.length;let O;for(let P=0;P<R;++P){const D=r[P],{[y]:F,[x]:B}=D,U=D._stacks||(D._stacks={});O=U[x]=O_(c,T,F),O[_]=B,O._top=au(O,d,!0,h.type),O._bottom=au(O,d,!1,h.type)}}function ll(l,r){const s=l.scales;return Object.keys(s).filter(h=>s[h].axis===r).shift()}function I_(l,r){return Rn(l,{active:!1,dataset:void 0,datasetIndex:r,index:r,mode:"default",type:"dataset"})}function A_(l,r,s){return Rn(l,{active:!1,dataIndex:r,parsed:void 0,raw:void 0,element:s,index:r,mode:"default",type:"data"})}function Jr(l,r){const s=l.controller.index,h=l.vScale&&l.vScale.axis;if(!!h){r=r||l._parsed;for(const c of r){const f=c._stacks;if(!f||f[h]===void 0||f[h][s]===void 0)return;delete f[h][s]}}}const hl=l=>l==="reset"||l==="none",hu=(l,r)=>r?l:Object.assign({},l),P_=(l,r,s)=>l&&!r.hidden&&r._stacked&&{keys:ru(s,!0),values:null};class en{constructor(r,s){this.chart=r,this._ctx=r.ctx,this.index=s,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.$context=void 0,this._syncList=[],this.initialize()}initialize(){const r=this._cachedMeta;this.configure(),this.linkScales(),r._stacked=su(r.vScale,r),this.addElements()}updateIndex(r){this.index!==r&&Jr(this._cachedMeta),this.index=r}linkScales(){const r=this.chart,s=this._cachedMeta,h=this.getDataset(),c=(R,O,P,D)=>R==="x"?O:R==="r"?D:P,f=s.xAxisID=gt(h.xAxisID,ll(r,"x")),d=s.yAxisID=gt(h.yAxisID,ll(r,"y")),_=s.rAxisID=gt(h.rAxisID,ll(r,"r")),y=s.indexAxis,x=s.iAxisID=c(y,f,d,_),T=s.vAxisID=c(y,d,f,_);s.xScale=this.getScaleForId(f),s.yScale=this.getScaleForId(d),s.rScale=this.getScaleForId(_),s.iScale=this.getScaleForId(x),s.vScale=this.getScaleForId(T)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(r){return this.chart.scales[r]}_getOtherScale(r){const s=this._cachedMeta;return r===s.iScale?s.vScale:s.iScale}reset(){this._update("reset")}_destroy(){const r=this._cachedMeta;this._data&&Ua(this._data,this),r._stacked&&Jr(r)}_dataCheck(){const r=this.getDataset(),s=r.data||(r.data=[]),h=this._data;if(vt(s))this._data=S_(s);else if(h!==s){if(h){Ua(h,this);const c=this._cachedMeta;Jr(c),c._parsed=[]}s&&Object.isExtensible(s)&&gc(s,this),this._syncList=[],this._data=s}}addElements(){const r=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(r.dataset=new this.datasetElementType)}buildOrUpdateElements(r){const s=this._cachedMeta,h=this.getDataset();let c=!1;this._dataCheck();const f=s._stacked;s._stacked=su(s.vScale,s),s.stack!==h.stack&&(c=!0,Jr(s),s.stack=h.stack),this._resyncElements(r),(c||f!==s._stacked)&&lu(this,s._parsed)}configure(){const r=this.chart.config,s=r.datasetScopeKeys(this._type),h=r.getOptionScopes(this.getDataset(),s,!0);this.options=r.createResolver(h,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(r,s){const{_cachedMeta:h,_data:c}=this,{iScale:f,_stacked:d}=h,_=f.axis;let y=r===0&&s===c.length?!0:h._sorted,x=r>0&&h._parsed[r-1],T,R,O;if(this._parsing===!1)h._parsed=c,h._sorted=!0,O=c;else{Dt(c[r])?O=this.parseArrayData(h,c,r,s):vt(c[r])?O=this.parseObjectData(h,c,r,s):O=this.parsePrimitiveData(h,c,r,s);const P=()=>R[_]===null||x&&R[_]<x[_];for(T=0;T<s;++T)h._parsed[T+r]=R=O[T],y&&(P()&&(y=!1),x=R);h._sorted=y}d&&lu(this,O)}parsePrimitiveData(r,s,h,c){const{iScale:f,vScale:d}=r,_=f.axis,y=d.axis,x=f.getLabels(),T=f===d,R=new Array(c);let O,P,D;for(O=0,P=c;O<P;++O)D=O+h,R[O]={[_]:T||f.parse(x[D],D),[y]:d.parse(s[D],D)};return R}parseArrayData(r,s,h,c){const{xScale:f,yScale:d}=r,_=new Array(c);let y,x,T,R;for(y=0,x=c;y<x;++y)T=y+h,R=s[T],_[y]={x:f.parse(R[0],T),y:d.parse(R[1],T)};return _}parseObjectData(r,s,h,c){const{xScale:f,yScale:d}=r,{xAxisKey:_="x",yAxisKey:y="y"}=this._parsing,x=new Array(c);let T,R,O,P;for(T=0,R=c;T<R;++T)O=T+h,P=s[O],x[T]={x:f.parse(Qe(P,_),O),y:d.parse(Qe(P,y),O)};return x}getParsed(r){return this._cachedMeta._parsed[r]}getDataElement(r){return this._cachedMeta.data[r]}applyStack(r,s,h){const c=this.chart,f=this._cachedMeta,d=s[r.axis],_={keys:ru(c,!0),values:s._stacks[r.axis]};return ou(_,d,f.index,{mode:h})}updateRangeFromParsed(r,s,h,c){const f=h[s.axis];let d=f===null?NaN:f;const _=c&&h._stacks[s.axis];c&&_&&(c.values=_,d=ou(c,f,this._cachedMeta.index)),r.min=Math.min(r.min,d),r.max=Math.max(r.max,d)}getMinMax(r,s){const h=this._cachedMeta,c=h._parsed,f=h._sorted&&r===h.iScale,d=c.length,_=this._getOtherScale(r),y=P_(s,h,this.chart),x={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:T,max:R}=C_(_);let O,P;function D(){P=c[O];const F=P[_.axis];return!jt(P[r.axis])||T>F||R<F}for(O=0;O<d&&!(!D()&&(this.updateRangeFromParsed(x,r,P,y),f));++O);if(f){for(O=d-1;O>=0;--O)if(!D()){this.updateRangeFromParsed(x,r,P,y);break}}return x}getAllParsedValues(r){const s=this._cachedMeta._parsed,h=[];let c,f,d;for(c=0,f=s.length;c<f;++c)d=s[c][r.axis],jt(d)&&h.push(d);return h}getMaxOverflow(){return!1}getLabelAndValue(r){const s=this._cachedMeta,h=s.iScale,c=s.vScale,f=this.getParsed(r);return{label:h?""+h.getLabelForValue(f[h.axis]):"",value:c?""+c.getLabelForValue(f[c.axis]):""}}_update(r){const s=this._cachedMeta;this.update(r||"default"),s._clip=w_(gt(this.options.clip,T_(s.xScale,s.yScale,this.getMaxOverflow())))}update(r){}draw(){const r=this._ctx,s=this.chart,h=this._cachedMeta,c=h.data||[],f=s.chartArea,d=[],_=this._drawStart||0,y=this._drawCount||c.length-_,x=this.options.drawActiveElementsOnTop;let T;for(h.dataset&&h.dataset.draw(r,f,_,y),T=_;T<_+y;++T){const R=c[T];R.hidden||(R.active&&x?d.push(R):R.draw(r,f))}for(T=0;T<d.length;++T)d[T].draw(r,f)}getStyle(r,s){const h=s?"active":"default";return r===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(h):this.resolveDataElementOptions(r||0,h)}getContext(r,s,h){const c=this.getDataset();let f;if(r>=0&&r<this._cachedMeta.data.length){const d=this._cachedMeta.data[r];f=d.$context||(d.$context=A_(this.getContext(),r,d)),f.parsed=this.getParsed(r),f.raw=c.data[r],f.index=f.dataIndex=r}else f=this.$context||(this.$context=I_(this.chart.getContext(),this.index)),f.dataset=c,f.index=f.datasetIndex=this.index;return f.active=!!s,f.mode=h,f}resolveDatasetElementOptions(r){return this._resolveElementOptions(this.datasetElementType.id,r)}resolveDataElementOptions(r,s){return this._resolveElementOptions(this.dataElementType.id,s,r)}_resolveElementOptions(r,s="default",h){const c=s==="active",f=this._cachedDataOpts,d=r+"-"+s,_=f[d],y=this.enableOptionSharing&&_e(h);if(_)return hu(_,y);const x=this.chart.config,T=x.datasetElementScopeKeys(this._type,r),R=c?[`${r}Hover`,"hover",r,""]:[r,""],O=x.getOptionScopes(this.getDataset(),T),P=Object.keys(Et.elements[r]),D=()=>this.getContext(h,c),F=x.resolveNamedOptions(O,P,D,R);return F.$shared&&(F.$shared=y,f[d]=Object.freeze(hu(F,y))),F}_resolveAnimations(r,s,h){const c=this.chart,f=this._cachedDataOpts,d=`animation-${s}`,_=f[d];if(_)return _;let y;if(c.options.animation!==!1){const T=this.chart.config,R=T.datasetAnimationScopeKeys(this._type,s),O=T.getOptionScopes(this.getDataset(),R);y=T.createResolver(O,this.getContext(r,h,s))}const x=new al(c,y&&y.animations);return y&&y._cacheable&&(f[d]=Object.freeze(x)),x}getSharedOptions(r){if(!!r.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},r))}includeOptions(r,s){return!s||hl(r)||this.chart._animationsDisabled}updateElement(r,s,h,c){hl(c)?Object.assign(r,h):this._resolveAnimations(s,c).update(r,h)}updateSharedOptions(r,s,h){r&&!hl(s)&&this._resolveAnimations(void 0,s).update(r,h)}_setStyle(r,s,h,c){r.active=c;const f=this.getStyle(s,c);this._resolveAnimations(s,h,c).update(r,{options:!c&&this.getSharedOptions(f)||f})}removeHoverStyle(r,s,h){this._setStyle(r,h,"active",!1)}setHoverStyle(r,s,h){this._setStyle(r,h,"active",!0)}_removeDatasetHoverStyle(){const r=this._cachedMeta.dataset;r&&this._setStyle(r,void 0,"active",!1)}_setDatasetHoverStyle(){const r=this._cachedMeta.dataset;r&&this._setStyle(r,void 0,"active",!0)}_resyncElements(r){const s=this._data,h=this._cachedMeta.data;for(const[_,y,x]of this._syncList)this[_](y,x);this._syncList=[];const c=h.length,f=s.length,d=Math.min(f,c);d&&this.parse(0,d),f>c?this._insertElements(c,f-c,r):f<c&&this._removeElements(f,c-f)}_insertElements(r,s,h=!0){const c=this._cachedMeta,f=c.data,d=r+s;let _;const y=x=>{for(x.length+=s,_=x.length-1;_>=d;_--)x[_]=x[_-s]};for(y(f),_=r;_<d;++_)f[_]=new this.dataElementType;this._parsing&&y(c._parsed),this.parse(r,s),h&&this.updateElements(f,r,s,"reset")}updateElements(r,s,h,c){}_removeElements(r,s){const h=this._cachedMeta;if(this._parsing){const c=h._parsed.splice(r,s);h._stacked&&Jr(h,c)}h.data.splice(r,s)}_sync(r){if(this._parsing)this._syncList.push(r);else{const[s,h,c]=r;this[s](h,c)}this.chart._dataChanges.push([this.index,...r])}_onDataPush(){const r=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-r,r])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(r,s){s&&this._sync(["_removeElements",r,s]);const h=arguments.length-2;h&&this._sync(["_insertElements",r,h])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}en.defaults={},en.prototype.datasetElementType=null,en.prototype.dataElementType=null;class $e{constructor(){this.x=void 0,this.y=void 0,this.active=!1,this.options=void 0,this.$animations=void 0}tooltipPosition(r){const{x:s,y:h}=this.getProps(["x","y"],r);return{x:s,y:h}}hasValue(){return qi(this.x)&&qi(this.y)}getProps(r,s){const h=this.$animations;if(!s||!h)return this;const c={};return r.forEach(f=>{c[f]=h[f]&&h[f].active()?h[f]._to:this[f]}),c}}$e.defaults={},$e.defaultRoutes=void 0;const cu={values(l){return Dt(l)?l:""+l},numeric(l,r,s){if(l===0)return"0";const h=this.chart.options.locale;let c,f=l;if(s.length>1){const x=Math.max(Math.abs(s[0].value),Math.abs(s[s.length-1].value));(x<1e-4||x>1e15)&&(c="scientific"),f=M_(l,s)}const d=Re(Math.abs(f)),_=Math.max(Math.min(-1*Math.floor(d),20),0),y={notation:c,minimumFractionDigits:_,maximumFractionDigits:_};return Object.assign(y,this.options.ticks.format),ir(l,h,y)},logarithmic(l,r,s){if(l===0)return"0";const h=l/Math.pow(10,Math.floor(Re(l)));return h===1||h===2||h===5?cu.numeric.call(this,l,r,s):""}};function M_(l,r){let s=r.length>3?r[2].value-r[1].value:r[1].value-r[0].value;return Math.abs(s)>=1&&l!==Math.floor(l)&&(s=l-Math.floor(l)),s}var Qr={formatters:cu};Et.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",grace:0,grid:{display:!0,lineWidth:1,drawBorder:!0,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(l,r)=>r.lineWidth,tickColor:(l,r)=>r.color,offset:!1,borderDash:[],borderDashOffset:0,borderWidth:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:Qr.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),Et.route("scale.ticks","color","","color"),Et.route("scale.grid","color","","borderColor"),Et.route("scale.grid","borderColor","","borderColor"),Et.route("scale.title","color","","color"),Et.describe("scale",{_fallback:!1,_scriptable:l=>!l.startsWith("before")&&!l.startsWith("after")&&l!=="callback"&&l!=="parser",_indexable:l=>l!=="borderDash"&&l!=="tickBorderDash"}),Et.describe("scales",{_fallback:"scale"}),Et.describe("scale.ticks",{_scriptable:l=>l!=="backdropPadding"&&l!=="callback",_indexable:l=>l!=="backdropPadding"});function L_(l,r){const s=l.options.ticks,h=s.maxTicksLimit||D_(l),c=s.major.enabled?F_(r):[],f=c.length,d=c[0],_=c[f-1],y=[];if(f>h)return N_(r,y,c,f/h),y;const x=k_(c,r,h);if(f>0){let T,R;const O=f>1?Math.round((_-d)/(f-1)):null;for(ns(r,y,x,It(O)?0:d-O,d),T=0,R=f-1;T<R;T++)ns(r,y,x,c[T],c[T+1]);return ns(r,y,x,_,It(O)?r.length:_+O),y}return ns(r,y,x),y}function D_(l){const r=l.options.offset,s=l._tickSize(),h=l._length/s+(r?0:1),c=l._maxLength/s;return Math.floor(Math.min(h,c))}function k_(l,r,s){const h=B_(l),c=r.length/s;if(!h)return Math.max(c,1);const f=rc(h);for(let d=0,_=f.length-1;d<_;d++){const y=f[d];if(y>c)return y}return Math.max(c,1)}function F_(l){const r=[];let s,h;for(s=0,h=l.length;s<h;s++)l[s].major&&r.push(s);return r}function N_(l,r,s,h){let c=0,f=s[0],d;for(h=Math.ceil(h),d=0;d<l.length;d++)d===f&&(r.push(l[d]),c++,f=s[c*h])}function ns(l,r,s,h,c){const f=gt(h,0),d=Math.min(gt(c,l.length),l.length);let _=0,y,x,T;for(s=Math.ceil(s),c&&(y=c-h,s=y/Math.floor(y/s)),T=f;T<0;)_++,T=Math.round(f+_*s);for(x=Math.max(f,0);x<d;x++)x===T&&(r.push(l[x]),_++,T=Math.round(f+_*s))}function B_(l){const r=l.length;let s,h;if(r<2)return!1;for(h=l[0],s=1;s<r;++s)if(l[s]-l[s-1]!==h)return!1;return h}const G_=l=>l==="left"?"right":l==="right"?"left":l,uu=(l,r,s)=>r==="top"||r==="left"?l[r]+s:l[r]-s;function fu(l,r){const s=[],h=l.length/r,c=l.length;let f=0;for(;f<c;f+=h)s.push(l[Math.floor(f)]);return s}function z_(l,r,s){const h=l.ticks.length,c=Math.min(r,h-1),f=l._startPixel,d=l._endPixel,_=1e-6;let y=l.getPixelForTick(c),x;if(!(s&&(h===1?x=Math.max(y-f,d-y):r===0?x=(l.getPixelForTick(1)-y)/2:x=(y-l.getPixelForTick(c-1))/2,y+=c<r?x:-x,y<f-_||y>d+_)))return y}function U_(l,r){At(l,s=>{const h=s.gc,c=h.length/2;let f;if(c>r){for(f=0;f<c;++f)delete s.data[h[f]];h.splice(0,c)}})}function to(l){return l.drawTicks?l.tickLength:0}function du(l,r){if(!l.display)return 0;const s=he(l.font,r),h=ve(l.padding);return(Dt(l.text)?l.text.length:1)*s.lineHeight+h.height}function V_(l,r){return Rn(l,{scale:r,type:"scale"})}function X_(l,r,s){return Rn(l,{tick:s,index:r,type:"tick"})}function j_(l,r,s){let h=u(l);return(s&&r!=="right"||!s&&r==="right")&&(h=G_(h)),h}function W_(l,r,s,h){const{top:c,left:f,bottom:d,right:_,chart:y}=l,{chartArea:x,scales:T}=y;let R=0,O,P,D;const F=d-c,B=_-f;if(l.isHorizontal()){if(P=p(h,f,_),vt(s)){const U=Object.keys(s)[0],j=s[U];D=T[U].getPixelForValue(j)+F-r}else s==="center"?D=(x.bottom+x.top)/2+F-r:D=uu(l,s,r);O=_-f}else{if(vt(s)){const U=Object.keys(s)[0],j=s[U];P=T[U].getPixelForValue(j)-B+r}else s==="center"?P=(x.left+x.right)/2-B+r:P=uu(l,s,r);D=p(h,d,c),R=s==="left"?-bt:bt}return{titleX:P,titleY:D,maxWidth:O,rotation:R}}class Yn extends $e{constructor(r){super();this.id=r.id,this.type=r.type,this.options=void 0,this.ctx=r.ctx,this.chart=r.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(r){this.options=r.setContext(this.getContext()),this.axis=r.axis,this._userMin=this.parse(r.min),this._userMax=this.parse(r.max),this._suggestedMin=this.parse(r.suggestedMin),this._suggestedMax=this.parse(r.suggestedMax)}parse(r,s){return r}getUserBounds(){let{_userMin:r,_userMax:s,_suggestedMin:h,_suggestedMax:c}=this;return r=we(r,Number.POSITIVE_INFINITY),s=we(s,Number.NEGATIVE_INFINITY),h=we(h,Number.POSITIVE_INFINITY),c=we(c,Number.NEGATIVE_INFINITY),{min:we(r,h),max:we(s,c),minDefined:jt(r),maxDefined:jt(s)}}getMinMax(r){let{min:s,max:h,minDefined:c,maxDefined:f}=this.getUserBounds(),d;if(c&&f)return{min:s,max:h};const _=this.getMatchingVisibleMetas();for(let y=0,x=_.length;y<x;++y)d=_[y].controller.getMinMax(this,r),c||(s=Math.min(s,d.min)),f||(h=Math.max(h,d.max));return s=f&&s>h?h:s,h=c&&s>h?s:h,{min:we(s,we(h,s)),max:we(h,we(s,h))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const r=this.chart.data;return this.options.labels||(this.isHorizontal()?r.xLabels:r.yLabels)||r.labels||[]}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){kt(this.options.beforeUpdate,[this])}update(r,s,h){const{beginAtZero:c,grace:f,ticks:d}=this.options,_=d.sampleSize;this.beforeUpdate(),this.maxWidth=r,this.maxHeight=s,this._margins=h=Object.assign({left:0,right:0,top:0,bottom:0},h),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+h.left+h.right:this.height+h.top+h.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=Ec(this,f,c),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const y=_<this.ticks.length;this._convertTicksToLabels(y?fu(this.ticks,_):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),d.display&&(d.autoSkip||d.source==="auto")&&(this.ticks=L_(this,this.ticks),this._labelSizes=null),y&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let r=this.options.reverse,s,h;this.isHorizontal()?(s=this.left,h=this.right):(s=this.top,h=this.bottom,r=!r),this._startPixel=s,this._endPixel=h,this._reversePixels=r,this._length=h-s,this._alignToPixels=this.options.alignToPixels}afterUpdate(){kt(this.options.afterUpdate,[this])}beforeSetDimensions(){kt(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){kt(this.options.afterSetDimensions,[this])}_callHooks(r){this.chart.notifyPlugins(r,this.getContext()),kt(this.options[r],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){kt(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(r){const s=this.options.ticks;let h,c,f;for(h=0,c=r.length;h<c;h++)f=r[h],f.label=kt(s.callback,[f.value,h,r],this)}afterTickToLabelConversion(){kt(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){kt(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const r=this.options,s=r.ticks,h=this.ticks.length,c=s.minRotation||0,f=s.maxRotation;let d=c,_,y,x;if(!this._isVisible()||!s.display||c>=f||h<=1||!this.isHorizontal()){this.labelRotation=c;return}const T=this._getLabelSizes(),R=T.widest.width,O=T.highest.height,P=de(this.chart.width-R,0,this.maxWidth);_=r.offset?this.maxWidth/h:P/(h-1),R+6>_&&(_=P/(h-(r.offset?.5:1)),y=this.maxHeight-to(r.grid)-s.padding-du(r.title,this.chart.options.font),x=Math.sqrt(R*R+O*O),d=Xo(Math.min(Math.asin(de((T.highest.height+6)/_,-1,1)),Math.asin(de(y/x,-1,1))-Math.asin(de(O/x,-1,1)))),d=Math.max(c,Math.min(f,d))),this.labelRotation=d}afterCalculateLabelRotation(){kt(this.options.afterCalculateLabelRotation,[this])}beforeFit(){kt(this.options.beforeFit,[this])}fit(){const r={width:0,height:0},{chart:s,options:{ticks:h,title:c,grid:f}}=this,d=this._isVisible(),_=this.isHorizontal();if(d){const y=du(c,s.options.font);if(_?(r.width=this.maxWidth,r.height=to(f)+y):(r.height=this.maxHeight,r.width=to(f)+y),h.display&&this.ticks.length){const{first:x,last:T,widest:R,highest:O}=this._getLabelSizes(),P=h.padding*2,D=Ye(this.labelRotation),F=Math.cos(D),B=Math.sin(D);if(_){const U=h.mirror?0:B*R.width+F*O.height;r.height=Math.min(this.maxHeight,r.height+U+P)}else{const U=h.mirror?0:F*R.width+B*O.height;r.width=Math.min(this.maxWidth,r.width+U+P)}this._calculatePadding(x,T,B,F)}}this._handleMargins(),_?(this.width=this._length=s.width-this._margins.left-this._margins.right,this.height=r.height):(this.width=r.width,this.height=this._length=s.height-this._margins.top-this._margins.bottom)}_calculatePadding(r,s,h,c){const{ticks:{align:f,padding:d},position:_}=this.options,y=this.labelRotation!==0,x=_!=="top"&&this.axis==="x";if(this.isHorizontal()){const T=this.getPixelForTick(0)-this.left,R=this.right-this.getPixelForTick(this.ticks.length-1);let O=0,P=0;y?x?(O=c*r.width,P=h*s.height):(O=h*r.height,P=c*s.width):f==="start"?P=s.width:f==="end"?O=r.width:(O=r.width/2,P=s.width/2),this.paddingLeft=Math.max((O-T+d)*this.width/(this.width-T),0),this.paddingRight=Math.max((P-R+d)*this.width/(this.width-R),0)}else{let T=s.height/2,R=r.height/2;f==="start"?(T=0,R=r.height):f==="end"&&(T=s.height,R=0),this.paddingTop=T+d,this.paddingBottom=R+d}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){kt(this.options.afterFit,[this])}isHorizontal(){const{axis:r,position:s}=this.options;return s==="top"||s==="bottom"||r==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(r){this.beforeTickToLabelConversion(),this.generateTickLabels(r);let s,h;for(s=0,h=r.length;s<h;s++)It(r[s].label)&&(r.splice(s,1),h--,s--);this.afterTickToLabelConversion()}_getLabelSizes(){let r=this._labelSizes;if(!r){const s=this.options.ticks.sampleSize;let h=this.ticks;s<h.length&&(h=fu(h,s)),this._labelSizes=r=this._computeLabelSizes(h,h.length)}return r}_computeLabelSizes(r,s){const{ctx:h,_longestTextCache:c}=this,f=[],d=[];let _=0,y=0,x,T,R,O,P,D,F,B,U,j,Z;for(x=0;x<s;++x){if(O=r[x].label,P=this._resolveTickFontOptions(x),h.font=D=P.string,F=c[D]=c[D]||{data:{},gc:[]},B=P.lineHeight,U=j=0,!It(O)&&!Dt(O))U=Vr(h,F.data,F.gc,U,O),j=B;else if(Dt(O))for(T=0,R=O.length;T<R;++T)Z=O[T],!It(Z)&&!Dt(Z)&&(U=Vr(h,F.data,F.gc,U,Z),j+=B);f.push(U),d.push(j),_=Math.max(U,_),y=Math.max(j,y)}U_(c,s);const $=f.indexOf(_),H=d.indexOf(y),rt=et=>({width:f[et]||0,height:d[et]||0});return{first:rt(0),last:rt(s-1),widest:rt($),highest:rt(H),widths:f,heights:d}}getLabelForValue(r){return r}getPixelForValue(r,s){return NaN}getValueForPixel(r){}getPixelForTick(r){const s=this.ticks;return r<0||r>s.length-1?null:this.getPixelForValue(s[r].value)}getPixelForDecimal(r){this._reversePixels&&(r=1-r);const s=this._startPixel+r*this._length;return ac(this._alignToPixels?Xn(this.chart,s,0):s)}getDecimalForPixel(r){const s=(r-this._startPixel)/this._length;return this._reversePixels?1-s:s}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:r,max:s}=this;return r<0&&s<0?s:r>0&&s>0?r:0}getContext(r){const s=this.ticks||[];if(r>=0&&r<s.length){const h=s[r];return h.$context||(h.$context=X_(this.getContext(),r,h))}return this.$context||(this.$context=V_(this.chart.getContext(),this))}_tickSize(){const r=this.options.ticks,s=Ye(this.labelRotation),h=Math.abs(Math.cos(s)),c=Math.abs(Math.sin(s)),f=this._getLabelSizes(),d=r.autoSkipPadding||0,_=f?f.widest.width+d:0,y=f?f.highest.height+d:0;return this.isHorizontal()?y*h>_*c?_/h:y/c:y*c<_*h?y/h:_/c}_isVisible(){const r=this.options.display;return r!=="auto"?!!r:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(r){const s=this.axis,h=this.chart,c=this.options,{grid:f,position:d}=c,_=f.offset,y=this.isHorizontal(),T=this.ticks.length+(_?1:0),R=to(f),O=[],P=f.setContext(this.getContext()),D=P.drawBorder?P.borderWidth:0,F=D/2,B=function(Tt){return Xn(h,Tt,D)};let U,j,Z,$,H,rt,et,ct,lt,zt,Ft,Mt;if(d==="top")U=B(this.bottom),rt=this.bottom-R,ct=U-F,zt=B(r.top)+F,Mt=r.bottom;else if(d==="bottom")U=B(this.top),zt=r.top,Mt=B(r.bottom)-F,rt=U+F,ct=this.top+R;else if(d==="left")U=B(this.right),H=this.right-R,et=U-F,lt=B(r.left)+F,Ft=r.right;else if(d==="right")U=B(this.left),lt=r.left,Ft=B(r.right)-F,H=U+F,et=this.left+R;else if(s==="x"){if(d==="center")U=B((r.top+r.bottom)/2+.5);else if(vt(d)){const Tt=Object.keys(d)[0],Vt=d[Tt];U=B(this.chart.scales[Tt].getPixelForValue(Vt))}zt=r.top,Mt=r.bottom,rt=U+F,ct=rt+R}else if(s==="y"){if(d==="center")U=B((r.left+r.right)/2);else if(vt(d)){const Tt=Object.keys(d)[0],Vt=d[Tt];U=B(this.chart.scales[Tt].getPixelForValue(Vt))}H=U-F,et=H-R,lt=r.left,Ft=r.right}const ce=gt(c.ticks.maxTicksLimit,T),Ce=Math.max(1,Math.ceil(T/ce));for(j=0;j<T;j+=Ce){const Tt=f.setContext(this.getContext(j)),Vt=Tt.lineWidth,so=Tt.color,Ci=f.borderDash||[],ao=Tt.borderDashOffset,xs=Tt.tickWidth,sr=Tt.tickColor,lo=Tt.tickBorderDash||[],ho=Tt.tickBorderDashOffset;Z=z_(this,j,_),Z!==void 0&&($=Xn(h,Z,Vt),y?H=et=lt=Ft=$:rt=ct=zt=Mt=$,O.push({tx1:H,ty1:rt,tx2:et,ty2:ct,x1:lt,y1:zt,x2:Ft,y2:Mt,width:Vt,color:so,borderDash:Ci,borderDashOffset:ao,tickWidth:xs,tickColor:sr,tickBorderDash:lo,tickBorderDashOffset:ho}))}return this._ticksLength=T,this._borderValue=U,O}_computeLabelItems(r){const s=this.axis,h=this.options,{position:c,ticks:f}=h,d=this.isHorizontal(),_=this.ticks,{align:y,crossAlign:x,padding:T,mirror:R}=f,O=to(h.grid),P=O+T,D=R?-T:P,F=-Ye(this.labelRotation),B=[];let U,j,Z,$,H,rt,et,ct,lt,zt,Ft,Mt,ce="middle";if(c==="top")rt=this.bottom-D,et=this._getXAxisLabelAlignment();else if(c==="bottom")rt=this.top+D,et=this._getXAxisLabelAlignment();else if(c==="left"){const Tt=this._getYAxisLabelAlignment(O);et=Tt.textAlign,H=Tt.x}else if(c==="right"){const Tt=this._getYAxisLabelAlignment(O);et=Tt.textAlign,H=Tt.x}else if(s==="x"){if(c==="center")rt=(r.top+r.bottom)/2+P;else if(vt(c)){const Tt=Object.keys(c)[0],Vt=c[Tt];rt=this.chart.scales[Tt].getPixelForValue(Vt)+P}et=this._getXAxisLabelAlignment()}else if(s==="y"){if(c==="center")H=(r.left+r.right)/2-P;else if(vt(c)){const Tt=Object.keys(c)[0],Vt=c[Tt];H=this.chart.scales[Tt].getPixelForValue(Vt)}et=this._getYAxisLabelAlignment(O).textAlign}s==="y"&&(y==="start"?ce="top":y==="end"&&(ce="bottom"));const Ce=this._getLabelSizes();for(U=0,j=_.length;U<j;++U){Z=_[U],$=Z.label;const Tt=f.setContext(this.getContext(U));ct=this.getPixelForTick(U)+f.labelOffset,lt=this._resolveTickFontOptions(U),zt=lt.lineHeight,Ft=Dt($)?$.length:1;const Vt=Ft/2,so=Tt.color,Ci=Tt.textStrokeColor,ao=Tt.textStrokeWidth;d?(H=ct,c==="top"?x==="near"||F!==0?Mt=-Ft*zt+zt/2:x==="center"?Mt=-Ce.highest.height/2-Vt*zt+zt:Mt=-Ce.highest.height+zt/2:x==="near"||F!==0?Mt=zt/2:x==="center"?Mt=Ce.highest.height/2-Vt*zt:Mt=Ce.highest.height-Ft*zt,R&&(Mt*=-1)):(rt=ct,Mt=(1-Ft)*zt/2);let xs;if(Tt.showLabelBackdrop){const sr=ve(Tt.backdropPadding),lo=Ce.heights[U],ho=Ce.widths[U];let Il=rt+Mt-sr.top,Al=H-sr.left;switch(ce){case"middle":Il-=lo/2;break;case"bottom":Il-=lo;break}switch(et){case"center":Al-=ho/2;break;case"right":Al-=ho;break}xs={left:Al,top:Il,width:ho+sr.width,height:lo+sr.height,color:Tt.backdropColor}}B.push({rotation:F,label:$,font:lt,color:so,strokeColor:Ci,strokeWidth:ao,textOffset:Mt,textAlign:et,textBaseline:ce,translation:[H,rt],backdrop:xs})}return B}_getXAxisLabelAlignment(){const{position:r,ticks:s}=this.options;if(-Ye(this.labelRotation))return r==="top"?"left":"right";let c="center";return s.align==="start"?c="left":s.align==="end"&&(c="right"),c}_getYAxisLabelAlignment(r){const{position:s,ticks:{crossAlign:h,mirror:c,padding:f}}=this.options,d=this._getLabelSizes(),_=r+f,y=d.widest.width;let x,T;return s==="left"?c?(T=this.right+f,h==="near"?x="left":h==="center"?(x="center",T+=y/2):(x="right",T+=y)):(T=this.right-_,h==="near"?x="right":h==="center"?(x="center",T-=y/2):(x="left",T=this.left)):s==="right"?c?(T=this.left+f,h==="near"?x="right":h==="center"?(x="center",T-=y/2):(x="left",T-=y)):(T=this.left+_,h==="near"?x="left":h==="center"?(x="center",T+=y/2):(x="right",T=this.right)):x="right",{textAlign:x,x:T}}_computeLabelArea(){if(this.options.ticks.mirror)return;const r=this.chart,s=this.options.position;if(s==="left"||s==="right")return{top:0,left:this.left,bottom:r.height,right:this.right};if(s==="top"||s==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:r.width}}drawBackground(){const{ctx:r,options:{backgroundColor:s},left:h,top:c,width:f,height:d}=this;s&&(r.save(),r.fillStyle=s,r.fillRect(h,c,f,d),r.restore())}getLineWidthForValue(r){const s=this.options.grid;if(!this._isVisible()||!s.display)return 0;const c=this.ticks.findIndex(f=>f.value===r);return c>=0?s.setContext(this.getContext(c)).lineWidth:0}drawGrid(r){const s=this.options.grid,h=this.ctx,c=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(r));let f,d;const _=(y,x,T)=>{!T.width||!T.color||(h.save(),h.lineWidth=T.width,h.strokeStyle=T.color,h.setLineDash(T.borderDash||[]),h.lineDashOffset=T.borderDashOffset,h.beginPath(),h.moveTo(y.x,y.y),h.lineTo(x.x,x.y),h.stroke(),h.restore())};if(s.display)for(f=0,d=c.length;f<d;++f){const y=c[f];s.drawOnChartArea&&_({x:y.x1,y:y.y1},{x:y.x2,y:y.y2},y),s.drawTicks&&_({x:y.tx1,y:y.ty1},{x:y.tx2,y:y.ty2},{color:y.tickColor,width:y.tickWidth,borderDash:y.tickBorderDash,borderDashOffset:y.tickBorderDashOffset})}}drawBorder(){const{chart:r,ctx:s,options:{grid:h}}=this,c=h.setContext(this.getContext()),f=h.drawBorder?c.borderWidth:0;if(!f)return;const d=h.setContext(this.getContext(0)).lineWidth,_=this._borderValue;let y,x,T,R;this.isHorizontal()?(y=Xn(r,this.left,f)-f/2,x=Xn(r,this.right,d)+d/2,T=R=_):(T=Xn(r,this.top,f)-f/2,R=Xn(r,this.bottom,d)+d/2,y=x=_),s.save(),s.lineWidth=c.borderWidth,s.strokeStyle=c.borderColor,s.beginPath(),s.moveTo(y,T),s.lineTo(x,R),s.stroke(),s.restore()}drawLabels(r){if(!this.options.ticks.display)return;const h=this.ctx,c=this._computeLabelArea();c&&jr(h,c);const f=this._labelItems||(this._labelItems=this._computeLabelItems(r));let d,_;for(d=0,_=f.length;d<_;++d){const y=f[d],x=y.font,T=y.label;y.backdrop&&(h.fillStyle=y.backdrop.color,h.fillRect(y.backdrop.left,y.backdrop.top,y.backdrop.width,y.backdrop.height));let R=y.textOffset;Wn(h,T,0,R,x,y)}c&&Wr(h)}drawTitle(){const{ctx:r,options:{position:s,title:h,reverse:c}}=this;if(!h.display)return;const f=he(h.font),d=ve(h.padding),_=h.align;let y=f.lineHeight/2;s==="bottom"||s==="center"||vt(s)?(y+=d.bottom,Dt(h.text)&&(y+=f.lineHeight*(h.text.length-1))):y+=d.top;const{titleX:x,titleY:T,maxWidth:R,rotation:O}=W_(this,y,s,_);Wn(r,h.text,0,0,f,{color:h.color,maxWidth:R,rotation:O,textAlign:j_(_,s,c),textBaseline:"middle",translation:[x,T]})}draw(r){!this._isVisible()||(this.drawBackground(),this.drawGrid(r),this.drawBorder(),this.drawTitle(),this.drawLabels(r))}_layers(){const r=this.options,s=r.ticks&&r.ticks.z||0,h=gt(r.grid&&r.grid.z,-1);return!this._isVisible()||this.draw!==Yn.prototype.draw?[{z:s,draw:c=>{this.draw(c)}}]:[{z:h,draw:c=>{this.drawBackground(),this.drawGrid(c),this.drawTitle()}},{z:h+1,draw:()=>{this.drawBorder()}},{z:s,draw:c=>{this.drawLabels(c)}}]}getMatchingVisibleMetas(r){const s=this.chart.getSortedVisibleDatasetMetas(),h=this.axis+"AxisID",c=[];let f,d;for(f=0,d=s.length;f<d;++f){const _=s[f];_[h]===this.id&&(!r||_.type===r)&&c.push(_)}return c}_resolveTickFontOptions(r){const s=this.options.ticks.setContext(this.getContext(r));return he(s.font)}_maxDigits(){const r=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/r}}class is{constructor(r,s,h){this.type=r,this.scope=s,this.override=h,this.items=Object.create(null)}isForType(r){return Object.prototype.isPrototypeOf.call(this.type.prototype,r.prototype)}register(r){const s=Object.getPrototypeOf(r);let h;$_(s)&&(h=this.register(s));const c=this.items,f=r.id,d=this.scope+"."+f;if(!f)throw new Error("class does not have id: "+r);return f in c||(c[f]=r,H_(r,d,h),this.override&&Et.override(r.id,r.overrides)),d}get(r){return this.items[r]}unregister(r){const s=this.items,h=r.id,c=this.scope;h in s&&delete s[h],c&&h in Et[c]&&(delete Et[c][h],this.override&&delete Ue[h])}}function H_(l,r,s){const h=sn(Object.create(null),[s?Et.get(s):{},Et.get(r),l.defaults]);Et.set(r,h),l.defaultRoutes&&Y_(r,l.defaultRoutes),l.descriptors&&Et.describe(r,l.descriptors)}function Y_(l,r){Object.keys(r).forEach(s=>{const h=s.split("."),c=h.pop(),f=[l].concat(h).join("."),d=r[s].split("."),_=d.pop(),y=d.join(".");Et.route(f,c,y,_)})}function $_(l){return"id"in l&&"defaults"in l}class K_{constructor(){this.controllers=new is(en,"datasets",!0),this.elements=new is($e,"elements"),this.plugins=new is(Object,"plugins"),this.scales=new is(Yn,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...r){this._each("register",r)}remove(...r){this._each("unregister",r)}addControllers(...r){this._each("register",r,this.controllers)}addElements(...r){this._each("register",r,this.elements)}addPlugins(...r){this._each("register",r,this.plugins)}addScales(...r){this._each("register",r,this.scales)}getController(r){return this._get(r,this.controllers,"controller")}getElement(r){return this._get(r,this.elements,"element")}getPlugin(r){return this._get(r,this.plugins,"plugin")}getScale(r){return this._get(r,this.scales,"scale")}removeControllers(...r){this._each("unregister",r,this.controllers)}removeElements(...r){this._each("unregister",r,this.elements)}removePlugins(...r){this._each("unregister",r,this.plugins)}removeScales(...r){this._each("unregister",r,this.scales)}_each(r,s,h){[...s].forEach(c=>{const f=h||this._getRegistryForType(c);h||f.isForType(c)||f===this.plugins&&c.id?this._exec(r,f,c):At(c,d=>{const _=h||this._getRegistryForType(d);this._exec(r,_,d)})})}_exec(r,s,h){const c=yi(r);kt(h["before"+c],[],h),s[r](h),kt(h["after"+c],[],h)}_getRegistryForType(r){for(let s=0;s<this._typedRegistries.length;s++){const h=this._typedRegistries[s];if(h.isForType(r))return h}return this.plugins}_get(r,s,h){const c=s.get(r);if(c===void 0)throw new Error('"'+r+'" is not a registered '+h+".");return c}}var cn=new K_;class Z_{constructor(){this._init=[]}notify(r,s,h,c){s==="beforeInit"&&(this._init=this._createDescriptors(r,!0),this._notify(this._init,r,"install"));const f=c?this._descriptors(r).filter(c):this._descriptors(r),d=this._notify(f,r,s,h);return s==="afterDestroy"&&(this._notify(f,r,"stop"),this._notify(this._init,r,"uninstall")),d}_notify(r,s,h,c){c=c||{};for(const f of r){const d=f.plugin,_=d[h],y=[s,c,f.options];if(kt(_,y,d)===!1&&c.cancelable)return!1}return!0}invalidate(){It(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(r){if(this._cache)return this._cache;const s=this._cache=this._createDescriptors(r);return this._notifyStateChanges(r),s}_createDescriptors(r,s){const h=r&&r.config,c=gt(h.options&&h.options.plugins,{}),f=q_(h);return c===!1&&!s?[]:Q_(r,f,c,s)}_notifyStateChanges(r){const s=this._oldCache||[],h=this._cache,c=(f,d)=>f.filter(_=>!d.some(y=>_.plugin.id===y.plugin.id));this._notify(c(s,h),r,"stop"),this._notify(c(h,s),r,"start")}}function q_(l){const r=[],s=Object.keys(cn.plugins.items);for(let c=0;c<s.length;c++)r.push(cn.getPlugin(s[c]));const h=l.plugins||[];for(let c=0;c<h.length;c++){const f=h[c];r.indexOf(f)===-1&&r.push(f)}return r}function J_(l,r){return!r&&l===!1?null:l===!0?{}:l}function Q_(l,r,s,h){const c=[],f=l.getContext();for(let d=0;d<r.length;d++){const _=r[d],y=_.id,x=J_(s[y],h);x!==null&&c.push({plugin:_,options:tv(l.config,_,x,f)})}return c}function tv(l,r,s,h){const c=l.pluginScopeKeys(r),f=l.getOptionScopes(s,c);return l.createResolver(f,h,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function cl(l,r){const s=Et.datasets[l]||{};return((r.datasets||{})[l]||{}).indexAxis||r.indexAxis||s.indexAxis||"x"}function ev(l,r){let s=l;return l==="_index_"?s=r:l==="_value_"&&(s=r==="x"?"y":"x"),s}function nv(l,r){return l===r?"_index_":"_value_"}function iv(l){if(l==="top"||l==="bottom")return"x";if(l==="left"||l==="right")return"y"}function ul(l,r){return l==="x"||l==="y"?l:r.axis||iv(r.position)||l.charAt(0).toLowerCase()}function rv(l,r){const s=Ue[l.type]||{scales:{}},h=r.scales||{},c=cl(l.type,r),f=Object.create(null),d=Object.create(null);return Object.keys(h).forEach(_=>{const y=h[_];if(!vt(y))return console.error(`Invalid scale configuration for scale: ${_}`);if(y._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${_}`);const x=ul(_,y),T=nv(x,c),R=s.scales||{};f[x]=f[x]||_,d[_]=Je(Object.create(null),[{axis:x},y,R[x],R[T]])}),l.data.datasets.forEach(_=>{const y=_.type||l.type,x=_.indexAxis||cl(y,r),R=(Ue[y]||{}).scales||{};Object.keys(R).forEach(O=>{const P=ev(O,x),D=_[P+"AxisID"]||f[P]||P;d[D]=d[D]||Object.create(null),Je(d[D],[{axis:P},h[D],R[O]])})}),Object.keys(d).forEach(_=>{const y=d[_];Je(y,[Et.scales[y.type],Et.scale])}),d}function pu(l){const r=l.options||(l.options={});r.plugins=gt(r.plugins,{}),r.scales=rv(l,r)}function gu(l){return l=l||{},l.datasets=l.datasets||[],l.labels=l.labels||[],l}function ov(l){return l=l||{},l.data=gu(l.data),pu(l),l}const _u=new Map,vu=new Set;function rs(l,r){let s=_u.get(l);return s||(s=r(),_u.set(l,s),vu.add(s)),s}const eo=(l,r,s)=>{const h=Qe(r,s);h!==void 0&&l.add(h)};class sv{constructor(r){this._config=ov(r),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(r){this._config.type=r}get data(){return this._config.data}set data(r){this._config.data=gu(r)}get options(){return this._config.options}set options(r){this._config.options=r}get plugins(){return this._config.plugins}update(){const r=this._config;this.clearCache(),pu(r)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(r){return rs(r,()=>[[`datasets.${r}`,""]])}datasetAnimationScopeKeys(r,s){return rs(`${r}.transition.${s}`,()=>[[`datasets.${r}.transitions.${s}`,`transitions.${s}`],[`datasets.${r}`,""]])}datasetElementScopeKeys(r,s){return rs(`${r}-${s}`,()=>[[`datasets.${r}.elements.${s}`,`datasets.${r}`,`elements.${s}`,""]])}pluginScopeKeys(r){const s=r.id,h=this.type;return rs(`${h}-plugin-${s}`,()=>[[`plugins.${s}`,...r.additionalOptionScopes||[]]])}_cachedScopes(r,s){const h=this._scopeCache;let c=h.get(r);return(!c||s)&&(c=new Map,h.set(r,c)),c}getOptionScopes(r,s,h){const{options:c,type:f}=this,d=this._cachedScopes(r,h),_=d.get(s);if(_)return _;const y=new Set;s.forEach(T=>{r&&(y.add(r),T.forEach(R=>eo(y,r,R))),T.forEach(R=>eo(y,c,R)),T.forEach(R=>eo(y,Ue[f]||{},R)),T.forEach(R=>eo(y,Et,R)),T.forEach(R=>eo(y,Sn,R))});const x=Array.from(y);return x.length===0&&x.push(Object.create(null)),vu.has(s)&&d.set(s,x),x}chartOptionScopes(){const{options:r,type:s}=this;return[r,Ue[s]||{},Et.datasets[s]||{},{type:s},Et,Sn]}resolveNamedOptions(r,s,h,c=[""]){const f={$shared:!0},{resolver:d,subPrefixes:_}=yu(this._resolverCache,r,c);let y=d;if(lv(d,s)){f.$shared=!1,h=He(h)?h():h;const x=this.createResolver(r,h,_);y=wi(d,h,x)}for(const x of s)f[x]=y[x];return f}createResolver(r,s,h=[""],c){const{resolver:f}=yu(this._resolverCache,r,h);return vt(s)?wi(f,s,void 0,c):f}}function yu(l,r,s){let h=l.get(r);h||(h=new Map,l.set(r,h));const c=s.join();let f=h.get(c);return f||(f={resolver:qo(r,s),subPrefixes:s.filter(_=>!_.toLowerCase().includes("hover"))},h.set(c,f)),f}const av=l=>vt(l)&&Object.getOwnPropertyNames(l).reduce((r,s)=>r||He(l[s]),!1);function lv(l,r){const{isScriptable:s,isIndexable:h}=Ja(l);for(const c of r){const f=s(c),d=h(c),_=(d||f)&&l[c];if(f&&(He(_)||av(_))||d&&Dt(_))return!0}return!1}var hv="3.7.1";const cv=["top","bottom","left","right","chartArea"];function mu(l,r){return l==="top"||l==="bottom"||cv.indexOf(l)===-1&&r==="x"}function xu(l,r){return function(s,h){return s[l]===h[l]?s[r]-h[r]:s[l]-h[l]}}function bu(l){const r=l.chart,s=r.options.animation;r.notifyPlugins("afterRender"),kt(s&&s.onComplete,[l],r)}function uv(l){const r=l.chart,s=r.options.animation;kt(s&&s.onProgress,[l],r)}function Eu(l){return Xa()&&typeof l=="string"?l=document.getElementById(l):l&&l.length&&(l=l[0]),l&&l.canvas&&(l=l.canvas),l}const os={},Tu=l=>{const r=Eu(l);return Object.values(os).filter(s=>s.canvas===r).pop()};function fv(l,r,s){const h=Object.keys(l);for(const c of h){const f=+c;if(f>=r){const d=l[c];delete l[c],(s>0||f>r)&&(l[f+s]=d)}}}function dv(l,r,s,h){return!s||l.type==="mouseout"?null:h?r:l}class te{constructor(r,s){const h=this.config=new sv(s),c=Eu(r),f=Tu(c);if(f)throw new Error("Canvas is already in use. Chart with ID '"+f.id+"' must be destroyed before the canvas can be reused.");const d=h.createResolver(h.chartOptionScopes(),this.getContext());this.platform=new(h.platform||Qc(c)),this.platform.updateConfig(h);const _=this.platform.acquireContext(c,d.aspectRatio),y=_&&_.canvas,x=y&&y.height,T=y&&y.width;if(this.id=$i(),this.ctx=_,this.canvas=y,this.width=T,this.height=x,this._options=d,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new Z_,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=a(R=>this.update(R),d.resizeDelay||0),this._dataChanges=[],os[this.id]=this,!_||!y){console.error("Failed to create chart: can't acquire context from the given item");return}m.listen(this,"complete",bu),m.listen(this,"progress",uv),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:r,maintainAspectRatio:s},width:h,height:c,_aspectRatio:f}=this;return It(r)?s&&f?f:c?h/c:null:r}get data(){return this.config.data}set data(r){this.config.data=r}get options(){return this._options}set options(r){this.config.options=r}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():Ha(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return za(this.canvas,this.ctx),this}stop(){return m.stop(this),this}resize(r,s){m.running(this)?this._resizeBeforeDraw={width:r,height:s}:this._resize(r,s)}_resize(r,s){const h=this.options,c=this.canvas,f=h.maintainAspectRatio&&this.aspectRatio,d=this.platform.getMaximumSize(c,r,s,f),_=h.devicePixelRatio||this.platform.getDevicePixelRatio(),y=this.width?"resize":"attach";this.width=d.width,this.height=d.height,this._aspectRatio=this.aspectRatio,Ha(this,_,!0)&&(this.notifyPlugins("resize",{size:d}),kt(h.onResize,[this,d],this),this.attached&&this._doResize(y)&&this.render())}ensureScalesHaveIDs(){const s=this.options.scales||{};At(s,(h,c)=>{h.id=c})}buildOrUpdateScales(){const r=this.options,s=r.scales,h=this.scales,c=Object.keys(h).reduce((d,_)=>(d[_]=!1,d),{});let f=[];s&&(f=f.concat(Object.keys(s).map(d=>{const _=s[d],y=ul(d,_),x=y==="r",T=y==="x";return{options:_,dposition:x?"chartArea":T?"bottom":"left",dtype:x?"radialLinear":T?"category":"linear"}}))),At(f,d=>{const _=d.options,y=_.id,x=ul(y,_),T=gt(_.type,d.dtype);(_.position===void 0||mu(_.position,x)!==mu(d.dposition))&&(_.position=d.dposition),c[y]=!0;let R=null;if(y in h&&h[y].type===T)R=h[y];else{const O=cn.getScale(T);R=new O({id:y,type:T,ctx:this.ctx,chart:this}),h[R.id]=R}R.init(_,r)}),At(c,(d,_)=>{d||delete h[_]}),At(h,d=>{ye.configure(this,d,d.options),ye.addBox(this,d)})}_updateMetasets(){const r=this._metasets,s=this.data.datasets.length,h=r.length;if(r.sort((c,f)=>c.index-f.index),h>s){for(let c=s;c<h;++c)this._destroyDatasetMeta(c);r.splice(s,h-s)}this._sortedMetasets=r.slice(0).sort(xu("order","index"))}_removeUnreferencedMetasets(){const{_metasets:r,data:{datasets:s}}=this;r.length>s.length&&delete this._stacks,r.forEach((h,c)=>{s.filter(f=>f===h._dataset).length===0&&this._destroyDatasetMeta(c)})}buildOrUpdateControllers(){const r=[],s=this.data.datasets;let h,c;for(this._removeUnreferencedMetasets(),h=0,c=s.length;h<c;h++){const f=s[h];let d=this.getDatasetMeta(h);const _=f.type||this.config.type;if(d.type&&d.type!==_&&(this._destroyDatasetMeta(h),d=this.getDatasetMeta(h)),d.type=_,d.indexAxis=f.indexAxis||cl(_,this.options),d.order=f.order||0,d.index=h,d.label=""+f.label,d.visible=this.isDatasetVisible(h),d.controller)d.controller.updateIndex(h),d.controller.linkScales();else{const y=cn.getController(_),{datasetElementType:x,dataElementType:T}=Et.datasets[_];Object.assign(y.prototype,{dataElementType:cn.getElement(T),datasetElementType:x&&cn.getElement(x)}),d.controller=new y(this,h),r.push(d.controller)}}return this._updateMetasets(),r}_resetElements(){At(this.data.datasets,(r,s)=>{this.getDatasetMeta(s).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(r){const s=this.config;s.update();const h=this._options=s.createResolver(s.chartOptionScopes(),this.getContext()),c=this._animationsDisabled=!h.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:r,cancelable:!0})===!1)return;const f=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let d=0;for(let x=0,T=this.data.datasets.length;x<T;x++){const{controller:R}=this.getDatasetMeta(x),O=!c&&f.indexOf(R)===-1;R.buildOrUpdateElements(O),d=Math.max(+R.getMaxOverflow(),d)}d=this._minPadding=h.layout.autoPadding?d:0,this._updateLayout(d),c||At(f,x=>{x.reset()}),this._updateDatasets(r),this.notifyPlugins("afterUpdate",{mode:r}),this._layers.sort(xu("z","_idx"));const{_active:_,_lastEvent:y}=this;y?this._eventHandler(y,!0):_.length&&this._updateHoverStyles(_,_,!0),this.render()}_updateScales(){At(this.scales,r=>{ye.removeBox(this,r)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const r=this.options,s=new Set(Object.keys(this._listeners)),h=new Set(r.events);(!mi(s,h)||!!this._responsiveListeners!==r.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:r}=this,s=this._getUniformDataChanges()||[];for(const{method:h,start:c,count:f}of s){const d=h==="_removeElements"?-f:f;fv(r,c,d)}}_getUniformDataChanges(){const r=this._dataChanges;if(!r||!r.length)return;this._dataChanges=[];const s=this.data.datasets.length,h=f=>new Set(r.filter(d=>d[0]===f).map((d,_)=>_+","+d.splice(1).join(","))),c=h(0);for(let f=1;f<s;f++)if(!mi(c,h(f)))return;return Array.from(c).map(f=>f.split(",")).map(f=>({method:f[1],start:+f[2],count:+f[3]}))}_updateLayout(r){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;ye.update(this,this.width,this.height,r);const s=this.chartArea,h=s.width<=0||s.height<=0;this._layers=[],At(this.boxes,c=>{h&&c.position==="chartArea"||(c.configure&&c.configure(),this._layers.push(...c._layers()))},this),this._layers.forEach((c,f)=>{c._idx=f}),this.notifyPlugins("afterLayout")}_updateDatasets(r){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:r,cancelable:!0})!==!1){for(let s=0,h=this.data.datasets.length;s<h;++s)this.getDatasetMeta(s).controller.configure();for(let s=0,h=this.data.datasets.length;s<h;++s)this._updateDataset(s,He(r)?r({datasetIndex:s}):r);this.notifyPlugins("afterDatasetsUpdate",{mode:r})}}_updateDataset(r,s){const h=this.getDatasetMeta(r),c={meta:h,index:r,mode:s,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",c)!==!1&&(h.controller._update(s),c.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",c))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(m.has(this)?this.attached&&!m.running(this)&&m.start(this):(this.draw(),bu({chart:this})))}draw(){let r;if(this._resizeBeforeDraw){const{width:h,height:c}=this._resizeBeforeDraw;this._resize(h,c),this._resizeBeforeDraw=null}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const s=this._layers;for(r=0;r<s.length&&s[r].z<=0;++r)s[r].draw(this.chartArea);for(this._drawDatasets();r<s.length;++r)s[r].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(r){const s=this._sortedMetasets,h=[];let c,f;for(c=0,f=s.length;c<f;++c){const d=s[c];(!r||d.visible)&&h.push(d)}return h}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const r=this.getSortedVisibleDatasetMetas();for(let s=r.length-1;s>=0;--s)this._drawDataset(r[s]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(r){const s=this.ctx,h=r._clip,c=!h.disabled,f=this.chartArea,d={meta:r,index:r.index,cancelable:!0};this.notifyPlugins("beforeDatasetDraw",d)!==!1&&(c&&jr(s,{left:h.left===!1?0:f.left-h.left,right:h.right===!1?this.width:f.right+h.right,top:h.top===!1?0:f.top-h.top,bottom:h.bottom===!1?this.height:f.bottom+h.bottom}),r.controller.draw(),c&&Wr(s),d.cancelable=!1,this.notifyPlugins("afterDatasetDraw",d))}getElementsAtEventForMode(r,s,h,c){const f=xc.modes[s];return typeof f=="function"?f(this,r,h,c):[]}getDatasetMeta(r){const s=this.data.datasets[r],h=this._metasets;let c=h.filter(f=>f&&f._dataset===s).pop();return c||(c={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:s&&s.order||0,index:r,_dataset:s,_parsed:[],_sorted:!1},h.push(c)),c}getContext(){return this.$context||(this.$context=Rn(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(r){const s=this.data.datasets[r];if(!s)return!1;const h=this.getDatasetMeta(r);return typeof h.hidden=="boolean"?!h.hidden:!s.hidden}setDatasetVisibility(r,s){const h=this.getDatasetMeta(r);h.hidden=!s}toggleDataVisibility(r){this._hiddenIndices[r]=!this._hiddenIndices[r]}getDataVisibility(r){return!this._hiddenIndices[r]}_updateVisibility(r,s,h){const c=h?"show":"hide",f=this.getDatasetMeta(r),d=f.controller._resolveAnimations(void 0,c);_e(s)?(f.data[s].hidden=!h,this.update()):(this.setDatasetVisibility(r,h),d.update(f,{visible:h}),this.update(_=>_.datasetIndex===r?c:void 0))}hide(r,s){this._updateVisibility(r,s,!1)}show(r,s){this._updateVisibility(r,s,!0)}_destroyDatasetMeta(r){const s=this._metasets[r];s&&s.controller&&s.controller._destroy(),delete this._metasets[r]}_stop(){let r,s;for(this.stop(),m.remove(this),r=0,s=this.data.datasets.length;r<s;++r)this._destroyDatasetMeta(r)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:r,ctx:s}=this;this._stop(),this.config.clearCache(),r&&(this.unbindEvents(),za(r,s),this.platform.releaseContext(s),this.canvas=null,this.ctx=null),this.notifyPlugins("destroy"),delete os[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...r){return this.canvas.toDataURL(...r)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const r=this._listeners,s=this.platform,h=(f,d)=>{s.addEventListener(this,f,d),r[f]=d},c=(f,d,_)=>{f.offsetX=d,f.offsetY=_,this._eventHandler(f)};At(this.options.events,f=>h(f,c))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const r=this._responsiveListeners,s=this.platform,h=(y,x)=>{s.addEventListener(this,y,x),r[y]=x},c=(y,x)=>{r[y]&&(s.removeEventListener(this,y,x),delete r[y])},f=(y,x)=>{this.canvas&&this.resize(y,x)};let d;const _=()=>{c("attach",_),this.attached=!0,this.resize(),h("resize",f),h("detach",d)};d=()=>{this.attached=!1,c("resize",f),this._stop(),this._resize(0,0),h("attach",_)},s.isAttached(this.canvas)?_():d()}unbindEvents(){At(this._listeners,(r,s)=>{this.platform.removeEventListener(this,s,r)}),this._listeners={},At(this._responsiveListeners,(r,s)=>{this.platform.removeEventListener(this,s,r)}),this._responsiveListeners=void 0}updateHoverStyle(r,s,h){const c=h?"set":"remove";let f,d,_,y;for(s==="dataset"&&(f=this.getDatasetMeta(r[0].datasetIndex),f.controller["_"+c+"DatasetHoverStyle"]()),_=0,y=r.length;_<y;++_){d=r[_];const x=d&&this.getDatasetMeta(d.datasetIndex).controller;x&&x[c+"HoverStyle"](d.element,d.datasetIndex,d.index)}}getActiveElements(){return this._active||[]}setActiveElements(r){const s=this._active||[],h=r.map(({datasetIndex:f,index:d})=>{const _=this.getDatasetMeta(f);if(!_)throw new Error("No dataset found at index "+f);return{datasetIndex:f,element:_.data[d],index:d}});!_i(h,s)&&(this._active=h,this._lastEvent=null,this._updateHoverStyles(h,s))}notifyPlugins(r,s,h){return this._plugins.notify(this,r,s,h)}_updateHoverStyles(r,s,h){const c=this.options.hover,f=(y,x)=>y.filter(T=>!x.some(R=>T.datasetIndex===R.datasetIndex&&T.index===R.index)),d=f(s,r),_=h?r:f(r,s);d.length&&this.updateHoverStyle(d,c.mode,!1),_.length&&c.mode&&this.updateHoverStyle(_,c.mode,!0)}_eventHandler(r,s){const h={event:r,replay:s,cancelable:!0,inChartArea:jn(r,this.chartArea,this._minPadding)},c=d=>(d.options.events||this.options.events).includes(r.native.type);if(this.notifyPlugins("beforeEvent",h,c)===!1)return;const f=this._handleEvent(r,s,h.inChartArea);return h.cancelable=!1,this.notifyPlugins("afterEvent",h,c),(f||h.changed)&&this.render(),this}_handleEvent(r,s,h){const{_active:c=[],options:f}=this,d=s,_=this._getActiveElements(r,c,h,d),y=Un(r),x=dv(r,this._lastEvent,h,y);h&&(this._lastEvent=null,kt(f.onHover,[r,_,this],this),y&&kt(f.onClick,[r,_,this],this));const T=!_i(_,c);return(T||s)&&(this._active=_,this._updateHoverStyles(_,c,s)),this._lastEvent=x,T}_getActiveElements(r,s,h,c){if(r.type==="mouseout")return[];if(!h)return s;const f=this.options.hover;return this.getElementsAtEventForMode(r,f.mode,f,c)}}const wu=()=>At(te.instances,l=>l._plugins.invalidate()),$n=!0;Object.defineProperties(te,{defaults:{enumerable:$n,value:Et},instances:{enumerable:$n,value:os},overrides:{enumerable:$n,value:Ue},registry:{enumerable:$n,value:cn},version:{enumerable:$n,value:hv},getChart:{enumerable:$n,value:Tu},register:{enumerable:$n,value:(...l)=>{cn.add(...l),wu()}},unregister:{enumerable:$n,value:(...l)=>{cn.remove(...l),wu()}}});function Ri(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class fl{constructor(r){this.options=r||{}}formats(){return Ri()}parse(r,s){return Ri()}format(r,s){return Ri()}add(r,s,h){return Ri()}diff(r,s,h){return Ri()}startOf(r,s,h){return Ri()}endOf(r,s){return Ri()}}fl.override=function(l){Object.assign(fl.prototype,l)};var Su={_date:fl};function pv(l,r){if(!l._cache.$bar){const s=l.getMatchingVisibleMetas(r);let h=[];for(let c=0,f=s.length;c<f;c++)h=h.concat(s[c].controller.getAllParsedValues(l));l._cache.$bar=Va(h.sort((c,f)=>c-f))}return l._cache.$bar}function gv(l){const r=l.iScale,s=pv(r,l.type);let h=r._length,c,f,d,_;const y=()=>{d===32767||d===-32768||(_e(_)&&(h=Math.min(h,Math.abs(d-_)||h)),_=d)};for(c=0,f=s.length;c<f;++c)d=r.getPixelForValue(s[c]),y();for(_=void 0,c=0,f=r.ticks.length;c<f;++c)d=r.getPixelForTick(c),y();return h}function _v(l,r,s,h){const c=s.barThickness;let f,d;return It(c)?(f=r.min*s.categoryPercentage,d=s.barPercentage):(f=c*h,d=1),{chunk:f/h,ratio:d,start:r.pixels[l]-f/2}}function vv(l,r,s,h){const c=r.pixels,f=c[l];let d=l>0?c[l-1]:null,_=l<c.length-1?c[l+1]:null;const y=s.categoryPercentage;d===null&&(d=f-(_===null?r.end-r.start:_-f)),_===null&&(_=f+f-d);const x=f-(f-Math.min(d,_))/2*y;return{chunk:Math.abs(_-d)/2*y/h,ratio:s.barPercentage,start:x}}function yv(l,r,s,h){const c=s.parse(l[0],h),f=s.parse(l[1],h),d=Math.min(c,f),_=Math.max(c,f);let y=d,x=_;Math.abs(d)>Math.abs(_)&&(y=_,x=d),r[s.axis]=x,r._custom={barStart:y,barEnd:x,start:c,end:f,min:d,max:_}}function Ru(l,r,s,h){return Dt(l)?yv(l,r,s,h):r[s.axis]=s.parse(l,h),r}function Cu(l,r,s,h){const c=l.iScale,f=l.vScale,d=c.getLabels(),_=c===f,y=[];let x,T,R,O;for(x=s,T=s+h;x<T;++x)O=r[x],R={},R[c.axis]=_||c.parse(d[x],x),y.push(Ru(O,R,f,x));return y}function dl(l){return l&&l.barStart!==void 0&&l.barEnd!==void 0}function mv(l,r,s){return l!==0?Ae(l):(r.isHorizontal()?1:-1)*(r.min>=s?1:-1)}function xv(l){let r,s,h,c,f;return l.horizontal?(r=l.base>l.x,s="left",h="right"):(r=l.base<l.y,s="bottom",h="top"),r?(c="end",f="start"):(c="start",f="end"),{start:s,end:h,reverse:r,top:c,bottom:f}}function bv(l,r,s,h){let c=r.borderSkipped;const f={};if(!c){l.borderSkipped=f;return}const{start:d,end:_,reverse:y,top:x,bottom:T}=xv(l);c==="middle"&&s&&(l.enableBorderRadius=!0,(s._top||0)===h?c=x:(s._bottom||0)===h?c=T:(f[Ou(T,d,_,y)]=!0,c=x)),f[Ou(c,d,_,y)]=!0,l.borderSkipped=f}function Ou(l,r,s,h){return h?(l=Ev(l,r,s),l=Iu(l,s,r)):l=Iu(l,r,s),l}function Ev(l,r,s){return l===r?s:l===s?r:l}function Iu(l,r,s){return l==="start"?r:l==="end"?s:l}function Tv(l,{inflateAmount:r},s){l.inflateAmount=r==="auto"?s===1?.33:0:r}class ss extends en{parsePrimitiveData(r,s,h,c){return Cu(r,s,h,c)}parseArrayData(r,s,h,c){return Cu(r,s,h,c)}parseObjectData(r,s,h,c){const{iScale:f,vScale:d}=r,{xAxisKey:_="x",yAxisKey:y="y"}=this._parsing,x=f.axis==="x"?_:y,T=d.axis==="x"?_:y,R=[];let O,P,D,F;for(O=h,P=h+c;O<P;++O)F=s[O],D={},D[f.axis]=f.parse(Qe(F,x),O),R.push(Ru(Qe(F,T),D,d,O));return R}updateRangeFromParsed(r,s,h,c){super.updateRangeFromParsed(r,s,h,c);const f=h._custom;f&&s===this._cachedMeta.vScale&&(r.min=Math.min(r.min,f.min),r.max=Math.max(r.max,f.max))}getMaxOverflow(){return 0}getLabelAndValue(r){const s=this._cachedMeta,{iScale:h,vScale:c}=s,f=this.getParsed(r),d=f._custom,_=dl(d)?"["+d.start+", "+d.end+"]":""+c.getLabelForValue(f[c.axis]);return{label:""+h.getLabelForValue(f[h.axis]),value:_}}initialize(){this.enableOptionSharing=!0,super.initialize();const r=this._cachedMeta;r.stack=this.getDataset().stack}update(r){const s=this._cachedMeta;this.updateElements(s.data,0,s.data.length,r)}updateElements(r,s,h,c){const f=c==="reset",{index:d,_cachedMeta:{vScale:_}}=this,y=_.getBasePixel(),x=_.isHorizontal(),T=this._getRuler(),R=this.resolveDataElementOptions(s,c),O=this.getSharedOptions(R),P=this.includeOptions(c,O);this.updateSharedOptions(O,c,R);for(let D=s;D<s+h;D++){const F=this.getParsed(D),B=f||It(F[_.axis])?{base:y,head:y}:this._calculateBarValuePixels(D),U=this._calculateBarIndexPixels(D,T),j=(F._stacks||{})[_.axis],Z={horizontal:x,base:B.base,enableBorderRadius:!j||dl(F._custom)||d===j._top||d===j._bottom,x:x?B.head:U.center,y:x?U.center:B.head,height:x?U.size:Math.abs(B.size),width:x?Math.abs(B.size):U.size};P&&(Z.options=O||this.resolveDataElementOptions(D,r[D].active?"active":c));const $=Z.options||r[D].options;bv(Z,$,j,d),Tv(Z,$,T.ratio),this.updateElement(r[D],D,Z,c)}}_getStacks(r,s){const c=this._cachedMeta.iScale,f=c.getMatchingVisibleMetas(this._type),d=c.options.stacked,_=f.length,y=[];let x,T;for(x=0;x<_;++x)if(T=f[x],!!T.controller.options.grouped){if(typeof s!="undefined"){const R=T.controller.getParsed(s)[T.controller._cachedMeta.vScale.axis];if(It(R)||isNaN(R))continue}if((d===!1||y.indexOf(T.stack)===-1||d===void 0&&T.stack===void 0)&&y.push(T.stack),T.index===r)break}return y.length||y.push(void 0),y}_getStackCount(r){return this._getStacks(void 0,r).length}_getStackIndex(r,s,h){const c=this._getStacks(r,h),f=s!==void 0?c.indexOf(s):-1;return f===-1?c.length-1:f}_getRuler(){const r=this.options,s=this._cachedMeta,h=s.iScale,c=[];let f,d;for(f=0,d=s.data.length;f<d;++f)c.push(h.getPixelForValue(this.getParsed(f)[h.axis],f));const _=r.barThickness;return{min:_||gv(s),pixels:c,start:h._startPixel,end:h._endPixel,stackCount:this._getStackCount(),scale:h,grouped:r.grouped,ratio:_?1:r.categoryPercentage*r.barPercentage}}_calculateBarValuePixels(r){const{_cachedMeta:{vScale:s,_stacked:h},options:{base:c,minBarLength:f}}=this,d=c||0,_=this.getParsed(r),y=_._custom,x=dl(y);let T=_[s.axis],R=0,O=h?this.applyStack(s,_,h):T,P,D;O!==T&&(R=O-T,O=T),x&&(T=y.barStart,O=y.barEnd-y.barStart,T!==0&&Ae(T)!==Ae(y.barEnd)&&(R=0),R+=T);const F=!It(c)&&!x?c:R;let B=s.getPixelForValue(F);if(this.chart.getDataVisibility(r)?P=s.getPixelForValue(R+O):P=B,D=P-B,Math.abs(D)<f&&(D=mv(D,s,d)*f,T===d&&(B-=D/2),P=B+D),B===s.getPixelForValue(d)){const U=Ae(D)*s.getLineWidthForValue(d)/2;B+=U,D-=U}return{size:D,base:B,head:P,center:P+D/2}}_calculateBarIndexPixels(r,s){const h=s.scale,c=this.options,f=c.skipNull,d=gt(c.maxBarThickness,1/0);let _,y;if(s.grouped){const x=f?this._getStackCount(r):s.stackCount,T=c.barThickness==="flex"?vv(r,s,c,x):_v(r,s,c,x),R=this._getStackIndex(this.index,this._cachedMeta.stack,f?r:void 0);_=T.start+T.chunk*R+T.chunk/2,y=Math.min(d,T.chunk*T.ratio)}else _=h.getPixelForValue(this.getParsed(r)[h.axis],r),y=Math.min(d,s.min*s.ratio);return{base:_-y/2,head:_+y/2,center:_,size:y}}draw(){const r=this._cachedMeta,s=r.vScale,h=r.data,c=h.length;let f=0;for(;f<c;++f)this.getParsed(f)[s.axis]!==null&&h[f].draw(this._ctx)}}ss.id="bar",ss.defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}},ss.overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};class as extends en{initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(r,s,h,c){const f=super.parsePrimitiveData(r,s,h,c);for(let d=0;d<f.length;d++)f[d]._custom=this.resolveDataElementOptions(d+h).radius;return f}parseArrayData(r,s,h,c){const f=super.parseArrayData(r,s,h,c);for(let d=0;d<f.length;d++){const _=s[h+d];f[d]._custom=gt(_[2],this.resolveDataElementOptions(d+h).radius)}return f}parseObjectData(r,s,h,c){const f=super.parseObjectData(r,s,h,c);for(let d=0;d<f.length;d++){const _=s[h+d];f[d]._custom=gt(_&&_.r&&+_.r,this.resolveDataElementOptions(d+h).radius)}return f}getMaxOverflow(){const r=this._cachedMeta.data;let s=0;for(let h=r.length-1;h>=0;--h)s=Math.max(s,r[h].size(this.resolveDataElementOptions(h))/2);return s>0&&s}getLabelAndValue(r){const s=this._cachedMeta,{xScale:h,yScale:c}=s,f=this.getParsed(r),d=h.getLabelForValue(f.x),_=c.getLabelForValue(f.y),y=f._custom;return{label:s.label,value:"("+d+", "+_+(y?", "+y:"")+")"}}update(r){const s=this._cachedMeta.data;this.updateElements(s,0,s.length,r)}updateElements(r,s,h,c){const f=c==="reset",{iScale:d,vScale:_}=this._cachedMeta,y=this.resolveDataElementOptions(s,c),x=this.getSharedOptions(y),T=this.includeOptions(c,x),R=d.axis,O=_.axis;for(let P=s;P<s+h;P++){const D=r[P],F=!f&&this.getParsed(P),B={},U=B[R]=f?d.getPixelForDecimal(.5):d.getPixelForValue(F[R]),j=B[O]=f?_.getBasePixel():_.getPixelForValue(F[O]);B.skip=isNaN(U)||isNaN(j),T&&(B.options=this.resolveDataElementOptions(P,D.active?"active":c),f&&(B.options.radius=0)),this.updateElement(D,P,B,c)}this.updateSharedOptions(x,c,y)}resolveDataElementOptions(r,s){const h=this.getParsed(r);let c=super.resolveDataElementOptions(r,s);c.$shared&&(c=Object.assign({},c,{$shared:!1}));const f=c.radius;return s!=="active"&&(c.radius=0),c.radius+=gt(h&&h._custom,f),c}}as.id="bubble",as.defaults={datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}},as.overrides={scales:{x:{type:"linear"},y:{type:"linear"}},plugins:{tooltip:{callbacks:{title(){return""}}}}};function wv(l,r,s){let h=1,c=1,f=0,d=0;if(r<Pt){const _=l,y=_+r,x=Math.cos(_),T=Math.sin(_),R=Math.cos(y),O=Math.sin(y),P=(Z,$,H)=>Qi(Z,_,y,!0)?1:Math.max($,$*s,H,H*s),D=(Z,$,H)=>Qi(Z,_,y,!0)?-1:Math.min($,$*s,H,H*s),F=P(0,x,R),B=P(bt,T,O),U=D(Nt,x,R),j=D(Nt+bt,T,O);h=(F-U)/2,c=(B-j)/2,f=-(F+U)/2,d=-(B+j)/2}return{ratioX:h,ratioY:c,offsetX:f,offsetY:d}}class rr extends en{constructor(r,s){super(r,s);this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(r,s){const h=this.getDataset().data,c=this._cachedMeta;if(this._parsing===!1)c._parsed=h;else{let f=y=>+h[y];if(vt(h[r])){const{key:y="value"}=this._parsing;f=x=>+Qe(h[x],y)}let d,_;for(d=r,_=r+s;d<_;++d)c._parsed[d]=f(d)}}_getRotation(){return Ye(this.options.rotation-90)}_getCircumference(){return Ye(this.options.circumference)}_getRotationExtents(){let r=Pt,s=-Pt;for(let h=0;h<this.chart.data.datasets.length;++h)if(this.chart.isDatasetVisible(h)){const c=this.chart.getDatasetMeta(h).controller,f=c._getRotation(),d=c._getCircumference();r=Math.min(r,f),s=Math.max(s,f+d)}return{rotation:r,circumference:s-r}}update(r){const s=this.chart,{chartArea:h}=s,c=this._cachedMeta,f=c.data,d=this.getMaxBorderWidth()+this.getMaxOffset(f)+this.options.spacing,_=Math.max((Math.min(h.width,h.height)-d)/2,0),y=Math.min(Ki(this.options.cutout,_),1),x=this._getRingWeight(this.index),{circumference:T,rotation:R}=this._getRotationExtents(),{ratioX:O,ratioY:P,offsetX:D,offsetY:F}=wv(R,T,y),B=(h.width-d)/O,U=(h.height-d)/P,j=Math.max(Math.min(B,U)/2,0),Z=gi(this.options.radius,j),$=Math.max(Z*y,0),H=(Z-$)/this._getVisibleDatasetWeightTotal();this.offsetX=D*Z,this.offsetY=F*Z,c.total=this.calculateTotal(),this.outerRadius=Z-H*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-H*x,0),this.updateElements(f,0,f.length,r)}_circumference(r,s){const h=this.options,c=this._cachedMeta,f=this._getCircumference();return s&&h.animation.animateRotate||!this.chart.getDataVisibility(r)||c._parsed[r]===null||c.data[r].hidden?0:this.calculateCircumference(c._parsed[r]*f/Pt)}updateElements(r,s,h,c){const f=c==="reset",d=this.chart,_=d.chartArea,x=d.options.animation,T=(_.left+_.right)/2,R=(_.top+_.bottom)/2,O=f&&x.animateScale,P=O?0:this.innerRadius,D=O?0:this.outerRadius,F=this.resolveDataElementOptions(s,c),B=this.getSharedOptions(F),U=this.includeOptions(c,B);let j=this._getRotation(),Z;for(Z=0;Z<s;++Z)j+=this._circumference(Z,f);for(Z=s;Z<s+h;++Z){const $=this._circumference(Z,f),H=r[Z],rt={x:T+this.offsetX,y:R+this.offsetY,startAngle:j,endAngle:j+$,circumference:$,outerRadius:D,innerRadius:P};U&&(rt.options=B||this.resolveDataElementOptions(Z,H.active?"active":c)),j+=$,this.updateElement(H,Z,rt,c)}this.updateSharedOptions(B,c,F)}calculateTotal(){const r=this._cachedMeta,s=r.data;let h=0,c;for(c=0;c<s.length;c++){const f=r._parsed[c];f!==null&&!isNaN(f)&&this.chart.getDataVisibility(c)&&!s[c].hidden&&(h+=Math.abs(f))}return h}calculateCircumference(r){const s=this._cachedMeta.total;return s>0&&!isNaN(r)?Pt*(Math.abs(r)/s):0}getLabelAndValue(r){const s=this._cachedMeta,h=this.chart,c=h.data.labels||[],f=ir(s._parsed[r],h.options.locale);return{label:c[r]||"",value:f}}getMaxBorderWidth(r){let s=0;const h=this.chart;let c,f,d,_,y;if(!r){for(c=0,f=h.data.datasets.length;c<f;++c)if(h.isDatasetVisible(c)){d=h.getDatasetMeta(c),r=d.data,_=d.controller;break}}if(!r)return 0;for(c=0,f=r.length;c<f;++c)y=_.resolveDataElementOptions(c),y.borderAlign!=="inner"&&(s=Math.max(s,y.borderWidth||0,y.hoverBorderWidth||0));return s}getMaxOffset(r){let s=0;for(let h=0,c=r.length;h<c;++h){const f=this.resolveDataElementOptions(h);s=Math.max(s,f.offset||0,f.hoverOffset||0)}return s}_getRingWeightOffset(r){let s=0;for(let h=0;h<r;++h)this.chart.isDatasetVisible(h)&&(s+=this._getRingWeight(h));return s}_getRingWeight(r){return Math.max(gt(this.chart.data.datasets[r].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}rr.id="doughnut",rr.defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"},rr.descriptors={_scriptable:l=>l!=="spacing",_indexable:l=>l!=="spacing"},rr.overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(l){const r=l.data;if(r.labels.length&&r.datasets.length){const{labels:{pointStyle:s}}=l.legend.options;return r.labels.map((h,c)=>{const d=l.getDatasetMeta(0).controller.getStyle(c);return{text:h,fillStyle:d.backgroundColor,strokeStyle:d.borderColor,lineWidth:d.borderWidth,pointStyle:s,hidden:!l.getDataVisibility(c),index:c}})}return[]}},onClick(l,r,s){s.chart.toggleDataVisibility(r.index),s.chart.update()}},tooltip:{callbacks:{title(){return""},label(l){let r=l.label;const s=": "+l.formattedValue;return Dt(r)?(r=r.slice(),r[0]+=s):r+=s,r}}}}};class no extends en{initialize(){this.enableOptionSharing=!0,super.initialize()}update(r){const s=this._cachedMeta,{dataset:h,data:c=[],_dataset:f}=s,d=this.chart._animationsDisabled;let{start:_,count:y}=Sv(s,c,d);this._drawStart=_,this._drawCount=y,Rv(s)&&(_=0,y=c.length),h._chart=this.chart,h._datasetIndex=this.index,h._decimated=!!f._decimated,h.points=c;const x=this.resolveDatasetElementOptions(r);this.options.showLine||(x.borderWidth=0),x.segment=this.options.segment,this.updateElement(h,void 0,{animated:!d,options:x},r),this.updateElements(c,_,y,r)}updateElements(r,s,h,c){const f=c==="reset",{iScale:d,vScale:_,_stacked:y,_dataset:x}=this._cachedMeta,T=this.resolveDataElementOptions(s,c),R=this.getSharedOptions(T),O=this.includeOptions(c,R),P=d.axis,D=_.axis,{spanGaps:F,segment:B}=this.options,U=qi(F)?F:Number.POSITIVE_INFINITY,j=this.chart._animationsDisabled||f||c==="none";let Z=s>0&&this.getParsed(s-1);for(let $=s;$<s+h;++$){const H=r[$],rt=this.getParsed($),et=j?H:{},ct=It(rt[D]),lt=et[P]=d.getPixelForValue(rt[P],$),zt=et[D]=f||ct?_.getBasePixel():_.getPixelForValue(y?this.applyStack(_,rt,y):rt[D],$);et.skip=isNaN(lt)||isNaN(zt)||ct,et.stop=$>0&&rt[P]-Z[P]>U,B&&(et.parsed=rt,et.raw=x.data[$]),O&&(et.options=R||this.resolveDataElementOptions($,H.active?"active":c)),j||this.updateElement(H,$,et,c),Z=rt}this.updateSharedOptions(R,c,T)}getMaxOverflow(){const r=this._cachedMeta,s=r.dataset,h=s.options&&s.options.borderWidth||0,c=r.data||[];if(!c.length)return h;const f=c[0].size(this.resolveDataElementOptions(0)),d=c[c.length-1].size(this.resolveDataElementOptions(c.length-1));return Math.max(h,f,d)/2}draw(){const r=this._cachedMeta;r.dataset.updateControlPoints(this.chart.chartArea,r.iScale.axis),super.draw()}}no.id="line",no.defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1},no.overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};function Sv(l,r,s){const h=r.length;let c=0,f=h;if(l._sorted){const{iScale:d,_parsed:_}=l,y=d.axis,{min:x,max:T,minDefined:R,maxDefined:O}=d.getUserBounds();R&&(c=de(Math.min(hn(_,d.axis,x).lo,s?h:hn(r,y,d.getPixelForValue(x)).lo),0,h-1)),O?f=de(Math.max(hn(_,d.axis,T).hi+1,s?0:hn(r,y,d.getPixelForValue(T)).hi+1),c,h)-c:f=h-c}return{start:c,count:f}}function Rv(l){const{xScale:r,yScale:s,_scaleRanges:h}=l,c={xmin:r.min,xmax:r.max,ymin:s.min,ymax:s.max};if(!h)return l._scaleRanges=c,!0;const f=h.xmin!==r.min||h.xmax!==r.max||h.ymin!==s.min||h.ymax!==s.max;return Object.assign(h,c),f}class ls extends en{constructor(r,s){super(r,s);this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(r){const s=this._cachedMeta,h=this.chart,c=h.data.labels||[],f=ir(s._parsed[r].r,h.options.locale);return{label:c[r]||"",value:f}}update(r){const s=this._cachedMeta.data;this._updateRadius(),this.updateElements(s,0,s.length,r)}_updateRadius(){const r=this.chart,s=r.chartArea,h=r.options,c=Math.min(s.right-s.left,s.bottom-s.top),f=Math.max(c/2,0),d=Math.max(h.cutoutPercentage?f/100*h.cutoutPercentage:1,0),_=(f-d)/r.getVisibleDatasetCount();this.outerRadius=f-_*this.index,this.innerRadius=this.outerRadius-_}updateElements(r,s,h,c){const f=c==="reset",d=this.chart,_=this.getDataset(),x=d.options.animation,T=this._cachedMeta.rScale,R=T.xCenter,O=T.yCenter,P=T.getIndexAngle(0)-.5*Nt;let D=P,F;const B=360/this.countVisibleElements();for(F=0;F<s;++F)D+=this._computeAngle(F,c,B);for(F=s;F<s+h;F++){const U=r[F];let j=D,Z=D+this._computeAngle(F,c,B),$=d.getDataVisibility(F)?T.getDistanceFromCenterForValue(_.data[F]):0;D=Z,f&&(x.animateScale&&($=0),x.animateRotate&&(j=Z=P));const H={x:R,y:O,innerRadius:0,outerRadius:$,startAngle:j,endAngle:Z,options:this.resolveDataElementOptions(F,U.active?"active":c)};this.updateElement(U,F,H,c)}}countVisibleElements(){const r=this.getDataset(),s=this._cachedMeta;let h=0;return s.data.forEach((c,f)=>{!isNaN(r.data[f])&&this.chart.getDataVisibility(f)&&h++}),h}_computeAngle(r,s,h){return this.chart.getDataVisibility(r)?Ye(this.resolveDataElementOptions(r,s).angle||h):0}}ls.id="polarArea",ls.defaults={dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0},ls.overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(l){const r=l.data;if(r.labels.length&&r.datasets.length){const{labels:{pointStyle:s}}=l.legend.options;return r.labels.map((h,c)=>{const d=l.getDatasetMeta(0).controller.getStyle(c);return{text:h,fillStyle:d.backgroundColor,strokeStyle:d.borderColor,lineWidth:d.borderWidth,pointStyle:s,hidden:!l.getDataVisibility(c),index:c}})}return[]}},onClick(l,r,s){s.chart.toggleDataVisibility(r.index),s.chart.update()}},tooltip:{callbacks:{title(){return""},label(l){return l.chart.data.labels[l.dataIndex]+": "+l.formattedValue}}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}};class pl extends rr{}pl.id="pie",pl.defaults={cutout:0,rotation:0,circumference:360,radius:"100%"};class hs extends en{getLabelAndValue(r){const s=this._cachedMeta.vScale,h=this.getParsed(r);return{label:s.getLabels()[r],value:""+s.getLabelForValue(h[s.axis])}}update(r){const s=this._cachedMeta,h=s.dataset,c=s.data||[],f=s.iScale.getLabels();if(h.points=c,r!=="resize"){const d=this.resolveDatasetElementOptions(r);this.options.showLine||(d.borderWidth=0);const _={_loop:!0,_fullLoop:f.length===c.length,options:d};this.updateElement(h,void 0,_,r)}this.updateElements(c,0,c.length,r)}updateElements(r,s,h,c){const f=this.getDataset(),d=this._cachedMeta.rScale,_=c==="reset";for(let y=s;y<s+h;y++){const x=r[y],T=this.resolveDataElementOptions(y,x.active?"active":c),R=d.getPointPositionForValue(y,f.data[y]),O=_?d.xCenter:R.x,P=_?d.yCenter:R.y,D={x:O,y:P,angle:R.angle,skip:isNaN(O)||isNaN(P),options:T};this.updateElement(x,y,D,c)}}}hs.id="radar",hs.defaults={datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}},hs.overrides={aspectRatio:1,scales:{r:{type:"radialLinear"}}};class cs extends no{}cs.id="scatter",cs.defaults={showLine:!1,fill:!1},cs.overrides={interaction:{mode:"point"},plugins:{tooltip:{callbacks:{title(){return""},label(l){return"("+l.label+", "+l.formattedValue+")"}}}},scales:{x:{type:"linear"},y:{type:"linear"}}};var Au=Object.freeze({__proto__:null,BarController:ss,BubbleController:as,DoughnutController:rr,LineController:no,PolarAreaController:ls,PieController:pl,RadarController:hs,ScatterController:cs});function Pu(l,r,s){const{startAngle:h,pixelMargin:c,x:f,y:d,outerRadius:_,innerRadius:y}=r;let x=c/_;l.beginPath(),l.arc(f,d,_,h-x,s+x),y>c?(x=c/y,l.arc(f,d,y,s+x,h-x,!0)):l.arc(f,d,c,s+bt,h-bt),l.closePath(),l.clip()}function Cv(l){return Ko(l,["outerStart","outerEnd","innerStart","innerEnd"])}function Ov(l,r,s,h){const c=Cv(l.options.borderRadius),f=(s-r)/2,d=Math.min(f,h*r/2),_=y=>{const x=(s-Math.min(f,y))*h/2;return de(y,0,Math.min(f,x))};return{outerStart:_(c.outerStart),outerEnd:_(c.outerEnd),innerStart:de(c.innerStart,0,d),innerEnd:de(c.innerEnd,0,d)}}function or(l,r,s,h){return{x:s+l*Math.cos(r),y:h+l*Math.sin(r)}}function gl(l,r,s,h,c){const{x:f,y:d,startAngle:_,pixelMargin:y,innerRadius:x}=r,T=Math.max(r.outerRadius+h+s-y,0),R=x>0?x+h+s+y:0;let O=0;const P=c-_;if(h){const Vt=x>0?x-h:0,so=T>0?T-h:0,Ci=(Vt+so)/2,ao=Ci!==0?P*Ci/(Ci+h):P;O=(P-ao)/2}const D=Math.max(.001,P*T-s/Nt)/T,F=(P-D)/2,B=_+F+O,U=c-F-O,{outerStart:j,outerEnd:Z,innerStart:$,innerEnd:H}=Ov(r,R,T,U-B),rt=T-j,et=T-Z,ct=B+j/rt,lt=U-Z/et,zt=R+$,Ft=R+H,Mt=B+$/zt,ce=U-H/Ft;if(l.beginPath(),l.arc(f,d,T,ct,lt),Z>0){const Vt=or(et,lt,f,d);l.arc(Vt.x,Vt.y,Z,lt,U+bt)}const Ce=or(Ft,U,f,d);if(l.lineTo(Ce.x,Ce.y),H>0){const Vt=or(Ft,ce,f,d);l.arc(Vt.x,Vt.y,H,U+bt,ce+Math.PI)}if(l.arc(f,d,R,U-H/R,B+$/R,!0),$>0){const Vt=or(zt,Mt,f,d);l.arc(Vt.x,Vt.y,$,Mt+Math.PI,B-bt)}const Tt=or(rt,B,f,d);if(l.lineTo(Tt.x,Tt.y),j>0){const Vt=or(rt,ct,f,d);l.arc(Vt.x,Vt.y,j,B-bt,ct)}l.closePath()}function Iv(l,r,s,h){const{fullCircles:c,startAngle:f,circumference:d}=r;let _=r.endAngle;if(c){gl(l,r,s,h,f+Pt);for(let y=0;y<c;++y)l.fill();isNaN(d)||(_=f+d%Pt,d%Pt===0&&(_+=Pt))}return gl(l,r,s,h,_),l.fill(),_}function Av(l,r,s){const{x:h,y:c,startAngle:f,pixelMargin:d,fullCircles:_}=r,y=Math.max(r.outerRadius-d,0),x=r.innerRadius+d;let T;for(s&&Pu(l,r,f+Pt),l.beginPath(),l.arc(h,c,x,f+Pt,f,!0),T=0;T<_;++T)l.stroke();for(l.beginPath(),l.arc(h,c,y,f,f+Pt),T=0;T<_;++T)l.stroke()}function Pv(l,r,s,h,c){const{options:f}=r,{borderWidth:d,borderJoinStyle:_}=f,y=f.borderAlign==="inner";!d||(y?(l.lineWidth=d*2,l.lineJoin=_||"round"):(l.lineWidth=d,l.lineJoin=_||"bevel"),r.fullCircles&&Av(l,r,y),y&&Pu(l,r,c),gl(l,r,s,h,c),l.stroke())}class us extends $e{constructor(r){super();this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,r&&Object.assign(this,r)}inRange(r,s,h){const c=this.getProps(["x","y"],h),{angle:f,distance:d}=Ga(c,{x:r,y:s}),{startAngle:_,endAngle:y,innerRadius:x,outerRadius:T,circumference:R}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],h),O=this.options.spacing/2,D=gt(R,y-_)>=Pt||Qi(f,_,y),F=ln(d,x+O,T+O);return D&&F}getCenterPoint(r){const{x:s,y:h,startAngle:c,endAngle:f,innerRadius:d,outerRadius:_}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius","circumference"],r),{offset:y,spacing:x}=this.options,T=(c+f)/2,R=(d+_+x+y)/2;return{x:s+Math.cos(T)*R,y:h+Math.sin(T)*R}}tooltipPosition(r){return this.getCenterPoint(r)}draw(r){const{options:s,circumference:h}=this,c=(s.offset||0)/2,f=(s.spacing||0)/2;if(this.pixelMargin=s.borderAlign==="inner"?.33:0,this.fullCircles=h>Pt?Math.floor(h/Pt):0,h===0||this.innerRadius<0||this.outerRadius<0)return;r.save();let d=0;if(c){d=c/2;const y=(this.startAngle+this.endAngle)/2;r.translate(Math.cos(y)*d,Math.sin(y)*d),this.circumference>=Nt&&(d=c)}r.fillStyle=s.backgroundColor,r.strokeStyle=s.borderColor;const _=Iv(r,this,d,f);Pv(r,this,d,f,_),r.restore()}}us.id="arc",us.defaults={borderAlign:"center",borderColor:"#fff",borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0},us.defaultRoutes={backgroundColor:"backgroundColor"};function Mu(l,r,s=r){l.lineCap=gt(s.borderCapStyle,r.borderCapStyle),l.setLineDash(gt(s.borderDash,r.borderDash)),l.lineDashOffset=gt(s.borderDashOffset,r.borderDashOffset),l.lineJoin=gt(s.borderJoinStyle,r.borderJoinStyle),l.lineWidth=gt(s.borderWidth,r.borderWidth),l.strokeStyle=gt(s.borderColor,r.borderColor)}function Mv(l,r,s){l.lineTo(s.x,s.y)}function Lv(l){return l.stepped?cc:l.tension||l.cubicInterpolationMode==="monotone"?uc:Mv}function Lu(l,r,s={}){const h=l.length,{start:c=0,end:f=h-1}=s,{start:d,end:_}=r,y=Math.max(c,d),x=Math.min(f,_),T=c<d&&f<d||c>_&&f>_;return{count:h,start:y,loop:r.loop,ilen:x<y&&!T?h+x-y:x-y}}function Dv(l,r,s,h){const{points:c,options:f}=r,{count:d,start:_,loop:y,ilen:x}=Lu(c,s,h),T=Lv(f);let{move:R=!0,reverse:O}=h||{},P,D,F;for(P=0;P<=x;++P)D=c[(_+(O?x-P:P))%d],!D.skip&&(R?(l.moveTo(D.x,D.y),R=!1):T(l,F,D,O,f.stepped),F=D);return y&&(D=c[(_+(O?x:0))%d],T(l,F,D,O,f.stepped)),!!y}function kv(l,r,s,h){const c=r.points,{count:f,start:d,ilen:_}=Lu(c,s,h),{move:y=!0,reverse:x}=h||{};let T=0,R=0,O,P,D,F,B,U;const j=$=>(d+(x?_-$:$))%f,Z=()=>{F!==B&&(l.lineTo(T,B),l.lineTo(T,F),l.lineTo(T,U))};for(y&&(P=c[j(0)],l.moveTo(P.x,P.y)),O=0;O<=_;++O){if(P=c[j(O)],P.skip)continue;const $=P.x,H=P.y,rt=$|0;rt===D?(H<F?F=H:H>B&&(B=H),T=(R*T+$)/++R):(Z(),l.lineTo($,H),D=rt,R=0,F=B=H),U=H}Z()}function _l(l){const r=l.options,s=r.borderDash&&r.borderDash.length;return!l._decimated&&!l._loop&&!r.tension&&r.cubicInterpolationMode!=="monotone"&&!r.stepped&&!s?kv:Dv}function Fv(l){return l.stepped?Gc:l.tension||l.cubicInterpolationMode==="monotone"?zc:Hn}function Nv(l,r,s,h){let c=r._path;c||(c=r._path=new Path2D,r.path(c,s,h)&&c.closePath()),Mu(l,r.options),l.stroke(c)}function Bv(l,r,s,h){const{segments:c,options:f}=r,d=_l(r);for(const _ of c)Mu(l,f,_.style),l.beginPath(),d(l,r,_,{start:s,end:s+h-1})&&l.closePath(),l.stroke()}const Gv=typeof Path2D=="function";function zv(l,r,s,h){Gv&&!r.options.segment?Nv(l,r,s,h):Bv(l,r,s,h)}class Kn extends $e{constructor(r){super();this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,r&&Object.assign(this,r)}updateControlPoints(r,s){const h=this.options;if((h.tension||h.cubicInterpolationMode==="monotone")&&!h.stepped&&!this._pointsUpdated){const c=h.spanGaps?this._loop:this._fullLoop;Fc(this._points,h,r,c,s),this._pointsUpdated=!0}}set points(r){this._points=r,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=jc(this,this.options.segment))}first(){const r=this.segments,s=this.points;return r.length&&s[r[0].start]}last(){const r=this.segments,s=this.points,h=r.length;return h&&s[r[h-1].end]}interpolate(r,s){const h=this.options,c=r[s],f=this.points,d=rl(this,{property:s,start:c,end:c});if(!d.length)return;const _=[],y=Fv(h);let x,T;for(x=0,T=d.length;x<T;++x){const{start:R,end:O}=d[x],P=f[R],D=f[O];if(P===D){_.push(P);continue}const F=Math.abs((c-P[s])/(D[s]-P[s])),B=y(P,D,F,h.stepped);B[s]=r[s],_.push(B)}return _.length===1?_[0]:_}pathSegment(r,s,h){return _l(this)(r,this,s,h)}path(r,s,h){const c=this.segments,f=_l(this);let d=this._loop;s=s||0,h=h||this.points.length-s;for(const _ of c)d&=f(r,this,_,{start:s,end:s+h-1});return!!d}draw(r,s,h,c){const f=this.options||{};(this.points||[]).length&&f.borderWidth&&(r.save(),zv(r,this,h,c),r.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}Kn.id="line",Kn.defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0},Kn.defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"},Kn.descriptors={_scriptable:!0,_indexable:l=>l!=="borderDash"&&l!=="fill"};function Du(l,r,s,h){const c=l.options,{[s]:f}=l.getProps([s],h);return Math.abs(r-f)<c.radius+c.hitRadius}class fs extends $e{constructor(r){super();this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,r&&Object.assign(this,r)}inRange(r,s,h){const c=this.options,{x:f,y:d}=this.getProps(["x","y"],h);return Math.pow(r-f,2)+Math.pow(s-d,2)<Math.pow(c.hitRadius+c.radius,2)}inXRange(r,s){return Du(this,r,"x",s)}inYRange(r,s){return Du(this,r,"y",s)}getCenterPoint(r){const{x:s,y:h}=this.getProps(["x","y"],r);return{x:s,y:h}}size(r){r=r||this.options||{};let s=r.radius||0;s=Math.max(s,s&&r.hoverRadius||0);const h=s&&r.borderWidth||0;return(s+h)*2}draw(r,s){const h=this.options;this.skip||h.radius<.1||!jn(this,s,this.size(h)/2)||(r.strokeStyle=h.borderColor,r.lineWidth=h.borderWidth,r.fillStyle=h.backgroundColor,Xr(r,h,this.x,this.y))}getRange(){const r=this.options||{};return r.radius+r.hitRadius}}fs.id="point",fs.defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0},fs.defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};function ku(l,r){const{x:s,y:h,base:c,width:f,height:d}=l.getProps(["x","y","base","width","height"],r);let _,y,x,T,R;return l.horizontal?(R=d/2,_=Math.min(s,c),y=Math.max(s,c),x=h-R,T=h+R):(R=f/2,_=s-R,y=s+R,x=Math.min(h,c),T=Math.max(h,c)),{left:_,top:x,right:y,bottom:T}}function Zn(l,r,s,h){return l?0:de(r,s,h)}function Uv(l,r,s){const h=l.options.borderWidth,c=l.borderSkipped,f=qa(h);return{t:Zn(c.top,f.top,0,s),r:Zn(c.right,f.right,0,r),b:Zn(c.bottom,f.bottom,0,s),l:Zn(c.left,f.left,0,r)}}function Vv(l,r,s){const{enableBorderRadius:h}=l.getProps(["enableBorderRadius"]),c=l.options.borderRadius,f=Ti(c),d=Math.min(r,s),_=l.borderSkipped,y=h||vt(c);return{topLeft:Zn(!y||_.top||_.left,f.topLeft,0,d),topRight:Zn(!y||_.top||_.right,f.topRight,0,d),bottomLeft:Zn(!y||_.bottom||_.left,f.bottomLeft,0,d),bottomRight:Zn(!y||_.bottom||_.right,f.bottomRight,0,d)}}function Xv(l){const r=ku(l),s=r.right-r.left,h=r.bottom-r.top,c=Uv(l,s/2,h/2),f=Vv(l,s/2,h/2);return{outer:{x:r.left,y:r.top,w:s,h,radius:f},inner:{x:r.left+c.l,y:r.top+c.t,w:s-c.l-c.r,h:h-c.t-c.b,radius:{topLeft:Math.max(0,f.topLeft-Math.max(c.t,c.l)),topRight:Math.max(0,f.topRight-Math.max(c.t,c.r)),bottomLeft:Math.max(0,f.bottomLeft-Math.max(c.b,c.l)),bottomRight:Math.max(0,f.bottomRight-Math.max(c.b,c.r))}}}}function vl(l,r,s,h){const c=r===null,f=s===null,_=l&&!(c&&f)&&ku(l,h);return _&&(c||ln(r,_.left,_.right))&&(f||ln(s,_.top,_.bottom))}function jv(l){return l.topLeft||l.topRight||l.bottomLeft||l.bottomRight}function Wv(l,r){l.rect(r.x,r.y,r.w,r.h)}function yl(l,r,s={}){const h=l.x!==s.x?-r:0,c=l.y!==s.y?-r:0,f=(l.x+l.w!==s.x+s.w?r:0)-h,d=(l.y+l.h!==s.y+s.h?r:0)-c;return{x:l.x+h,y:l.y+c,w:l.w+f,h:l.h+d,radius:l.radius}}class ds extends $e{constructor(r){super();this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,r&&Object.assign(this,r)}draw(r){const{inflateAmount:s,options:{borderColor:h,backgroundColor:c}}=this,{inner:f,outer:d}=Xv(this),_=jv(d.radius)?Hr:Wv;r.save(),(d.w!==f.w||d.h!==f.h)&&(r.beginPath(),_(r,yl(d,s,f)),r.clip(),_(r,yl(f,-s,d)),r.fillStyle=h,r.fill("evenodd")),r.beginPath(),_(r,yl(f,s)),r.fillStyle=c,r.fill(),r.restore()}inRange(r,s,h){return vl(this,r,s,h)}inXRange(r,s){return vl(this,r,null,s)}inYRange(r,s){return vl(this,null,r,s)}getCenterPoint(r){const{x:s,y:h,base:c,horizontal:f}=this.getProps(["x","y","base","horizontal"],r);return{x:f?(s+c)/2:s,y:f?h:(h+c)/2}}getRange(r){return r==="x"?this.width/2:this.height/2}}ds.id="bar",ds.defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0},ds.defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};var ml=Object.freeze({__proto__:null,ArcElement:us,LineElement:Kn,PointElement:fs,BarElement:ds});function Hv(l,r,s,h,c){const f=c.samples||h;if(f>=s)return l.slice(r,r+s);const d=[],_=(s-2)/(f-2);let y=0;const x=r+s-1;let T=r,R,O,P,D,F;for(d[y++]=l[T],R=0;R<f-2;R++){let B=0,U=0,j;const Z=Math.floor((R+1)*_)+1+r,$=Math.min(Math.floor((R+2)*_)+1,s)+r,H=$-Z;for(j=Z;j<$;j++)B+=l[j].x,U+=l[j].y;B/=H,U/=H;const rt=Math.floor(R*_)+1+r,et=Math.min(Math.floor((R+1)*_)+1,s)+r,{x:ct,y:lt}=l[T];for(P=D=-1,j=rt;j<et;j++)D=.5*Math.abs((ct-B)*(l[j].y-lt)-(ct-l[j].x)*(U-lt)),D>P&&(P=D,O=l[j],F=j);d[y++]=O,T=F}return d[y++]=l[x],d}function Yv(l,r,s,h){let c=0,f=0,d,_,y,x,T,R,O,P,D,F;const B=[],U=r+s-1,j=l[r].x,$=l[U].x-j;for(d=r;d<r+s;++d){_=l[d],y=(_.x-j)/$*h,x=_.y;const H=y|0;if(H===T)x<D?(D=x,R=d):x>F&&(F=x,O=d),c=(f*c+_.x)/++f;else{const rt=d-1;if(!It(R)&&!It(O)){const et=Math.min(R,O),ct=Math.max(R,O);et!==P&&et!==rt&&B.push(qn(On({},l[et]),{x:c})),ct!==P&&ct!==rt&&B.push(qn(On({},l[ct]),{x:c}))}d>0&&rt!==P&&B.push(l[rt]),B.push(_),T=H,f=0,D=F=x,R=O=P=d}}return B}function Fu(l){if(l._decimated){const r=l._data;delete l._decimated,delete l._data,Object.defineProperty(l,"data",{value:r})}}function Nu(l){l.data.datasets.forEach(r=>{Fu(r)})}function $v(l,r){const s=r.length;let h=0,c;const{iScale:f}=l,{min:d,max:_,minDefined:y,maxDefined:x}=f.getUserBounds();return y&&(h=de(hn(r,f.axis,d).lo,0,s-1)),x?c=de(hn(r,f.axis,_).hi+1,h,s)-h:c=s-h,{start:h,count:c}}var Kv={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(l,r,s)=>{if(!s.enabled){Nu(l);return}const h=l.width;l.data.datasets.forEach((c,f)=>{const{_data:d,indexAxis:_}=c,y=l.getDatasetMeta(f),x=d||c.data;if(tr([_,l.options.indexAxis])==="y"||y.type!=="line")return;const T=l.scales[y.xAxisID];if(T.type!=="linear"&&T.type!=="time"||l.options.parsing)return;let{start:R,count:O}=$v(y,x);const P=s.threshold||4*h;if(O<=P){Fu(c);return}It(d)&&(c._data=x,delete c.data,Object.defineProperty(c,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(F){this._data=F}}));let D;switch(s.algorithm){case"lttb":D=Hv(x,R,O,h,s);break;case"min-max":D=Yv(x,R,O,h);break;default:throw new Error(`Unsupported decimation algorithm '${s.algorithm}'`)}c._decimated=D})},destroy(l){Nu(l)}};function Zv(l,r){const s=l.getDatasetMeta(r);return s&&l.isDatasetVisible(r)?s.dataset:null}function qv(l){const r=l.options,s=r.fill;let h=gt(s&&s.target,s);return h===void 0&&(h=!!r.backgroundColor),h===!1||h===null?!1:h===!0?"origin":h}function Jv(l,r,s){const h=qv(l);if(vt(h))return isNaN(h.value)?!1:h;let c=parseFloat(h);return jt(c)&&Math.floor(c)===c?((h[0]==="-"||h[0]==="+")&&(c=r+c),c===r||c<0||c>=s?!1:c):["origin","start","end","stack","shape"].indexOf(h)>=0&&h}function Qv(l){const{scale:r={},fill:s}=l;let h=null,c;return s==="start"?h=r.bottom:s==="end"?h=r.top:vt(s)?h=r.getPixelForValue(s.value):r.getBasePixel&&(h=r.getBasePixel()),jt(h)?(c=r.isHorizontal(),{x:c?h:null,y:c?null:h}):null}class Bu{constructor(r){this.x=r.x,this.y=r.y,this.radius=r.radius}pathSegment(r,s,h){const{x:c,y:f,radius:d}=this;return s=s||{start:0,end:Pt},r.arc(c,f,d,s.end,s.start,!0),!h.bounds}interpolate(r){const{x:s,y:h,radius:c}=this,f=r.angle;return{x:s+Math.cos(f)*c,y:h+Math.sin(f)*c,angle:f}}}function ty(l){const{scale:r,fill:s}=l,h=r.options,c=r.getLabels().length,f=[],d=h.reverse?r.max:r.min,_=h.reverse?r.min:r.max;let y,x,T;if(s==="start"?T=d:s==="end"?T=_:vt(s)?T=s.value:T=r.getBaseValue(),h.grid.circular)return x=r.getPointPositionForValue(0,d),new Bu({x:x.x,y:x.y,radius:r.getDistanceFromCenterForValue(T)});for(y=0;y<c;++y)f.push(r.getPointPositionForValue(y,T));return f}function ey(l){return(l.scale||{}).getPointPositionForValue?ty(l):Qv(l)}function xl(l,r,s){for(;r>l;r--){const h=s[r];if(!isNaN(h.x)&&!isNaN(h.y))break}return r}function ny(l,r){const{x:s=null,y:h=null}=l||{},c=r.points,f=[];return r.segments.forEach(({start:d,end:_})=>{_=xl(d,_,c);const y=c[d],x=c[_];h!==null?(f.push({x:y.x,y:h}),f.push({x:x.x,y:h})):s!==null&&(f.push({x:s,y:y.y}),f.push({x:s,y:x.y}))}),f}function iy(l){const{scale:r,index:s,line:h}=l,c=[],f=h.segments,d=h.points,_=ry(r,s);_.push(Gu({x:null,y:r.bottom},h));for(let y=0;y<f.length;y++){const x=f[y];for(let T=x.start;T<=x.end;T++)oy(c,d[T],_)}return new Kn({points:c,options:{}})}function ry(l,r){const s=[],h=l.getMatchingVisibleMetas("line");for(let c=0;c<h.length;c++){const f=h[c];if(f.index===r)break;f.hidden||s.unshift(f.dataset)}return s}function oy(l,r,s){const h=[];for(let c=0;c<s.length;c++){const f=s[c],{first:d,last:_,point:y}=sy(f,r,"x");if(!(!y||d&&_)){if(d)h.unshift(y);else if(l.push(y),!_)break}}l.push(...h)}function sy(l,r,s){const h=l.interpolate(r,s);if(!h)return{};const c=h[s],f=l.segments,d=l.points;let _=!1,y=!1;for(let x=0;x<f.length;x++){const T=f[x],R=d[T.start][s],O=d[T.end][s];if(ln(c,R,O)){_=c===R,y=c===O;break}}return{first:_,last:y,point:h}}function ay(l){const{chart:r,fill:s,line:h}=l;if(jt(s))return Zv(r,s);if(s==="stack")return iy(l);if(s==="shape")return!0;const c=ey(l);return c instanceof Bu?c:Gu(c,h)}function Gu(l,r){let s=[],h=!1;return Dt(l)?(h=!0,s=l):s=ny(l,r),s.length?new Kn({points:s,options:{tension:0},_loop:h,_fullLoop:h}):null}function ly(l,r,s){let c=l[r].fill;const f=[r];let d;if(!s)return c;for(;c!==!1&&f.indexOf(c)===-1;){if(!jt(c))return c;if(d=l[c],!d)return!1;if(d.visible)return c;f.push(c),c=d.fill}return!1}function zu(l,r,s){const{segments:h,points:c}=r;let f=!0,d=!1;l.beginPath();for(const _ of h){const{start:y,end:x}=_,T=c[y],R=c[xl(y,x,c)];f?(l.moveTo(T.x,T.y),f=!1):(l.lineTo(T.x,s),l.lineTo(T.x,T.y)),d=!!r.pathSegment(l,_,{move:d}),d?l.closePath():l.lineTo(R.x,s)}l.lineTo(r.first().x,s),l.closePath(),l.clip()}function bl(l,r,s,h){if(h)return;let c=r[l],f=s[l];return l==="angle"&&(c=Pe(c),f=Pe(f)),{property:l,start:c,end:f}}function Uu(l,r,s,h){return l&&r?h(l[s],r[s]):l?l[s]:r?r[s]:0}function hy(l,r,s){const h=l.segments,c=l.points,f=r.points,d=[];for(const _ of h){let{start:y,end:x}=_;x=xl(y,x,c);const T=bl(s,c[y],c[x],_.loop);if(!r.segments){d.push({source:_,target:T,start:c[y],end:c[x]});continue}const R=rl(r,T);for(const O of R){const P=bl(s,f[O.start],f[O.end],O.loop),D=il(_,c,P);for(const F of D)d.push({source:F,target:O,start:{[s]:Uu(T,P,"start",Math.max)},end:{[s]:Uu(T,P,"end",Math.min)}})}}return d}function cy(l,r,s){const{top:h,bottom:c}=r.chart.chartArea,{property:f,start:d,end:_}=s||{};f==="x"&&(l.beginPath(),l.rect(d,h,_-d,c-h),l.clip())}function Vu(l,r,s,h){const c=r.interpolate(s,h);c&&l.lineTo(c.x,c.y)}function Xu(l,r){const{line:s,target:h,property:c,color:f,scale:d}=r,_=hy(s,h,c);for(const{source:y,target:x,start:T,end:R}of _){const{style:{backgroundColor:O=f}={}}=y,P=h!==!0;l.save(),l.fillStyle=O,cy(l,d,P&&bl(c,T,R)),l.beginPath();const D=!!s.pathSegment(l,y);let F;if(P){D?l.closePath():Vu(l,h,R,c);const B=!!h.pathSegment(l,x,{move:D,reverse:!0});F=D&&B,F||Vu(l,h,T,c)}l.closePath(),l.fill(F?"evenodd":"nonzero"),l.restore()}}function uy(l,r){const{line:s,target:h,above:c,below:f,area:d,scale:_}=r,y=s._loop?"angle":r.axis;l.save(),y==="x"&&f!==c&&(zu(l,h,d.top),Xu(l,{line:s,target:h,color:c,scale:_,property:y}),l.restore(),l.save(),zu(l,h,d.bottom)),Xu(l,{line:s,target:h,color:f,scale:_,property:y}),l.restore()}function El(l,r,s){const h=ay(r),{line:c,scale:f,axis:d}=r,_=c.options,y=_.fill,x=_.backgroundColor,{above:T=x,below:R=x}=y||{};h&&c.points.length&&(jr(l,s),uy(l,{line:c,target:h,above:T,below:R,area:s,scale:f,axis:d}),Wr(l))}var fy={id:"filler",afterDatasetsUpdate(l,r,s){const h=(l.data.datasets||[]).length,c=[];let f,d,_,y;for(d=0;d<h;++d)f=l.getDatasetMeta(d),_=f.dataset,y=null,_&&_.options&&_ instanceof Kn&&(y={visible:l.isDatasetVisible(d),index:d,fill:Jv(_,d,h),chart:l,axis:f.controller.options.indexAxis,scale:f.vScale,line:_}),f.$filler=y,c.push(y);for(d=0;d<h;++d)y=c[d],!(!y||y.fill===!1)&&(y.fill=ly(c,d,s.propagate))},beforeDraw(l,r,s){const h=s.drawTime==="beforeDraw",c=l.getSortedVisibleDatasetMetas(),f=l.chartArea;for(let d=c.length-1;d>=0;--d){const _=c[d].$filler;!_||(_.line.updateControlPoints(f,_.axis),h&&El(l.ctx,_,f))}},beforeDatasetsDraw(l,r,s){if(s.drawTime!=="beforeDatasetsDraw")return;const h=l.getSortedVisibleDatasetMetas();for(let c=h.length-1;c>=0;--c){const f=h[c].$filler;f&&El(l.ctx,f,l.chartArea)}},beforeDatasetDraw(l,r,s){const h=r.meta.$filler;!h||h.fill===!1||s.drawTime!=="beforeDatasetDraw"||El(l.ctx,h,l.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const ju=(l,r)=>{let{boxHeight:s=r,boxWidth:h=r}=l;return l.usePointStyle&&(s=Math.min(s,r),h=Math.min(h,r)),{boxWidth:h,boxHeight:s,itemHeight:Math.max(r,s)}},dy=(l,r)=>l!==null&&r!==null&&l.datasetIndex===r.datasetIndex&&l.index===r.index;class Wu extends $e{constructor(r){super();this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=r.chart,this.options=r.options,this.ctx=r.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(r,s,h){this.maxWidth=r,this.maxHeight=s,this._margins=h,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const r=this.options.labels||{};let s=kt(r.generateLabels,[this.chart],this)||[];r.filter&&(s=s.filter(h=>r.filter(h,this.chart.data))),r.sort&&(s=s.sort((h,c)=>r.sort(h,c,this.chart.data))),this.options.reverse&&s.reverse(),this.legendItems=s}fit(){const{options:r,ctx:s}=this;if(!r.display){this.width=this.height=0;return}const h=r.labels,c=he(h.font),f=c.size,d=this._computeTitleHeight(),{boxWidth:_,itemHeight:y}=ju(h,f);let x,T;s.font=c.string,this.isHorizontal()?(x=this.maxWidth,T=this._fitRows(d,f,_,y)+10):(T=this.maxHeight,x=this._fitCols(d,f,_,y)+10),this.width=Math.min(x,r.maxWidth||this.maxWidth),this.height=Math.min(T,r.maxHeight||this.maxHeight)}_fitRows(r,s,h,c){const{ctx:f,maxWidth:d,options:{labels:{padding:_}}}=this,y=this.legendHitBoxes=[],x=this.lineWidths=[0],T=c+_;let R=r;f.textAlign="left",f.textBaseline="middle";let O=-1,P=-T;return this.legendItems.forEach((D,F)=>{const B=h+s/2+f.measureText(D.text).width;(F===0||x[x.length-1]+B+2*_>d)&&(R+=T,x[x.length-(F>0?0:1)]=0,P+=T,O++),y[F]={left:0,top:P,row:O,width:B,height:c},x[x.length-1]+=B+_}),R}_fitCols(r,s,h,c){const{ctx:f,maxHeight:d,options:{labels:{padding:_}}}=this,y=this.legendHitBoxes=[],x=this.columnSizes=[],T=d-r;let R=_,O=0,P=0,D=0,F=0;return this.legendItems.forEach((B,U)=>{const j=h+s/2+f.measureText(B.text).width;U>0&&P+c+2*_>T&&(R+=O+_,x.push({width:O,height:P}),D+=O+_,F++,O=P=0),y[U]={left:D,top:P,col:F,width:j,height:c},O=Math.max(O,j),P+=c+_}),R+=O,x.push({width:O,height:P}),R}adjustHitBoxes(){if(!this.options.display)return;const r=this._computeTitleHeight(),{legendHitBoxes:s,options:{align:h,labels:{padding:c},rtl:f}}=this,d=Si(f,this.left,this.width);if(this.isHorizontal()){let _=0,y=p(h,this.left+c,this.right-this.lineWidths[_]);for(const x of s)_!==x.row&&(_=x.row,y=p(h,this.left+c,this.right-this.lineWidths[_])),x.top+=this.top+r+c,x.left=d.leftForLtr(d.x(y),x.width),y+=x.width+c}else{let _=0,y=p(h,this.top+r+c,this.bottom-this.columnSizes[_].height);for(const x of s)x.col!==_&&(_=x.col,y=p(h,this.top+r+c,this.bottom-this.columnSizes[_].height)),x.top=y,x.left+=this.left+c,x.left=d.leftForLtr(d.x(x.left),x.width),y+=x.height+c}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const r=this.ctx;jr(r,this),this._draw(),Wr(r)}}_draw(){const{options:r,columnSizes:s,lineWidths:h,ctx:c}=this,{align:f,labels:d}=r,_=Et.color,y=Si(r.rtl,this.left,this.width),x=he(d.font),{color:T,padding:R}=d,O=x.size,P=O/2;let D;this.drawTitle(),c.textAlign=y.textAlign("left"),c.textBaseline="middle",c.lineWidth=.5,c.font=x.string;const{boxWidth:F,boxHeight:B,itemHeight:U}=ju(d,O),j=function(et,ct,lt){if(isNaN(F)||F<=0||isNaN(B)||B<0)return;c.save();const zt=gt(lt.lineWidth,1);if(c.fillStyle=gt(lt.fillStyle,_),c.lineCap=gt(lt.lineCap,"butt"),c.lineDashOffset=gt(lt.lineDashOffset,0),c.lineJoin=gt(lt.lineJoin,"miter"),c.lineWidth=zt,c.strokeStyle=gt(lt.strokeStyle,_),c.setLineDash(gt(lt.lineDash,[])),d.usePointStyle){const Ft={radius:F*Math.SQRT2/2,pointStyle:lt.pointStyle,rotation:lt.rotation,borderWidth:zt},Mt=y.xPlus(et,F/2),ce=ct+P;Xr(c,Ft,Mt,ce)}else{const Ft=ct+Math.max((O-B)/2,0),Mt=y.leftForLtr(et,F),ce=Ti(lt.borderRadius);c.beginPath(),Object.values(ce).some(Ce=>Ce!==0)?Hr(c,{x:Mt,y:Ft,w:F,h:B,radius:ce}):c.rect(Mt,Ft,F,B),c.fill(),zt!==0&&c.stroke()}c.restore()},Z=function(et,ct,lt){Wn(c,lt.text,et,ct+U/2,x,{strikethrough:lt.hidden,textAlign:y.textAlign(lt.textAlign)})},$=this.isHorizontal(),H=this._computeTitleHeight();$?D={x:p(f,this.left+R,this.right-h[0]),y:this.top+R+H,line:0}:D={x:this.left+R,y:p(f,this.top+H+R,this.bottom-s[0].height),line:0},el(this.ctx,r.textDirection);const rt=U+R;this.legendItems.forEach((et,ct)=>{c.strokeStyle=et.fontColor||T,c.fillStyle=et.fontColor||T;const lt=c.measureText(et.text).width,zt=y.textAlign(et.textAlign||(et.textAlign=d.textAlign)),Ft=F+P+lt;let Mt=D.x,ce=D.y;y.setWidth(this.width),$?ct>0&&Mt+Ft+R>this.right&&(ce=D.y+=rt,D.line++,Mt=D.x=p(f,this.left+R,this.right-h[D.line])):ct>0&&ce+rt>this.bottom&&(Mt=D.x=Mt+s[D.line].width+R,D.line++,ce=D.y=p(f,this.top+H+R,this.bottom-s[D.line].height));const Ce=y.x(Mt);j(Ce,ce,et),Mt=g(zt,Mt+F+P,$?Mt+Ft:this.right,r.rtl),Z(y.x(Mt),ce,et),$?D.x+=Ft+R:D.y+=rt}),nl(this.ctx,r.textDirection)}drawTitle(){const r=this.options,s=r.title,h=he(s.font),c=ve(s.padding);if(!s.display)return;const f=Si(r.rtl,this.left,this.width),d=this.ctx,_=s.position,y=h.size/2,x=c.top+y;let T,R=this.left,O=this.width;if(this.isHorizontal())O=Math.max(...this.lineWidths),T=this.top+x,R=p(r.align,R,this.right-O);else{const D=this.columnSizes.reduce((F,B)=>Math.max(F,B.height),0);T=x+p(r.align,this.top,this.bottom-D-r.labels.padding-this._computeTitleHeight())}const P=p(_,R,R+O);d.textAlign=f.textAlign(u(_)),d.textBaseline="middle",d.strokeStyle=s.color,d.fillStyle=s.color,d.font=h.string,Wn(d,s.text,P,T,h)}_computeTitleHeight(){const r=this.options.title,s=he(r.font),h=ve(r.padding);return r.display?s.lineHeight+h.height:0}_getLegendItemAt(r,s){let h,c,f;if(ln(r,this.left,this.right)&&ln(s,this.top,this.bottom)){for(f=this.legendHitBoxes,h=0;h<f.length;++h)if(c=f[h],ln(r,c.left,c.left+c.width)&&ln(s,c.top,c.top+c.height))return this.legendItems[h]}return null}handleEvent(r){const s=this.options;if(!py(r.type,s))return;const h=this._getLegendItemAt(r.x,r.y);if(r.type==="mousemove"){const c=this._hoveredItem,f=dy(c,h);c&&!f&&kt(s.onLeave,[r,c,this],this),this._hoveredItem=h,h&&!f&&kt(s.onHover,[r,h,this],this)}else h&&kt(s.onClick,[r,h,this],this)}}function py(l,r){return!!(l==="mousemove"&&(r.onHover||r.onLeave)||r.onClick&&(l==="click"||l==="mouseup"))}var gy={id:"legend",_element:Wu,start(l,r,s){const h=l.legend=new Wu({ctx:l.ctx,options:s,chart:l});ye.configure(l,h,s),ye.addBox(l,h)},stop(l){ye.removeBox(l,l.legend),delete l.legend},beforeUpdate(l,r,s){const h=l.legend;ye.configure(l,h,s),h.options=s},afterUpdate(l){const r=l.legend;r.buildLabels(),r.adjustHitBoxes()},afterEvent(l,r){r.replay||l.legend.handleEvent(r.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(l,r,s){const h=r.datasetIndex,c=s.chart;c.isDatasetVisible(h)?(c.hide(h),r.hidden=!0):(c.show(h),r.hidden=!1)},onHover:null,onLeave:null,labels:{color:l=>l.chart.options.color,boxWidth:40,padding:10,generateLabels(l){const r=l.data.datasets,{labels:{usePointStyle:s,pointStyle:h,textAlign:c,color:f}}=l.legend.options;return l._getSortedDatasetMetas().map(d=>{const _=d.controller.getStyle(s?0:void 0),y=ve(_.borderWidth);return{text:r[d.index].label,fillStyle:_.backgroundColor,fontColor:f,hidden:!d.visible,lineCap:_.borderCapStyle,lineDash:_.borderDash,lineDashOffset:_.borderDashOffset,lineJoin:_.borderJoinStyle,lineWidth:(y.width+y.height)/4,strokeStyle:_.borderColor,pointStyle:h||_.pointStyle,rotation:_.rotation,textAlign:c||_.textAlign,borderRadius:0,datasetIndex:d.index}},this)}},title:{color:l=>l.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:l=>!l.startsWith("on"),labels:{_scriptable:l=>!["generateLabels","filter","sort"].includes(l)}}};class Tl extends $e{constructor(r){super();this.chart=r.chart,this.options=r.options,this.ctx=r.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(r,s){const h=this.options;if(this.left=0,this.top=0,!h.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=r,this.height=this.bottom=s;const c=Dt(h.text)?h.text.length:1;this._padding=ve(h.padding);const f=c*he(h.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=f:this.width=f}isHorizontal(){const r=this.options.position;return r==="top"||r==="bottom"}_drawArgs(r){const{top:s,left:h,bottom:c,right:f,options:d}=this,_=d.align;let y=0,x,T,R;return this.isHorizontal()?(T=p(_,h,f),R=s+r,x=f-h):(d.position==="left"?(T=h+r,R=p(_,c,s),y=Nt*-.5):(T=f-r,R=p(_,s,c),y=Nt*.5),x=c-s),{titleX:T,titleY:R,maxWidth:x,rotation:y}}draw(){const r=this.ctx,s=this.options;if(!s.display)return;const h=he(s.font),f=h.lineHeight/2+this._padding.top,{titleX:d,titleY:_,maxWidth:y,rotation:x}=this._drawArgs(f);Wn(r,s.text,0,0,h,{color:s.color,maxWidth:y,rotation:x,textAlign:u(s.align),textBaseline:"middle",translation:[d,_]})}}function _y(l,r){const s=new Tl({ctx:l.ctx,options:r,chart:l});ye.configure(l,s,r),ye.addBox(l,s),l.titleBlock=s}var vy={id:"title",_element:Tl,start(l,r,s){_y(l,s)},stop(l){const r=l.titleBlock;ye.removeBox(l,r),delete l.titleBlock},beforeUpdate(l,r,s){const h=l.titleBlock;ye.configure(l,h,s),h.options=s},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const ps=new WeakMap;var yy={id:"subtitle",start(l,r,s){const h=new Tl({ctx:l.ctx,options:s,chart:l});ye.configure(l,h,s),ye.addBox(l,h),ps.set(l,h)},stop(l){ye.removeBox(l,ps.get(l)),ps.delete(l)},beforeUpdate(l,r,s){const h=ps.get(l);ye.configure(l,h,s),h.options=s},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const io={average(l){if(!l.length)return!1;let r,s,h=0,c=0,f=0;for(r=0,s=l.length;r<s;++r){const d=l[r].element;if(d&&d.hasValue()){const _=d.tooltipPosition();h+=_.x,c+=_.y,++f}}return{x:h/f,y:c/f}},nearest(l,r){if(!l.length)return!1;let s=r.x,h=r.y,c=Number.POSITIVE_INFINITY,f,d,_;for(f=0,d=l.length;f<d;++f){const y=l[f].element;if(y&&y.hasValue()){const x=y.getCenterPoint(),T=jo(r,x);T<c&&(c=T,_=y)}}if(_){const y=_.tooltipPosition();s=y.x,h=y.y}return{x:s,y:h}}};function un(l,r){return r&&(Dt(r)?Array.prototype.push.apply(l,r):l.push(r)),l}function Cn(l){return(typeof l=="string"||l instanceof String)&&l.indexOf(`
`)>-1?l.split(`
`):l}function my(l,r){const{element:s,datasetIndex:h,index:c}=r,f=l.getDatasetMeta(h).controller,{label:d,value:_}=f.getLabelAndValue(c);return{chart:l,label:d,parsed:f.getParsed(c),raw:l.data.datasets[h].data[c],formattedValue:_,dataset:f.getDataset(),dataIndex:c,datasetIndex:h,element:s}}function Hu(l,r){const s=l.chart.ctx,{body:h,footer:c,title:f}=l,{boxWidth:d,boxHeight:_}=r,y=he(r.bodyFont),x=he(r.titleFont),T=he(r.footerFont),R=f.length,O=c.length,P=h.length,D=ve(r.padding);let F=D.height,B=0,U=h.reduce(($,H)=>$+H.before.length+H.lines.length+H.after.length,0);if(U+=l.beforeBody.length+l.afterBody.length,R&&(F+=R*x.lineHeight+(R-1)*r.titleSpacing+r.titleMarginBottom),U){const $=r.displayColors?Math.max(_,y.lineHeight):y.lineHeight;F+=P*$+(U-P)*y.lineHeight+(U-1)*r.bodySpacing}O&&(F+=r.footerMarginTop+O*T.lineHeight+(O-1)*r.footerSpacing);let j=0;const Z=function($){B=Math.max(B,s.measureText($).width+j)};return s.save(),s.font=x.string,At(l.title,Z),s.font=y.string,At(l.beforeBody.concat(l.afterBody),Z),j=r.displayColors?d+2+r.boxPadding:0,At(h,$=>{At($.before,Z),At($.lines,Z),At($.after,Z)}),j=0,s.font=T.string,At(l.footer,Z),s.restore(),B+=D.width,{width:B,height:F}}function xy(l,r){const{y:s,height:h}=r;return s<h/2?"top":s>l.height-h/2?"bottom":"center"}function by(l,r,s,h){const{x:c,width:f}=h,d=s.caretSize+s.caretPadding;if(l==="left"&&c+f+d>r.width||l==="right"&&c-f-d<0)return!0}function Ey(l,r,s,h){const{x:c,width:f}=s,{width:d,chartArea:{left:_,right:y}}=l;let x="center";return h==="center"?x=c<=(_+y)/2?"left":"right":c<=f/2?x="left":c>=d-f/2&&(x="right"),by(x,l,r,s)&&(x="center"),x}function Yu(l,r,s){const h=s.yAlign||r.yAlign||xy(l,s);return{xAlign:s.xAlign||r.xAlign||Ey(l,r,s,h),yAlign:h}}function Ty(l,r){let{x:s,width:h}=l;return r==="right"?s-=h:r==="center"&&(s-=h/2),s}function wy(l,r,s){let{y:h,height:c}=l;return r==="top"?h+=s:r==="bottom"?h-=c+s:h-=c/2,h}function $u(l,r,s,h){const{caretSize:c,caretPadding:f,cornerRadius:d}=l,{xAlign:_,yAlign:y}=s,x=c+f,{topLeft:T,topRight:R,bottomLeft:O,bottomRight:P}=Ti(d);let D=Ty(r,_);const F=wy(r,y,x);return y==="center"?_==="left"?D+=x:_==="right"&&(D-=x):_==="left"?D-=Math.max(T,O)+c:_==="right"&&(D+=Math.max(R,P)+c),{x:de(D,0,h.width-r.width),y:de(F,0,h.height-r.height)}}function gs(l,r,s){const h=ve(s.padding);return r==="center"?l.x+l.width/2:r==="right"?l.x+l.width-h.right:l.x+h.left}function Ku(l){return un([],Cn(l))}function Sy(l,r,s){return Rn(l,{tooltip:r,tooltipItems:s,type:"tooltip"})}function Zu(l,r){const s=r&&r.dataset&&r.dataset.tooltip&&r.dataset.tooltip.callbacks;return s?l.override(s):l}class wl extends $e{constructor(r){super();this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=r.chart||r._chart,this._chart=this.chart,this.options=r.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(r){this.options=r,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const r=this._cachedAnimations;if(r)return r;const s=this.chart,h=this.options.setContext(this.getContext()),c=h.enabled&&s.options.animation&&h.animations,f=new al(this.chart,c);return c._cacheable&&(this._cachedAnimations=Object.freeze(f)),f}getContext(){return this.$context||(this.$context=Sy(this.chart.getContext(),this,this._tooltipItems))}getTitle(r,s){const{callbacks:h}=s,c=h.beforeTitle.apply(this,[r]),f=h.title.apply(this,[r]),d=h.afterTitle.apply(this,[r]);let _=[];return _=un(_,Cn(c)),_=un(_,Cn(f)),_=un(_,Cn(d)),_}getBeforeBody(r,s){return Ku(s.callbacks.beforeBody.apply(this,[r]))}getBody(r,s){const{callbacks:h}=s,c=[];return At(r,f=>{const d={before:[],lines:[],after:[]},_=Zu(h,f);un(d.before,Cn(_.beforeLabel.call(this,f))),un(d.lines,_.label.call(this,f)),un(d.after,Cn(_.afterLabel.call(this,f))),c.push(d)}),c}getAfterBody(r,s){return Ku(s.callbacks.afterBody.apply(this,[r]))}getFooter(r,s){const{callbacks:h}=s,c=h.beforeFooter.apply(this,[r]),f=h.footer.apply(this,[r]),d=h.afterFooter.apply(this,[r]);let _=[];return _=un(_,Cn(c)),_=un(_,Cn(f)),_=un(_,Cn(d)),_}_createItems(r){const s=this._active,h=this.chart.data,c=[],f=[],d=[];let _=[],y,x;for(y=0,x=s.length;y<x;++y)_.push(my(this.chart,s[y]));return r.filter&&(_=_.filter((T,R,O)=>r.filter(T,R,O,h))),r.itemSort&&(_=_.sort((T,R)=>r.itemSort(T,R,h))),At(_,T=>{const R=Zu(r.callbacks,T);c.push(R.labelColor.call(this,T)),f.push(R.labelPointStyle.call(this,T)),d.push(R.labelTextColor.call(this,T))}),this.labelColors=c,this.labelPointStyles=f,this.labelTextColors=d,this.dataPoints=_,_}update(r,s){const h=this.options.setContext(this.getContext()),c=this._active;let f,d=[];if(!c.length)this.opacity!==0&&(f={opacity:0});else{const _=io[h.position].call(this,c,this._eventPosition);d=this._createItems(h),this.title=this.getTitle(d,h),this.beforeBody=this.getBeforeBody(d,h),this.body=this.getBody(d,h),this.afterBody=this.getAfterBody(d,h),this.footer=this.getFooter(d,h);const y=this._size=Hu(this,h),x=Object.assign({},_,y),T=Yu(this.chart,h,x),R=$u(h,x,T,this.chart);this.xAlign=T.xAlign,this.yAlign=T.yAlign,f={opacity:1,x:R.x,y:R.y,width:y.width,height:y.height,caretX:_.x,caretY:_.y}}this._tooltipItems=d,this.$context=void 0,f&&this._resolveAnimations().update(this,f),r&&h.external&&h.external.call(this,{chart:this.chart,tooltip:this,replay:s})}drawCaret(r,s,h,c){const f=this.getCaretPosition(r,h,c);s.lineTo(f.x1,f.y1),s.lineTo(f.x2,f.y2),s.lineTo(f.x3,f.y3)}getCaretPosition(r,s,h){const{xAlign:c,yAlign:f}=this,{caretSize:d,cornerRadius:_}=h,{topLeft:y,topRight:x,bottomLeft:T,bottomRight:R}=Ti(_),{x:O,y:P}=r,{width:D,height:F}=s;let B,U,j,Z,$,H;return f==="center"?($=P+F/2,c==="left"?(B=O,U=B-d,Z=$+d,H=$-d):(B=O+D,U=B+d,Z=$-d,H=$+d),j=B):(c==="left"?U=O+Math.max(y,T)+d:c==="right"?U=O+D-Math.max(x,R)-d:U=this.caretX,f==="top"?(Z=P,$=Z-d,B=U-d,j=U+d):(Z=P+F,$=Z+d,B=U+d,j=U-d),H=Z),{x1:B,x2:U,x3:j,y1:Z,y2:$,y3:H}}drawTitle(r,s,h){const c=this.title,f=c.length;let d,_,y;if(f){const x=Si(h.rtl,this.x,this.width);for(r.x=gs(this,h.titleAlign,h),s.textAlign=x.textAlign(h.titleAlign),s.textBaseline="middle",d=he(h.titleFont),_=h.titleSpacing,s.fillStyle=h.titleColor,s.font=d.string,y=0;y<f;++y)s.fillText(c[y],x.x(r.x),r.y+d.lineHeight/2),r.y+=d.lineHeight+_,y+1===f&&(r.y+=h.titleMarginBottom-_)}}_drawColorBox(r,s,h,c,f){const d=this.labelColors[h],_=this.labelPointStyles[h],{boxHeight:y,boxWidth:x,boxPadding:T}=f,R=he(f.bodyFont),O=gs(this,"left",f),P=c.x(O),D=y<R.lineHeight?(R.lineHeight-y)/2:0,F=s.y+D;if(f.usePointStyle){const B={radius:Math.min(x,y)/2,pointStyle:_.pointStyle,rotation:_.rotation,borderWidth:1},U=c.leftForLtr(P,x)+x/2,j=F+y/2;r.strokeStyle=f.multiKeyBackground,r.fillStyle=f.multiKeyBackground,Xr(r,B,U,j),r.strokeStyle=d.borderColor,r.fillStyle=d.backgroundColor,Xr(r,B,U,j)}else{r.lineWidth=d.borderWidth||1,r.strokeStyle=d.borderColor,r.setLineDash(d.borderDash||[]),r.lineDashOffset=d.borderDashOffset||0;const B=c.leftForLtr(P,x-T),U=c.leftForLtr(c.xPlus(P,1),x-T-2),j=Ti(d.borderRadius);Object.values(j).some(Z=>Z!==0)?(r.beginPath(),r.fillStyle=f.multiKeyBackground,Hr(r,{x:B,y:F,w:x,h:y,radius:j}),r.fill(),r.stroke(),r.fillStyle=d.backgroundColor,r.beginPath(),Hr(r,{x:U,y:F+1,w:x-2,h:y-2,radius:j}),r.fill()):(r.fillStyle=f.multiKeyBackground,r.fillRect(B,F,x,y),r.strokeRect(B,F,x,y),r.fillStyle=d.backgroundColor,r.fillRect(U,F+1,x-2,y-2))}r.fillStyle=this.labelTextColors[h]}drawBody(r,s,h){const{body:c}=this,{bodySpacing:f,bodyAlign:d,displayColors:_,boxHeight:y,boxWidth:x,boxPadding:T}=h,R=he(h.bodyFont);let O=R.lineHeight,P=0;const D=Si(h.rtl,this.x,this.width),F=function(ct){s.fillText(ct,D.x(r.x+P),r.y+O/2),r.y+=O+f},B=D.textAlign(d);let U,j,Z,$,H,rt,et;for(s.textAlign=d,s.textBaseline="middle",s.font=R.string,r.x=gs(this,B,h),s.fillStyle=h.bodyColor,At(this.beforeBody,F),P=_&&B!=="right"?d==="center"?x/2+T:x+2+T:0,$=0,rt=c.length;$<rt;++$){for(U=c[$],j=this.labelTextColors[$],s.fillStyle=j,At(U.before,F),Z=U.lines,_&&Z.length&&(this._drawColorBox(s,r,$,D,h),O=Math.max(R.lineHeight,y)),H=0,et=Z.length;H<et;++H)F(Z[H]),O=R.lineHeight;At(U.after,F)}P=0,O=R.lineHeight,At(this.afterBody,F),r.y-=f}drawFooter(r,s,h){const c=this.footer,f=c.length;let d,_;if(f){const y=Si(h.rtl,this.x,this.width);for(r.x=gs(this,h.footerAlign,h),r.y+=h.footerMarginTop,s.textAlign=y.textAlign(h.footerAlign),s.textBaseline="middle",d=he(h.footerFont),s.fillStyle=h.footerColor,s.font=d.string,_=0;_<f;++_)s.fillText(c[_],y.x(r.x),r.y+d.lineHeight/2),r.y+=d.lineHeight+h.footerSpacing}}drawBackground(r,s,h,c){const{xAlign:f,yAlign:d}=this,{x:_,y}=r,{width:x,height:T}=h,{topLeft:R,topRight:O,bottomLeft:P,bottomRight:D}=Ti(c.cornerRadius);s.fillStyle=c.backgroundColor,s.strokeStyle=c.borderColor,s.lineWidth=c.borderWidth,s.beginPath(),s.moveTo(_+R,y),d==="top"&&this.drawCaret(r,s,h,c),s.lineTo(_+x-O,y),s.quadraticCurveTo(_+x,y,_+x,y+O),d==="center"&&f==="right"&&this.drawCaret(r,s,h,c),s.lineTo(_+x,y+T-D),s.quadraticCurveTo(_+x,y+T,_+x-D,y+T),d==="bottom"&&this.drawCaret(r,s,h,c),s.lineTo(_+P,y+T),s.quadraticCurveTo(_,y+T,_,y+T-P),d==="center"&&f==="left"&&this.drawCaret(r,s,h,c),s.lineTo(_,y+R),s.quadraticCurveTo(_,y,_+R,y),s.closePath(),s.fill(),c.borderWidth>0&&s.stroke()}_updateAnimationTarget(r){const s=this.chart,h=this.$animations,c=h&&h.x,f=h&&h.y;if(c||f){const d=io[r.position].call(this,this._active,this._eventPosition);if(!d)return;const _=this._size=Hu(this,r),y=Object.assign({},d,this._size),x=Yu(s,r,y),T=$u(r,y,x,s);(c._to!==T.x||f._to!==T.y)&&(this.xAlign=x.xAlign,this.yAlign=x.yAlign,this.width=_.width,this.height=_.height,this.caretX=d.x,this.caretY=d.y,this._resolveAnimations().update(this,T))}}draw(r){const s=this.options.setContext(this.getContext());let h=this.opacity;if(!h)return;this._updateAnimationTarget(s);const c={width:this.width,height:this.height},f={x:this.x,y:this.y};h=Math.abs(h)<.001?0:h;const d=ve(s.padding),_=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;s.enabled&&_&&(r.save(),r.globalAlpha=h,this.drawBackground(f,r,c,s),el(r,s.textDirection),f.y+=d.top,this.drawTitle(f,r,s),this.drawBody(f,r,s),this.drawFooter(f,r,s),nl(r,s.textDirection),r.restore())}getActiveElements(){return this._active||[]}setActiveElements(r,s){const h=this._active,c=r.map(({datasetIndex:_,index:y})=>{const x=this.chart.getDatasetMeta(_);if(!x)throw new Error("Cannot find a dataset at index "+_);return{datasetIndex:_,element:x.data[y],index:y}}),f=!_i(h,c),d=this._positionChanged(c,s);(f||d)&&(this._active=c,this._eventPosition=s,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(r,s,h=!0){if(s&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const c=this.options,f=this._active||[],d=this._getActiveElements(r,f,s,h),_=this._positionChanged(d,r),y=s||!_i(d,f)||_;return y&&(this._active=d,(c.enabled||c.external)&&(this._eventPosition={x:r.x,y:r.y},this.update(!0,s))),y}_getActiveElements(r,s,h,c){const f=this.options;if(r.type==="mouseout")return[];if(!c)return s;const d=this.chart.getElementsAtEventForMode(r,f.mode,f,h);return f.reverse&&d.reverse(),d}_positionChanged(r,s){const{caretX:h,caretY:c,options:f}=this,d=io[f.position].call(this,r,s);return d!==!1&&(h!==d.x||c!==d.y)}}wl.positioners=io;var Ry={id:"tooltip",_element:wl,positioners:io,afterInit(l,r,s){s&&(l.tooltip=new wl({chart:l,options:s}))},beforeUpdate(l,r,s){l.tooltip&&l.tooltip.initialize(s)},reset(l,r,s){l.tooltip&&l.tooltip.initialize(s)},afterDraw(l){const r=l.tooltip,s={tooltip:r};l.notifyPlugins("beforeTooltipDraw",s)!==!1&&(r&&r.draw(l.ctx),l.notifyPlugins("afterTooltipDraw",s))},afterEvent(l,r){if(l.tooltip){const s=r.replay;l.tooltip.handleEvent(r.event,s,r.inChartArea)&&(r.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(l,r)=>r.bodyFont.size,boxWidth:(l,r)=>r.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:{beforeTitle:Te,title(l){if(l.length>0){const r=l[0],s=r.chart.data.labels,h=s?s.length:0;if(this&&this.options&&this.options.mode==="dataset")return r.dataset.label||"";if(r.label)return r.label;if(h>0&&r.dataIndex<h)return s[r.dataIndex]}return""},afterTitle:Te,beforeBody:Te,beforeLabel:Te,label(l){if(this&&this.options&&this.options.mode==="dataset")return l.label+": "+l.formattedValue||l.formattedValue;let r=l.dataset.label||"";r&&(r+=": ");const s=l.formattedValue;return It(s)||(r+=s),r},labelColor(l){const s=l.chart.getDatasetMeta(l.datasetIndex).controller.getStyle(l.dataIndex);return{borderColor:s.borderColor,backgroundColor:s.backgroundColor,borderWidth:s.borderWidth,borderDash:s.borderDash,borderDashOffset:s.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(l){const s=l.chart.getDatasetMeta(l.datasetIndex).controller.getStyle(l.dataIndex);return{pointStyle:s.pointStyle,rotation:s.rotation}},afterLabel:Te,afterBody:Te,beforeFooter:Te,footer:Te,afterFooter:Te}},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:l=>l!=="filter"&&l!=="itemSort"&&l!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},qu=Object.freeze({__proto__:null,Decimation:Kv,Filler:fy,Legend:gy,SubTitle:yy,Title:vy,Tooltip:Ry});const Cy=(l,r,s,h)=>(typeof r=="string"?(s=l.push(r)-1,h.unshift({index:s,label:r})):isNaN(r)&&(s=null),s);function Oy(l,r,s,h){const c=l.indexOf(r);if(c===-1)return Cy(l,r,s,h);const f=l.lastIndexOf(r);return c!==f?s:c}const Iy=(l,r)=>l===null?null:de(Math.round(l),0,r);class _s extends Yn{constructor(r){super(r);this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(r){const s=this._addedLabels;if(s.length){const h=this.getLabels();for(const{index:c,label:f}of s)h[c]===f&&h.splice(c,1);this._addedLabels=[]}super.init(r)}parse(r,s){if(It(r))return null;const h=this.getLabels();return s=isFinite(s)&&h[s]===r?s:Oy(h,r,gt(s,r),this._addedLabels),Iy(s,h.length-1)}determineDataLimits(){const{minDefined:r,maxDefined:s}=this.getUserBounds();let{min:h,max:c}=this.getMinMax(!0);this.options.bounds==="ticks"&&(r||(h=0),s||(c=this.getLabels().length-1)),this.min=h,this.max=c}buildTicks(){const r=this.min,s=this.max,h=this.options.offset,c=[];let f=this.getLabels();f=r===0&&s===f.length-1?f:f.slice(r,s+1),this._valueRange=Math.max(f.length-(h?0:1),1),this._startValue=this.min-(h?.5:0);for(let d=r;d<=s;d++)c.push({value:d});return c}getLabelForValue(r){const s=this.getLabels();return r>=0&&r<s.length?s[r]:r}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(r){return typeof r!="number"&&(r=this.parse(r)),r===null?NaN:this.getPixelForDecimal((r-this._startValue)/this._valueRange)}getPixelForTick(r){const s=this.ticks;return r<0||r>s.length-1?null:this.getPixelForValue(s[r].value)}getValueForPixel(r){return Math.round(this._startValue+this.getDecimalForPixel(r)*this._valueRange)}getBasePixel(){return this.bottom}}_s.id="category",_s.defaults={ticks:{callback:_s.prototype.getLabelForValue}};function Ay(l,r){const s=[],{bounds:c,step:f,min:d,max:_,precision:y,count:x,maxTicks:T,maxDigits:R,includeBounds:O}=l,P=f||1,D=T-1,{min:F,max:B}=r,U=!It(d),j=!It(_),Z=!It(x),$=(B-F)/(R+1);let H=Fa((B-F)/D/P)*P,rt,et,ct,lt;if(H<1e-14&&!U&&!j)return[{value:F},{value:B}];lt=Math.ceil(B/H)-Math.floor(F/H),lt>D&&(H=Fa(lt*H/D/P)*P),It(y)||(rt=Math.pow(10,y),H=Math.ceil(H*rt)/rt),c==="ticks"?(et=Math.floor(F/H)*H,ct=Math.ceil(B/H)*H):(et=F,ct=B),U&&j&&f&&oc((_-d)/f,H/1e3)?(lt=Math.round(Math.min((_-d)/H,T)),H=(_-d)/lt,et=d,ct=_):Z?(et=U?d:et,ct=j?_:ct,lt=x-1,H=(ct-et)/lt):(lt=(ct-et)/H,Ji(lt,Math.round(lt),H/1e3)?lt=Math.round(lt):lt=Math.ceil(lt));const zt=Math.max(Ba(H),Ba(et));rt=Math.pow(10,It(y)?zt:y),et=Math.round(et*rt)/rt,ct=Math.round(ct*rt)/rt;let Ft=0;for(U&&(O&&et!==d?(s.push({value:d}),et<d&&Ft++,Ji(Math.round((et+Ft*H)*rt)/rt,d,Ju(d,$,l))&&Ft++):et<d&&Ft++);Ft<lt;++Ft)s.push({value:Math.round((et+Ft*H)*rt)/rt});return j&&O&&ct!==_?s.length&&Ji(s[s.length-1].value,_,Ju(_,$,l))?s[s.length-1].value=_:s.push({value:_}):(!j||ct===_)&&s.push({value:ct}),s}function Ju(l,r,{horizontal:s,minRotation:h}){const c=Ye(h),f=(s?Math.sin(c):Math.cos(c))||.001,d=.75*r*(""+l).length;return Math.min(r/f,d)}class vs extends Yn{constructor(r){super(r);this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(r,s){return It(r)||(typeof r=="number"||r instanceof Number)&&!isFinite(+r)?null:+r}handleTickRangeOptions(){const{beginAtZero:r}=this.options,{minDefined:s,maxDefined:h}=this.getUserBounds();let{min:c,max:f}=this;const d=y=>c=s?c:y,_=y=>f=h?f:y;if(r){const y=Ae(c),x=Ae(f);y<0&&x<0?_(0):y>0&&x>0&&d(0)}if(c===f){let y=1;(f>=Number.MAX_SAFE_INTEGER||c<=Number.MIN_SAFE_INTEGER)&&(y=Math.abs(f*.05)),_(f+y),r||d(c-y)}this.min=c,this.max=f}getTickLimit(){const r=this.options.ticks;let{maxTicksLimit:s,stepSize:h}=r,c;return h?(c=Math.ceil(this.max/h)-Math.floor(this.min/h)+1,c>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${h} would result generating up to ${c} ticks. Limiting to 1000.`),c=1e3)):(c=this.computeTickLimit(),s=s||11),s&&(c=Math.min(s,c)),c}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const r=this.options,s=r.ticks;let h=this.getTickLimit();h=Math.max(2,h);const c={maxTicks:h,bounds:r.bounds,min:r.min,max:r.max,precision:s.precision,step:s.stepSize,count:s.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:s.minRotation||0,includeBounds:s.includeBounds!==!1},f=this._range||this,d=Ay(c,f);return r.bounds==="ticks"&&Na(d,this,"value"),r.reverse?(d.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),d}configure(){const r=this.ticks;let s=this.min,h=this.max;if(super.configure(),this.options.offset&&r.length){const c=(h-s)/Math.max(r.length-1,1)/2;s-=c,h+=c}this._startValue=s,this._endValue=h,this._valueRange=h-s}getLabelForValue(r){return ir(r,this.chart.options.locale,this.options.ticks.format)}}class Sl extends vs{determineDataLimits(){const{min:r,max:s}=this.getMinMax(!0);this.min=jt(r)?r:0,this.max=jt(s)?s:1,this.handleTickRangeOptions()}computeTickLimit(){const r=this.isHorizontal(),s=r?this.width:this.height,h=Ye(this.options.ticks.minRotation),c=(r?Math.sin(h):Math.cos(h))||.001,f=this._resolveTickFontOptions(0);return Math.ceil(s/Math.min(40,f.lineHeight/c))}getPixelForValue(r){return r===null?NaN:this.getPixelForDecimal((r-this._startValue)/this._valueRange)}getValueForPixel(r){return this._startValue+this.getDecimalForPixel(r)*this._valueRange}}Sl.id="linear",Sl.defaults={ticks:{callback:Qr.formatters.numeric}};function Qu(l){return l/Math.pow(10,Math.floor(Re(l)))===1}function Py(l,r){const s=Math.floor(Re(r.max)),h=Math.ceil(r.max/Math.pow(10,s)),c=[];let f=we(l.min,Math.pow(10,Math.floor(Re(r.min)))),d=Math.floor(Re(f)),_=Math.floor(f/Math.pow(10,d)),y=d<0?Math.pow(10,Math.abs(d)):1;do c.push({value:f,major:Qu(f)}),++_,_===10&&(_=1,++d,y=d>=0?1:y),f=Math.round(_*Math.pow(10,d)*y)/y;while(d<s||d===s&&_<h);const x=we(l.max,f);return c.push({value:x,major:Qu(f)}),c}class Rl extends Yn{constructor(r){super(r);this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(r,s){const h=vs.prototype.parse.apply(this,[r,s]);if(h===0){this._zero=!0;return}return jt(h)&&h>0?h:null}determineDataLimits(){const{min:r,max:s}=this.getMinMax(!0);this.min=jt(r)?Math.max(0,r):null,this.max=jt(s)?Math.max(0,s):null,this.options.beginAtZero&&(this._zero=!0),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:r,maxDefined:s}=this.getUserBounds();let h=this.min,c=this.max;const f=y=>h=r?h:y,d=y=>c=s?c:y,_=(y,x)=>Math.pow(10,Math.floor(Re(y))+x);h===c&&(h<=0?(f(1),d(10)):(f(_(h,-1)),d(_(c,1)))),h<=0&&f(_(c,-1)),c<=0&&d(_(h,1)),this._zero&&this.min!==this._suggestedMin&&h===_(this.min,0)&&f(_(h,-1)),this.min=h,this.max=c}buildTicks(){const r=this.options,s={min:this._userMin,max:this._userMax},h=Py(s,this);return r.bounds==="ticks"&&Na(h,this,"value"),r.reverse?(h.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),h}getLabelForValue(r){return r===void 0?"0":ir(r,this.chart.options.locale,this.options.ticks.format)}configure(){const r=this.min;super.configure(),this._startValue=Re(r),this._valueRange=Re(this.max)-Re(r)}getPixelForValue(r){return(r===void 0||r===0)&&(r=this.min),r===null||isNaN(r)?NaN:this.getPixelForDecimal(r===this.min?0:(Re(r)-this._startValue)/this._valueRange)}getValueForPixel(r){const s=this.getDecimalForPixel(r);return Math.pow(10,this._startValue+s*this._valueRange)}}Rl.id="logarithmic",Rl.defaults={ticks:{callback:Qr.formatters.logarithmic,major:{enabled:!0}}};function Cl(l){const r=l.ticks;if(r.display&&l.display){const s=ve(r.backdropPadding);return gt(r.font&&r.font.size,Et.font.size)+s.height}return 0}function My(l,r,s){return s=Dt(s)?s:[s],{w:hc(l,r.string,s),h:s.length*r.lineHeight}}function tf(l,r,s,h,c){return l===h||l===c?{start:r-s/2,end:r+s/2}:l<h||l>c?{start:r-s,end:r}:{start:r,end:r+s}}function Ly(l){const r={l:l.left+l._padding.left,r:l.right-l._padding.right,t:l.top+l._padding.top,b:l.bottom-l._padding.bottom},s=Object.assign({},r),h=[],c=[],f=l._pointLabels.length,d=l.options.pointLabels,_=d.centerPointLabels?Nt/f:0;for(let y=0;y<f;y++){const x=d.setContext(l.getPointLabelContext(y));c[y]=x.padding;const T=l.getPointPosition(y,l.drawingArea+c[y],_),R=he(x.font),O=My(l.ctx,R,l._pointLabels[y]);h[y]=O;const P=Pe(l.getIndexAngle(y)+_),D=Math.round(Xo(P)),F=tf(D,T.x,O.w,0,180),B=tf(D,T.y,O.h,90,270);Dy(s,r,P,F,B)}l.setCenterPoint(r.l-s.l,s.r-r.r,r.t-s.t,s.b-r.b),l._pointLabelItems=ky(l,h,c)}function Dy(l,r,s,h,c){const f=Math.abs(Math.sin(s)),d=Math.abs(Math.cos(s));let _=0,y=0;h.start<r.l?(_=(r.l-h.start)/f,l.l=Math.min(l.l,r.l-_)):h.end>r.r&&(_=(h.end-r.r)/f,l.r=Math.max(l.r,r.r+_)),c.start<r.t?(y=(r.t-c.start)/d,l.t=Math.min(l.t,r.t-y)):c.end>r.b&&(y=(c.end-r.b)/d,l.b=Math.max(l.b,r.b+y))}function ky(l,r,s){const h=[],c=l._pointLabels.length,f=l.options,d=Cl(f)/2,_=l.drawingArea,y=f.pointLabels.centerPointLabels?Nt/c:0;for(let x=0;x<c;x++){const T=l.getPointPosition(x,_+d+s[x],y),R=Math.round(Xo(Pe(T.angle+bt))),O=r[x],P=By(T.y,O.h,R),D=Fy(R),F=Ny(T.x,O.w,D);h.push({x:T.x,y:P,textAlign:D,left:F,top:P,right:F+O.w,bottom:P+O.h})}return h}function Fy(l){return l===0||l===180?"center":l<180?"left":"right"}function Ny(l,r,s){return s==="right"?l-=r:s==="center"&&(l-=r/2),l}function By(l,r,s){return s===90||s===270?l-=r/2:(s>270||s<90)&&(l-=r),l}function Gy(l,r){const{ctx:s,options:{pointLabels:h}}=l;for(let c=r-1;c>=0;c--){const f=h.setContext(l.getPointLabelContext(c)),d=he(f.font),{x:_,y,textAlign:x,left:T,top:R,right:O,bottom:P}=l._pointLabelItems[c],{backdropColor:D}=f;if(!It(D)){const F=ve(f.backdropPadding);s.fillStyle=D,s.fillRect(T-F.left,R-F.top,O-T+F.width,P-R+F.height)}Wn(s,l._pointLabels[c],_,y+d.lineHeight/2,d,{color:f.color,textAlign:x,textBaseline:"middle"})}}function ef(l,r,s,h){const{ctx:c}=l;if(s)c.arc(l.xCenter,l.yCenter,r,0,Pt);else{let f=l.getPointPosition(0,r);c.moveTo(f.x,f.y);for(let d=1;d<h;d++)f=l.getPointPosition(d,r),c.lineTo(f.x,f.y)}}function zy(l,r,s,h){const c=l.ctx,f=r.circular,{color:d,lineWidth:_}=r;!f&&!h||!d||!_||s<0||(c.save(),c.strokeStyle=d,c.lineWidth=_,c.setLineDash(r.borderDash),c.lineDashOffset=r.borderDashOffset,c.beginPath(),ef(l,s,f,h),c.closePath(),c.stroke(),c.restore())}function Uy(l,r,s){return Rn(l,{label:s,index:r,type:"pointLabel"})}class ro extends vs{constructor(r){super(r);this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const r=this._padding=ve(Cl(this.options)/2),s=this.width=this.maxWidth-r.width,h=this.height=this.maxHeight-r.height;this.xCenter=Math.floor(this.left+s/2+r.left),this.yCenter=Math.floor(this.top+h/2+r.top),this.drawingArea=Math.floor(Math.min(s,h)/2)}determineDataLimits(){const{min:r,max:s}=this.getMinMax(!1);this.min=jt(r)&&!isNaN(r)?r:0,this.max=jt(s)&&!isNaN(s)?s:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/Cl(this.options))}generateTickLabels(r){vs.prototype.generateTickLabels.call(this,r),this._pointLabels=this.getLabels().map((s,h)=>{const c=kt(this.options.pointLabels.callback,[s,h],this);return c||c===0?c:""}).filter((s,h)=>this.chart.getDataVisibility(h))}fit(){const r=this.options;r.display&&r.pointLabels.display?Ly(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(r,s,h,c){this.xCenter+=Math.floor((r-s)/2),this.yCenter+=Math.floor((h-c)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(r,s,h,c))}getIndexAngle(r){const s=Pt/(this._pointLabels.length||1),h=this.options.startAngle||0;return Pe(r*s+Ye(h))}getDistanceFromCenterForValue(r){if(It(r))return NaN;const s=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-r)*s:(r-this.min)*s}getValueForDistanceFromCenter(r){if(It(r))return NaN;const s=r/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-s:this.min+s}getPointLabelContext(r){const s=this._pointLabels||[];if(r>=0&&r<s.length){const h=s[r];return Uy(this.getContext(),r,h)}}getPointPosition(r,s,h=0){const c=this.getIndexAngle(r)-bt+h;return{x:Math.cos(c)*s+this.xCenter,y:Math.sin(c)*s+this.yCenter,angle:c}}getPointPositionForValue(r,s){return this.getPointPosition(r,this.getDistanceFromCenterForValue(s))}getBasePosition(r){return this.getPointPositionForValue(r||0,this.getBaseValue())}getPointLabelPosition(r){const{left:s,top:h,right:c,bottom:f}=this._pointLabelItems[r];return{left:s,top:h,right:c,bottom:f}}drawBackground(){const{backgroundColor:r,grid:{circular:s}}=this.options;if(r){const h=this.ctx;h.save(),h.beginPath(),ef(this,this.getDistanceFromCenterForValue(this._endValue),s,this._pointLabels.length),h.closePath(),h.fillStyle=r,h.fill(),h.restore()}}drawGrid(){const r=this.ctx,s=this.options,{angleLines:h,grid:c}=s,f=this._pointLabels.length;let d,_,y;if(s.pointLabels.display&&Gy(this,f),c.display&&this.ticks.forEach((x,T)=>{if(T!==0){_=this.getDistanceFromCenterForValue(x.value);const R=c.setContext(this.getContext(T-1));zy(this,R,_,f)}}),h.display){for(r.save(),d=f-1;d>=0;d--){const x=h.setContext(this.getPointLabelContext(d)),{color:T,lineWidth:R}=x;!R||!T||(r.lineWidth=R,r.strokeStyle=T,r.setLineDash(x.borderDash),r.lineDashOffset=x.borderDashOffset,_=this.getDistanceFromCenterForValue(s.ticks.reverse?this.min:this.max),y=this.getPointPosition(d,_),r.beginPath(),r.moveTo(this.xCenter,this.yCenter),r.lineTo(y.x,y.y),r.stroke())}r.restore()}}drawBorder(){}drawLabels(){const r=this.ctx,s=this.options,h=s.ticks;if(!h.display)return;const c=this.getIndexAngle(0);let f,d;r.save(),r.translate(this.xCenter,this.yCenter),r.rotate(c),r.textAlign="center",r.textBaseline="middle",this.ticks.forEach((_,y)=>{if(y===0&&!s.reverse)return;const x=h.setContext(this.getContext(y)),T=he(x.font);if(f=this.getDistanceFromCenterForValue(this.ticks[y].value),x.showLabelBackdrop){r.font=T.string,d=r.measureText(_.label).width,r.fillStyle=x.backdropColor;const R=ve(x.backdropPadding);r.fillRect(-d/2-R.left,-f-T.size/2-R.top,d+R.width,T.size+R.height)}Wn(r,_.label,0,-f,T,{color:x.color})}),r.restore()}drawTitle(){}}ro.id="radialLinear",ro.defaults={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:Qr.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(l){return l},padding:5,centerPointLabels:!1}},ro.defaultRoutes={"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"},ro.descriptors={angleLines:{_fallback:"grid"}};const ys={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Me=Object.keys(ys);function Vy(l,r){return l-r}function nf(l,r){if(It(r))return null;const s=l._adapter,{parser:h,round:c,isoWeekday:f}=l._parseOpts;let d=r;return typeof h=="function"&&(d=h(d)),jt(d)||(d=typeof h=="string"?s.parse(d,h):s.parse(d)),d===null?null:(c&&(d=c==="week"&&(qi(f)||f===!0)?s.startOf(d,"isoWeek",f):s.startOf(d,c)),+d)}function rf(l,r,s,h){const c=Me.length;for(let f=Me.indexOf(l);f<c-1;++f){const d=ys[Me[f]],_=d.steps?d.steps:Number.MAX_SAFE_INTEGER;if(d.common&&Math.ceil((s-r)/(_*d.size))<=h)return Me[f]}return Me[c-1]}function Xy(l,r,s,h,c){for(let f=Me.length-1;f>=Me.indexOf(s);f--){const d=Me[f];if(ys[d].common&&l._adapter.diff(c,h,d)>=r-1)return d}return Me[s?Me.indexOf(s):0]}function jy(l){for(let r=Me.indexOf(l)+1,s=Me.length;r<s;++r)if(ys[Me[r]].common)return Me[r]}function of(l,r,s){if(!s)l[r]=!0;else if(s.length){const{lo:h,hi:c}=Wo(s,r),f=s[h]>=r?s[h]:s[c];l[f]=!0}}function Wy(l,r,s,h){const c=l._adapter,f=+c.startOf(r[0].value,h),d=r[r.length-1].value;let _,y;for(_=f;_<=d;_=+c.add(_,1,h))y=s[_],y>=0&&(r[y].major=!0);return r}function sf(l,r,s){const h=[],c={},f=r.length;let d,_;for(d=0;d<f;++d)_=r[d],c[_]=d,h.push({value:_,major:!1});return f===0||!s?h:Wy(l,h,c,s)}class oo extends Yn{constructor(r){super(r);this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(r,s){const h=r.time||(r.time={}),c=this._adapter=new Su._date(r.adapters.date);Je(h.displayFormats,c.formats()),this._parseOpts={parser:h.parser,round:h.round,isoWeekday:h.isoWeekday},super.init(r),this._normalized=s.normalized}parse(r,s){return r===void 0?null:nf(this,r)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const r=this.options,s=this._adapter,h=r.time.unit||"day";let{min:c,max:f,minDefined:d,maxDefined:_}=this.getUserBounds();function y(x){!d&&!isNaN(x.min)&&(c=Math.min(c,x.min)),!_&&!isNaN(x.max)&&(f=Math.max(f,x.max))}(!d||!_)&&(y(this._getLabelBounds()),(r.bounds!=="ticks"||r.ticks.source!=="labels")&&y(this.getMinMax(!1))),c=jt(c)&&!isNaN(c)?c:+s.startOf(Date.now(),h),f=jt(f)&&!isNaN(f)?f:+s.endOf(Date.now(),h)+1,this.min=Math.min(c,f-1),this.max=Math.max(c+1,f)}_getLabelBounds(){const r=this.getLabelTimestamps();let s=Number.POSITIVE_INFINITY,h=Number.NEGATIVE_INFINITY;return r.length&&(s=r[0],h=r[r.length-1]),{min:s,max:h}}buildTicks(){const r=this.options,s=r.time,h=r.ticks,c=h.source==="labels"?this.getLabelTimestamps():this._generate();r.bounds==="ticks"&&c.length&&(this.min=this._userMin||c[0],this.max=this._userMax||c[c.length-1]);const f=this.min,d=this.max,_=dc(c,f,d);return this._unit=s.unit||(h.autoSkip?rf(s.minUnit,this.min,this.max,this._getLabelCapacity(f)):Xy(this,_.length,s.minUnit,this.min,this.max)),this._majorUnit=!h.major.enabled||this._unit==="year"?void 0:jy(this._unit),this.initOffsets(c),r.reverse&&_.reverse(),sf(this,_,this._majorUnit)}initOffsets(r){let s=0,h=0,c,f;this.options.offset&&r.length&&(c=this.getDecimalForValue(r[0]),r.length===1?s=1-c:s=(this.getDecimalForValue(r[1])-c)/2,f=this.getDecimalForValue(r[r.length-1]),r.length===1?h=f:h=(f-this.getDecimalForValue(r[r.length-2]))/2);const d=r.length<3?.5:.25;s=de(s,0,d),h=de(h,0,d),this._offsets={start:s,end:h,factor:1/(s+1+h)}}_generate(){const r=this._adapter,s=this.min,h=this.max,c=this.options,f=c.time,d=f.unit||rf(f.minUnit,s,h,this._getLabelCapacity(s)),_=gt(f.stepSize,1),y=d==="week"?f.isoWeekday:!1,x=qi(y)||y===!0,T={};let R=s,O,P;if(x&&(R=+r.startOf(R,"isoWeek",y)),R=+r.startOf(R,x?"day":d),r.diff(h,s,d)>1e5*_)throw new Error(s+" and "+h+" are too far apart with stepSize of "+_+" "+d);const D=c.ticks.source==="data"&&this.getDataTimestamps();for(O=R,P=0;O<h;O=+r.add(O,_,d),P++)of(T,O,D);return(O===h||c.bounds==="ticks"||P===1)&&of(T,O,D),Object.keys(T).sort((F,B)=>F-B).map(F=>+F)}getLabelForValue(r){const s=this._adapter,h=this.options.time;return h.tooltipFormat?s.format(r,h.tooltipFormat):s.format(r,h.displayFormats.datetime)}_tickFormatFunction(r,s,h,c){const f=this.options,d=f.time.displayFormats,_=this._unit,y=this._majorUnit,x=_&&d[_],T=y&&d[y],R=h[s],O=y&&T&&R&&R.major,P=this._adapter.format(r,c||(O?T:x)),D=f.ticks.callback;return D?kt(D,[P,s,h],this):P}generateTickLabels(r){let s,h,c;for(s=0,h=r.length;s<h;++s)c=r[s],c.label=this._tickFormatFunction(c.value,s,r)}getDecimalForValue(r){return r===null?NaN:(r-this.min)/(this.max-this.min)}getPixelForValue(r){const s=this._offsets,h=this.getDecimalForValue(r);return this.getPixelForDecimal((s.start+h)*s.factor)}getValueForPixel(r){const s=this._offsets,h=this.getDecimalForPixel(r)/s.factor-s.end;return this.min+h*(this.max-this.min)}_getLabelSize(r){const s=this.options.ticks,h=this.ctx.measureText(r).width,c=Ye(this.isHorizontal()?s.maxRotation:s.minRotation),f=Math.cos(c),d=Math.sin(c),_=this._resolveTickFontOptions(0).size;return{w:h*f+_*d,h:h*d+_*f}}_getLabelCapacity(r){const s=this.options.time,h=s.displayFormats,c=h[s.unit]||h.millisecond,f=this._tickFormatFunction(r,0,sf(this,[r],this._majorUnit),c),d=this._getLabelSize(f),_=Math.floor(this.isHorizontal()?this.width/d.w:this.height/d.h)-1;return _>0?_:1}getDataTimestamps(){let r=this._cache.data||[],s,h;if(r.length)return r;const c=this.getMatchingVisibleMetas();if(this._normalized&&c.length)return this._cache.data=c[0].controller.getAllParsedValues(this);for(s=0,h=c.length;s<h;++s)r=r.concat(c[s].controller.getAllParsedValues(this));return this._cache.data=this.normalize(r)}getLabelTimestamps(){const r=this._cache.labels||[];let s,h;if(r.length)return r;const c=this.getLabels();for(s=0,h=c.length;s<h;++s)r.push(nf(this,c[s]));return this._cache.labels=this._normalized?r:this.normalize(r)}normalize(r){return Va(r.sort(Vy))}}oo.id="time",oo.defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",major:{enabled:!1}}};function ms(l,r,s){let h=0,c=l.length-1,f,d,_,y;s?(r>=l[h].pos&&r<=l[c].pos&&({lo:h,hi:c}=hn(l,"pos",r)),{pos:f,time:_}=l[h],{pos:d,time:y}=l[c]):(r>=l[h].time&&r<=l[c].time&&({lo:h,hi:c}=hn(l,"time",r)),{time:f,pos:_}=l[h],{time:d,pos:y}=l[c]);const x=d-f;return x?_+(y-_)*(r-f)/x:_}class Ol extends oo{constructor(r){super(r);this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const r=this._getTimestampsForTable(),s=this._table=this.buildLookupTable(r);this._minPos=ms(s,this.min),this._tableRange=ms(s,this.max)-this._minPos,super.initOffsets(r)}buildLookupTable(r){const{min:s,max:h}=this,c=[],f=[];let d,_,y,x,T;for(d=0,_=r.length;d<_;++d)x=r[d],x>=s&&x<=h&&c.push(x);if(c.length<2)return[{time:s,pos:0},{time:h,pos:1}];for(d=0,_=c.length;d<_;++d)T=c[d+1],y=c[d-1],x=c[d],Math.round((T+y)/2)!==x&&f.push({time:x,pos:d/(_-1)});return f}_getTimestampsForTable(){let r=this._cache.all||[];if(r.length)return r;const s=this.getDataTimestamps(),h=this.getLabelTimestamps();return s.length&&h.length?r=this.normalize(s.concat(h)):r=s.length?s:h,r=this._cache.all=r,r}getDecimalForValue(r){return(ms(this._table,r)-this._minPos)/this._tableRange}getValueForPixel(r){const s=this._offsets,h=this.getDecimalForPixel(r)/s.factor-s.end;return ms(this._table,h*this._tableRange+this._minPos,!0)}}Ol.id="timeseries",Ol.defaults=oo.defaults;var af=Object.freeze({__proto__:null,CategoryScale:_s,LinearScale:Sl,LogarithmicScale:Rl,RadialLinearScale:ro,TimeScale:oo,TimeSeriesScale:Ol});return te.register(Au,af,ml,qu),te.helpers=On({},o_),te._adapters=Su,te.Animation=nu,te.Animations=al,te.animator=m,te.controllers=cn.controllers.items,te.DatasetController=en,te.Element=$e,te.elements=ml,te.Interaction=xc,te.layouts=ye,te.platforms=tu,te.Scale=Yn,te.Ticks=Qr,Object.assign(te,Au,af,ml,qu,tu),te.Chart=te,typeof window!="undefined"&&(window.Chart=te),te})})(pg);var vd=pg.exports,rR={jet:[{index:0,rgb:[0,0,131]},{index:.125,rgb:[0,60,170]},{index:.375,rgb:[5,255,255]},{index:.625,rgb:[255,255,0]},{index:.875,rgb:[250,0,0]},{index:1,rgb:[128,0,0]}],hsv:[{index:0,rgb:[255,0,0]},{index:.169,rgb:[253,255,2]},{index:.173,rgb:[247,255,2]},{index:.337,rgb:[0,252,4]},{index:.341,rgb:[0,252,10]},{index:.506,rgb:[1,249,255]},{index:.671,rgb:[2,0,253]},{index:.675,rgb:[8,0,253]},{index:.839,rgb:[255,0,251]},{index:.843,rgb:[255,0,245]},{index:1,rgb:[255,0,6]}],hot:[{index:0,rgb:[0,0,0]},{index:.3,rgb:[230,0,0]},{index:.6,rgb:[255,210,0]},{index:1,rgb:[255,255,255]}],spring:[{index:0,rgb:[255,0,255]},{index:1,rgb:[255,255,0]}],summer:[{index:0,rgb:[0,128,102]},{index:1,rgb:[255,255,102]}],autumn:[{index:0,rgb:[255,0,0]},{index:1,rgb:[255,255,0]}],winter:[{index:0,rgb:[0,0,255]},{index:1,rgb:[0,255,128]}],bone:[{index:0,rgb:[0,0,0]},{index:.376,rgb:[84,84,116]},{index:.753,rgb:[169,200,200]},{index:1,rgb:[255,255,255]}],copper:[{index:0,rgb:[0,0,0]},{index:.804,rgb:[255,160,102]},{index:1,rgb:[255,199,127]}],greys:[{index:0,rgb:[0,0,0]},{index:1,rgb:[255,255,255]}],yignbu:[{index:0,rgb:[8,29,88]},{index:.125,rgb:[37,52,148]},{index:.25,rgb:[34,94,168]},{index:.375,rgb:[29,145,192]},{index:.5,rgb:[65,182,196]},{index:.625,rgb:[127,205,187]},{index:.75,rgb:[199,233,180]},{index:.875,rgb:[237,248,217]},{index:1,rgb:[255,255,217]}],greens:[{index:0,rgb:[0,68,27]},{index:.125,rgb:[0,109,44]},{index:.25,rgb:[35,139,69]},{index:.375,rgb:[65,171,93]},{index:.5,rgb:[116,196,118]},{index:.625,rgb:[161,217,155]},{index:.75,rgb:[199,233,192]},{index:.875,rgb:[229,245,224]},{index:1,rgb:[247,252,245]}],yiorrd:[{index:0,rgb:[128,0,38]},{index:.125,rgb:[189,0,38]},{index:.25,rgb:[227,26,28]},{index:.375,rgb:[252,78,42]},{index:.5,rgb:[253,141,60]},{index:.625,rgb:[254,178,76]},{index:.75,rgb:[254,217,118]},{index:.875,rgb:[255,237,160]},{index:1,rgb:[255,255,204]}],bluered:[{index:0,rgb:[0,0,255]},{index:1,rgb:[255,0,0]}],rdbu:[{index:0,rgb:[5,10,172]},{index:.35,rgb:[106,137,247]},{index:.5,rgb:[190,190,190]},{index:.6,rgb:[220,170,132]},{index:.7,rgb:[230,145,90]},{index:1,rgb:[178,10,28]}],picnic:[{index:0,rgb:[0,0,255]},{index:.1,rgb:[51,153,255]},{index:.2,rgb:[102,204,255]},{index:.3,rgb:[153,204,255]},{index:.4,rgb:[204,204,255]},{index:.5,rgb:[255,255,255]},{index:.6,rgb:[255,204,255]},{index:.7,rgb:[255,153,255]},{index:.8,rgb:[255,102,204]},{index:.9,rgb:[255,102,102]},{index:1,rgb:[255,0,0]}],rainbow:[{index:0,rgb:[150,0,90]},{index:.125,rgb:[0,0,200]},{index:.25,rgb:[0,25,255]},{index:.375,rgb:[0,152,255]},{index:.5,rgb:[44,255,150]},{index:.625,rgb:[151,255,0]},{index:.75,rgb:[255,234,0]},{index:.875,rgb:[255,111,0]},{index:1,rgb:[255,0,0]}],portland:[{index:0,rgb:[12,51,131]},{index:.25,rgb:[10,136,186]},{index:.5,rgb:[242,211,56]},{index:.75,rgb:[242,143,56]},{index:1,rgb:[217,30,30]}],blackbody:[{index:0,rgb:[0,0,0]},{index:.2,rgb:[230,0,0]},{index:.4,rgb:[230,210,0]},{index:.7,rgb:[255,255,255]},{index:1,rgb:[160,200,255]}],earth:[{index:0,rgb:[0,0,130]},{index:.1,rgb:[0,180,180]},{index:.2,rgb:[40,210,40]},{index:.4,rgb:[230,230,50]},{index:.6,rgb:[120,70,20]},{index:1,rgb:[255,255,255]}],electric:[{index:0,rgb:[0,0,0]},{index:.15,rgb:[30,0,100]},{index:.4,rgb:[120,0,100]},{index:.6,rgb:[160,90,0]},{index:.8,rgb:[230,200,0]},{index:1,rgb:[255,250,220]}],alpha:[{index:0,rgb:[255,255,255,0]},{index:1,rgb:[255,255,255,1]}],viridis:[{index:0,rgb:[68,1,84]},{index:.13,rgb:[71,44,122]},{index:.25,rgb:[59,81,139]},{index:.38,rgb:[44,113,142]},{index:.5,rgb:[33,144,141]},{index:.63,rgb:[39,173,129]},{index:.75,rgb:[92,200,99]},{index:.88,rgb:[170,220,50]},{index:1,rgb:[253,231,37]}],inferno:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[31,12,72]},{index:.25,rgb:[85,15,109]},{index:.38,rgb:[136,34,106]},{index:.5,rgb:[186,54,85]},{index:.63,rgb:[227,89,51]},{index:.75,rgb:[249,140,10]},{index:.88,rgb:[249,201,50]},{index:1,rgb:[252,255,164]}],magma:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[28,16,68]},{index:.25,rgb:[79,18,123]},{index:.38,rgb:[129,37,129]},{index:.5,rgb:[181,54,122]},{index:.63,rgb:[229,80,100]},{index:.75,rgb:[251,135,97]},{index:.88,rgb:[254,194,135]},{index:1,rgb:[252,253,191]}],plasma:[{index:0,rgb:[13,8,135]},{index:.13,rgb:[75,3,161]},{index:.25,rgb:[125,3,168]},{index:.38,rgb:[168,34,150]},{index:.5,rgb:[203,70,121]},{index:.63,rgb:[229,107,93]},{index:.75,rgb:[248,148,65]},{index:.88,rgb:[253,195,40]},{index:1,rgb:[240,249,33]}],warm:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[172,0,187]},{index:.25,rgb:[219,0,170]},{index:.38,rgb:[255,0,130]},{index:.5,rgb:[255,63,74]},{index:.63,rgb:[255,123,0]},{index:.75,rgb:[234,176,0]},{index:.88,rgb:[190,228,0]},{index:1,rgb:[147,255,0]}],cool:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[116,0,218]},{index:.25,rgb:[98,74,237]},{index:.38,rgb:[68,146,231]},{index:.5,rgb:[0,204,197]},{index:.63,rgb:[0,247,146]},{index:.75,rgb:[0,255,88]},{index:.88,rgb:[40,255,8]},{index:1,rgb:[147,255,0]}],"rainbow-soft":[{index:0,rgb:[125,0,179]},{index:.1,rgb:[199,0,180]},{index:.2,rgb:[255,0,121]},{index:.3,rgb:[255,108,0]},{index:.4,rgb:[222,194,0]},{index:.5,rgb:[150,255,0]},{index:.6,rgb:[0,255,55]},{index:.7,rgb:[0,246,150]},{index:.8,rgb:[50,167,222]},{index:.9,rgb:[103,51,235]},{index:1,rgb:[124,0,186]}],bathymetry:[{index:0,rgb:[40,26,44]},{index:.13,rgb:[59,49,90]},{index:.25,rgb:[64,76,139]},{index:.38,rgb:[63,110,151]},{index:.5,rgb:[72,142,158]},{index:.63,rgb:[85,174,163]},{index:.75,rgb:[120,206,163]},{index:.88,rgb:[187,230,172]},{index:1,rgb:[253,254,204]}],cdom:[{index:0,rgb:[47,15,62]},{index:.13,rgb:[87,23,86]},{index:.25,rgb:[130,28,99]},{index:.38,rgb:[171,41,96]},{index:.5,rgb:[206,67,86]},{index:.63,rgb:[230,106,84]},{index:.75,rgb:[242,149,103]},{index:.88,rgb:[249,193,135]},{index:1,rgb:[254,237,176]}],chlorophyll:[{index:0,rgb:[18,36,20]},{index:.13,rgb:[25,63,41]},{index:.25,rgb:[24,91,59]},{index:.38,rgb:[13,119,72]},{index:.5,rgb:[18,148,80]},{index:.63,rgb:[80,173,89]},{index:.75,rgb:[132,196,122]},{index:.88,rgb:[175,221,162]},{index:1,rgb:[215,249,208]}],density:[{index:0,rgb:[54,14,36]},{index:.13,rgb:[89,23,80]},{index:.25,rgb:[110,45,132]},{index:.38,rgb:[120,77,178]},{index:.5,rgb:[120,113,213]},{index:.63,rgb:[115,151,228]},{index:.75,rgb:[134,185,227]},{index:.88,rgb:[177,214,227]},{index:1,rgb:[230,241,241]}],"freesurface-blue":[{index:0,rgb:[30,4,110]},{index:.13,rgb:[47,14,176]},{index:.25,rgb:[41,45,236]},{index:.38,rgb:[25,99,212]},{index:.5,rgb:[68,131,200]},{index:.63,rgb:[114,156,197]},{index:.75,rgb:[157,181,203]},{index:.88,rgb:[200,208,216]},{index:1,rgb:[241,237,236]}],"freesurface-red":[{index:0,rgb:[60,9,18]},{index:.13,rgb:[100,17,27]},{index:.25,rgb:[142,20,29]},{index:.38,rgb:[177,43,27]},{index:.5,rgb:[192,87,63]},{index:.63,rgb:[205,125,105]},{index:.75,rgb:[216,162,148]},{index:.88,rgb:[227,199,193]},{index:1,rgb:[241,237,236]}],oxygen:[{index:0,rgb:[64,5,5]},{index:.13,rgb:[106,6,15]},{index:.25,rgb:[144,26,7]},{index:.38,rgb:[168,64,3]},{index:.5,rgb:[188,100,4]},{index:.63,rgb:[206,136,11]},{index:.75,rgb:[220,174,25]},{index:.88,rgb:[231,215,44]},{index:1,rgb:[248,254,105]}],par:[{index:0,rgb:[51,20,24]},{index:.13,rgb:[90,32,35]},{index:.25,rgb:[129,44,34]},{index:.38,rgb:[159,68,25]},{index:.5,rgb:[182,99,19]},{index:.63,rgb:[199,134,22]},{index:.75,rgb:[212,171,35]},{index:.88,rgb:[221,210,54]},{index:1,rgb:[225,253,75]}],phase:[{index:0,rgb:[145,105,18]},{index:.13,rgb:[184,71,38]},{index:.25,rgb:[186,58,115]},{index:.38,rgb:[160,71,185]},{index:.5,rgb:[110,97,218]},{index:.63,rgb:[50,123,164]},{index:.75,rgb:[31,131,110]},{index:.88,rgb:[77,129,34]},{index:1,rgb:[145,105,18]}],salinity:[{index:0,rgb:[42,24,108]},{index:.13,rgb:[33,50,162]},{index:.25,rgb:[15,90,145]},{index:.38,rgb:[40,118,137]},{index:.5,rgb:[59,146,135]},{index:.63,rgb:[79,175,126]},{index:.75,rgb:[120,203,104]},{index:.88,rgb:[193,221,100]},{index:1,rgb:[253,239,154]}],temperature:[{index:0,rgb:[4,35,51]},{index:.13,rgb:[23,51,122]},{index:.25,rgb:[85,59,157]},{index:.38,rgb:[129,79,143]},{index:.5,rgb:[175,95,130]},{index:.63,rgb:[222,112,101]},{index:.75,rgb:[249,146,66]},{index:.88,rgb:[249,196,65]},{index:1,rgb:[232,250,91]}],turbidity:[{index:0,rgb:[34,31,27]},{index:.13,rgb:[65,50,41]},{index:.25,rgb:[98,69,52]},{index:.38,rgb:[131,89,57]},{index:.5,rgb:[161,112,59]},{index:.63,rgb:[185,140,66]},{index:.75,rgb:[202,174,88]},{index:.88,rgb:[216,209,126]},{index:1,rgb:[233,246,171]}],"velocity-blue":[{index:0,rgb:[17,32,64]},{index:.13,rgb:[35,52,116]},{index:.25,rgb:[29,81,156]},{index:.38,rgb:[31,113,162]},{index:.5,rgb:[50,144,169]},{index:.63,rgb:[87,173,176]},{index:.75,rgb:[149,196,189]},{index:.88,rgb:[203,221,211]},{index:1,rgb:[254,251,230]}],"velocity-green":[{index:0,rgb:[23,35,19]},{index:.13,rgb:[24,64,38]},{index:.25,rgb:[11,95,45]},{index:.38,rgb:[39,123,35]},{index:.5,rgb:[95,146,12]},{index:.63,rgb:[152,165,18]},{index:.75,rgb:[201,186,69]},{index:.88,rgb:[233,216,137]},{index:1,rgb:[255,253,205]}],cubehelix:[{index:0,rgb:[0,0,0]},{index:.07,rgb:[22,5,59]},{index:.13,rgb:[60,4,105]},{index:.2,rgb:[109,1,135]},{index:.27,rgb:[161,0,147]},{index:.33,rgb:[210,2,142]},{index:.4,rgb:[251,11,123]},{index:.47,rgb:[255,29,97]},{index:.53,rgb:[255,54,69]},{index:.6,rgb:[255,85,46]},{index:.67,rgb:[255,120,34]},{index:.73,rgb:[255,157,37]},{index:.8,rgb:[241,191,57]},{index:.87,rgb:[224,220,93]},{index:.93,rgb:[218,241,142]},{index:1,rgb:[227,253,198]}]};function oR(o,e,t){return o*(1-t)+e*t}var sR=oR,yd=rR,ks=sR,aR=lR;function lR(o){var e,t,n,i,a,u,p,g,b,v,m;if(o||(o={}),g=(o.nshades||72)-1,p=o.format||"hex",u=o.colormap,u||(u="jet"),typeof u=="string"){if(u=u.toLowerCase(),!yd[u])throw Error(u+" not a supported colorscale");a=yd[u]}else if(Array.isArray(u))a=u.slice();else throw Error("unsupported colormap option",u);if(a.length>g+1)throw new Error(u+" map requires nshades to be at least size "+a.length);Array.isArray(o.alpha)?o.alpha.length!==2?v=[1,1]:v=o.alpha.slice():typeof o.alpha=="number"?v=[o.alpha,o.alpha]:v=[1,1],e=a.map(function(C){return Math.round(C.index*g)}),v[0]=Math.min(Math.max(v[0],0),1),v[1]=Math.min(Math.max(v[1],0),1);var E=a.map(function(C,A){var M=a[A].index,I=a[A].rgb.slice();return I.length===4&&I[3]>=0&&I[3]<=1||(I[3]=v[0]+(v[1]-v[0])*M),I}),b=[];for(m=0;m<e.length-1;++m){i=e[m+1]-e[m],t=E[m],n=E[m+1];for(var w=0;w<i;w++){var S=w/i;b.push([Math.round(ks(t[0],n[0],S)),Math.round(ks(t[1],n[1],S)),Math.round(ks(t[2],n[2],S)),ks(t[3],n[3],S)])}}return b.push(a[a.length-1].rgb.concat(v[1])),p==="hex"?b=b.map(cR):p==="rgbaString"?b=b.map(uR):p==="float"&&(b=b.map(hR)),b}function hR(o){return[o[0]/255,o[1]/255,o[2]/255,o[3]]}function cR(o){for(var e,t="#",n=0;n<3;++n)e=o[n],e=e.toString(16),t+=("00"+e).substr(e.length);return t}function uR(o){return"rgba("+o.join(",")+")"}const nh=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,fR=typeof AbortController!="undefined",gg=fR?AbortController:Object.assign(class{constructor(){this.signal=new gg.AbortSignal}abort(){this.signal.aborted=!0}},{AbortSignal:class{constructor(){this.aborted=!1}}}),nc=new Set,ih=(o,e)=>{const t=`LRU_CACHE_OPTION_${o}`;La(t)&&ic(t,`${o} option`,`options.${e}`,ai)},rh=(o,e)=>{const t=`LRU_CACHE_METHOD_${o}`;if(La(t)){const{prototype:n}=ai,{get:i}=Object.getOwnPropertyDescriptor(n,o);ic(t,`${o} method`,`cache.${e}()`,i)}},dR=(o,e)=>{const t=`LRU_CACHE_PROPERTY_${o}`;if(La(t)){const{prototype:n}=ai,{get:i}=Object.getOwnPropertyDescriptor(n,o);ic(t,`${o} property`,`cache.${e}`,i)}},La=o=>typeof process=="object"&&process&&!nc.has(o),ic=(o,e,t,n)=>{nc.add(o);const i=`The ${e} is deprecated. Please use ${t} instead.`;process.emitWarning(i,"DeprecationWarning",o,n)},Mi=o=>o&&o===Math.floor(o)&&o>0&&isFinite(o),_g=o=>Mi(o)?o<=Math.pow(2,8)?Uint8Array:o<=Math.pow(2,16)?Uint16Array:o<=Math.pow(2,32)?Uint32Array:o<=Number.MAX_SAFE_INTEGER?Ws:null:null;class Ws extends Array{constructor(e){super(e);this.fill(0)}}class pR{constructor(e){const t=e?_g(e):Array;this.heap=new t(e),this.length=0}push(e){this.heap[this.length++]=e}pop(){return this.heap[--this.length]}}class ai{constructor(e={}){const{max:t=0,ttl:n,ttlResolution:i=1,ttlAutopurge:a,updateAgeOnGet:u,allowStale:p,dispose:g,disposeAfter:v,noDisposeOnSet:m,noUpdateTTL:E,maxSize:b=0,sizeCalculation:w,fetchMethod:S}=e,{length:C,maxAge:A,stale:M}=e instanceof ai?{}:e;if(t!==0&&!Mi(t))throw new TypeError("max option must be a nonnegative integer");const I=t?_g(t):Array;if(!I)throw new Error("invalid max value: "+t);if(this.max=t,this.maxSize=b,this.sizeCalculation=w||C,this.sizeCalculation){if(!this.maxSize)throw new TypeError("cannot set sizeCalculation without setting maxSize");if(typeof this.sizeCalculation!="function")throw new TypeError("sizeCalculation set to non-function")}if(this.fetchMethod=S||null,this.fetchMethod&&typeof this.fetchMethod!="function")throw new TypeError("fetchMethod must be a function if specified");if(this.keyMap=new Map,this.keyList=new Array(t).fill(null),this.valList=new Array(t).fill(null),this.next=new I(t),this.prev=new I(t),this.head=0,this.tail=0,this.free=new pR(t),this.initialFill=1,this.size=0,typeof g=="function"&&(this.dispose=g),typeof v=="function"?(this.disposeAfter=v,this.disposed=[]):(this.disposeAfter=null,this.disposed=null),this.noDisposeOnSet=!!m,this.noUpdateTTL=!!E,this.maxSize!==0){if(!Mi(this.maxSize))throw new TypeError("maxSize must be a positive integer if specified");this.initializeSizeTracking()}if(this.allowStale=!!p||!!M,this.updateAgeOnGet=!!u,this.ttlResolution=Mi(i)||i===0?i:1,this.ttlAutopurge=!!a,this.ttl=n||A||0,this.ttl){if(!Mi(this.ttl))throw new TypeError("ttl must be a positive integer if specified");this.initializeTTLTracking()}if(this.max===0&&this.ttl===0&&this.maxSize===0)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!this.max&&!this.maxSize){const L="LRU_CACHE_UNBOUNDED";if(La(L)){nc.add(L);const k="TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.";process.emitWarning(k,"UnboundedCacheWarning",L,ai)}}M&&ih("stale","allowStale"),A&&ih("maxAge","ttl"),C&&ih("length","sizeCalculation")}getRemainingTTL(e){return this.has(e)?1/0:0}initializeTTLTracking(){this.ttls=new Ws(this.max),this.starts=new Ws(this.max),this.setItemTTL=(n,i)=>{if(this.starts[n]=i!==0?nh.now():0,this.ttls[n]=i,i!==0&&this.ttlAutopurge){const a=setTimeout(()=>{this.isStale(n)&&this.delete(this.keyList[n])},i+1);a.unref&&a.unref()}},this.updateItemAge=n=>{this.starts[n]=this.ttls[n]!==0?nh.now():0};let e=0;const t=()=>{const n=nh.now();if(this.ttlResolution>0){e=n;const i=setTimeout(()=>e=0,this.ttlResolution);i.unref&&i.unref()}return n};this.getRemainingTTL=n=>{const i=this.keyMap.get(n);return i===void 0?0:this.ttls[i]===0||this.starts[i]===0?1/0:this.starts[i]+this.ttls[i]-(e||t())},this.isStale=n=>this.ttls[n]!==0&&this.starts[n]!==0&&(e||t())-this.starts[n]>this.ttls[n]}updateItemAge(e){}setItemTTL(e,t){}isStale(e){return!1}initializeSizeTracking(){this.calculatedSize=0,this.sizes=new Ws(this.max),this.removeItemSize=e=>this.calculatedSize-=this.sizes[e],this.requireSize=(e,t,n,i)=>{if(!Mi(n))if(i){if(typeof i!="function")throw new TypeError("sizeCalculation must be a function");if(n=i(t,e),!Mi(n))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}else throw new TypeError("invalid size value (must be positive integer)");return n},this.addItemSize=(e,t,n,i)=>{this.sizes[e]=i;const a=this.maxSize-this.sizes[e];for(;this.calculatedSize>a;)this.evict();this.calculatedSize+=this.sizes[e]},this.delete=e=>{if(this.size!==0){const t=this.keyMap.get(e);t!==void 0&&(this.calculatedSize-=this.sizes[t])}return ai.prototype.delete.call(this,e)}}removeItemSize(e){}addItemSize(e,t,n,i){}requireSize(e,t,n,i){if(n||i)throw new TypeError("cannot set size without setting maxSize on cache")}*indexes({allowStale:e=this.allowStale}={}){if(this.size)for(let t=this.tail;!(!this.isValidIndex(t)||((e||!this.isStale(t))&&(yield t),t===this.head));)t=this.prev[t]}*rindexes({allowStale:e=this.allowStale}={}){if(this.size)for(let t=this.head;!(!this.isValidIndex(t)||((e||!this.isStale(t))&&(yield t),t===this.tail));)t=this.next[t]}isValidIndex(e){return this.keyMap.get(this.keyList[e])===e}*entries(){for(const e of this.indexes())yield[this.keyList[e],this.valList[e]]}*rentries(){for(const e of this.rindexes())yield[this.keyList[e],this.valList[e]]}*keys(){for(const e of this.indexes())yield this.keyList[e]}*rkeys(){for(const e of this.rindexes())yield this.keyList[e]}*values(){for(const e of this.indexes())yield this.valList[e]}*rvalues(){for(const e of this.rindexes())yield this.valList[e]}[Symbol.iterator](){return this.entries()}find(e,t={}){for(const n of this.indexes())if(e(this.valList[n],this.keyList[n],this))return this.get(this.keyList[n],t)}forEach(e,t=this){for(const n of this.indexes())e.call(t,this.valList[n],this.keyList[n],this)}rforEach(e,t=this){for(const n of this.rindexes())e.call(t,this.valList[n],this.keyList[n],this)}get prune(){return rh("prune","purgeStale"),this.purgeStale}purgeStale(){let e=!1;for(const t of this.rindexes({allowStale:!0}))this.isStale(t)&&(this.delete(this.keyList[t]),e=!0);return e}dump(){const e=[];for(const t of this.indexes()){const n=this.keyList[t],a={value:this.valList[t]};this.ttls&&(a.ttl=this.ttls[t]),this.sizes&&(a.size=this.sizes[t]),e.unshift([n,a])}return e}load(e){this.clear();for(const[t,n]of e)this.set(t,n.value,n)}dispose(e,t,n){}set(e,t,{ttl:n=this.ttl,noDisposeOnSet:i=this.noDisposeOnSet,size:a=0,sizeCalculation:u=this.sizeCalculation,noUpdateTTL:p=this.noUpdateTTL}={}){a=this.requireSize(e,t,a,u);let g=this.size===0?void 0:this.keyMap.get(e);if(g===void 0)g=this.newIndex(),this.keyList[g]=e,this.valList[g]=t,this.keyMap.set(e,g),this.next[this.tail]=g,this.prev[g]=this.tail,this.tail=g,this.size++,this.addItemSize(g,t,e,a),p=!1;else{const v=this.valList[g];t!==v&&(this.isBackgroundFetch(v)?v.__abortController.abort():i||(this.dispose(v,e,"set"),this.disposeAfter&&this.disposed.push([v,e,"set"])),this.removeItemSize(g),this.valList[g]=t,this.addItemSize(g,t,e,a)),this.moveToTail(g)}if(n!==0&&this.ttl===0&&!this.ttls&&this.initializeTTLTracking(),p||this.setItemTTL(g,n),this.disposeAfter)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift());return this}newIndex(){return this.size===0?this.tail:this.size===this.max?this.evict():this.free.length!==0?this.free.pop():this.initialFill++}pop(){if(this.size){const e=this.valList[this.head];return this.evict(),e}}evict(){const e=this.head,t=this.keyList[e],n=this.valList[e];return this.isBackgroundFetch(n)?n.__abortController.abort():(this.dispose(n,t,"evict"),this.disposeAfter&&this.disposed.push([n,t,"evict"])),this.removeItemSize(e),this.head=this.next[e],this.keyMap.delete(t),this.size--,e}has(e){return this.keyMap.has(e)&&!this.isStale(this.keyMap.get(e))}peek(e,{allowStale:t=this.allowStale}={}){const n=this.keyMap.get(e);if(n!==void 0&&(t||!this.isStale(n)))return this.valList[n]}backgroundFetch(e,t,n){const i=t===void 0?void 0:this.valList[t];if(this.isBackgroundFetch(i))return i;const a=new gg,u={signal:a.signal,options:n},p=Promise.resolve(this.fetchMethod(e,i,u)).then(g=>(a.signal.aborted||this.set(e,g,u.options),g));return p.__abortController=a,p.__staleWhileFetching=i,t===void 0?(this.set(e,p,u.options),t=this.keyMap.get(e)):this.valList[t]=p,p}isBackgroundFetch(e){return e&&typeof e=="object"&&typeof e.then=="function"&&Object.prototype.hasOwnProperty.call(e,"__staleWhileFetching")}async fetch(e,{allowStale:t=this.allowStale,updateAgeOnGet:n=this.updateAgeOnGet,ttl:i=this.ttl,noDisposeOnSet:a=this.noDisposeOnSet,size:u=0,sizeCalculation:p=this.sizeCalculation,noUpdateTTL:g=this.noUpdateTTL}={}){if(!this.fetchMethod)return this.get(e,{allowStale:t,updateAgeOnGet:n});const v={allowStale:t,updateAgeOnGet:n,ttl:i,noDisposeOnSet:a,size:u,sizeCalculation:p,noUpdateTTL:g};let m=this.keyMap.get(e);if(m===void 0)return this.backgroundFetch(e,m,v);{const E=this.valList[m];if(this.isBackgroundFetch(E))return t&&E.__staleWhileFetching!==void 0?E.__staleWhileFetching:E;if(!this.isStale(m))return this.moveToTail(m),n&&this.updateItemAge(m),E;const b=this.backgroundFetch(e,m,v);return t&&b.__staleWhileFetching!==void 0?b.__staleWhileFetching:b}}get(e,{allowStale:t=this.allowStale,updateAgeOnGet:n=this.updateAgeOnGet}={}){const i=this.keyMap.get(e);if(i!==void 0){const a=this.valList[i],u=this.isBackgroundFetch(a);return this.isStale(i)?u?t?a.__staleWhileFetching:void 0:(this.delete(e),t?a:void 0):u?void 0:(this.moveToTail(i),n&&this.updateItemAge(i),a)}}connect(e,t){this.prev[t]=e,this.next[e]=t}moveToTail(e){e!==this.tail&&(e===this.head?this.head=this.next[e]:this.connect(this.prev[e],this.next[e]),this.connect(this.tail,e),this.tail=e)}get del(){return rh("del","delete"),this.delete}delete(e){let t=!1;if(this.size!==0){const n=this.keyMap.get(e);if(n!==void 0)if(t=!0,this.size===1)this.clear();else{this.removeItemSize(n);const i=this.valList[n];this.isBackgroundFetch(i)?i.__abortController.abort():(this.dispose(i,e,"delete"),this.disposeAfter&&this.disposed.push([i,e,"delete"])),this.keyMap.delete(e),this.keyList[n]=null,this.valList[n]=null,n===this.tail?this.tail=this.prev[n]:n===this.head?this.head=this.next[n]:(this.next[this.prev[n]]=this.next[n],this.prev[this.next[n]]=this.prev[n]),this.size--,this.free.push(n)}}if(this.disposed)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift());return t}clear(){for(const e of this.rindexes({allowStale:!0})){const t=this.valList[e];if(this.isBackgroundFetch(t))t.__abortController.abort();else{const n=this.keyList[e];this.dispose(t,n,"delete"),this.disposeAfter&&this.disposed.push([t,n,"delete"])}}if(this.keyMap.clear(),this.valList.fill(null),this.keyList.fill(null),this.ttls&&(this.ttls.fill(0),this.starts.fill(0)),this.sizes&&this.sizes.fill(0),this.head=0,this.tail=0,this.initialFill=1,this.free.length=0,this.calculatedSize=0,this.size=0,this.disposed)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift())}get reset(){return rh("reset","clear"),this.clear}get length(){return dR("length","size"),this.size}}var gR=ai;function _R(o){let e,t,n,i,a,u=o[0].showingType+"",p,g,v,m,E,b,w,S,C,A,M,I;function L(N){o[5](N)}let k={names:o[1],color:"slate"};return o[0].showingType!==void 0&&(k.curr=o[0].showingType),v=new js({props:k}),Fs.push(()=>Ns(v,"curr",L)),{c(){e=Kt("section"),t=Kt("div"),n=Kt("p"),i=kn("Now showing: "),a=Kt("span"),p=kn(u),g=Le(),br(v.$$.fragment),E=Le(),b=Kt("div"),w=Kt("div"),S=Kt("canvas"),C=Le(),A=Kt("div"),M=Kt("canvas"),this.h()},l(N){e=Zt(N,"SECTION",{class:!0});var G=oe(e);t=Zt(G,"DIV",{});var z=oe(t);n=Zt(z,"P",{class:!0});var V=oe(n);i=Fn(V,"Now showing: "),a=Zt(V,"SPAN",{class:!0});var Y=oe(a);p=Fn(Y,u),Y.forEach(Gt),V.forEach(Gt),z.forEach(Gt),g=De(G),Er(v.$$.fragment,G),E=De(G),b=Zt(G,"DIV",{class:!0});var X=oe(b);w=Zt(X,"DIV",{class:!0});var J=oe(w);S=Zt(J,"CANVAS",{id:!0}),oe(S).forEach(Gt),J.forEach(Gt),C=De(X),A=Zt(X,"DIV",{class:!0});var q=oe(A);M=Zt(q,"CANVAS",{id:!0}),oe(M).forEach(Gt),q.forEach(Gt),X.forEach(Gt),G.forEach(Gt),this.h()},h(){wt(a,"class","text-white"),wt(n,"class","text-lg text-slate-100"),wt(S,"id","myChart"),wt(w,"class","relative"),wt(M,"id","bar"),wt(A,"class","relative"),wt(b,"class","mt-2 flex w-[50vw] max-w-[600px] flex-col"),wt(e,"class","flex flex-col gap-y-2")},m(N,G){gn(N,e,G),St(e,t),St(t,n),St(n,i),St(n,a),St(a,p),St(e,g),Tr(v,e,null),St(e,E),St(e,b),St(b,w),St(w,S),St(b,C),St(b,A),St(A,M),I=!0},p(N,[G]){(!I||G&1)&&u!==(u=N[0].showingType+"")&&Hs(p,u);const z={};!m&&G&1&&(m=!0,z.curr=N[0].showingType,Bs(()=>m=!1)),v.$set(z)},i(N){I||(Bi(v.$$.fragment,N),I=!0)},o(N){Gi(v.$$.fragment,N),I=!1},d(N){N&&Gt(e),wr(v)}}}function vR(o,e,t){let n;bd(o,Ln,I=>t(0,n=I));let{data:i}=e;const a=i.coords,u=i.by_row;delete i.coords,delete i.by_row;const p={},g=[],v=[];for(const[I,L]of Object.keys(i).entries())p[L]=I,v.push(L),g.push(Math.max(...i[L]));let m,E;const b=aR({colormap:"viridis",nshades:255,format:"hex"});function w(I){return i[I].map(L=>b[Math.round(L/g[p[I]]*255)])}function S(I){const L=new gR({max:100});return(...k)=>{if(L.has(k))return L.get(k);{const N=I(...k);return L.set(k,N),N}}}const C=S(w);function A(I,L){!I||(I.data.datasets[0].backgroundColor=C(L),I.update())}Ed(()=>{const I=document.getElementById("myChart").getContext("2d");lr(Ln,n.showingType=v[0],n),t(3,m=new vd(I,{type:"scatter",data:{datasets:[{data:a,backgroundColor:C(n.showingType),normalized:!0,pointRadius:2.5,pointHoverRadius:15,pointHoverBorderWidth:1,pointHoverBorderColor:"#eeeeee"}]},options:{animation:!1,aspectRatio:1,scales:{x:{ticks:{display:!1}},y:{ticks:{display:!1}}},plugins:{legend:{display:!1},tooltip:{enabled:!1}},onHover:(k,N,G)=>{N.length!==0&&lr(Ln,n.currIdx=N[0].index,n)},onClick:(k,N,G)=>{if(N.length===0)return;const z=N[0].index;if(N[0].element.options.radius=100,m.update(),z===n.locked){lr(Ln,n.locked=-1,n);return}lr(Ln,n.lockedCoords=a[z],n),lr(Ln,n.locked=z,n)}}}));const L=document.getElementById("bar").getContext("2d");t(4,E=new vd(L,{type:"bar",data:{datasets:[{data:u[0],backgroundColor:"white",normalized:!0}]},options:{scales:{x:{color:"white",grid:{borderColor:"white"},ticks:{color:"white"}},y:{min:0,max:10,grid:{borderColor:"white"},ticks:{color:"white"}}},animation:{duration:200},plugins:{tooltip:{enabled:!1},legend:{display:!1}}}}))});function M(I){o.$$.not_equal(n.showingType,I)&&(n.showingType=I,Ln.set(n))}return o.$$set=I=>{"data"in I&&t(2,i=I.data)},o.$$.update=()=>{o.$$.dirty&17&&(lr(Ln,n.currCoords=a[n.currIdx],n),E&&(n.locked!==-1?t(4,E.data.datasets[0].data=u[n.locked],E):t(4,E.data.datasets[0].data=u[n.currIdx],E),E.update())),o.$$.dirty&9&&A(m,n.showingType)},[n,v,i,m,E,M]}class yR extends da{constructor(e){super();pa(this,e,vR,_R,ga,{data:2})}}const mR="https://f004.backblazeb2.com/file/chaichontat-host/libd-rotation/",md=["Astro","Endo","Excit","Inhib","MSN.D1","MSN.D2","Macrophage","Micro","Mural","Neu","OPC","Oligo","Tcell","by_row","coords"];var xR=async o=>(await Promise.all(md.map(t=>fetch(`${mR}/${o}/${t}.json`).then(n=>n.json())))).reduce((t,n,i)=>qn(On({},t),{[md[i]]:n}),{});function bR(o){return{c:me,l:me,m:me,p:me,i:me,o:me,d:me}}function ER(o){let e,t,n,i;return e=new yR({props:{data:o[1]}}),n=new iR({props:{sample:fa}}),{c(){br(e.$$.fragment),t=Le(),br(n.$$.fragment)},l(a){Er(e.$$.fragment,a),t=De(a),Er(n.$$.fragment,a)},m(a,u){Tr(e,a,u),gn(a,t,u),Tr(n,a,u),i=!0},p:me,i(a){i||(Bi(e.$$.fragment,a),Bi(n.$$.fragment,a),i=!0)},o(a){Gi(e.$$.fragment,a),Gi(n.$$.fragment,a),i=!1},d(a){wr(e,a),a&&Gt(t),wr(n,a)}}}function TR(o){return{c:me,l:me,m:me,p:me,i:me,o:me,d:me}}function wR(o){let e,t,n,i,a,u,p,g,v,m,E,b={ctx:o,current:null,token:null,hasCatch:!1,pending:TR,then:ER,catch:bR,value:1,blocks:[,,,]};return Zy(o[0],b),{c(){e=Kt("h1"),t=kn("Visium "),n=Kt("span"),i=kn("IF"),a=Le(),u=Kt("h3"),p=kn("Sample: "),g=kn(fa),v=Le(),m=Kt("main"),b.block.c(),this.h()},l(w){e=Zt(w,"H1",{class:!0});var S=oe(e);t=Fn(S,"Visium "),n=Zt(S,"SPAN",{class:!0});var C=oe(n);i=Fn(C,"IF"),C.forEach(Gt),S.forEach(Gt),a=De(w),u=Zt(w,"H3",{class:!0});var A=oe(u);p=Fn(A,"Sample: "),g=Fn(A,fa),A.forEach(Gt),v=De(w),m=Zt(w,"MAIN",{class:!0});var M=oe(m);b.block.l(M),M.forEach(Gt),this.h()},h(){wt(n,"class","fancy svelte-ul317a"),wt(e,"class","order-1 mb-2 text-3xl font-bold text-white sm:text-5xl sm:leading-none"),wt(u,"class","mb-6 text-lg text-slate-100"),wt(m,"class","grid grid-cols-1 gap-x-2 md:grid-cols-2")},m(w,S){gn(w,e,S),St(e,t),St(e,n),St(n,i),gn(w,a,S),gn(w,u,S),St(u,p),St(u,g),gn(w,v,S),gn(w,m,S),b.block.m(m,b.anchor=null),b.mount=()=>m,b.anchor=null,E=!0},p(w,[S]){o=w,qy(b,o,S)},i(w){E||(Bi(b.block),E=!0)},o(w){for(let S=0;S<3;S+=1){const C=b.blocks[S];Gi(C)}E=!1},d(w){w&&Gt(e),w&&Gt(a),w&&Gt(u),w&&Gt(v),w&&Gt(m),b.block.d(),b.token=null,b=null}}}const fa="Br6522_Ant_IF";function SR(o){return[xR(fa)]}class XR extends da{constructor(e){super();pa(this,e,SR,wR,ga,{})}}export{GR as L,XR as R,zR as a};
